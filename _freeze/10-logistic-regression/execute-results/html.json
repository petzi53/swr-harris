{
  "hash": "a1e2dcebeee8274643ce3e4faeebcabb",
  "result": {
    "engine": "knitr",
    "markdown": "# Binary logistic regression {#sec-chap10}\n\n\n\n\n\n## Achievements to unlock\n\n::: {#obj-chap10}\n::: my-objectives\n::: my-objectives-header\nObjectives for chapter 10\n:::\n\n::: my-objectives-container\n**SwR Achievements**\n\n-   **Achievement 1**: Using exploratory data analysis before developing\n    a logistic regression models (@sec-chap10-achievement1)\n-   **Achievement 2**: Understanding the binary logistic regression\n    statistical model (@sec-chap10-achievement2)\n-   **Achievement 3**: Estimating a simple logistic regression model and\n    interpreting predictor significance and interpretation (@sec-chap10-achievement3)\n-   **Achievement 4**: Computing and interpreting two measures of model\n    fit (@sec-chap10-achievement4)\n-   **Achievement 5**: Estimating a larger logistic regression model\n    with categorical and continuous predictors (@sec-chap10-achievement5)\n-   **Achievement 6**: Interpreting the results of a larger logistic\n    regression model (@sec-chap10-achievement6)\n-   **Achievement 7**: Checking logistic regression assumptions and\n    using diagnostics to identify outliers and influential values (@sec-chap10-achievement7)\n-   **Achievement 8**: Using the model to predict probabilities for\n    observations that are outside the data set (@sec-chap10-achievement8)\n-   **Achievement 9**: Adding and interpreting interaction terms in\n    logistic regression (@sec-chap10-achievement9)\n-   **Achievement 10**: Using the likelihood ratio test to compare two\n    nested logistic regression models (@sec-chap10-achievement10)\n:::\n:::\n\nAchievements for chapter 10\n:::\n\n## The perplexing libraries problem\n\nHarris defines <a class='glossary' title='The term “digital divide” refers to the gap between individuals, households, businesses and geographic areas at different socio-economic levels with regard to their opportunities to access information and communication technologies (ICTs). (OECD Library)'>digital divide</a> broader and includes both limited access\nto information and communication technologies (ICT) and a deficit in the\nability to use information gained through access to\nICTs[^10-logistic-regression-1]. \n\n[^10-logistic-regression-1]: My current research indicates that mostly\n    only the first problem (limited access) falls under the definition\n    ([@wikipedia2024; @oecd2001].\n\nPeople were more likely to fall into this digital divide if they were poor, a racial minority, had limited education, had a disability, or lived in an area with low population density. The digital divide often exacerbated other problems like finding an employment either by not searching relevant offers using the internet or not getting the job because of missing ICT skills.\n\nThe question this chapter tries to answer: \"Which characteristics are associated with library use?\"\n\n\n\n\n## Resources & Chapter Outline\n\n### Data, codebook, and R packages {#sec-chap10-data-codebook-packages}\n\n::: my-resource\n::: my-resource-header\nData, codebook, and R packages for learning about descriptive statistics\n:::\n\n::: my-resource-container\n**Data**\n\nTwo options for accessing the data:\n\n1. Download the cleaned data set `pew_libraries_2016_cleaned_ch10.csv` from <https://edge.sagepub.com/harris1e>. \n2. Follow the instructions in Box 10.1 to import and clean `pew_libraries_2016_ch10.csv` from <https://edge.sagepub.com/harris1e> or download from the original Internet data source and clean.\n\nI am using the first option because there is nothing new for me to import and clean data files.\n\n**Codebook**\n\nTwo options:\n\n1. Download the `pew_libraries_2016_codebook_ch10.docx` codebook file from <https://edge.sagepub.com/harris1e>.\n2. Use the version that comes with the raw data file from Pew Research Center (https://www.pewinternet.org/dataset/march2016-libraries/)\n\n**Packages**\n\n1.  Packages used with the book (sorted alphabetically)\n\n-   {**car**}: @pak-car (John Fox)\n-   {**lmtest**}: @pak-lmtest (Achim Zeileis) \n-   {**odds.n.ends**}: @pak-odds.n.ends (Jenine Harris) \n-   {**tableone**}: @pak-tableone (Kazuki Yoshida) \n-   {**tidyverse**}: @pak-tidyverse (Hadley Wickham)\n\n2.  My additional packages (sorted alphabetically)\n\n-   {**skimr**}: @pak-skimr (Elin Waring)\n\n:::\n:::\n\n## Achievement 1: EDA {#sec-chap10-achievement1}\n\n### Get, show, and recode data\n\n:::::{.my-example}\n:::{.my-example-header}\n:::::: {#exm-chap09-eda}\n: EDA: Get, show and recode data\n::::::\n:::\n::::{.my-example-container}\n\n::: {.panel-tabset}\n\n###### Get data\n\n:::::{.my-r-code}\n:::{.my-r-code-header}\n:::::: {#cnj-chap10-get-data}\n: Import data from .csv file\n::::::\n:::\n::::{.my-r-code-container}\n::: {#lst-chap10-get-data}\n\n::: {.cell}\n\n```{.r .cell-code}\n## run only once (manually)\ntbl10 <- readr::read_csv(\n    \"data/chap10/pew_libraries_2016_cleaned_ch10.csv\",\n    col_types = \"nffffffff\"\n)\n\nsave_data_file(\"chap10\", tbl10, \"tbl10.rds\")\n```\n:::\n\nGet data for chapter 10\n:::\n\n(*For this R code chunk is no output available*)\n\n***\n\nIn my first import trial it turned out that all the factor variables are imported as character variables. So I had to add the columns specifications `col_types = \"nffffffff\"`.\n\n::::\n:::::\n\n\n###### Show data\n\n:::::{.my-r-code}\n:::{.my-r-code-header}\n:::::: {#cnj-chap10-show-data}\n: Show raw data for chapter 10\n::::::\n:::\n::::{.my-r-code-container}\n::: {#lst-chap10-show-data}    \n\n::: {.cell}\n\n```{.r .cell-code}\ntbl10 <- base::readRDS(\"data/chap10/tbl10.rds\")\n\nskimr::skim(tbl10)\n```\n\n::: {.cell-output-display}\n\nTable: Data summary\n\n|                         |      |\n|:------------------------|:-----|\n|Name                     |tbl10 |\n|Number of rows           |1601  |\n|Number of columns        |9     |\n|_______________________  |      |\n|Column type frequency:   |      |\n|factor                   |8     |\n|numeric                  |1     |\n|________________________ |      |\n|Group variables          |None  |\n\n\n**Variable type: factor**\n\n|skim_variable | n_missing| complete_rate|ordered | n_unique|top_counts                    |\n|:-------------|---------:|-------------:|:-------|--------:|:-----------------------------|\n|sex           |         0|          1.00|FALSE   |        2|mal: 833, fem: 768            |\n|parent        |         5|          1.00|FALSE   |        2|not: 1205, par: 391           |\n|disabled      |         8|          1.00|FALSE   |        2|no: 1340, yes: 253            |\n|uses.lib      |         0|          1.00|FALSE   |        2|no: 809, yes: 792             |\n|ses           |         0|          1.00|FALSE   |        3|med: 1197, low: 246, hig: 158 |\n|raceth        |       140|          0.91|FALSE   |        3|Non: 1097, His: 194, Non: 170 |\n|educ          |         0|          1.00|FALSE   |        3|HS : 772, Fou: 658, < H: 171  |\n|rurality      |        14|          0.99|FALSE   |        3|rur: 879, sub: 355, urb: 353  |\n\n\n**Variable type: numeric**\n\n|skim_variable | n_missing| complete_rate|  mean|    sd| p0| p25| p50| p75| p100|hist  |\n|:-------------|---------:|-------------:|-----:|-----:|--:|---:|---:|---:|----:|:-----|\n|age           |        30|          0.98| 49.31| 18.85| 16|  33|  51|  64|   95|▆▅▇▆▁ |\n\n\n:::\n:::\n\n\nSkim raw data for chapter 10\n:::\n\n***\n\n\n\nI have used the {**skimr**} package instead of {**tableone**}. It wouldn't be necessary to plot a histogram for `age` to decide if the mean or median has to be used. The tiny histogram at the right side of the `age` line already shows that age is not normally distributed. But for the sake of practice I will create the histogram in the next tab.\n\n::::\n:::::\n\n###### age\n\n:::::{.my-r-code}\n:::{.my-r-code-header}\n:::::: {#cnj-chap10-age-hist}\n: Show age distribution\n::::::\n:::\n::::{.my-r-code-container}\n::: {#lst-chap10-age-dist}\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_hist_dnorm(tbl10, tbl10$age)\n```\n\n::: {.cell-output-display}\n![](10-logistic-regression_files/figure-html/age-dist-1.png){width=672}\n:::\n:::\n\n\nThe distribution of age in the 2016 Pew Research Center library use data set\n:::\n\n::::\n:::::\n\n###### {tableone}\n\n:::::{.my-r-code}\n:::{.my-r-code-header}\n:::::: {#cnj-chap10-desc-stats}\n: Table of descriptive statistics\n::::::\n:::\n::::{.my-r-code-container}\n::: {#lst-chap10-desc-stats}\n\n::: {.cell}\n\n```{.r .cell-code}\ntab_desc <- tableone::CreateTableOne(\n    data = tbl10,\n    strata = 'uses.lib',\n    vars = c(\"age\", \"sex\", \"parent\", \"disabled\",\n             \"ses\", \"raceth\", \"educ\", \"rurality\"))\n\nprint(tab_desc,\n      nonnormal = 'age',\n      showAllLevels = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#>                     Stratified by uses.lib\n#>                      level                    yes                 \n#>   n                                             792               \n#>   age (median [IQR])                          49.00 [31.00, 62.00]\n#>   sex (%)            female                     438 (55.3)        \n#>                      male                       354 (44.7)        \n#>   parent (%)         parent                     222 (28.2)        \n#>                      not parent                 566 (71.8)        \n#>   disabled (%)       no                         679 (86.3)        \n#>                      yes                        108 (13.7)        \n#>   ses (%)            medium                     585 (73.9)        \n#>                      high                        91 (11.5)        \n#>                      low                        116 (14.6)        \n#>   raceth (%)         Non-Hispanic White         540 (75.6)        \n#>                      Hispanic                    83 (11.6)        \n#>                      Non-Hispanic Black          91 (12.7)        \n#>   educ (%)           HS to 2-year degree        341 (43.1)        \n#>                      Four-year degree or more   382 (48.2)        \n#>                      < HS                        69 ( 8.7)        \n#>   rurality (%)       suburban                   196 (24.9)        \n#>                      rural                      401 (51.0)        \n#>                      urban                      189 (24.0)        \n#>                     Stratified by uses.lib\n#>                      no                   p      test   \n#>   n                    809                              \n#>   age (median [IQR]) 53.00 [35.00, 65.00]  0.001 nonnorm\n#>   sex (%)              330 (40.8)         <0.001        \n#>                        479 (59.2)                       \n#>   parent (%)           169 (20.9)          0.001        \n#>                        639 (79.1)                       \n#>   disabled (%)         661 (82.0)          0.024        \n#>                        145 (18.0)                       \n#>   ses (%)              612 (75.6)          0.088        \n#>                         67 ( 8.3)                       \n#>                        130 (16.1)                       \n#>   raceth (%)           557 (74.6)          0.110        \n#>                        111 (14.9)                       \n#>                         79 (10.6)                       \n#>   educ (%)             431 (53.3)         <0.001        \n#>                        276 (34.1)                       \n#>                        102 (12.6)                       \n#>   rurality (%)         159 (19.9)          0.002        \n#>                        478 (59.7)                       \n#>                        164 (20.5)\n```\n\n\n:::\n:::\n\n\nDescriptive statistics with bivariate tests using {**tableone**}\n:::\n***\n\n:::::{.my-remark}\n:::{.my-remark-header}\n:::::: {#rem-chap10-test-all-variables-together}\n: Printing bivariate tests for all variables --- a <a class='glossary' title='Questionable Research Practice (QRP) is a research practice that introduces bias, usually in pursuit of statistical significance; an example of such practices might be dropping or recoding values or variables solely to improve a model fit statistic. (SwR, GLossary)'>QRP</a>\n::::::\n:::\n::::{.my-remark-container}\nI am not feeling comfortable to use {**tableone**} to print descriptive statistics with bivariate test for all variables. Besides the mentioned danger of a <a class='glossary' title='Questionable Research Practice (QRP) is a research practice that introduces bias, usually in pursuit of statistical significance; an example of such practices might be dropping or recoding values or variables solely to improve a model fit statistic. (SwR, GLossary)'>questionable research practice</a> (QRP) in looking for statistically significance I would like to inspect the relationships more slowly and to see more details. I think at a minimum one should examine plots of the bivariate correlations. \n\nI have the same skepticism about the advice to \"examine the frequencies and percentages in the table to identify some possible categories that may be driving the significant results for the bivariate tests\". I think one should be guided to inspect more in detail in the first instance by theoretical assumptions, an approach that is fairly well demonstrated with Bayesian model design in \"Statistical Rethinking\" [@mcelreath2020]. \n\nTo facilitate <a class='glossary' title='Explorative Data Analysis is an approach of analyzing data sets to summarize their main characteristics, often using statistical graphics and other data visualization methods. A statistical model can be used or not, but primarily EDA is for seeing what the data can tell us beyond the formal modeling and thereby contrasts traditional hypothesis testing. (Wikipedia)'>exploratory data analysis</a> one could use packages that combine the analysis of different variables in one go, as my experiments with `GGally::ggpairs()` in @lst-chap09-plot-ggpairs or with `ggfortify::autoplot()` in @lst-chap09-test-ggfortify have shown. But this approach gets too overwhelming when there are more than 5-6 variables as I will demonstrate in @lst-chap10-bivariate-data with {**GGally**).\n\n\n::::\n:::::\n\n\n\n\n\n::::\n:::::\n\n###### {GGally}\n\n:::::{.my-r-code}\n:::{.my-r-code-header}\n:::::: {#cnj-chap10-bivariate-eda}\n: Bivariate exploratory data analysis for variables of chapter 10\n::::::\n:::\n::::{.my-r-code-container}\n::: {#lst-chap10-bivariate-data}\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntbl10 |> \n    GGally::ggpairs()\n```\n\n::: {.cell-output-display}\n![](10-logistic-regression_files/figure-html/plot-ggpairs-1.png){width=960}\n:::\n:::\n\n\nBivariate exploratory data analysis for variables of chapter 10\n:::\n\n*** \n\nThere are too many plots (variables) in this example. I could divide easily the amount of variables into different patches as demonstrated in [Columns and Mapping](https://ggobi.github.io/ggally/articles/ggpairs.html#columns-and-mapping) and inspect these results in more details. But in order to get all variations I have to plan the approach systematically which destroys the advantage of automatic plotting.\n\n::::\n:::::\n\n\n\n:::\n\n::::\n:::::\n\n\n## Achievement 2: Understanding binary logistic regression {#sec-chap10-achievement2}\n\nBinary logistic regression follows a similar format and process as linear regression (@sec-chap09), but the outcome or dependent variable is binary. Because the outcome is binary, or categorical consisting of two categories, the model predicts the probability that a person is in one of the two categories. In this chapter we want to predict the library use `uses.lib`.\n\nBecause of the binary outcome the linear regression model would not work since it requires a continuous outcome. However, the <a class='glossary' title='Linear regression is used to predict the value of an outcome variable Y based on one or more input predictor variables X. The aim is to establish a linear relationship (a mathematical formula) between the predictor variable(s) and the response variable, so that, we can use this formula to estimate the value of the response Y, when only the predictors (Xs) values are known. (r-statistics.co) (Chap.4)'>linear regression</a> statistical model can be transformed using <a class='glossary' title='Logit transformations are transformations that takes the log value of p/(1-p); this transformation is often used to normalize percentage data and is used in the logistic model to transform the outcome. (SwR, Glossary)'>logit transformations</a> in order to be useful for modeling binary outcomes.\n\n### Formula of the logistic model\n\n:::::{.my-theorem}\n:::{.my-theorem-header}\n:::::: {#thm-chap10-logistic-model}\n: Formula for the statistical form of the logistic model\n::::::\n:::\n::::{.my-theorem-container}\n$$\n\\begin{align*}\np(y) = \\frac{1}{1+e^{-(b_{0}+b_{1}x_{1}+b_{2}x_{2})}}\n\\end{align*}\n$$ {#eq-chap10-logistic-model}\n\n***\n\n- $y$: binary outcome variable (e.g., library use) \n- $p(y)$: probability of the outcome (e.g., probability of library use) \n- $b_{0}$: y-intercept \n- $x_{1}$ and $x_{2}$: predictors of the outcome (e.g., age, rurality) \n- $b_{1}$ and $b_{2}$: coefficients for $x_{1}$ and $x_{2}$\n\n::::\n:::::\n\n### Logistic function\n\nThe logistic function has a <a class='glossary' title='A sigmoid function is any mathematical function whose graph has a characteristic S-shaped curve or sigmoid curve. (Wikipedia)'>sigmoid</a> shape that stretches from $–∞$ to $∞$ on the x-axis and from $0$ to $1$ on the y-axis. The function can take any value along the x-axis and give the corresponding value between $0$ and $1$ on the y-axis.\n\n:::::{.my-theorem}\n:::{.my-theorem-header}\n:::::: {#thm-chap10-logistic-function}\n: Formula of the logistic function\n::::::\n:::\n::::{.my-theorem-container}\n$$\n\\begin{align*}\n\\sigma(t) &= \\frac{e^t}{1+e^t} =\\\\\n&= \\frac{1}{1 + e^{-t}}\n\\end{align*}\n$$ {#eq-chap10-logistic-function}\n\n***\n\n$t$: value along the $x$-axis of the function\n$\\sigma$: value of $y$ for a specific value of $t$, or the probability of $y$ given $t$.\n\nIn the case of logistic regression, the value of $t$ will be the right-hand side of the regression model, which looks something like $β_{0} + β_{1}x$, where $x$ is an independent variable, $β_{1}$ is the coefficient (rather than slope) for that variable, and $β_{0}$ is the constant (rather than $y$-intercept).\n\nSubstituting this regression model for $t$ in the logistic function:\n\n$$\n\\begin{align*}\np(y) = \\frac{1}{1 + e^{-(β_{0} + β_{1}x)}}\n\\end{align*}\n$$ {#eq-chap10-logistic-function}\n\n::::\n:::::\n\n:::::{.my-example}\n:::{.my-example-header}\n:::::: {#exm-chap10-logistic-function}\n: Drawing shape of logistic function empty and with example data points\n::::::\n:::\n::::{.my-example-container}\n\n::: {.panel-tabset}\n\n###### Shape\n\n:::::{.my-r-code}\n:::{.my-r-code-header}\n:::::: {#cnj-chap10-logistic-function-shape}\n: Shape of the logistic function\n::::::\n:::\n::::{.my-r-code-container}\n::: {#lst-chap10-logistic-function-shape}\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot2::ggplot(data = data.frame(x = c(-5, 5)), \n         ggplot2::aes(x)) +\n    ggplot2::stat_function(fun = \n           function(x) base::exp(x)/(1 + base::exp(x)), n = 100,\n           linewidth = 1,\n           ggplot2::aes(color = \"Logistic function\")\n           ) +\n    ggplot2::scale_x_continuous(\n        labels = seq.int(10, 35, length.out = 5)\n        ) +\n    ggplot2::scale_color_manual(\n        name = \"\",\n        values = \"hotpink2\"\n    ) +\n    ggplot2::labs(\n        x = \"Values of input\",\n        y = \"Value of outcome\"\n    )\n```\n\n::: {.cell-output-display}\n![](10-logistic-regression_files/figure-html/logistic-function-shape-1.png){width=672}\n:::\n:::\n\nShape of the logistic function\n:::\n\n::::\n:::::\n\n\n\n###### Example with data points\n\n:::::{.my-r-code}\n:::{.my-r-code-header}\n:::::: {#cnj-chap10-logistic-function-data}\n: Example of logistic function with data points\n::::::\n:::\n::::{.my-r-code-container}\n::: {#lst-chap10-logistic-function-data}    \n\n::: {.cell}\n\n```{.r .cell-code}\n## generate fake data frame\nx1 = c(10.2, 13.0, 14.1, 14.3, 14.5, 14.7, 15.0, 15.5, \n      16.1, 17.3, 19.0, 19.2, 19.8, 21.0, 26.5)\ny1 = rep(0, 15)\nx2 = c(17.8, 18.2, 19.0, 21.4, 21.5, 22.7, 24.0, 27.2, 31.0, 32.4, 33.8)\ny2 = rep(1, 11)\ntbl <-  tibble::tibble(x = c(x1, x2),\n                     y = c(y1, y2)) |> \n    dplyr::arrange(x)\n\n## draw logistic function with faked data points\nggplot2::ggplot( \n        data = tbl,\n        ggplot2::aes(x = x, y = y,\n                 color = \"Logistic function\")\n    ) +\n    ggplot2::stat_smooth(\n        data = tbl,\n        formula = y ~ x,\n        method = \"glm\",\n        se = FALSE,\n        method.args = list(family = binomial)\n    ) +\n    ggplot2::geom_point(\n        ggplot2::aes(alpha = \"Observation\"),\n        color = \"grey41\"\n    ) +\n    ggplot2::labs(\n        x = \"Values of input\",\n        y = \"Value of outcome\"\n    ) +\n    ggplot2::scale_color_manual(\n        name = \"\",\n        values = \"hotpink2\"\n    ) +\n    ggplot2::scale_alpha_manual(\n        name = \"\",\n        values = 0.5\n    )\n```\n\n::: {.cell-output-display}\n![](10-logistic-regression_files/figure-html/logistic-function-data-1.png){width=672}\n:::\n:::\n\n\nExample of logistic function with data points\n:::\n\n***\n\n::::\n:::::\n\n###### Probability of outcome\n\n:::::{.my-r-code}\n:::{.my-r-code-header}\n:::::: {#cnj-chap10-logistic-function-data-annotated}\n: Example of logistic function showing probability of outcome for x = 20\n::::::\n:::\n::::{.my-r-code-container}\n::: {#lst-chap10-logistic-function-data-annotated}    \n\n::: {.cell}\n\n```{.r .cell-code}\n## generate fake data frame\nx1 = c(10.2, 13.0, 14.1, 14.3, 14.5, 14.7, 15.0, 15.5, \n      16.1, 17.3, 19.0, 19.2, 19.8, 21.0, 26.5)\ny1 = rep(0, 15)\nx2 = c(17.8, 18.2, 19.0, 21.4, 21.5, 22.7, 24.0, 27.2, 31.0, 32.4, 33.8)\ny2 = rep(1, 11)\ntbl <-  tibble::tibble(x = c(x1, x2),\n                     y = c(y1, y2)) |> \n    dplyr::arrange(x)\n\n## draw logistic function with faked data points\nggplot2::ggplot( \n    data = tbl,\n    ggplot2::aes(x = x, y = y,\n                 color = \"Logistic function\")\n    ) +\n    ggplot2::stat_smooth(\n        data = tbl,\n        formula = y ~ x,\n        method = \"glm\",\n        se = FALSE,\n        method.args = list(family = binomial),\n        ggplot2::aes(linetype = \"predictor = 20 and\\noutcome = .44 example\")\n    ) +\n    ggplot2::geom_point(\n        ggplot2::aes(alpha = \"Observation\"),\n        color = \"grey41\"\n        ) +\n    ggplot2::geom_segment(\n        x = 20, xend = 20,\n        y = 0, yend = .44,\n        color = \"#1f6fca\",\n        linetype = \"dashed\"\n    ) +\n    ggplot2::geom_segment(\n        x = 10, xend = 20,\n        y = .44, yend = .44,\n        color = \"#1f6fca\",\n        linetype = \"dashed\"\n    ) +\n    ggplot2::labs(\n        x = \"Values of input\",\n        y = \"Value of outcome\"\n    ) +\n    ggplot2::scale_color_manual(\n        name = \"\",\n        values = \"hotpink2\"\n    ) +\n    ggplot2::scale_alpha_manual(\n        name = \"\",\n        values = 0.5\n    ) +\n    ggplot2::scale_linetype_manual(\n        name = \"\",\n        values = c(\"dashed\", \"dashed\")\n    ) +\n    ggplot2::annotate(\"text\", x = 10, y = .48, label = \"0.44\", color = \"#1f6fca\" ) +\n    ggplot2::annotate(\"text\", x = 20.5, y = -.02, label = \"20\", color = \"#1f6fca\" )\n```\n\n::: {.cell-output-display}\n![](10-logistic-regression_files/figure-html/logistic-function-data-annotated-1.png){width=672}\n:::\n:::\n\n\nExample of logistic function showing a probability of outcome for $x = 20$\n:::\n\n***\n\nLet's assume that the above graphic is a model for predicting library use from age. Then we can interpret it as a 44% probability of library use for a 20-year-old. Since 44% is lower than a 50% probability of the value of $y$, the model is predicting that the 20-year-old does not have the outcome. So, if the outcome is library use, the logistic model would predict this 20-year-old was not a library user. \n\n\n::::\n:::::\n\n:::\n\n\n\n\n\n::::\n:::::\n\n:::::{.my-theorem}\n:::{.my-theorem-header}\n:::::: {#thm-chap10-odds}\n: Formula of odds related to probability\n::::::\n:::\n::::{.my-theorem-container}\n$$\n\\begin{align*}\nodds = \\frac{probability}{1-probability}\n\\end{align*}\n$$ {#eq-chap10-odds}\n\nSubstituting the logistic model from @eq-chap10-logistic-model:\n\n$$\n\\begin{align*}\nodds &= \\frac{\\frac{1}{1+e^{-(\\beta_{0}+\\beta_{1}x)}}}{1- \\frac{1}{1+e^{-(\\beta_{0}+\\beta_{1}x)}}} = \ne^{\\beta_{0} + \\beta_{1}x}\n\\end{align*}\n$$ {#eq-chap10-odds-logistic-model}\n\nTo be equivalent to the interpretation of the coefficients in linear regression, however, there is one more step. That is, what is the increase or decrease in the odds of the outcome with a one-unit increase in $x$?\n\n\n$$\n\\begin{align*}\nOR = \\frac{e^{b_0+b_{1}(x+1)}}{e^{b_0+b_{1}x}}\n\\end{align*}\n$$ {#eq-chap10-odds-ratio}\n\n::::\n:::::\n\n@eq-chap10-odds-ratio shows that for every one-unit increase in the independent variable $x$, the odds of the outcome increase or decrease by $e^{b_1}$. Taking $e$ to the power of $b_1$ is referred to as exponentiating $b_1.$ After a model is estimated, the analyst will usually exponentiate the b value(s) in order to report odds ratios describing the relationships between each predictor and the outcome.\n\n## Achievement 3: Interpreting a simple logistic regression {#sec-chap10-achievement3}\n\n### NHST\n\n#### NHST Step 1\n\nWrite the null and alternate hypotheses:\n\n::: {.callout-note}\n- **H0**: The model is no better than the baseline at predicting library use.\n- **HA**: The model is better than the baseline at predicting library use.\n:::\n\n#### NHST Step 2\n\nCompute the test statistic. \n\nThe generalized linear model (<a class='glossary' title='A generalized linear model (GLM) is a flexible generalization of ordinary linear regression. The GLM generalizes linear regression by allowing the linear model to be related to the response variable via a link function and by allowing the magnitude of the variance of each measurement to be a function of its predicted value. (Wikipedia). the binary logistic regression model is one example of a generalized linear model. (SwR, Glossary)'>GLM</a>) or `stats::glm()` function can be used to estimate a binary logistic regression model. The model is generalized because it starts with the basic linear model and generalizes to other situations.\n\nThe `stats::glm()` function will treat the first category as the reference group (the group *without* the outcome) and the second category as the group *with* the outcome. To see the order of `uses.lib`, use `base::levels()` to show the levels in order and use `stats:relevel()` to re-order levels.\n\n:::::{.my-example}\n:::{.my-example-header}\n:::::: {#exm-ID-text}\n: Numbered Example Title\n::::::\n:::\n::::{.my-example-container}\n\n::: {.panel-tabset}\n\n###### Reorder `uses.lib`\n\n:::::{.my-r-code}\n:::{.my-r-code-header}\n:::::: {#cnj-chap10-uses-lib-order}\n: Reverse the order of `uses.lib`\n::::::\n:::\n::::{.my-r-code-container}\n::: {#lst-chap10-uses-lib-order}\n\n::: {.cell}\n\n```{.r .cell-code}\nglue::glue(\"Order of uses.lib levels originally\")\nbase::levels(tbl10$uses.lib)\n\ntbl10.1 <- tbl10 |> \n    dplyr::mutate(uses.lib =\n        forcats::fct_rev(uses.lib)\n    )\n\nsave_data_file(\"chap10\", tbl10.1, \"tbl10.1.rds\")\n\n\nglue::glue(\"\")\nglue::glue(\"---------------------------------------\")\nglue::glue(\"Order of uses.lib levels reversed\")\nbase::levels(tbl10.1$uses.lib)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> Order of uses.lib levels originally\n#> [1] \"yes\" \"no\" \n#> \n#> ---------------------------------------\n#> Order of uses.lib levels reversed\n#> [1] \"no\"  \"yes\"\n```\n\n\n:::\n:::\n\n\nReversing order of `uses.lib`\n:::\n\n::::\n:::::\n\nIn contrast to the book the order of my levels for the `uses.lib` data is reversed. It makes more sense to ask about if one uses the library, e.g., \"yes\" has to be the second category. To get the same order as in the book, I had to reverse the order. Instead of using `stats:relevel()` I reversed the order with `forcats::fct_rev()`.\n\n\n\n\n###### glm10.1\n\n:::::{.my-r-code}\n:::{.my-r-code-header}\n:::::: {#cnj-chap10-glm10.1}\n: Estimate library use model and print results\n::::::\n:::\n::::{.my-r-code-container}\n::: {#lst-chap10-glm10.1}    \n\n::: {.cell}\n\n```{.r .cell-code}\nglm10.1 <- \n    glm(\n        formula = uses.lib ~ age, \n        data = tbl10.1, \n        family = binomial(link = \"logit\")\n        ) \n\nsave_data_file(\"chap10\", glm10.1, \"glm10.1.rds\")\n\nbase::summary(glm10.1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> \n#> Call:\n#> glm(formula = uses.lib ~ age, family = binomial(link = \"logit\"), \n#>     data = tbl10.1)\n#> \n#> Coefficients:\n#>              Estimate Std. Error z value Pr(>|z|)   \n#> (Intercept)  0.403785   0.142194   2.840  0.00452 **\n#> age         -0.008838   0.002697  -3.277  0.00105 **\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> (Dispersion parameter for binomial family taken to be 1)\n#> \n#>     Null deviance: 2177.5  on 1570  degrees of freedom\n#> Residual deviance: 2166.7  on 1569  degrees of freedom\n#>   (30 observations deleted due to missingness)\n#> AIC: 2170.7\n#> \n#> Number of Fisher Scoring iterations: 3\n```\n\n\n:::\n:::\n\n\nEstimate the simple library use model and print (= summmarize) the results\n:::\n\n***\n\n@lst-chap10-glm10.1 uses `stats::family = binomial(link = \"logit\")`to specify the outcome variable. The \"family\" argument provides a description of the error distribution and link function to be used in the model. This is a convenient way to specify the details of the models and to distinguish between different types of generalized linear models that are appropriate for different kinds of outcome variables. In addition to the `glm()` help page you get additional information if you type [?family](https://rdrr.io/r/stats/family.html) into the console.\n\n::::\n:::::\n\n::: {.callout-warning #wrn-chap10-pkg-name-stats1}\n##### Problem with `stats::`-prefix in front of `glm()` in later R code\n\nBecause of an error in the coding of the DescTools::PseudoR2() function I had to delete my `stats::`-prefix in front of the `glm()` function in @lst-chap10-glm10.1. (See @wrn-chap10-pkg-name-stats2)\n:::\n\n\n\n###### Odds Ratio\n\n:::::{.my-r-code}\n:::{.my-r-code-header}\n:::::: {#cnj-chap10-compute-odds-ratio}\n: Get model fit, model significance, and odds ratios\n::::::\n:::\n::::{.my-r-code-container}\n::: {#lst-chap10-compute-odds-ratio}\n\n::: {.cell}\n\n```{.r .cell-code}\nodds.n.ends::odds.n.ends(glm10.1)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Waiting for profiling to be done...\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> $`Logistic regression model significance`\n#> Chi-squared        d.f.           p \n#>      10.815       1.000       0.001 \n#> \n#> $`Contingency tables (model fit): frequency predicted`\n#>                 Number observed\n#> Number predicted    1    0  Sum\n#>              1    338  298  636\n#>              0    435  500  935\n#>              Sum  773  798 1571\n#> \n#> $`Count R-squared (model fit): percent correctly predicted`\n#> [1] 53.34182\n#> \n#> $`Model sensitivity`\n#> [1] 0.4372574\n#> \n#> $`Model specificity`\n#> [1] 0.6265664\n#> \n#> $`Predictor odds ratios and 95% CI`\n#>                   OR     2.5 %    97.5 %\n#> (Intercept) 1.497482 1.1339164 1.9804811\n#> age         0.991201 0.9859589 0.9964415\n```\n\n\n:::\n:::\n\n\nModel fit, model significance, and odds ratios\n:::\n\n::::\n:::::\n\n\n:::\n\n::::\n:::::\n\n***\n\n#### NHST Step 3\n\nReview and interpret the test statistics: \nCalculate the probability that your test statistic is at least as big as it is if there is no relationship (i.e., the null is true).\n\n:::::{.my-example}\n:::{.my-example-header}\n:::::: {#exm-chap10-chi-squared-dist}\n: Chi-squared distribution with df = 1\n::::::\n:::\n::::{.my-example-container}\n\n::: {.panel-tabset}\n\n###### Theory: df = 1\n\n:::::{.my-r-code}\n:::{.my-r-code-header}\n:::::: {#cnj-chap10-chi-squared-graph}\n: Theoretical chi-squared distribution with df = 1 \n::::::\n:::\n::::{.my-r-code-container}\n::: {#lst-chap10-chi-squared-graph}\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot2::ggplot() +\n    ggplot2::xlim(0, 12) +\n    ggplot2::stat_function(\n        fun = dchisq,\n        args = list(df = 1),\n        linewidth = 1,\n        color = \"hotpink2\"\n    ) +\n    ggplot2::labs(\n        x = \"Chi-squared statistic\",\n        y = \"Probability density\"\n    )\n```\n\n::: {.cell-output-display}\n![](10-logistic-regression_files/figure-html/chi-squared-graph-theory-1.png){width=672}\n:::\n:::\n\n\nTheoretical chi-squared distribution with df = 1 \n:::\n\nGraphing the probability of the chi-squared distribution with 1 degree of freedom to show that the probability that the chi-squared would be 10.815 or higher --- if the null hypothesis were true --- is the very small area under the curve from 10.815 to the right.\n\nTo get a better look at the position $x = 10.815$ let's zoom into the critical region. See @lst-chap10-chi-squared-graph-zoomed.\n\n::::\n:::::\n\n\n###### Theory: df = 1, zoomed\n\n:::::{.my-r-code}\n:::{.my-r-code-header}\n:::::: {#cnj-chap10-chi-squared-graph-zoomed}\n: Theoretical chi-squared distribution with df = 1, zoomed into the critical region of  p = 10.815\n::::::\n:::\n::::{.my-r-code-container}\n::: {#lst-chap10-chi-squared-graph-zoomed}\n\n::: {.cell}\n\n```{.r .cell-code}\n## Define start of shade\nx_shade = 10.815 \ndf = 1\ny_shade = stats::dchisq(x_shade, df)\n\n\n\n## Define sequence of x-values\ntib <- tibble::tibble(x = seq(9, 20, length.out = 300)) |> \n    # Compute density values\n    dplyr::mutate(\n        y = stats::dchisq(x, df)\n    )\n\n## Subset data for shaded area\nshaded_area <- tib |> \n    dplyr::filter(x >= x_shade) |> \n    ## Necessary as starting point for y = 0!\n    tibble::add_row(x = x_shade, y = 0, .before = 1)\n\n\ntib |> \n    ## Plot the Chi-square distribution: df = 1\n    ggplot2::ggplot(ggplot2::aes(x = x, y = y)) +\n    ggplot2::geom_line(\n        linewidth = 1,\n        color = \"hotpink2\"\n    ) +\n    \n    ## Draw segment \n    ggplot2::geom_segment(\n        x = x_shade,\n        y = 0,\n        xend = x_shade,\n        yend = y_shade\n    ) +\n    \n    ## Shade curve\n    ggplot2::geom_polygon(\n        data = shaded_area, \n        fill = \"lightblue\",\n        ggplot2::aes(x = x, y = y)\n        ) +\n    ggplot2::labs(\n        x = \"Chi-squared statistic\",\n        y = \"Probability density\" \n    ) + \n    ggplot2::annotate(\n        geom = \"text\",\n        x = 11.5,\n        y = .00058,\n        label = base::round(stats::dchisq(x_shade, df), 6)\n    )\n```\n\n::: {.cell-output-display}\n![](10-logistic-regression_files/figure-html/chi-squared-graph-zoomed-1.png){width=672}\n:::\n:::\n\n\nTheoretical chi-squared distribution with df = 1, zoomed into the critical region \n:::\n\nHere we see that at the chi-square statistic of 10.815 the p-value is with .0005 very tiny and about 100 times much smaller as the level of statistical significance of .05. \n\n::::\n:::::\n\nWhen I developed above plots I wondered why in the book the graph is a rough line and the sample size (without NA's) of $n = 1501$ was mentioned. I learned that my curve was the theoretical curve whereas I need the randomized values to get a more rough simulation that is nearer the factual data.\n\n\n###### Randomized\n\n:::::{.my-r-code}\n:::{.my-r-code-header}\n:::::: {#cnj-chi-squared-graph-randomized}\n: Randomized chi-squared distribution with df = 1, n = 1571\n::::::\n:::\n::::{.my-r-code-container}\n::: {#lst-chi-squared-graph-randomized}    \n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\nn = 1571\ndf = 1\n\nchisq_dist <- tibble::tibble(x = stats::rchisq(n, df))\n\nchisq_dist |> \n    ggplot2::ggplot(\n        ggplot2::aes(x)\n    ) +\n    ggplot2::geom_density(\n        linewidth = 1,\n        color = \"hotpink2\"\n    ) +\n    ggplot2::labs(\n        x = \"Chi-squared statistic\",\n        y = \"Probability density\"\n    )\n```\n\n::: {.cell-output-display}\n![](10-logistic-regression_files/figure-html/chi-squared-graph-randomized-1.png){width=672}\n:::\n:::\n\n\nRandomized chi-squared distribution with df = 1, n = 1571\n:::\n\n\n\nThis is a randomized chi-squared distribution. I could not shade values $p > 10.815$ because there were only three rows with values greater than that. \n\n\n\n::::\n:::::\n\n:::::: {#tdo-chap10-empiricial-chisq-dist}\n:::::{.my-checklist}\n:::{.my-checklist-header}\nTODO: I wonder if I could provide an empirical chi-squared distribution with the actual data.\n:::\n\n:::::\nHow to plot an empirical chi-squared distribution with real data?\n:::\n\n:::\n\n\n::::\n:::::\n\n:::::{.my-resource}\n:::{.my-resource-header}\n:::::: {#lem-chap10-chisq-video}\n: Video about the chi-squared distribution\n::::::\n:::\n::::{.my-resource-container}\nI found a lengthy video tutorial (19:31) using RStudio featuring chi-squared distribution. You will see, <a class='glossary' title='A probability densitiy function (PDF) describes a probability distribution for a random, continuous variable. Use a probability density function to find the chances that the value of a random variable will occur within a range of values that you specify. More specifically, a PDF is a function where its integral for an interval provides the probability of a value occurring in that interval. (Statistics By Jim)'>pdf</a>, <a class='glossary' title='A cumulative distribution function (CDF) tells us the probability that a random variable takes on a value less than or equal to x. (Statology) It sums all parts of the distribution, replacing a lot of calculus work. The CDF takes in a value and returns the probability of getting that value or lower. (BF, Chap.13) A CDF is a hypothetical model of a distribution, the ECDF models empirical (i.e. observed) data. (Statistics How To)'>cdf</a>, <a class='glossary' title='Quantiles are cut points dividing the range of a probability distribution into continuous intervals with equal probabilities (Wikipedia)'>quantile</a>, plotting, examples, independence, <a class='glossary' title='The chi-squared goodness-of-fit test is used for comparing the values of a single categorical variable to values from a hypothesized or population variable. The goodness-of-fit test is often used when trying to determine if a sample is a good representation of the population. (SwR, Chap 5)'>goodness of fit</a> and explanations. There is also a accompanying web page with text and the code.\n::::\n:::::\n\n\n\n#### NHST Step 4\n\nConclude and write report.\n\n::: {.callout #rep-chap10-chisq-glm10.1}\nThe chi-squared test statistic for a logistic regression model with age predicting library use had a p-value of .001. This p-value indicates there is a .1% chance of a chi-squared statistic this large or larger if the null hypothesis were true. The null hypothesis is therefore rejected in favor of the alternate hypothesis that the model is better than the baseline at predicting library use. A logistic regression model including age was statistically significantly better than a null model at predicting library use [$χ^2(1) = 10.82; p = .001$].\n:::\n\n### Interpreting odds ratio significance\n\nBoth, `base::summary()` and `odds.n.ends::odds.n.ends()` included values and significance statistics for the age predictor. The `odds.n.ends()` output included <a class='glossary' title='Odds is usually defined in statistics as the probability an event will occur divided by the probability that it will not occur. An odds ratio (OR) is a measure of association between a certain property A and a second property B in a population. Specifically, it tells you how the presence or absence of property A has an effect on the presence or absence of property B. (Statistics How To). An odds ratio is a ratio of two ratios. They quantify the strength of the relationship between two conditions. They indicate how likely an outcome is to occur in one context relative to another. (Statistics by Jim)'>odds ratios</a>, which are easier to interpret. The outcome is transformed by the logistic function, therefore the coefficients from `summary()` are not easy to interpret directly.\n\nLooking at @lst-chap10-compute-odds-ratio we see that `age`has a odds ratio of .99. This could be interpreted as, “The odds of library use decrease by 1% for every 1-year increase in age.” The 1% comes from subtracting the odds ratio of .99 from 1 and multiplying by 100 to convert it to a percent. This is a stategy to make interpreting odds below 1 easier. Otherwise we would have to say: “The odds of library use are .99 times as high with every 1-year increase in age.”\n\n**When the confidence interval includes 1, the odds of the outcome are not statistically significantly different with a change in the independent variable.**\n\nThe odds ratio for the age variable is less than 1, and the confidence interval does not include 1. Thus, the interpretation of this odds ratio would be as follows: \n\n::: {.callout #rep-chap10-odds-ratio}\n##### Interpretation of age odds ratio\n\nThe odds of library use are 1% lower for every 1-year increase in age ($OR = .99; 95% CI: .986–.996$).\n:::\n\n\n#### NHST Step 1\n\nWrite the null and alternate hypotheses:\n\n::: {.callout-note}\n- **H0**: Library use is not associated with age.\n- **HA**: Library use is associated with age.\n:::\n\n#### NHST Step 2\n\nCompute the test statistic. \n\nThe `base::summary()` function following a `stats::glm()` function includes a <a class='glossary' title='A z-score (also called a standard score) gives you an idea of how far from the mean a data point is. But more technically it’s a measure of how many standard deviations below or above the population mean a raw score is. (StatisticsHowTo)'>z-statistic</a> comparing the coefficient estimate to zero. The z-score is a measure how many standard deviations away a value is from a mean. But for logistic regression, the coefficient divided by the <a class='glossary' title='The standard error (SE) of a statistic is the standard deviation of its [sampling distribution]. If the statistic is the sample mean, it is called the standard error of the mean (SEM). (Wikipedia) The standard error is a measure of variability that estimates how much variability there is in a population based on the variability in the sample and the size of the sample. (SwR, Glossary)'>standard error</a> --- not by the <a class='glossary' title='The standard deviation is a measure of the amount of variation or dispersion of a set of values. A low standard deviation indicates that the values tend to be close to the mean (also called the expected value) of the set, while a high standard deviation indicates that the values are spread out over a wider range. The standard deviation is the square root of its variance. A useful property of the standard deviation is that, unlike the variance, it is expressed in the same unit as the data. Standard deviation may be abbreviated SD, and is most commonly represented in mathematical texts and equations by the lower case Greek letter \\(\\sigma\\) (sigma), for the population standard deviation, or the Latin letter \\(s\\) for the sample standard deviation. (Wikipedia)'>standard deviation</a> --- follows a z-distribution. This z-statistic is the test statistic for the <a class='glossary' title='Wald test is the statistical test for comparing the value of the coefficient in linear or logistic regression to the hypothesized value of zero; the form is similar to a one-sample t-test, although some Wald tests use a t-statistic and others use a z-statistic as the test statistic. (SwR, Glossary)'>Wald test</a>, which has the same purpose (but follows a different distribution) as the Wald test from @sec-chap09-achievement4.\n\nIn the case of the `age` variable, dividing the estimate of $-0.008838$ by its standard error of $0.002697$ gives a z-statistic of $-3.276974$, which is well beyond the boundary of $–1.96$ for statistical significance when $\\alpha$ is set at $.05$.\n\nThe z-distribution is a normal distribution with a mean of 0 and a standard deviation of 1.\n\n:::::{.my-r-code}\n:::{.my-r-code-header}\n:::::: {#cnj-chap10-z-dist-odds-ratio}\n: z-distribution for sample size of 1571\n::::::\n:::\n::::{.my-r-code-container}\n::: {#lst-chap10-z-dist-odds-ratio}\n\n::: {.cell}\n\n```{.r .cell-code}\nnhstplot::plotztest(\n    z = -3.28,\n    tails = \"one\",\n    xmax = 5\n    )\n```\n\n::: {.cell-output-display}\n![](10-logistic-regression_files/figure-html/z-dist-odds-ratio-1.png){width=672}\n:::\n:::\n\n\nz-distribution for sample size of 1571\n:::\n\n::::\n:::::\n\n\n#### NHST Step 3\n\nReview and interpret the test statistics: \nCalculate the probability that your test statistic is at least as big as it is if there is no relationship (i.e., the null is true).\n\nThe area under the curve to the left of the test statistic in @lst-chap10-z-dist-odds-ratio is very small. Given this area is very small, the p-value of .00105 in the output @lst-chap10-glm10.1 from `base::summary(glm10.1)` makes sense. There is a .105% probability that this sample came from a population where there was no relationship between age and library use. Thus, there is a statistically significant relationship between age and library use (z = –3.28; p = .001).\n\n\n#### NHST Step 4\n\nConclude and write report.\n\nThe odds ratio for age is .99 with a 95% CI of .986–.996. The confidence interval shows the range where the odds ratio likely is in the population. Because the confidence interval does not include 1, this indicates that the odds ratio is statistically significantly different from 1. The interpretation would be as follows:\n\n::: {.callout #rep-odds-ratio-significance}\n##### Interpreting odds ratio significance\n\n The null hypothesis of no relationship between library use and age is rejected. The odds of library use are 1% lower for every 1-year increase in age in the sample (OR = .99; 95% CI: .986–.996). The 95% confidence interval indicates that the odds of library use are .4%–1.4% lower with each 1-year increase in age in the population that the sample came from.\n:::\n\n## Achievement 4: Interpreting two measures of model fit {#sec-chap10-achievement4}\n\nFor linear regression, the $R^2$ statistic measured how well the model fit the observed data by measuring how much of the variability in the outcome was explained by the model. The concept of variance is appropriate for continuous but not categorical variables. There are several measures for categorical model fit, including the percent correctly predicted, sometimes called <a class='glossary' title='Count R-squared, or percent correctly predicted, is a measure of model fit for a logistic regression model that is the proportion of the outcome values that were correctly predicted out of all observations modeled. (SwR, Glossary)'>count $R^2$</a> and the <a class='glossary' title='Adjusted count R-squared is a measure of model fit for binary logistic regression that adjusts the percent correctly predicted (or count R-squared) by the model for the number of people in the largest outcome category. (SwR, Glossary)'>adjusted count $R^2$</a>, which adjusts the count $R^2$ for the number of people in the largest of the two categories of the outcome.\n\n### Percent correctly predicted\n\nThe percent correctly predicted by the model is computed using the predicted probabilities, or fitted values, for each of the observations and comparing these probabilities to the true value of the outcome.\n\n:::::{.my-theorem}\n:::{.my-theorem-header}\n:::::: {#thm-chap10-percent-correctly-predicted}\n: Percent correctly predicted or count $R^2$\n::::::\n:::\n::::{.my-theorem-container}\n$$\n\\begin{align*}\nR^2_{count} = \\frac{n_{correct}}{n_{total}}\n\\end{align*}\n$$ {#eq-chap10-percent-correctly-predicted}\n::::\n:::::\n\nFor example, if a person in the data set were predicted to have a chance of more than 50% of library use, this would be transformed into a “yes” or “1” value of the outcome and then compared to the person’s actual library use. If the predicted value and the true value matched, this would be considered a correct prediction. The same vice-versa for predicted values less than 50%. The total number of people the model gets correct out of the total number of people in the data analyzed is the <a class='glossary' title='Count R-squared, or percent correctly predicted, is a measure of model fit for a logistic regression model that is the proportion of the outcome values that were correctly predicted out of all observations modeled. (SwR, Glossary)'>percent correctly predicted</a> or count $R^2$.\n\nThe @lst-chap10-compute-odds-ratio includes a table showing how many observations were correctly predicted in each category of the outcome.\n\n:::::{.my-theorem}\n:::{.my-theorem-header}\n:::::: {#thm-chap10-percent-correctly-predicted-example}\n: Calculate the percent correctly predicted with the `glm10.1` data\n::::::\n:::\n::::{.my-theorem-container}\n$$\n\\begin{align*}\nR^2_{count} = \\frac{338 + 500}{1571} = \\frac{838}{1571} = 0.5334\n\\end{align*}\n$$ {#eq-chapXY-formula}\n::::\n:::::\n\n### Adjusted count $R^2$\n\nAn alternative measure of percent correctly predicted is the <a class='glossary' title='Adjusted count R-squared is a measure of model fit for binary logistic regression that adjusts the percent correctly predicted (or count R-squared) by the model for the number of people in the largest outcome category. (SwR, Glossary)'>adjusted count R^2</a> measure. It adjusts the count $R^2$ for the number of people in the largest of the two categories of the outcome.\n\n:::::{.my-theorem}\n:::{.my-theorem-header}\n:::::: {#thm-chap10-adjusted-count-r-squared}\n: Adjusted count $R^2$\n::::::\n:::\n::::{.my-theorem-container}\n$$\n\\begin{align*}\nR^2_{count.adj} = \\frac{n_{correct}- n_{most.common.outcome}}{n_{total}- n_{most.common.outcome}}\n\\end{align*}\n$$ {#eq-chap10-adjusted-count-r-squared}\n::::\n:::::\n\nThe argument behind this adjustment is that a null model, or a model with no predictors, could get a good percent correctly predicted just by predicting everyone was in the outcome category that had the bigger percentage of people in it.\n\nFor the library use data, the most common category is library nonuse (or 0), with 798 of the 1571 participants with complete data for the model. Without knowing anything about library use, you could predict everyone in the data set was a nonuser and be right $\\frac{788}{1571}$ or 50.8% of the time. Using the age predictor, the model is right $\\frac{338+500}{1571}$ or 53% of the time. While this is not a huge increase, it did classify 40 additional people correctly compared to using the percentages in the outcome categories with no other information.\n\nThe model using age to predict library use was correct 53% of the time (Count $R^2$ = .53). The adjusted count $R^2$ would be $\\frac{338+500-798}{1571-798}$ or .05.\n\n::: {.callout #rep-chap10-adjusted-r-squared}\n##### Interpretation of adjusted $R^2$ in `glm10.1`\n\nThere were 5% more correct predictions by the age model than by the baseline (Adjusted Count $R^2$ = .05).\n:::\n\n### Pseudo-$R^2$\n\nPseudo-$R^2$ is another measure that are reported relatively frequently. This measure generally tries to quantify the reduction in lack of fit between a null and full model. You can compute Pseudo-$R^2$  \n\n:::{.my-bulletbox}\n:::: {.my-bulletbox-header}\n::::: {.my-bulletbox-icon}\n:::::\n:::::: {#bul-chap10-pseudo-r2-functions}\n::::::\n: Packages with function for computing pseudo-$R^2$\n::::\n:::: {.my-bulletbox-body}\n- with r2_mcfadden() from the {**performance**} package (see: @pak-performance)\n- with `PseudoR2()` from the {**DescTools**} package (see: @pak-DescTools),\n- with `lrm()`(instead of the `stats::glm()`!) from the {**rms**} package (see: @pak-rms)\n- with `pR2()`from the {**pscl**} package (see: @pak-pscl), and\n- with `pseudo_r2() from the {**pubh**} package (see: @pak-pubh).\n\nMany of these packages have also function for percent correctly predicted and the adjusted count $R^2$ measure.\n::::\n:::\n\n\n:::::{.my-resource}\n:::{.my-resource-header}\n:::::: {#lem-chap10-computing-pseudo-r-squared}\n: Interpreting the different Pseudo-$R^2$\n::::::\n:::\n::::{.my-resource-container}\nThere are many different pseudo-$R^2$ measures with different theoretical approaches. Therefore also the interpretation of these measures differ. \n\nThe best resource I found to explain these differences: [FAQ: What are pseudo R-squareds?](https://stats.oarc.ucla.edu/other/mult-pkg/faq/general/faq-what-are-pseudo-r-squareds/) [@ucla2011].\n\nBut even in this resource not all different pseudo-$R^2$ measures are explained. Anyway it is an complex issues where I have to spend more time to study the details.\n\n::::\n:::::\n\n\n::: {.callout-caution #cau-chap10-pseudo-r2}\n##### Interpreting pseudo-$R^2$\n\nEven in @lem-chap10-computing-pseudo-r-squared not all different pseudo-$R^2$ measures are explained. It is an complex issues where I have to spend more time to study the details.\n:::\n\n\n:::::{.my-example}\n:::{.my-example-header}\n:::::: {#exm-chap10-pseudo-r-squared}\n: Computing Pseudo $R^2$ with different packages\n::::::\n:::\n::::{.my-example-container}\n\n::: {.panel-tabset}\n\n###### DescTools\n\n:::::{.my-r-code}\n:::{.my-r-code-header}\n:::::: {#cnj-chap10-pseudo-r-squared-desctools}\n: Computing Pseudo-$R^2$ \n::::::\n:::\n::::{.my-r-code-container}\n::: {#lst-chap10-pseudo-r-squared-desctools}\n\n::: {.cell}\n\n```{.r .cell-code}\nDescTools::PseudoR2(\n    x = glm10.1,\n    which = \"all\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#>        McFadden     McFaddenAdj        CoxSnell      Nagelkerke   AldrichNelson \n#>    4.966964e-03    3.129970e-03    6.860773e-03    9.148470e-03    6.837345e-03 \n#> VeallZimmermann           Efron McKelveyZavoina            Tjur             AIC \n#>    1.177035e-02    6.845171e-03    8.360693e-03    6.856907e-03    2.170655e+03 \n#>             BIC          logLik         logLik0              G2 \n#>    2.181374e+03   -1.083328e+03   -1.088735e+03    1.081542e+01\n```\n\n\n:::\n:::\n\nComputing Pseudo-$R^2$ with {**DescTools**}\n:::\n\n::::\n:::::\n\n::: {.callout-warning #wrn-chap10-pkg-name-stats2}\n##### `DescTools::PseudoR2()` throws an error message\n\nFrom `DescTools::PseudoR2()` I got always the error that the function `stats::glm()`was not known. After two hours of trials I learned that the function was not programmed for the case that you provide the package name in front of the `glm()`function. After I deleted this prefix in @lst-chap10-glm10.1 the `DescTools::PseudoR2()` function worked. (See also @wrn-chap10-pkg-name-stats1)\n:::\n\n\n###### performance\n\n:::::{.my-r-code}\n:::{.my-r-code-header}\n:::::: {#cnj-chap10-pseudo-r-squared-performance}\n: Computing Pseudo-$R^2$ with {**performance**}\n::::::\n:::\n::::{.my-r-code-container}\n::: {#lst-chap10-pseudo-r-squared-performance}    \n\n::: {.cell}\n\n```{.r .cell-code}\nperformance::r2(glm10.1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> # R2 for Logistic Regression\n#>   Tjur's R2: 0.007\n```\n\n\n:::\n\n```{.r .cell-code}\nperformance::r2_tjur(glm10.1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#>   Tjur's R2 \n#> 0.006856907\n```\n\n\n:::\n\n```{.r .cell-code}\nperformance::r2_mcfadden(glm10.1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> # R2 for Generalized Linear Regression\n#>        R2: 0.024\n#>   adj. R2: 0.023\n```\n\n\n:::\n\n```{.r .cell-code}\nperformance::r2_coxsnell(glm10.1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> Cox & Snell's R2 \n#>      0.006860773\n```\n\n\n:::\n\n```{.r .cell-code}\nperformance::r2_nagelkerke(glm10.1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> Nagelkerke's R2 \n#>      0.00914847\n```\n\n\n:::\n\n```{.r .cell-code}\nperformance::r2_efron(glm10.1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> [1] 0.006845171\n```\n\n\n:::\n\n```{.r .cell-code}\nperformance::r2_mckelvey(glm10.1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> McKelvey's R2 \n#>   0.008360693\n```\n\n\n:::\n:::\n\n\nComputing Pseudo-$R^2$ with {**performance**}\n:::\n\n::::\n:::::\n\n###### rms\n\n:::::{.my-r-code}\n:::{.my-r-code-header}\n:::::: {#cnj-chap10-pseudo-r-squared-rms}\n: Computing Pseudo-$R^2$ with {**rms**}\n::::::\n:::\n::::{.my-r-code-container}\n::: {#lst-chap10-pseudo-r-squared-rms}\n\n::: {.cell}\n\n```{.r .cell-code}\nrms::lrm(\n    formula = uses.lib ~ age,\n    data = tbl10.1\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> Frequencies of Missing Values Due to Each Variable\n#> uses.lib      age \n#>        0       30 \n#> \n#> Logistic Regression Model\n#> \n#> rms::lrm(formula = uses.lib ~ age, data = tbl10.1)\n#> \n#> \n#>                       Model Likelihood     Discrimination    Rank Discrim.    \n#>                             Ratio Test            Indexes          Indexes    \n#> Obs          1571    LR chi2     10.82     R2       0.009    C       0.548    \n#>  no           798    d.f.            1    R2(1,1571)0.006    Dxy     0.096    \n#>  yes          773    Pr(> chi2) 0.0010    R2(1,1178)0.008    gamma   0.097    \n#> max |deriv| 3e-12                          Brier    0.248    tau-a   0.048    \n#> \n#>           Coef    S.E.   Wald Z Pr(>|Z|)\n#> Intercept  0.4038 0.1422  2.84  0.0045  \n#> age       -0.0088 0.0027 -3.28  0.0010\n```\n\n\n:::\n:::\n\n\nComputing Pseudo-$R^2$ with {**rms**}\n:::\n\n::::\n:::::\n\n###### psel\n\n:::::{.my-r-code}\n:::{.my-r-code-header}\n:::::: {#cnj-chap10-pseudo-r-squared-pscl}\n: Computing Pseudo-$R^2$ with {**pscl**}\n::::::\n:::\n::::{.my-r-code-container}\n::: {#lst-chap10-pseudo-r-squared-pscl}\n\n::: {.cell}\n\n```{.r .cell-code}\npscl::pR2(glm10.1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> fitting null model for pseudo-r2\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#>           llh       llhNull            G2      McFadden          r2ML \n#> -1.083328e+03 -1.088735e+03  1.081542e+01  4.966964e-03  6.860773e-03 \n#>          r2CU \n#>  9.148470e-03\n```\n\n\n:::\n:::\n\n\nComputing Pseudo-$R^2$ with {**pscl**}\n:::\n\n::::\n:::::\n\n###### pubh\n\n:::::{.my-r-code}\n:::{.my-r-code-header}\n:::::: {#cnj-chap10-pseudo-r-squared-pubh}\n: Computing Pseudo-$R^2$ with {**pubh**}\n::::::\n:::\n::::{.my-r-code-container}\n::: {#lst-chap10-pseudo-r-squared-pubh}\n\n::: {.cell}\n\n```{.r .cell-code}\npubh::pseudo_r2(glm10.1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#>                 Index Estimate\n#> 1          Nagelkerke    0.009\n#> 2 Hosmer and Lemeshow    0.005\n#> 3       Cox and Snell    0.007\n```\n\n\n:::\n:::\n\n\nComputing Pseudo-$R^2$ with {**pubh**}\n:::\n\n::::\n:::::\n\n\n:::\n\n::::\n:::::\n\n***\n\n\n### Sensitivity and specificity\n\nSometimes it is useful to know whether the model is better at predicting people with the outcome or people without the outcome. The measures used for these two concepts are sensitivity and specificity.\n\n<a class='glossary' title='The true positive rate (one minus the false negative rate), is referred to as sensitivity, recall, or probability of detection. (Bayesian Thinking, Chap.1). But also the percentage of “yes” values or 1s a logistic regression model got right. (SwR, Glossary)'>Sensitivity</a> determines the percentage of the 1s or “yes” values the model got correct, while <a class='glossary' title='The true negative rate (one minus the false positive rate), is referred to as specificity. (Bayesian Thinking, Chap.1) But also the percentage of “no” values or 0s a logistic regression model predicted correctly. (SwR, Glossary)'>specificity</a> computes the percentage of 0s or “no” values the model got correct.\n\nIn @lst-chap10-compute-odds-ratio, the sensitivity is 43.7% while the specificity is 62.7%. The model was better at predicting the \"no\" values than the \"yes\" values. These percentages could also be computed from the frequency table in the output: The model predicted 500 of the 798 people in the 0 category correctly (62.7%) and 338 of the 773 in the 1 category correctly (43.7%).\n\n## Achievement 5: Estimating a larger logistic regression model {#sec-chap10-achievement5}\n\n### Compute full logistic regression model\n\n:::::{.my-example}\n:::{.my-example-header}\n:::::: {#exm-chap10-compute-full-glm}\n: Compute full logistic regression model\n::::::\n:::\n::::{.my-example-container}\n\n::: {.panel-tabset}\n\n###### glm10.2\n\n:::::{.my-r-code}\n:::{.my-r-code-header}\n:::::: {#cnj-chap10-compute-glm10.2}\n: Compute full logistic regression model, first try (`glm10.2`)\n::::::\n:::\n::::{.my-r-code-container}\n::: {#lst-chap10-compute-glm10.2}\n\n::: {.cell}\n\n```{.r .cell-code}\n# estimate the full library use model and print results\nglm10.2 <- glm(\n    formula = uses.lib ~ age + sex + educ + parent +\n         disabled + rurality + raceth + ses,\n         data = tbl10.1,\n         na.action = na.exclude,\n         family = binomial(\"logit\"))\n\nodds.n.ends::odds.n.ends(glm10.2)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Waiting for profiling to be done...\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> $`Logistic regression model significance`\n#> Chi-squared        d.f.           p \n#>      94.736          12       <.001 \n#> \n#> $`Contingency tables (model fit): frequency predicted`\n#>                 Number observed\n#> Number predicted    1    0  Sum\n#>              1    378  249  627\n#>              0    318  482  800\n#>              Sum  696  731 1427\n#> \n#> $`Count R-squared (model fit): percent correctly predicted`\n#> [1] 60.26629\n#> \n#> $`Model sensitivity`\n#> [1] 0.5431034\n#> \n#> $`Model specificity`\n#> [1] 0.6593707\n#> \n#> $`Predictor odds ratios and 95% CI`\n#>                                     OR     2.5 %    97.5 %\n#> (Intercept)                  2.5374457 1.5934592 4.0590559\n#> age                          0.9899123 0.9835415 0.9962814\n#> sexmale                      0.4891734 0.3921079 0.6091430\n#> educFour-year degree or more 1.6592450 1.3037357 2.1140981\n#> educ< HS                     0.8714204 0.5900475 1.2806573\n#> parentnot parent             0.7903350 0.6060517 1.0297999\n#> disabledyes                  0.8003756 0.5836481 1.0949054\n#> ruralityrural                0.8403500 0.6367719 1.1086567\n#> ruralityurban                1.0336350 0.7397448 1.4447031\n#> racethHispanic               0.7602893 0.5367016 1.0738082\n#> racethNon-Hispanic Black     1.1814334 0.8363155 1.6717295\n#> seshigh                      1.1804392 0.8037360 1.7398860\n#> seslow                       1.1005903 0.7957933 1.5220253\n```\n\n\n:::\n:::\n\n\nFull logistic regression model for library use data (`glm2`)\n:::\n\nMy values are quite different than the outcome in the book. The reason is that I have the levels ordered differently. I will order my levels so that I get the same result as in the book.\n\n::::\n:::::\n\n###### order levels\n\n:::::{.my-r-code}\n:::{.my-r-code-header}\n:::::: {#cnj-chap10-order-levels}\n: Order level to match the result from the book\n::::::\n:::\n::::{.my-r-code-container}\n::: {#lst-chap10-order-levels}\n\n::: {.cell}\n\n```{.r .cell-code}\ntbl10.3 <- tbl10.1 |> \n    dplyr::mutate(educ =\n        forcats::fct_relevel(educ, \"< HS\", \"Four-year degree or more\",\n                             \"HS to 2-year degree\")\n    ) |> \n    dplyr::mutate(parent =\n        forcats::fct_rev(parent)\n    ) |> \n    dplyr::mutate(rurality =\n        forcats::fct_relevel(rurality, \"rural\", \"suburban\", \"urban\")\n    ) |> \n    dplyr::mutate(raceth =\n        forcats::fct_relevel(raceth, \"Hispanic\", \n                 \"Non-Hispanic Black\", \"Non-Hispanic White\")\n    ) |> \n    dplyr::mutate(ses =\n        forcats::fct_relevel(ses, \"high\", \n                 \"low\", \"medium\")\n    ) \n\nsave_data_file(\"chap10\", tbl10.3, \"tbl10.3.rds\")\n```\n:::\n\n\nLevel ordered to match the result from the book\n:::\n\n::: {.callout-caution #cau-chap10-level-order}\n##### Why levels such as `ses` not ordered to their intrinsically ordering?\n\nI have ordered the levels to match the book outcome. But I do not understand why some of the levels (`educ`, `rurality` or `ses`) are not ordered from high to low or vice versa. The highest or lowest level is in the order of the book always in the middle.\n:::\n\n\n\n\n::::\n:::::\n\n\n###### glm10.3\n\n:::::{.my-r-code}\n:::{.my-r-code-header}\n:::::: {#cnj-chap10-compute-glm10.3}\n: Compute full logistic regression model, final version (`glm10.3`)\n::::::\n:::\n::::{.my-r-code-container}\n::: {#lst-chap10-compute-glm10.3}\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# estimate the full library use model \n# matching the level order from the book \n# and print results with odds.n.ends()\n\nglm10.3 <- glm(\n    formula = uses.lib ~ age + sex + educ + parent +\n         disabled + rurality + raceth + ses,\n         data = tbl10.3,\n         na.action = na.exclude,\n         family = binomial(\"logit\"))\n\nsave_data_file(\"chap10\", glm10.3, \"glm10.3.rds\")\n\nodds.n.ends::odds.n.ends(glm10.3)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Waiting for profiling to be done...\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> $`Logistic regression model significance`\n#> Chi-squared        d.f.           p \n#>      94.736          12       <.001 \n#> \n#> $`Contingency tables (model fit): frequency predicted`\n#>                 Number observed\n#> Number predicted    1    0  Sum\n#>              1    378  249  627\n#>              0    318  482  800\n#>              Sum  696  731 1427\n#> \n#> $`Count R-squared (model fit): percent correctly predicted`\n#> [1] 60.26629\n#> \n#> $`Model sensitivity`\n#> [1] 0.5431034\n#> \n#> $`Model specificity`\n#> [1] 0.6593707\n#> \n#> $`Predictor odds ratios and 95% CI`\n#>                                     OR     2.5 %    97.5 %\n#> (Intercept)                  1.3180091 0.6778733 2.5644803\n#> age                          0.9899123 0.9835415 0.9962814\n#> sexmale                      0.4891734 0.3921079 0.6091430\n#> educFour-year degree or more 1.9040694 1.2584331 2.8953329\n#> educHS to 2-year degree      1.1475517 0.7808490 1.6947789\n#> parentparent                 1.2652862 0.9710624 1.6500243\n#> disabledyes                  0.8003756 0.5836481 1.0949054\n#> ruralitysuburban             1.1899804 0.9019925 1.5704210\n#> ruralityurban                1.2300055 0.9281956 1.6307183\n#> racethNon-Hispanic Black     1.5539262 1.0018330 2.4167032\n#> racethNon-Hispanic White     1.3152888 0.9312650 1.8632329\n#> seslow                       0.9323567 0.5720558 1.5162449\n#> sesmedium                    0.8471423 0.5747503 1.2441896\n```\n\n\n:::\n:::\n\n\nCompute full logistic regression model, final version (`glm10.3`)\n:::\n\n::: {.callout-caution #cau-chap10-na-action}\n##### Using `na.action = na.omit` instead of `na.action = na.exlcude`\n\nTo find influential values I have tried several different packages. Using {**glmtoolbox**} I received an error message when I used `na.action = na.exlcude`. In the help file to the `influence()` function I learned: \n\n> Cases omitted in the fit are omitted unless a `na.action` method was used (such as `na.exclude`) which restores them. … If a model has been fitted with `na.action = na.exclude` (see `na.exclude`), cases excluded in the fit are considered here.\n\nThis is a weird  behavior because I thought that `na.exclude` will exclude and not restore the NA-values. But if I tried to change therefore to `na.action = na.omit` I got an error message in @lst-chap10-check-residuals: \"`res_std` must be size 1601 or 1, not 1427.\"\n\nFinally I decided to stick with `na.action = na.exclude` (or to delete this line completely with the same result) and not to use the {**glmtoolbox**} package.\n:::\n\n\n::::\n:::::\n\n:::\n\n::::\n:::::\n\n\n\n\n\n\n### NHST Step 1\n\nWrite the null and alternate hypotheses:\n\n::: {.callout-note}\n- **H0**: A model containing age, sex, education, parent status, disability status, rurality, SES, and race-ethnicity is no better than the baseline at explaining library use.\n- **HA**: A model containing age, sex, education, parent status, disability status, rurality, SES, and race-ethnicity is better than the baseline at explaining library use.\n:::\n\n### NHST Step 2\n\nCompute the test statistic. \n\nThe chi-squared test statistic of 94.74 was computed by the `odds.n.ends()` function.\n\n:::::{.my-r-code}\n:::{.my-r-code-header}\n:::::: {#cnj-chap10-chi-squared-glm10.2}\n: Visualizing a chi-squared distribution with n = 1427, df = 12 and test statistic of 94.74\n::::::\n:::\n::::{.my-r-code-container}\n::: {#lst-chap10-chi-squared-glm10.2}\n\n::: {.cell}\n\n```{.r .cell-code}\nnhstplot::plotchisqtest(\n    chisq = 94.74,\n    df = 12\n)\n```\n\n::: {.cell-output-display}\n![](10-logistic-regression_files/figure-html/chi-squared-glm10.2-1.png){width=672}\n:::\n:::\n\n\nChi-squared distribution with n = 1427, df = 12 and a test statistic of 94.74\n:::\n\n::::\n:::::\n\n\n### NHST Step 3\n\nReview and interpret the test statistics: \nCalculate the probability that your test statistic is at least as big as it is if there is no relationship (i.e., the null is true).\n\nThe probability that the chi-squared would be 94.74 if the full model were no better than the null model is shown as the area under the curve to the right starting at 94.74. This corresponds with a very small p-value < .001.\n\n### NHST Step 4\n\nConclude and write report.\n\n::: {.callout #rep-chap10-glm10.2}\nA logistic regression model containing age, sex, education, parental status, disability status, SES, race-ethnicity, and rurality was statistically significantly better than the baseline probability at predicting library use [$χ^2(12) = 94.74; p < .001$].\n:::\n\n## Achievement 6: Interpreting the results of a larger logistic regression model {#sec-chap10-achievement6}\n\n### Interpreting odds ratios\n\n@lst-chap10-compute-glm10.2 includes the odds ratio which are easier to interpret as the significance statistics for the predictors. When the <a class='glossary' title='A range of values, calculated from the sample observations, that is believed, with a particular probability, to contain the true parameter value. (Cambridge Dictionary of Statistics, 4th ed., p.98)'>confidence interval</a> includes 1, the <a class='glossary' title='Odds is usually defined in statistics as the probability an event will occur divided by the probability that it will not occur. An odds ratio (OR) is a measure of association between a certain property A and a second property B in a population. Specifically, it tells you how the presence or absence of property A has an effect on the presence or absence of property B. (Statistics How To). An odds ratio is a ratio of two ratios. They quantify the strength of the relationship between two conditions. They indicate how likely an outcome is to occur in one context relative to another. (Statistics by Jim)'>odds ratio</a> could be 1 and this indicates it is not statistically significantly different from 1. If the odds ratio is greater than 1 *and* the confidence interval does not include 1, the odds ratio suggests a statistically significant increase in the odds of the outcome.\n\nFactor variables with two categories were interpreted with respect to the reference group, or the group *not* shown in the output. Since the factor variables can only change by going from one group to the other, instead of the odds ratio being for a one-unit change in the predictor, it is **the change in the odds of the outcome when moving from the reference group to the other group**.\n\nFor the sex variable, `male` is the group shown in the output, so interpreting the odds ratio for `sex` is as follows: “Males have 51% lower odds of library use compared to females.” She showed Leslie that the 51% came from subtracting the odds ratio of .489 from 1 (1 – .49 = .51) and multiplying by 100.\n\n**For factor variables with more than two categories each odds ratio is interpreted with respect to the reference group for that variable**. For `educ`, the group not shown is the `< HS` group, indicating that it is the reference group. The odds ratio for the Four-year degree or more group is 1.90, so the interpretation would be that individuals with a four-year degree or more have 1.90 times higher odds of library use compared to people with less than a high school education.\n\nA list of the odds ratios where the confidence interval did not include 1: \n\n- age (OR = .99; 95% CI: .984–.996) \n- sexmale (OR = .49; 95% CI: .39–.61) \n- educFour year degree or more (OR = 1.90; 95% CI: 1.26–2.90) \n- racethNon-Hispanic Black (OR = 1.55; 95% CI: 1.002–2.417)\n\n#### Interpreting significant odds ratios greater than 1\n\nThere were two significant predictors with odds ratios greater than 1. \n\n::: {.callout #rep-chap10-interpret-educ-raceth}\n##### Interpreting `educ` and `raceth` as significant odds ratios greater than 1\n\n- People with a four-year degree or more education had 1.90 times higher odds of library use compared to people with less than a high school education (OR = 1.90; 95% CI: 1.26–2.90).\n- People who were non-Hispanic Black had 1.55 times higher odds of library use compared to people who were Hispanic (OR = 1.55; 95% CI: 1.002–2.417).\n:::\n\n\n\n#### Interpreting non-significant odds ratios greater than 1\n\nWhen the confidence interval includes 1, it is possible that the true value of the odds ratio is 1. Therefore the values would be reported without the interpretation of higher odds. For instance:\n\n::: {.callout #rep-chap10-interpret-rurality}\n##### Interpreting `rurality` as a non-significant odds ratio greater than 1\n\nThe odds of library use were not statistically significantly different for urban residents compared to rural residents (OR = 1.23; 95% CI: .93–1.63).\n:::\n\n\n\n#### Interpreting significant odds ratios less than 1\n\nThe age variable and male sex both show significant odds ratios lower than 1. \n\n::: {.callout #rep-chap10-interpret-age-sex}\n##### Interpreting `age` and `sex` as significant odds ratios less than 1\n\n- For age, the odds of library use are 1% lower for every 1-year increase in a person’s age (OR = .99; 95% CI: .984–.996). \n- For male sex, the reference group is female and the odds ratio is .49. Subtracting 1 – .49 results in .51, so the odds of library use are 51% lower for males compared to females (OR = .49; 95% CI: .39–.61).\n:::\n\n\n\n#### Interpreting non-significant odds ratios less than 1\n\nThe low-SES category had a non-significant odds ratio of .93 (95% CI: .571.52). The interpretation would be as follows:\n\n::: {.callout #rep-chap10-interpret-ses}\n##### Interpreting `ses` as a non-significant odds ratio less than 1 \n\nThe odds of library use are not statistically significantly different for those with low SES compared to those in the reference group of high SES (OR = .93; 95% CI: .57–1.52).\n:::\n\n\n### Compute and interpret model fit\n\n#### Count $R^2$\n\nThe model correctly predicted 378 of the 696 who use the library and 482 of the 731 who do not use the library. Overall, it was correct for $\\frac{378+482}{1427} = \\frac{860}{1427}$ of the observations, or 60.3% of the time (count $R^2 = .603$). It was better at classifying those who do not use the library (specificity = 65.9%) than those who use the library (sensitivity = 54.3%).\n\n#### Adjusted count $R^2$\n\n$$\nR^2_{adj.count} = \\frac{860-731}{1427-731} = .185\n$$\n\nThe model predicted 18.5% more of the observations correctly than a baseline model would have.\n\n## Achievement 7: Checking logistic regression assumptions {#sec-chap10-achievement7}\n\n:::{.my-bulletbox}\n:::: {.my-bulletbox-header}\n::::: {.my-bulletbox-icon}\n:::::\n:::::: {#bul-chap10-logistic-regression-assumption}\n::::::\n: Logistic regression assumptions\n::::\n:::: {.my-bulletbox-body}\nThere are three assumptions for logistic regression: \n\n- independence of observations, \n- linearity, and \n- no perfect multicollinearity.\n::::\n:::\n\n### Logistic regresion assumptions\n\n#### Independence of observation\n\nThe Pew Research Center conducted a phone survey where they selected a single person in a randomly selected household. **The assumption is met**.\n\n#### Linearity\n\nFor logistic regression, the outcome variable is binary, so its relationship with another variable will never be linear. Instead of plotting the relationship of the <a class='glossary' title='Outcome is the variable being explained or predicted by a model; in linear and logistic regression, the outcome variable is on the left-hand side of the equal sign. (SwR, Glossary)'>outcome</a> with each continuous predictor, <a class='glossary' title='Linearity is the assumption of some statistical models that requires the outcome, or transformed outcome, to have a linear relationship with numeric predictors, where linear relationships are relationships that are evenly distributed around a line. (SwR, Glossary)'>linearity</a> is tested by plotting the log-odds of the predicted probabilities for the outcome against each of the continuous <a class='glossary' title='Predictor variable – also known sometimes as the independent or explanatory variable – is the counterpart to the response or dependent variable. Predictor variables are used to make predictions for dependent variables. (DeepAI, MiniTab)'>predictors</a> in the model. For example, are the predicted values equally accurate for people of a younger age compared to people of an older age?\n\n:::::{.my-r-code}\n:::{.my-r-code-header}\n:::::: {#cnj-chap10-check-linearity-logistic-regression}\n: Checking linearity of the age variable for the model of library use `glm10.3`\n::::::\n:::\n::::{.my-r-code-container}\n::: {#lst-chap10-check-linearity-logistic-regression}\n\n::: {.cell}\n\n```{.r .cell-code}\n#make a variable of the log-odds of the predicted values\nlogit_use <- log(x = glm10.3$fitted.values / (1 - glm10.3$fitted.values))\n\n# make a small data frame with the log-odds variable and the age predictor\ntbl10_lin <- tibble::tibble(logit_use, age = glm10.3$model$age)\n\n# create a plot (Figure 10.9)\ntbl10_lin  |> \n  ggplot2::ggplot(\n      ggplot2::aes(\n          x = age, \n          y = logit_use)\n      ) +\n  ggplot2::geom_point(\n      ggplot2::aes(\n          size = \"Observation\"\n          ), \n      color = \"gray60\", \n      alpha = .6\n      ) +\n  ggplot2::geom_smooth(\n      formula = y ~ s(x, bs = \"cs\"),\n      method = \"gam\",\n      se = FALSE, \n      ggplot2::aes(\n          color = \"Loess curve\")\n      ) +\n  ggplot2::geom_smooth(\n      formula = y ~ x,\n      method = lm, \n      se = FALSE, \n      ggplot2::aes(\n          color = \"linear\"\n          )\n      ) +\n  ggplot2::labs(\n      x = \"Age in years\", \n      y = \"Log-odds of library use predicted probability\") +\n  ggplot2::scale_color_manual(\n      name = \"Type of fit line\", \n      values = c(\"dodgerblue2\",\"deeppink\")\n      ) +\n  ggplot2::scale_size_manual(\n      values = 1.5, \n      name = \"\"\n      )\n```\n\n::: {.cell-output-display}\n![](10-logistic-regression_files/figure-html/check-linearity-logistic-regression-1.png){width=672}\n:::\n:::\n\n\nChecking linearity of the age variable for the model of library use `glm10.3`\n:::\n\nThe graph shows the Loess curve close to the linear fit line with the exception of the youngest ages.\n\n\n::::\n:::::\n\nIt is up to the analyst to determine whether the actual relationship is close enough to linear to meet this assumption. If the assumption is not met, this variable might be removed from analysis, transformed, or recoded.\n\n1. <a class='glossary' title='The term “spline” refers to a wide class of basis functions that are used in applications requiring data interpolation and/or smoothing. Splines are special function defined piecewise by polynomials, it results to a smooth function built out of smaller, component functions. In interpolating problems, spline interpolation is often preferred to polynomial interpolation because it yields similar results, even when using low degree polynomials, while avoiding big numbers and the problem of oscillation at the edges of intervals of higher degrees. The term “spline” comes from the flexible spline devices used by shipbuilders and draftsmen to draw smooth shapes. They used a long, thin piece of wood or metal that could be anchored in a few places in order to aid drawing curves. | There are many types of splines, especially the common-place ‘B-splines’: The ‘B’ stands for ‘basis,’ which just means ‘component.’ B-splines build up wiggly functions from simpler less-wiggly components. Those components are called basis functions. B-splines force you to make a number of choices that other types of splines automate. (Chap.4)'>spline regression</a> is one way to deal with problems of linearity in linear and logistic regression. \n2. It might be worth considering that the data frame includes people as young as 16 years old; it is possible that there are different predictors of library use before adulthood and restricting the age range of the data frame to adults over 18 could be another option for addressing this deviation from linearity in the youngest survey participants.\n\n::: {.callout-note  #nte-chap10-rectify-assumptions-not-met}\n##### Why older than 18 and not older than 25?\n\nIt seems for me that there is still a problem with people 18 years old. The loess curve in @lst-chap10-check-linearity-logistic-regression only gets better with people older than 25 years.\n\nGenerally I have a bad feeling with the sentence: \"It is up to the analyst to determine whether the actual relationship is close enough to linear to meet this assumption.\" For me there seems to much subjectivity in this approach. As I am already remarked in @tdo-chap09-linearity-test: I have to look for tools, like statistical tests to get a more objective decision if the assumption of linearity is met.  \n:::\n\n#### No perfect multicollinearity\n\nThe <a class='glossary' title='The generalized variance inflation factor (GVIF) is a generalized version of the variance inflation factor (VIF) that is used to identify problems with multicollinearity; the GVIF is used in binary logistic regression. (SwR, Glossary)'>GVIF</a> is similar to the <a class='glossary' title='The variance inflation factor (VIF) is a statistic for determining whether there is problematic multicollinearity in a linear regression model. (SwR, Glossary)'>VIF</a> used for linear regression, but modified to account for the categorical outcome. It examines how well each predictor variable in the model is explained by the group of other predictor variables. If a predictor is well explained by the others, it is redundant and unnecessary. For the GVIF, often a threshold of $GVIF^{\\frac{1}{2 \\times df}} < 2.5$ is used as a cutoff, with values of 2.5 or higher indicating a failed multicollinearity assumption.\n\n:::::{.my-r-code}\n:::{.my-r-code-header}\n:::::: {#cnj-chap10-compute-gvif}\n: Compute GVIF\n::::::\n:::\n::::{.my-r-code-container}\n::: {#lst-chap10-compute-gvif}\n\n::: {.cell}\n\n```{.r .cell-code}\ncar::vif(mod = glm10.3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#>              GVIF Df GVIF^(1/(2*Df))\n#> age      1.254322  1        1.119965\n#> sex      1.051221  1        1.025291\n#> educ     1.309506  2        1.069737\n#> parent   1.101618  1        1.049580\n#> disabled 1.153173  1        1.073859\n#> rurality 1.118617  2        1.028420\n#> raceth   1.212126  2        1.049269\n#> ses      1.249162  2        1.057194\n```\n\n\n:::\n:::\n\n\nCompute and show GVIF values\n:::\n\nNone of the values in the right-hand column have a value of 2.5 or higher, so there is no discernable problem with multicollinearity.\n\n::::\n:::::\n\n\n#### Conclusion\n\nOverall, the assumption checking revealed a possible problem with age as a predictor, mostly at the youngest ages. The other assumptions were met. It might be useful to restrict the age variable to adults or to transform the age variable.\n\n### Model diagnostics\n\n#### Finding outliers with standardized residuals\n\nReferring to @lst-chap09-diagnostics-standardized-residuals residuals are the distances between the predicted value of the outcome and the true value of the outcome for each person or observation in the data set.  \n\nThese values are standardized by computing z-scores for each one so that they follow a z-distribution. **Standardized <a class='glossary' title='Residuals are the differences between the observed values and the predicted values. (SwR, Glossary)'>residuals</a> are <a class='glossary' title='A z-score (also called a standard score) gives you an idea of how far from the mean a data point is. But more technically it’s a measure of how many standard deviations below or above the population mean a raw score is. (StatisticsHowTo)'>z-scores</a> for the residual values.** Z-scores that are greater than 1.96 or less than –1.96 are about two standard deviations or more away from the mean of a measure. In this case, they are more than two standard deviations away from the mean residual value. Very large values of standardized residuals can indicate that the predicted value for an observation is far from the true value for that observation, indicating that an examination of that observation could be useful.\n\n:::::{.my-example}\n:::{.my-example-header}\n:::::: {#exm-chap10-standardize-residuals}\n: Standardize residuals and check if z-scores greater than 2\n::::::\n:::\n::::{.my-example-container}\n\n::: {.panel-tabset}\n\n###### Computing\n\n:::::{.my-r-code}\n:::{.my-r-code-header}\n:::::: {#cnj-chap10-check-residuals}\n: Compute and check residuals\n::::::\n:::\n::::{.my-r-code-container}\n::: {#lst-chap10-check-residuals}\n\n::: {.cell}\n\n```{.r .cell-code}\n# get standardized residuals and add to data frame\ntbl10.4 <-  tbl10.3 |> \n    dplyr::mutate(res_std = stats::rstandard(model = glm10.3)) |> \n    tibble::rowid_to_column(\"ID\")\n\n# check the residuals for large values > 2\ntbl10.4  |> \n  tidyr::drop_na(res_std)  |> \n  dplyr::summarize(max_resid = max(abs(x = res_std)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> # A tibble: 1 × 1\n#>   max_resid\n#>       <dbl>\n#> 1      1.82\n```\n\n\n:::\n\n```{.r .cell-code}\nsave_data_file(\"chap10\", tbl10.4, \"tbl10.4.rds\")\n```\n:::\n\nCompute and check residuals\n:::\n\nThe maximum absolute value of any standardized residual was less than 1.96, so the standardized residuals did not reveal any outliers.\n\n::::\n:::::\n\n\n###### Plotting\n\n:::::{.my-r-code}\n:::{.my-r-code-header}\n:::::: {#cnj-chap10-graph-residuals}\n: Standardized residuals for library use model\n::::::\n:::\n::::{.my-r-code-container}\n::: {#lst-chap10-graph-residuals}    \n\n::: {.cell}\n\n```{.r .cell-code}\ntbl10.4 |> \n    # tidyr::drop_na(res_std) |>\n    ggplot2::ggplot(\n        ggplot2::aes(\n            x = ID,\n            y = res_std,\n            group = \"Library use\"\n        )\n    ) +\n    ggplot2::geom_jitter(\n        ggplot2::aes(\n            color = uses.lib\n        )\n    ) +\n    ggplot2::labs(\n        x = \"Observation number\",\n        y = \"Standarized reeisudals\"\n    ) +\n    ggokabeito::scale_okabe_ito(\n        name = \"Library use\",\n        aesthetics = \"color\",\n        order = c(1,3),\n        alpha = .6\n        )\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Warning: Removed 174 rows containing missing values or values outside the scale range\n#> (`geom_point()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](10-logistic-regression_files/figure-html/graph-residuals-1.png){width=672}\n:::\n:::\n\n\nStandardized residuals for library use model\n:::\n\nThis is my reproduction of book’s Figure 10.10, using the colorblind-friendly Okabe-Ito scale.\nMost predicted probabilities were about one standard deviation above or below the mean predicted probability. So there were not outliers to examine.\n\n::::\n:::::\n\n:::\n\n::::\n:::::\n\n### dfbeta(s)\n\nAs I already mentioned in @wrn-chap09-diagnostics-df-beta the book mixes <a class='glossary' title='dfbeta are effects on coefficients of deleting each observation in turn. (“Companion to Applied Regression”, car package, help file)'>dfbeta</a> & <a class='glossary' title='dfbetas are effect on coefficients of deleting each observation in turn, standardized by a deleted estimate of the coefficient standard error (“Companion to Applied Regression”, car package, help file)'>dfbetas</a> together. But these two are different measures:\n\n`dfbetas` (plural) are the standardized values, with a cutoff of $2 / \\sqrt{n}$. Because of standardization `dfbetas` are the recommended measure to use. \n- `dfbeta` (singular) values depend on the scale of the data.\n\n:::::{.my-example}\n:::{.my-example-header}\n:::::: {#exm-chap10-compute-influence-measures}\n: Computing dfbeta(s)\n::::::\n:::\n::::{.my-example-container}\n\n::: {.panel-tabset}\n\n###### all together\n\n:::::{.my-r-code}\n:::{.my-r-code-header}\n:::::: {#cnj-chap10-compute-influence-measures}\n: Computing different influence measures\n::::::\n:::\n::::{.my-r-code-container}\n::: {#lst-chap10-compute-influence-measures}\n\n::: {.cell}\n\n```{.r .cell-code}\n## get influence statistics \ninfl10.3 <- stats::influence.measures(model = glm10.3)\n\n## print influential data\nglue::glue(\"The next two results are from 'example(influence.measure)'\")\nglue::glue(\"\")\nglue::glue(\"Print list of influential data\")\nwhich(apply(infl10.3$is.inf, 1, any))\n\n## which observations 'are' influential\nglue::glue(\"\")\nglue::glue(\"Which observations 'are' influential?\")\nsummary(infl10.3)\n\n## print all diagnostic data\nglue::glue(\"\")\nglue::glue(\"Print a summary of all diagnostic data\")\nbase::summary(infl10.3$infmat)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> The next two results are from 'example(influence.measure)'\n#> \n#> Print list of influential data\n#> named integer(0)\n#> \n#> Which observations 'are' influential?\n#> Potentially influential observations of\n#> \t glm(formula = uses.lib ~ age + sex + educ + parent + disabled +      rurality + raceth + ses, family = binomial(\"logit\"), data = tbl10.3,      na.action = na.exclude) :\n#> NONE\n#> numeric(0)\n#> \n#> Print a summary of all diagnostic data\n#>      dfb.1_              dfb.age              dfb.sxml        \n#>  Min.   :-0.1051922   Min.   :-0.0767940   Min.   :-0.039027  \n#>  1st Qu.:-0.0129510   1st Qu.:-0.0160893   1st Qu.:-0.023107  \n#>  Median : 0.0000000   Median : 0.0000000   Median :-0.015882  \n#>  Mean   : 0.0001392   Mean   :-0.0005355   Mean   :-0.001121  \n#>  3rd Qu.: 0.0125725   3rd Qu.: 0.0142736   3rd Qu.: 0.024395  \n#>  Max.   : 0.1142539   Max.   : 0.0825243   Max.   : 0.055434  \n#>                                                               \n#>     dfb.edom             dfb.et2d             dfb.prnt        \n#>  Min.   :-0.1161072   Min.   :-0.1179326   Min.   :-0.073641  \n#>  1st Qu.:-0.0106307   1st Qu.:-0.0069438   1st Qu.:-0.013862  \n#>  Median : 0.0000000   Median : 0.0000000   Median : 0.000000  \n#>  Mean   : 0.0005464   Mean   : 0.0001351   Mean   : 0.000333  \n#>  3rd Qu.: 0.0113543   3rd Qu.: 0.0068441   3rd Qu.: 0.014662  \n#>  Max.   : 0.0967673   Max.   : 0.0949315   Max.   : 0.069974  \n#>                                                               \n#>     dfb.dsbl           dfb.rrltys           dfb.rrltyr        \n#>  Min.   :-0.079962   Min.   :-0.0733540   Min.   :-0.0742958  \n#>  1st Qu.:-0.011309   1st Qu.:-0.0152557   1st Qu.:-0.0150995  \n#>  Median : 0.000000   Median : 0.0000000   Median : 0.0000000  \n#>  Mean   :-0.000256   Mean   : 0.0002054   Mean   : 0.0002627  \n#>  3rd Qu.: 0.009065   3rd Qu.: 0.0139402   3rd Qu.: 0.0147617  \n#>  Max.   : 0.089810   Max.   : 0.0741895   Max.   : 0.0714801  \n#>                                                               \n#>     dfb.rN-B             dfb.rN-W             dfb.sslw         \n#>  Min.   :-0.0843655   Min.   :-0.1059933   Min.   :-9.111e-02  \n#>  1st Qu.:-0.0023347   1st Qu.:-0.0079223   1st Qu.:-9.360e-03  \n#>  Median : 0.0000000   Median : 0.0000000   Median : 0.000e+00  \n#>  Mean   : 0.0003143   Mean   : 0.0002498   Mean   :-2.919e-05  \n#>  3rd Qu.: 0.0025706   3rd Qu.: 0.0083564   3rd Qu.: 8.515e-03  \n#>  Max.   : 0.0847660   Max.   : 0.0939644   Max.   : 9.547e-02  \n#>                                                                \n#>     dfb.ssmd              dffit              cov.r            cook.d       \n#>  Min.   :-0.1118319   Min.   :-0.17302   Min.   :0.9952   Min.   :0.00011  \n#>  1st Qu.:-0.0062815   1st Qu.:-0.09024   1st Qu.:1.0035   1st Qu.:0.00032  \n#>  Median : 0.0000000   Median :-0.04160   Median :1.0079   Median :0.00057  \n#>  Mean   :-0.0001344   Mean   :-0.00026   Mean   :1.0082   Mean   :0.00071  \n#>  3rd Qu.: 0.0073985   3rd Qu.: 0.08853   3rd Qu.:1.0127   3rd Qu.:0.00093  \n#>  Max.   : 0.1113670   Max.   : 0.18890   Max.   :1.0250   Max.   :0.00353  \n#>                       NA's   :174                         NA's   :174      \n#>       hat          \n#>  Min.   :0.000000  \n#>  1st Qu.:0.004505  \n#>  Median :0.007261  \n#>  Mean   :0.008120  \n#>  3rd Qu.:0.011625  \n#>  Max.   :0.022682  \n#> \n```\n\n\n:::\n:::\n\n\nComputing different influence measures\n:::\n\nGenerally it turned out that there are no influential values! Otherwise I would have get an output where different variable results would have be signed with an asterisk.\n\nI had a hard time to understand the output, because the names of the variables do not conform to the name in the tibble. But after some trial and error I understood that I have to look for the variable name without vocals and add a combination of letters for the levels:\n\n- dfb.1_: intercept\n- dfb.age: age\n- dfb.sxml: sex-male\n- dfb.prnt: parent-parent\n- dfb.dsbl: disabled-yes\n- dfb.rrltys: rurality-suburban\n- dfb.rrltyr: rurality-rural\n- dfb.sslw: ses-low\n- dfb.ssmd: ses-medium\n- dfb.edom: educ-Four-year degree or more\n- dfb.et2d: educ-HS to 2-year degree\n- dfb.rN-B: raceth-Non-Hispanic Black\n- dfb.rN-W: raceth-Non-Hispanic White\n\nThis list was confirmed after I computed `dfbetas` directly with @lst-chap10-compute-dfbetas because I got better variable names for the results.\n\n\n::::\n:::::\n\nI added to @lst-chap10-compute-influence-measures two measures provided by an additional example of the last line of the `stats::lm-influence()` help page (\"For more \"user level\" examples, use example(influence.measures)\") or respectively the examples in the `stats::influence.measures()` help page.\n\n\n###### dfbetas\n\n:::::{.my-r-code}\n:::{.my-r-code-header}\n:::::: {#cnj-chap10-compute-dfbetas}\n: Compute `dfbetas`\n::::::\n:::\n::::{.my-r-code-container}\n::: {#lst-chap10-compute-dfbetas}    \n\n::: {.cell}\n\n```{.r .cell-code}\nbase::summary(dfbetas(model = glm10.3))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#>   (Intercept)              age                sexmale         \n#>  Min.   :-0.1051922   Min.   :-0.0767940   Min.   :-0.039027  \n#>  1st Qu.:-0.0129510   1st Qu.:-0.0160893   1st Qu.:-0.023107  \n#>  Median : 0.0000000   Median : 0.0000000   Median :-0.015882  \n#>  Mean   : 0.0001392   Mean   :-0.0005355   Mean   :-0.001121  \n#>  3rd Qu.: 0.0125725   3rd Qu.: 0.0142736   3rd Qu.: 0.024395  \n#>  Max.   : 0.1142539   Max.   : 0.0825243   Max.   : 0.055434  \n#>  educFour-year degree or more educHS to 2-year degree  parentparent      \n#>  Min.   :-0.1161072           Min.   :-0.1179326      Min.   :-0.073641  \n#>  1st Qu.:-0.0106307           1st Qu.:-0.0069438      1st Qu.:-0.013862  \n#>  Median : 0.0000000           Median : 0.0000000      Median : 0.000000  \n#>  Mean   : 0.0005464           Mean   : 0.0001351      Mean   : 0.000333  \n#>  3rd Qu.: 0.0113543           3rd Qu.: 0.0068441      3rd Qu.: 0.014662  \n#>  Max.   : 0.0967673           Max.   : 0.0949315      Max.   : 0.069974  \n#>   disabledyes        ruralitysuburban     ruralityurban       \n#>  Min.   :-0.079962   Min.   :-0.0733540   Min.   :-0.0742958  \n#>  1st Qu.:-0.011309   1st Qu.:-0.0152557   1st Qu.:-0.0150995  \n#>  Median : 0.000000   Median : 0.0000000   Median : 0.0000000  \n#>  Mean   :-0.000256   Mean   : 0.0002054   Mean   : 0.0002627  \n#>  3rd Qu.: 0.009065   3rd Qu.: 0.0139402   3rd Qu.: 0.0147617  \n#>  Max.   : 0.089810   Max.   : 0.0741895   Max.   : 0.0714801  \n#>  racethNon-Hispanic Black racethNon-Hispanic White     seslow          \n#>  Min.   :-0.0843655       Min.   :-0.1059933       Min.   :-9.111e-02  \n#>  1st Qu.:-0.0023347       1st Qu.:-0.0079223       1st Qu.:-9.360e-03  \n#>  Median : 0.0000000       Median : 0.0000000       Median : 0.000e+00  \n#>  Mean   : 0.0003143       Mean   : 0.0002498       Mean   :-2.919e-05  \n#>  3rd Qu.: 0.0025706       3rd Qu.: 0.0083564       3rd Qu.: 8.515e-03  \n#>  Max.   : 0.0847660       Max.   : 0.0939644       Max.   : 9.547e-02  \n#>    sesmedium         \n#>  Min.   :-0.1118319  \n#>  1st Qu.:-0.0062815  \n#>  Median : 0.0000000  \n#>  Mean   :-0.0001344  \n#>  3rd Qu.: 0.0073985  \n#>  Max.   : 0.1113670\n```\n\n\n:::\n:::\n\n\nCompute `dfbetas`\n:::\n\nBesides the better variable names it also turned out the in @lst-chap10-compute-influence-measures the results are dfbetas and not dfbeta as I have computed in @lst-chap10-compute-dfbeta to see the differences.\n\n::::\n:::::\n\n###### dfbeta\n\n:::::{.my-r-code}\n:::{.my-r-code-header}\n:::::: {#cnj-chap10-compute-dfbeta}\n: Compute `dfbeta`\n::::::\n:::\n::::{.my-r-code-container}\n::: {#lst-chap10-compute-dfbeta}    \n\n::: {.cell}\n\n```{.r .cell-code}\nbase::summary(dfbeta(model = glm10.3))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#>   (Intercept)              age                sexmale          \n#>  Min.   :-4.116e-02   Min.   :-2.908e-04   Min.   :-0.0050592  \n#>  1st Qu.:-5.068e-03   1st Qu.:-6.093e-05   1st Qu.:-0.0029956  \n#>  Median : 0.000e+00   Median : 0.000e+00   Median :-0.0020589  \n#>  Mean   : 5.456e-05   Mean   :-2.031e-06   Mean   :-0.0001456  \n#>  3rd Qu.: 4.920e-03   3rd Qu.: 5.405e-05   3rd Qu.: 0.0031625  \n#>  Max.   : 4.471e-02   Max.   : 3.124e-04   Max.   : 0.0071843  \n#>  educFour-year degree or more educHS to 2-year degree  parentparent       \n#>  Min.   :-0.0284321           Min.   :-2.685e-02      Min.   :-1.148e-02  \n#>  1st Qu.:-0.0026041           1st Qu.:-1.582e-03      1st Qu.:-2.162e-03  \n#>  Median : 0.0000000           Median : 0.000e+00      Median : 0.000e+00  \n#>  Mean   : 0.0001341           Mean   : 3.084e-05      Mean   : 5.204e-05  \n#>  3rd Qu.: 0.0027817           3rd Qu.: 1.559e-03      3rd Qu.: 2.287e-03  \n#>  Max.   : 0.0237047           Max.   : 2.162e-02      Max.   : 1.091e-02  \n#>   disabledyes         ruralitysuburban     ruralityurban       \n#>  Min.   :-1.479e-02   Min.   :-1.196e-02   Min.   :-1.231e-02  \n#>  1st Qu.:-2.092e-03   1st Qu.:-2.488e-03   1st Qu.:-2.503e-03  \n#>  Median : 0.000e+00   Median : 0.000e+00   Median : 0.000e+00  \n#>  Mean   :-4.745e-05   Mean   : 3.356e-05   Mean   : 4.363e-05  \n#>  3rd Qu.: 1.676e-03   3rd Qu.: 2.274e-03   3rd Qu.: 2.448e-03  \n#>  Max.   : 1.661e-02   Max.   : 1.210e-02   Max.   : 1.185e-02  \n#>  racethNon-Hispanic Black racethNon-Hispanic White     seslow          \n#>  Min.   :-2.185e-02       Min.   :-2.160e-02       Min.   :-2.612e-02  \n#>  1st Qu.:-6.046e-04       1st Qu.:-1.616e-03       1st Qu.:-2.683e-03  \n#>  Median : 0.000e+00       Median : 0.000e+00       Median : 0.000e+00  \n#>  Mean   : 8.155e-05       Mean   : 5.104e-05       Mean   :-8.383e-06  \n#>  3rd Qu.: 6.658e-04       3rd Qu.: 1.704e-03       3rd Qu.: 2.441e-03  \n#>  Max.   : 2.195e-02       Max.   : 1.916e-02       Max.   : 2.736e-02  \n#>    sesmedium         \n#>  Min.   :-2.538e-02  \n#>  1st Qu.:-1.426e-03  \n#>  Median : 0.000e+00  \n#>  Mean   :-3.055e-05  \n#>  3rd Qu.: 1.679e-03  \n#>  Max.   : 2.527e-02\n```\n\n\n:::\n:::\n\n\nCompute `dfbeta`\n:::\n\nThese `dfbeta` values are quite different to the `dfbetas`.\n\n::::\n:::::\n\n\n:::\n\n::::\n:::::\n\n\n::: {.callout-warning #wrn-chap10-dfbetas-glm}\n##### dfbetas suitable for Generalized Linear Models (GLMs)?\n\nI am not sure if the dfbeta values are --- beside of linear models computed with `stats::lm()` --- also valid for *generalized* linear models, computed with `stats::glm()`. My doubts are nurtured on the fact that in the help file all computed `dfbeta` and `dfbetas` require a method of class `lm`. This is in contrast to <a class='glossary' title='Cook’s distance (often abbreviated Cook’s D) is used in Regression Analysis to find influential outliers in a set of predictor variables. IIt is a way to identify points that negatively affect the regression model. (Statistics How To)'>Cook’s D</a> where a method for both classes `lm` and `glm` exists.\n\nSee also the explanation of the argument ìnfl`: \n\n> influence structure as returned by `lm.influence` or `influence` (the latter only for the glm method of rstudent and cooks.distance).\n:::\n\n\n\n### Cook’s Distance\n\nCook’s Distance, is computed in a similar way to dfbeta(s) --- each observation is removed and the model is re-estimated without it. <a class='glossary' title='Cook’s distance (often abbreviated Cook’s D) is used in Regression Analysis to find influential outliers in a set of predictor variables. IIt is a way to identify points that negatively affect the regression model. (Statistics How To)'>Cook’s D</a> then combines the differences between the models with and without an observation for all the parameters together instead of one at a time like the dfbeta(s). A high Cook’s D would indicate that removing the observation made a big difference and therefore it might be considered influential.\n\n:::::{.my-r-code}\n:::{.my-r-code-header}\n:::::: {#cnj-chap10-compute-cooks-d}\n: Compute Cook’s D\n::::::\n:::\n::::{.my-r-code-container}\n::: {#lst-chap10-compute-cooks-d}\n\n::: {.cell}\n\n```{.r .cell-code}\ntibble::tibble(infl_cooks_d = cooks.distance(glm10.3)) |> \n    tidyr::drop_na() |>\n    dplyr::filter(infl_cooks_d > 4 / dplyr::n())\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> # A tibble: 6 × 1\n#>   infl_cooks_d\n#>          <dbl>\n#> 1      0.00301\n#> 2      0.00298\n#> 3      0.00353\n#> 4      0.00280\n#> 5      0.00327\n#> 6      0.00282\n```\n\n\n:::\n:::\n\n\nCompute Cook’s D\n:::\n\nDepending if I compute it with NA's or without NA's I got 12 or six influential values. This is in contrast to @lst-chap10-compute-influence-measures, where I couldn't detect any influential values.\n\nBut I cannot see which row in the data these six values belong. I think that would be necessary to inspect and/or delete these values.\n\n::::\n:::::\n\n### Compute leverage \n\nLeverage is the influence that the observed value of the outcome has on the predicted value of the outcome. Leverage values range between 0 and 1. To determine which leverage values indicate influential observations, a cutoff of $\\frac{2p}{n}$is often used. In this case, we have 13 parameters, so the cutoff is $\\frac{2 \\times 13}{1427}= 0.01822004$\n\n:::::{.my-r-code}\n:::{.my-r-code-header}\n:::::: {#cnj-chap10-compute-hat-values}\n: Compute leverage (hat values)\n::::::\n:::\n::::{.my-r-code-container}\n::: {#lst-chap10-compute-hat-values}\n\n::: {.cell}\n\n```{.r .cell-code}\ninfl_hat <- tibble::tibble(data.frame(infl10.3$infmat)) |> \n    dplyr::select(hat) |> \n    tidyr::drop_na() \n\ninfl_hat |> \n    dplyr::filter(hat > 2 * 13 / dplyr::n())\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> # A tibble: 95 × 1\n#>       hat\n#>     <dbl>\n#>  1 0.0184\n#>  2 0.0190\n#>  3 0.0185\n#>  4 0.0184\n#>  5 0.0164\n#>  6 0.0176\n#>  7 0.0219\n#>  8 0.0180\n#>  9 0.0205\n#> 10 0.0198\n#> # ℹ 85 more rows\n```\n\n\n:::\n:::\n\n\nCompute leverage (hat values)\n:::\n\nInstead of 35 values I got 95 influential values. The reason for the difference is that there are 1601 records and not 1427 as calculated in the book.\n\nBut all in all I still think that both results 35 and 95 are wrong, because the variable `infl10.3$is.inf` has not even a single `TRUE` value for any measures as already shown in @lst-chap10-compute-influence-measures.\n\n::::\n:::::\n\n\n:::::: {#tdo-chap10-influential-values}\n:::::{.my-checklist}\n:::{.my-checklist-header}\nTODO: Look for other tutorials how to compute influential values\n:::\n::::{.my-checklist-container}\nI think that there are several reasons why the computation of the influential values in the book has some inaccuracies:\n\n- There is a misunderstanding in `dfbeta` and `dfbetas`. In the book both measures are treated the same, but there is a difference. (BTW: Both measures are written without a dash as is the case in the book.)\n- In my opinion it is not established that all of the `lm`-measures work the same with `glm`. In the help file there are several hints that there exist differences.\n- The output of `stats::influential.measures()` as explained in the examples of the help files does not show any `TRUE`s for the diagnosis variable `is.inf`. \n- And last not least: There is no clear advice what I should do when I detect influential values. The books says that one should inspect the values and if there was a coding error to correct or remove the data. But if it was no coding error, should I stick with the influential values? Even if I notice a pattern of the influential errors such as we have seen with distances in Texas in @sec-chap09?\n\nThere are many tutorials explaining how to work with outliers and influential values. But these texts --- often buried in textbooks --- are complex. I need to dedicate some time to read and to try out their data examples. But from the big importance that this subject has, I will explores some of these tutorials.\n\n\n::::\n:::::\nLook for other tutorials how to compute influential values\n:::\n\n\n:::::{.my-remark}\n:::{.my-remark-header}\n:::::: {#rem-chap10-outlier-vs-influential}\n: Difference between outliers and influential points\n::::::\n:::\n::::{.my-remark-container}\nThere was no good explication in the book about the difference between <a class='glossary' title='Outliers are observations with unusual values. (SwR, Glossary). Outliers are observed data points that are far from the least squares line. They have large “errors”, where the “error” or residual is the vertical distance from the line to the point. (Introductory Statistics 12.6)'>outliers</a> and <a class='glossary' title='An influential observation is an observation that changes the slope of a regression line. (SwR, Glossary) Influential points are observed data points that are far from the other observed data points in the horizontal direction. These points may have a big effect on the slope of the regression line. To begin to identify an influential point, you can remove it from the data set and see if the slope of the regression line is changed significantly. (Introductory Statistics 12.6)'>influential values</a>. (See for the [clarification in section 12.6](https://openstax.org/books/introductory-statistics/pages/12-6-outliers) of Introductory Statistics, [@illowsky2011, 541]).\n\n> **Outliers are observed data points that are far from the least squares line**. They have large \"errors\", where the \"error\" or residual is the vertical distance from the line to the point.\n\n> Besides outliers, a sample may contain one or a few points that are called **influential points**. Influential points are observed data points that are far from the other observed data points in the horizontal direction. These points may have a big effect on the slope of the regression line. To begin to identify an influential point, you can remove it from the data set and see if the slope of the regression line is changed significantly.\n\n:::::{.my-r-code}\n:::{.my-r-code-header}\n:::::: {#cnj-chap10-anscombe-datasets}\n: Anscombe's Quartet of 'Identical' Simple Linear Regressions\n::::::\n:::\n::::{.my-r-code-container}\n::: {#lst-chap10-anscombe-datasets}\n\n::: {.cell}\n\n```{.r .cell-code}\n## Now, do what you should have done in the first place: PLOTS\nff <- y ~ x\nmods <- setNames(as.list(1:4), paste0(\"lm\", 1:4))\nfor(i in 1:4) {\n    ff[2:3] <- lapply(paste0(c(\"y\", \"x\"), i), as.name)\n    mods[[i]] <- lmi <- lm(ff, data = anscombe)\n}\n\nop <-\n    par(\n        mfrow = c(2, 2),\n        mar = 0.1 + c(4, 4, 1, 1),\n        oma =  c(0, 0, 2, 0)\n    )\nfor (i in 1:4) {\n    ff[2:3] <- lapply(paste0(c(\"y\", \"x\"), i), as.name)\n    plot(\n        ff,\n        data = anscombe,\n        col = \"red\",\n        pch = 21,\n        bg = \"orange\",\n        cex = 1.2,\n        xlim = c(3, 19),\n        ylim = c(3, 13)\n    )\n    abline(mods[[i]], col = \"blue\")\n}\nmtext(\"Anscombe's 4 Regression data sets\",\n      outer = TRUE,\n      cex = 1.5)\n```\n\n::: {.cell-output-display}\n![](10-logistic-regression_files/figure-html/anscombe-datasets-1.png){width=672}\n:::\n:::\n\n\nAnscombe's 4 Regression data sets\n:::\n\n@lst-chap10-anscombe-datasets shows the difference between outlier and influential point very clearly: \n\n- The point at the far right top of panel x4 is an outlier without any influence because it lies on the regression line.\n- The point at the right top of panel x3 is an  outlier and at the same time an influential point, because it changes the regression line.\n::::\n:::::\n\n::::\n:::::\n\n## Achievement 8: Using the model for predictions {#sec-chap10-achievement8}\n\nLogistic regression models are useful not only for examining relationships between predictors and binary outcomes, but also for predicting probabilities for hypothetical or new cases that are not in the data frame.\n\n:::::{.my-r-code}\n:::{.my-r-code-header}\n:::::: {#cnj-chap10-model-prediction}\n: Using the model to predict probabilities for observations that are outside the data set\n::::::\n:::\n::::{.my-r-code-container}\n::: {#lst-chap10-model-prediction}\n\n::: {.cell}\n\n```{.r .cell-code}\n# make a new data frame containing the observations of interest\nglm10.3_example <- tibble::tibble(age = c(35, 65, 68),\n                         sex = c(\"male\", \"female\", \"male\"),\n                         educ = c(\"Four-year degree or more\",\n                                  \"Four-year degree or more\",\n                                  \"Four-year degree or more\"),\n                         disabled = c(\"no\", \"no\", \"no\"),\n                         parent = c(\"not parent\", \"parent\", \"parent\"),\n                         rurality = c(\"rural\", \"rural\", \"rural\"),\n                         raceth = c(\"Non-Hispanic White\",\n                                    \"Non-Hispanic White\",\n                                    \"Non-Hispanic White\"),\n                         ses = c(\"low\", \"medium\", \"medium\"))\n\n# use the new data frame to predict\npredictions <- predict(object = glm10.3, newdata = glm10.3_example,\n                       type = \"response\")\npredictions\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#>         1         2         3 \n#> 0.5135547 0.6466977 0.4648331\n```\n\n\n:::\n:::\n\n\nPredict probabilities for observations that are outside the data set\n:::\n\n::::\n:::::\n\n## Achievement 9: Adding and interpreting interaction terms {#sec-chap10-achievement9}\n\nAn interaction term examines how two (or more) variables might work together to influence an outcome. A possible interaction between sex and parental status can be included in the logistic regression model by adding a term, $+ sex \\times parent$, to the formula. When an interaction is included in a model, it is customary to also include the interacting variables separately. In a model with interaction terms, the terms that are not part of the interaction are called *main effects*.\n\n### Computing interaction\n\n:::::{.my-r-code}\n:::{.my-r-code-header}\n:::::: {#cnj-chap10-interaction-parent-sex}\n: Computing interaction parental status and sex\n::::::\n:::\n::::{.my-r-code-container}\n::: {#lst-chap10-interaction-parent-sex}\n\n::: {.cell}\n\n```{.r .cell-code}\n# estimate the library use model for interaction term and print results\nglm10.4 <- glm(formula = uses.lib ~ age + sex + educ + parent +\n                         disabled + rurality + ses + raceth + sex*parent,\n             data = tbl10.4,\n             family = binomial(\"logit\")\n             )\n\nodds.n.ends::odds.n.ends(mod = glm10.4)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Waiting for profiling to be done...\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> $`Logistic regression model significance`\n#> Chi-squared        d.f.           p \n#>      96.296          13       <.001 \n#> \n#> $`Contingency tables (model fit): frequency predicted`\n#>                 Number observed\n#> Number predicted    1    0  Sum\n#>              1    383  264  647\n#>              0    313  467  780\n#>              Sum  696  731 1427\n#> \n#> $`Count R-squared (model fit): percent correctly predicted`\n#> [1] 59.56552\n#> \n#> $`Model sensitivity`\n#> [1] 0.5502874\n#> \n#> $`Model specificity`\n#> [1] 0.6388509\n#> \n#> $`Predictor odds ratios and 95% CI`\n#>                                     OR     2.5 %    97.5 %\n#> (Intercept)                  1.3896208 0.7106390 2.7205274\n#> age                          0.9894621 0.9830350 0.9958813\n#> sexmale                      0.4518131 0.3500795 0.5816044\n#> educFour-year degree or more 1.9341335 1.2770482 2.9441143\n#> educHS to 2-year degree      1.1558031 0.7862126 1.7074900\n#> parentparent                 1.0553800 0.7182384 1.5579958\n#> disabledyes                  0.7939236 0.5785547 1.0867415\n#> ruralitysuburban             1.1796693 0.8937225 1.5575559\n#> ruralityurban                1.2198083 0.9199887 1.6180430\n#> seslow                       0.9509862 0.5828701 1.5483108\n#> sesmedium                    0.8534710 0.5788626 1.2539095\n#> racethNon-Hispanic Black     1.5599911 1.0060581 2.4253682\n#> racethNon-Hispanic White     1.3110430 0.9283916 1.8568026\n#> sexmale:parentparent         1.3855389 0.8300643 2.3074929\n```\n\n\n:::\n:::\n\n\nGeneralized linear model `glm10.4` with interaction parental status and sex\n:::\n\n::::\n:::::\n\n\n### NHST Step 1\n\nWrite the null and alternate hypotheses:\n\n::: {.callout-note}\n- **H0**: A model containing age, sex, education, parent status, disability status, rurality, SES, race-ethnicity, and an interaction between sex and parent status is not useful in explaining library use.\n- **HA**: A model containing age, sex, education, parent status, disability status, rurality, SES, race-ethnicity, and an interaction between sex and parent status is useful in explaining library use.\n:::\n\n### NHST Step 2\n\nCompute the test statistic. \n\nThe test statistic is $χ^2 = 96.30$ with 13 degrees of freedom.\n\n### NHST Step 3\n\nReview and interpret the test statistics: \nCalculate the probability that your test statistic is at least as big as it is if there is no relationship (i.e., the null is true).\n\nThe p-value is less than .001.\n\n### NHST Step 4\n\nConclude and write report.\n\nThe null hypothesis is rejected. The model including age, sex, education, parent status, disability status, rurality, SES, race-ethnicity, and an interaction between sex and parent status is useful in explaining library use [$χ^2(13) = 96.30; p < .001$].\n\n::: {.callout #rep-chap10-interpret-glm10.4}\n##### Interpreation of `glm10.4` for library use with interaction parent status and sex\n\nAge, sex, having a four-year degree or more, and non-Hispanic Black race-ethnicity were statistically significant predictors of library use. For every 1year increase in age, the odds of library use decreased by 1% (OR = .99; 95% CI: .983–.996). Males have 55% lower odds of library use compared to females (OR = .45; 95% CI: .35–.58) and those with a four-year degree have 1.93 times higher odds of library use compared to those with less than a high school education (OR = 1.93; 95% CI: 1.28–2.94). Finally, non-Hispanic Black participants had 1.56 times higher odds of library use compared to Hispanic participants (OR = 1.56; 95% CI: 1.01–2.43). Disability status, SES, disabled status, and rurality were not significantly associated with library use, and those with a high school to 2-year degree had no higher nor lower odds of library use than those with less education. Likewise, non-Hispanic White participants had no higher nor lower odds of library use compared to Hispanic participants. There was no statistically significant interaction between sex and parent status on the odds of library use.\n\nThe model correctly predicted 383 of 696 library users and 467 of 731 library nonusers. Overall, the model correctly predicted 850 of 1427 observations (59.6%); the model was more specific (63.9%) than sensitive (55.0%), indicating that it was better at classifying library nonusers than library users.\n:::\n\n### Check assumption\n\nThee is nothing new in this section.\n\n## Achievement 10: Likelihood ratio test {#sec-chap10-achievement10}\n\nGiven that the interaction term was not statistically significant and the model violated the linearity assumption, it seems preferable to report the previous model without the interaction term as the final model. However, there is a statistical test that can be used to determine whether a larger model is statistically significantly better than a smaller model. The test is called the <a class='glossary' title='The likelihood ratio test is a test that compares two nested binary logistic regression models to determine which is a better fit to the data; the difference between two log-likelihoods follows a chi-squared distribution with a significant result indicating the larger model is a better fitting model. (SwR, Glossary)'>likelihood ratio test</a>.\n\nThe likelihood ratio (LR) test compares two nested models where one model includes a subset of the variables in the other model. For example, the simple logistic regression model with age as the only predictor could be compared statistically to any of the larger models because they all have the age variable in them. The small model is nested in each of the larger models. In addition, the larger model without the interaction could be compared to the model with the interaction term. Models where the variables of one are completely different from the variables of the other cannot be compared with this test.\n\nThe idea behind the LR test is to determine if the additional variables in a model make the model better enough to warrant the complexity of adding more variables to the model.\n\n\n### NHST Step 1\n\nWrite the null and alternate hypotheses:\n\n::: {.callout-note}\n- **H0**: The larger model with the interaction term is no better at explaining library use compared to the model without the interaction term.\n- **HA**: The larger model with the interaction term is better at explaining library use compared to the model without the interaction term.\n:::\n\n### NHST Step 2\n\nCompute the test statistic. \n\nThe {**lmtest**} package (@pak-lmtest) has the `lrtest()` function, which can be used to compare two nested models. The LR test computes the difference between the log-likelihoods for the two models and multiplies this by 2; the result has a chi-squared distribution.\n\n:::::{.my-r-code}\n:::{.my-r-code-header}\n:::::: {#cnj-chap10-lr-test}\n: Likelihood ratio test\n::::::\n:::\n::::{.my-r-code-container}\n::: {#lst-chap10-lr-test}\n\n::: {.cell}\n\n```{.r .cell-code}\nlmtest::lrtest(object = glm10.3, glm10.4)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> Likelihood ratio test\n#> \n#> Model 1: uses.lib ~ age + sex + educ + parent + disabled + rurality + \n#>     raceth + ses\n#> Model 2: uses.lib ~ age + sex + educ + parent + disabled + rurality + \n#>     ses + raceth + sex * parent\n#>   #Df  LogLik Df  Chisq Pr(>Chisq)\n#> 1  13 -941.32                     \n#> 2  14 -940.54  1 1.5599     0.2117\n```\n\n\n:::\n:::\n\n\nLikelihood ratio test\n:::\n\nThe output from `lmtest::lrtest()` shows the test statistic is $χ^2 = 1.56$.\n\n::::\n:::::\n\n\n### NHST Step 3\n\nReview and interpret the test statistics: \nCalculate the probability that your test statistic is at least as big as it is if there is no relationship (i.e., the null is true).\n\nThe test statistic of $χ^2 = 1.56$ had a <a class='glossary' title='The p-value is the probability that the test statistic is at least as big as it is under the null hypothesis (SwR, Glossary)'>p-value</a> of .21.\n\n### NHST Step 4\n\nConclude and write report.\n\n::: {.callout #rep-chap10-lrtest}\n##### Report the result of the likelihood ratio test\n\nThe null hypothesis was retained; the model with the interaction term was no different in explaining library use from the model without the interaction term ($χ^2 = 1.56; p = .21$).\n:::\n\nWhen the larger model is not statistically significantly better, then use of the smaller model to aid in interpretation is preferred. The more complex a model becomes, the more difficult it is to interpret. Generally speaking, parsimony is preferable. However, there are exceptions to this, such as when the larger model has variables in it that have been consistently related to the outcome in other research or are important to understanding the outcome for some other reason.\n\n\n### Complete interpretation of the final model\n\n::: {.callout #rep-chap10-final-interpretation}\n##### Interpretation of the final model\n\n**Model chosen**\n\nA logistic regression model with age, sex, education, parent status, socioeconomic status, race-ethnicity, and disability status was statistically significantly better than a baseline model at explaining library use [$χ^2(12) = 94.74; p < .001$]. \n\nA likelihood ratio test comparing this model to a model that also included an interaction between sex and parent status showed that the larger model was not statistically significantly better than the smaller model [$χ^2(1) = 1.56; p = .21$], so the smaller model was retained. \n\n**Odds of library use**\n\n- The odds of library use were 51% lower for males compared to females ($OR = .49; 95% CI: .39–.61$).\n- The odds of library use were 1.90 times higher for those with a four-year degree compared to those with less than a high school education ($OR = 1.90; 95% CI: 1.26–2.90$). \n- The odds of library use are 1.55 times higher for non-Hispanic Black participants compared to Hispanic participants ($OR = 1.55; 95% CI: 1.002–2.42$). \n- The odds of library use are 1% lower for every 1-year increase in a person’s age ($OR = .99; 95% CI: .984–.996$). \n- The odds of library use are not statistically significantly different for urban or suburban residents compared to rural residents, for parents compared to nonparents, for non-Hispanic Whites compared to Hispanics, or for people with low or medium SES compared to high SES. \n\n**Checked assumptions and model diagnostics**\n\nAssumption checking revealed a possible problem with the linearity of the age predictor, especially at the youngest ages. The other assumptions were met. \n\nDiagnostics found two problematic outlying or influential observations, but the observations did not appear to be data entry mistakes or much different from the rest of the sample in any way.\n:::\n\n:::::{.my-example}\n:::{.my-example-header}\n:::::: {#exm-chap10-forest-plot}\n: Forest plot for reporting odds ratios\n::::::\n:::\n::::{.my-example-container}\n\n::: {.panel-tabset}\n\n###### version 1\n\n:::::{.my-r-code}\n:::{.my-r-code-header}\n:::::: {#cnj-chap10-forest-plot1}\n: Forest plot for reporting odds ratios (Version 1)\n::::::\n:::\n::::{.my-r-code-container}\n::: {#lst-chap10-forest-plot1}\n\n::: {.cell}\n\n```{.r .cell-code}\n# get odds ratio table from glm10.3\n# not [4] as in the book, but [6]\ndf10.3_odds <- data.frame(\n    odds.n.ends::odds.n.ends(mod = glm10.3)[6]\n)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Waiting for profiling to be done...\n```\n\n\n:::\n\n```{.r .cell-code}\n# change variable names for easier use\nnames(df10.3_odds) <- c(\"OR\", \"lower\", \"upper\")\n\n# make row names a variable\ntbl10.3_odds <- df10.3_odds |> \n    tibble::rownames_to_column(var = \"variable\")  \n\n# forest plot of odds ratios from glm10.3 (Figure 10.15)\ntbl10.3_odds |> \n  ggplot2::ggplot(\n      ggplot2::aes(\n          x = variable, \n          y = OR, \n          ymin = lower, \n          ymax = upper)\n      ) +\n  ggplot2::geom_pointrange(color = \"#7463AC\") +\n  ggplot2::geom_hline(\n      yintercept = 1, \n      lty = 2, \n      color = \"deeppink\",\n      linewidth = 1) +\n  ggplot2::coord_flip() +\n  ggplot2::labs(x = \"Variable from library use model\", y = \"Odds ratio (95% CI)\") \n```\n\n::: {.cell-output-display}\n![](10-logistic-regression_files/figure-html/forest-plot1-1.png){width=672}\n:::\n:::\n\nAssociation between demographic characteristics and library use from Pew Research Center 2016 library use survey (Version 1)\n:::\n\n::::\n:::::\n\n\n###### version 2\n\n:::::{.my-r-code}\n:::{.my-r-code-header}\n:::::: {#cnj-chap10-forest-plot2}\n: Forest plot for reporting odds ratios (Version 2)\n::::::\n:::\n::::{.my-r-code-container}\n::: {#lst-chap10-forest-plot2}    \n\n::: {.cell}\n\n```{.r .cell-code}\n# clean variable names for graph\ntbl10.3_odds_clean <- tbl10.3_odds |> \n  dplyr::mutate(\n      variable = dplyr::recode(.x = variable,\n           \"sexmale\" = \"Male\",\n           \"ruralityurban\" = \"Urban residence\",\n           \"ruralitysuburban\" = \"Suburban residence\",\n           \"parentparent\" = \"Parent\",\n           \"educHS to 2-year degree\" = \"HS to 2-year degree\",\n           \"educFour-year degree or more\" = \"Four-year degree or more\",\n           \"disabledyes\" = \"Disabled\",\n           \"age\" = \"Age\",\n           \"seslow\" = \"Low socioeconomic status\",\n           \"sesmedium\" = \"Medium socioeconomic status\",\n           \"racethNon-Hispanic White\" = \"Non-Hispanic white\",\n           \"racethNon-Hispanic Black\" = \"Non-Hispanic black\",\n           \"(Intercept)\" = \"Intercept\")\n      )\n\n# modify graph to include clean variable names (Figure 10.16)\n# change scale of y-axis (flipped) to log scale for visualization\ntbl10.3_odds_clean |> \n  ggplot2::ggplot(\n      ggplot2::aes(\n          x = variable, \n          y = OR, \n          ymin = lower, \n          ymax = upper)) +\n  ggplot2::geom_pointrange(color = \"#7463AC\") +\n  ggplot2::geom_hline(\n      yintercept = 1, \n      lty = 2, \n      color = \"deeppink\", \n      linewidth = 1) +\n  ggplot2::scale_y_log10(\n      breaks = c(0.1, 0.2, 0.5, 1.0, 2.0, 5.0, 10),\n                minor_breaks = NULL) +\n  ggplot2::coord_flip() +\n  ggplot2::labs(\n      x = \"Variable from library use model\", \n      y = \"Odds ratio (95% CI)\") \n```\n\n::: {.cell-output-display}\n![](10-logistic-regression_files/figure-html/forest-plot2-1.png){width=672}\n:::\n:::\n\n\nAssociation between demographic characteristics and library use from Pew Research Center 2016 library use survey (Version 2)\n:::\n\n::::\n:::::\n\n###### final\n\n:::::{.my-r-code}\n:::{.my-r-code-header}\n:::::: {#cnj-chap10-forest-plot3}\n: Forest plot for reporting odds ratios (Final version)\n::::::\n:::\n::::{.my-r-code-container}\n::: {#lst-chap10-forest-plot3}\n\n::: {.cell}\n\n```{.r .cell-code}\ntbl10.3_odds_clean |> \n  ggplot2::ggplot(\n      ggplot2::aes(x = \n               reorder(variable, OR), \n               y = OR, \n               ymin = lower, \n               ymax = upper)) +\n  ggplot2::geom_pointrange(color = \"#7463AC\") +\n  ggplot2::geom_hline(\n      yintercept = 1, \n      lty = 2, \n      color = \"deeppink\", \n      linewidth = 1) +\n  ggplot2::scale_y_log10(\n      breaks = c(0.1, 0.2, 0.5, 1.0, 2.0, 5.0, 10), \n      minor_breaks = NULL) +\n  ggplot2::coord_flip() +\n  ggplot2::labs(\n      x = \"Variable from library use model\", \n      y = \"Odds ratio (95% CI)\")\n```\n\n::: {.cell-output-display}\n![](10-logistic-regression_files/figure-html/forest-plot3-1.png){width=672}\n:::\n:::\n\n\nAssociation between demographic characteristics and library use from Pew Research Center 2016 library use survey (Final version)\n:::\n\n::::\n:::::\n\n\n:::\n\n::::\n:::::\n\n\n\n## Exercises (empty)\n\n## Glossary\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:left;\"> definition </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Adjusted-count-R2 </td>\n   <td style=\"text-align:left;\"> Adjusted count R-squared is a measure of model fit for binary logistic regression that adjusts the percent correctly predicted (or count R-squared) by the model for the number of people in the largest outcome category. (SwR, Glossary) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> B-Spline </td>\n   <td style=\"text-align:left;\"> The term \"spline\" refers to a wide class of basis functions that are used in applications requiring data interpolation and/or smoothing. Splines are special function defined piecewise by polynomials, it results to a smooth function built out of smaller, component functions. In interpolating problems, spline interpolation is often preferred to polynomial interpolation because it yields similar results, even when using low degree polynomials, while avoiding big numbers and the problem of oscillation at the edges of intervals of higher degrees. The term \"spline\" comes from the flexible [spline](https://en.wikipedia.org/wiki/Flat_spline) devices used by shipbuilders and draftsmen to draw smooth shapes. They used a long, thin piece of wood or metal that could be anchored in a few places in order to aid drawing curves.\nThere are many types of splines, especially the common-place 'B-splines': The 'B' stands for 'basis,' which just means 'component.' B-splines build up wiggly functions from simpler less-wiggly components. Those components are called basis functions. B-splines force you to make a number of choices t </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Confidence Interval </td>\n   <td style=\"text-align:left;\"> A range of values, calculated from the sample observations, that is believed, with a particular probability, to contain the true parameter value. (Cambridge Dictionary of Statistics, 4th ed., p.98) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Cook’s D </td>\n   <td style=\"text-align:left;\"> Cook’s distance (often abbreviated Cook’s D) is used in Regression Analysis to find influential outliers in a set of predictor variables. IIt is a way to identify points that negatively affect the regression model. ([Statistics How To](https://www.statisticshowto.com/cooks-distance/)) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Count-R-squared </td>\n   <td style=\"text-align:left;\"> Count R-squared, or percent correctly predicted, is a measure of model fit for a logistic regression model that is the proportion of the outcome values that were correctly predicted out of all observations modeled. (SwR, Glossary) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Cumulative Distribution Function </td>\n   <td style=\"text-align:left;\"> A cumulative distribution function (CDF) tells us the probability that a random variable takes on a value less than or equal to x. (&lt;a href=\"https://www.statology.org/cdf-vs-pdf/\"&gt;Statology&lt;/a&gt;) It sums all parts of the distribution, replacing a lot of calculus work. The CDF takes in a value and returns the probability of getting that value or lower. (BF, Chap.13) A CDF is a hypothetical model of a distribution, the ECDF models empirical (i.e. observed) data. (&lt;a href=\"https://www.statisticshowto.com/empirical-distribution-function/\"&gt;Statistics How To&lt;/a&gt;) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> dfbeta </td>\n   <td style=\"text-align:left;\"> dfbeta are effects on coefficients of deleting each observation in turn. (\"Companion to Applied Regression\", car package, help file) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> dfbetas </td>\n   <td style=\"text-align:left;\"> dfbetas are effect on coefficients of deleting each observation in turn, standardized by a deleted estimate of the coefficient standard error (\"Companion to Applied Regression\", car package, help file) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Digital Divide </td>\n   <td style=\"text-align:left;\"> The term \"digital divide\" refers to the gap between individuals, households, businesses and geographic areas at different socio-economic levels with regard to their opportunities to access information and communication technologies (ICTs). (&lt;a href= \"https://www.oecd-ilibrary.org/science-and-technology/understanding-the-digital-divide_236405667766\"&gt;OECD Library&lt;/a&gt;) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ExDA </td>\n   <td style=\"text-align:left;\"> Explorative Data Analysis is an approach of analyzing data sets to summarize their main characteristics, often using statistical graphics and other data visualization methods. A statistical model can be used or not, but primarily EDA is for seeing what the data can tell us beyond the formal modeling and thereby contrasts traditional hypothesis testing. (&lt;a href=\"https://en.wikipedia.org/wiki/Exploratory_data_analysis\"&gt;Wikipedia&lt;/a&gt;) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> GLM </td>\n   <td style=\"text-align:left;\"> A generalized linear model (GLM) is a flexible generalization of ordinary linear regression. The GLM generalizes linear regression by allowing the linear model to be related to the response variable via a link function and by allowing the magnitude of the variance of each measurement to be a function of its predicted value. (&lt;a href=\"https://en.wikipedia.org/w/index.php?title=Generalized_linear_model&amp;oldid=1175448680\"&gt;Wikipedia&lt;/a&gt;). the binary logistic regression model is one example of a generalized linear model. (SwR, Glossary) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Goodness-of-fit </td>\n   <td style=\"text-align:left;\"> The chi-squared goodness-of-fit test is used for comparing the values of a single categorical variable to values from a hypothesized or population variable. The goodness-of-fit test is often used when trying to determine if a sample is a good representation of the population. (SwR, Chap 5) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> GVIF </td>\n   <td style=\"text-align:left;\"> The generalized variance inflation factor (GVIF) is a generalized version of the variance inflation factor (VIF) that is used to identify problems with multicollinearity; the GVIF is used in binary logistic regression. (SwR, Glossary) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Influential Observation </td>\n   <td style=\"text-align:left;\"> An influential observation is an observation that changes the slope of a regression line. (SwR, Glossary) Influential points are observed data points that are far from the other observed data points in the horizontal direction. These points may have a big effect on the slope of the regression line. To begin to identify an influential point, you can remove it from the data set and see if the slope of the regression line is changed significantly. (&lt;a href= \"https://openstax.org/books/introductory-statistics/pages/12-6-outliers\"&gt;Introductory Statistics 12.6&lt;/a&gt;) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Likelihood-ratio </td>\n   <td style=\"text-align:left;\"> The likelihood ratio test is a test that compares two nested binary logistic regression models to determine which is a better fit to the data; the difference between two log-likelihoods follows a chi-squared distribution with a significant result indicating the larger model is a better fitting model. (SwR, Glossary) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Linear Regression </td>\n   <td style=\"text-align:left;\"> Linear regression is used to predict the value of an outcome variable Y based on one or more input predictor variables X. The aim is to establish a linear relationship (a mathematical formula) between the predictor variable(s) and the response variable, so that, we can use this formula to estimate the value of the response Y, when only the predictors (Xs) values are known. ([r-statistics.co](https://r-statistics.co/Linear-Regression.html)) (Chap.4) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Linearity </td>\n   <td style=\"text-align:left;\"> Linearity is the assumption of some statistical models that requires the outcome, or transformed outcome, to have a linear relationship with numeric predictors, where linear relationships are relationships that are evenly distributed around a line. (SwR, Glossary) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Logit Transformations </td>\n   <td style=\"text-align:left;\"> Logit transformations are transformations that takes the log value of p/(1-p); this transformation is often used to normalize percentage data and is used in the logistic model to transform the outcome. (SwR, Glossary) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Odds Ratio </td>\n   <td style=\"text-align:left;\"> Odds is usually defined in statistics as the probability an event will occur divided by the probability that it will not occur. An odds ratio (OR) is a measure of association between a certain property A and a second property B in a population. Specifically, it tells you how the presence or absence of property A has an effect on the presence or absence of property B. (&lt;a href=\"https://www.statisticshowto.com/probability-and-statistics/probability-main-index/odds-ratio/\"&gt;Statistics How To&lt;/a&gt;). An odds ratio is a ratio of two ratios. They quantify the strength of the relationship between two conditions. They indicate how likely an outcome is to occur in one context relative to another. (&lt;a href=\"https://statisticsbyjim.com/probability/odds-ratio/\"&gt;Statistics by Jim&lt;/a&gt;) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Outcome </td>\n   <td style=\"text-align:left;\"> Outcome is the variable being explained or predicted by a model; in linear and logistic regression, the outcome variable is on the left-hand side of the equal sign. (SwR, Glossary) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Outliers </td>\n   <td style=\"text-align:left;\"> Outliers are observations with unusual values. (SwR, Glossary). Outliers are observed data points that are far from the least squares line. They have large \"errors\", where the \"error\" or residual is the vertical distance from the line to the point. (&lt;a href= \"https://openstax.org/books/introductory-statistics/pages/12-6-outliers\"&gt;Introductory Statistics 12.6&lt;/a&gt;) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> p-value </td>\n   <td style=\"text-align:left;\"> The p-value is the probability that the test statistic is at least as big as it is under the null hypothesis (SwR, Glossary) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PDF </td>\n   <td style=\"text-align:left;\"> A probability densitiy function (PDF) describes a probability distribution for a random, continuous variable. Use a probability density function to find the chances that the value of a random variable will occur within a range of values that you specify. More specifically, a PDF is a function where its integral for an interval provides the probability of a value occurring in that interval. (&lt;a href=\"https://statisticsbyjim.com/probability/probability-density-function/\"&gt;Statistics By Jim&lt;/a&gt;) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Predictor Variable </td>\n   <td style=\"text-align:left;\"> Predictor variable -- also known sometimes as the independent or explanatory variable -- is the counterpart to the response or dependent variable. Predictor variables are used to make predictions for dependent variables. ([DeepAI](https://deepai.org/machine-learning-glossary-and-terms/predictor-variable), [MiniTab](https://support.minitab.com/en-us/minitab/21/help-and-how-to/statistical-modeling/regression/supporting-topics/basics/what-are-response-and-predictor-variables/)) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> QRP </td>\n   <td style=\"text-align:left;\"> Questionable Research Practice (QRP) is a research practice that introduces bias, usually in pursuit of statistical significance; an example of such practices might be dropping or recoding values or variables solely to improve a model fit statistic. (SwR, GLossary) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Quantile </td>\n   <td style=\"text-align:left;\"> Quantiles are cut points dividing the range of a probability distribution into continuous intervals with equal probabilities (&lt;a href=\"https://en.wikipedia.org/wiki/Quantile\"&gt;Wikipedia&lt;/a&gt;) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Residually </td>\n   <td style=\"text-align:left;\"> Residuals are the differences between the observed values and the predicted values. (SwR, Glossary) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Sensitivity </td>\n   <td style=\"text-align:left;\"> The true positive rate (one minus the false negative rate), is referred to as sensitivity, recall, or probability of detection. (Bayesian Thinking, Chap.1). But also the percentage of “yes” values or 1s a logistic regression model got right. (SwR, Glossary) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Sigmoid </td>\n   <td style=\"text-align:left;\"> A sigmoid function is any mathematical function whose graph has a characteristic S-shaped curve or sigmoid curve. (&lt;a href=\"https://en.wikipedia.org/wiki/Sigmoid_function\"&gt;Wikipedia&lt;/a&gt;) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Specificity </td>\n   <td style=\"text-align:left;\"> The true negative rate (one minus the false positive rate), is referred to as specificity. (Bayesian Thinking, Chap.1) But also the percentage of “no” values or 0s a logistic regression model predicted correctly. (SwR, Glossary) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Standard Deviation </td>\n   <td style=\"text-align:left;\"> The standard deviation is a measure of the amount of variation or dispersion of a set of values. A low standard deviation indicates that the values tend to be close to the mean (also called the expected value) of the set, while a high standard deviation indicates that the values are spread out over a wider range. The standard deviation is the square root of its variance. A useful property of the standard deviation is that, unlike the variance, it is expressed in the same unit as the data. Standard deviation may be abbreviated SD, and is most commonly represented in mathematical texts and equations by the lower case Greek letter $\\sigma$ (sigma), for the population standard deviation, or the Latin letter $s$ for the sample standard deviation. ([Wikipedia](https://en.wikipedia.org/wiki/Standard_deviation)) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Standard Error </td>\n   <td style=\"text-align:left;\"> The standard error (SE) of a statistic is the standard deviation of its [sampling distribution]. If the statistic is the sample mean, it is called the standard error of the mean (SEM). (&lt;a href=\"https://en.wikipedia.org/wiki/Standard_error\"&gt;Wikipedia&lt;/a&gt;) The standard error is a measure of variability that estimates how much variability there is in a population based on the variability in the sample and the size of the sample. (SwR, Glossary) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> VIF </td>\n   <td style=\"text-align:left;\"> The variance inflation factor (VIF) is a statistic for determining whether there is problematic multicollinearity in a linear regression model. (SwR, Glossary) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Wald </td>\n   <td style=\"text-align:left;\"> Wald test is the statistical test for comparing the value of the coefficient in linear or logistic regression to the hypothesized value of zero; the form is similar to a one-sample t-test, although some Wald tests use a t-statistic and others use a z-statistic as the test statistic. (SwR, Glossary) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Z-score </td>\n   <td style=\"text-align:left;\"> A z-score (also called a standard score) gives you an idea of how far from the mean a data point is. But more technically it’s a measure of how many standard deviations below or above the population mean a raw score is. (&lt;a href=\"https://www.statisticshowto.com/probability-and-statistics/z-score/#Whatisazscore\"&gt;StatisticsHowTo&lt;/a&gt;) </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n## Session Info {.unnumbered}\n\n::: my-r-code\n::: my-r-code-header\nSession Info\n:::\n\n::: my-r-code-container\n\n::: {.cell}\n\n```{.r .cell-code}\nsessioninfo::session_info()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> ─ Session info ───────────────────────────────────────────────────────────────\n#>  setting  value\n#>  version  R version 4.4.0 (2024-04-24)\n#>  os       macOS Sonoma 14.4.1\n#>  system   x86_64, darwin20\n#>  ui       X11\n#>  language (EN)\n#>  collate  en_US.UTF-8\n#>  ctype    en_US.UTF-8\n#>  tz       Europe/Vienna\n#>  date     2024-05-01\n#>  pandoc   3.1.13 @ /usr/local/bin/ (via rmarkdown)\n#> \n#> ─ Packages ───────────────────────────────────────────────────────────────────\n#>  package       * version    date (UTC) lib source\n#>  abind           1.4-5      2016-07-21 [1] CRAN (R 4.4.0)\n#>  assertthat      0.2.1      2019-03-21 [1] CRAN (R 4.4.0)\n#>  backports       1.4.1      2021-12-13 [1] CRAN (R 4.4.0)\n#>  base64enc       0.1-3      2015-07-28 [1] CRAN (R 4.4.0)\n#>  boot            1.3-30     2024-02-26 [1] CRAN (R 4.4.0)\n#>  broom.helpers   1.15.0     2024-04-05 [1] CRAN (R 4.4.0)\n#>  car             3.1-2      2023-03-30 [1] CRAN (R 4.4.0)\n#>  carData         3.0-5      2022-01-06 [1] CRAN (R 4.4.0)\n#>  cellranger      1.1.0      2016-07-27 [1] CRAN (R 4.4.0)\n#>  checkmate       2.3.1      2023-12-04 [1] CRAN (R 4.4.0)\n#>  class           7.3-22     2023-05-03 [1] CRAN (R 4.4.0)\n#>  cli             3.6.2      2023-12-11 [1] CRAN (R 4.4.0)\n#>  cluster         2.1.6      2023-12-01 [1] CRAN (R 4.4.0)\n#>  coda            0.19-4.1   2024-01-31 [1] CRAN (R 4.4.0)\n#>  codetools       0.2-20     2024-03-31 [1] CRAN (R 4.4.0)\n#>  colorspace      2.1-0      2023-01-23 [1] CRAN (R 4.4.0)\n#>  commonmark      1.9.1      2024-01-30 [1] CRAN (R 4.4.0)\n#>  crayon          1.5.2      2022-09-29 [1] CRAN (R 4.4.0)\n#>  curl            5.2.1      2024-03-01 [1] CRAN (R 4.4.0)\n#>  data.table      1.15.4     2024-03-30 [1] CRAN (R 4.4.0)\n#>  datawizard      0.10.0     2024-03-26 [1] CRAN (R 4.4.0)\n#>  DescTools       0.99.54    2024-02-03 [1] CRAN (R 4.4.0)\n#>  digest          0.6.35     2024-03-11 [1] CRAN (R 4.4.0)\n#>  dplyr           1.1.4      2023-11-17 [1] CRAN (R 4.4.0)\n#>  e1071           1.7-14     2023-12-06 [1] CRAN (R 4.4.0)\n#>  emmeans         1.10.1     2024-04-06 [1] CRAN (R 4.4.0)\n#>  estimability    1.5        2024-02-20 [1] CRAN (R 4.4.0)\n#>  evaluate        0.23       2023-11-01 [1] CRAN (R 4.4.0)\n#>  Exact           3.2        2022-09-25 [1] CRAN (R 4.4.0)\n#>  expm            0.999-9    2024-01-11 [1] CRAN (R 4.4.0)\n#>  fansi           1.0.6      2023-12-08 [1] CRAN (R 4.4.0)\n#>  farver          2.1.1      2022-07-06 [1] CRAN (R 4.4.0)\n#>  fastmap         1.1.1      2023-02-24 [1] CRAN (R 4.4.0)\n#>  forcats         1.0.0      2023-01-29 [1] CRAN (R 4.4.0)\n#>  foreign         0.8-86     2023-11-28 [1] CRAN (R 4.4.0)\n#>  Formula         1.2-5      2023-02-24 [1] CRAN (R 4.4.0)\n#>  generics        0.1.3      2022-07-05 [1] CRAN (R 4.4.0)\n#>  ggformula       0.12.0     2023-11-09 [1] CRAN (R 4.4.0)\n#>  ggokabeito      0.1.0      2021-10-18 [1] CRAN (R 4.4.0)\n#>  ggplot2         3.5.1      2024-04-23 [1] CRAN (R 4.4.0)\n#>  ggridges        0.5.6      2024-01-23 [1] CRAN (R 4.4.0)\n#>  gld             2.6.6      2022-10-23 [1] CRAN (R 4.4.0)\n#>  glossary      * 1.0.0.9003 2024-04-25 [1] Github (debruine/glossary@05e4a61)\n#>  glue            1.7.0      2024-01-09 [1] CRAN (R 4.4.0)\n#>  gridExtra       2.3        2017-09-09 [1] CRAN (R 4.4.0)\n#>  gt              0.10.1     2024-01-17 [1] CRAN (R 4.4.0)\n#>  gtable          0.3.5      2024-04-22 [1] CRAN (R 4.4.0)\n#>  gtsummary       1.7.2      2023-07-15 [1] CRAN (R 4.4.0)\n#>  haven           2.5.4      2023-11-30 [1] CRAN (R 4.4.0)\n#>  here            1.0.1      2020-12-13 [1] CRAN (R 4.4.0)\n#>  highr           0.10       2022-12-22 [1] CRAN (R 4.4.0)\n#>  Hmisc           5.1-2      2024-03-11 [1] CRAN (R 4.4.0)\n#>  hms             1.1.3      2023-03-21 [1] CRAN (R 4.4.0)\n#>  htmlTable       2.4.2      2023-10-29 [1] CRAN (R 4.4.0)\n#>  htmltools       0.5.8.1    2024-04-04 [1] CRAN (R 4.4.0)\n#>  htmlwidgets     1.6.4      2023-12-06 [1] CRAN (R 4.4.0)\n#>  httr            1.4.7      2023-08-15 [1] CRAN (R 4.4.0)\n#>  huxtable        5.5.6      2024-02-15 [1] CRAN (R 4.4.0)\n#>  insight         0.19.10    2024-03-22 [1] CRAN (R 4.4.0)\n#>  jsonlite        1.8.8      2023-12-04 [1] CRAN (R 4.4.0)\n#>  kableExtra      1.4.0      2024-01-24 [1] CRAN (R 4.4.0)\n#>  knitr           1.46       2024-04-06 [1] CRAN (R 4.4.0)\n#>  labeling        0.4.3      2023-08-29 [1] CRAN (R 4.4.0)\n#>  labelled        2.13.0     2024-04-23 [1] CRAN (R 4.4.0)\n#>  lattice         0.22-6     2024-03-20 [1] CRAN (R 4.4.0)\n#>  lifecycle       1.0.4      2023-11-07 [1] CRAN (R 4.4.0)\n#>  lmom            3.0        2023-08-29 [1] CRAN (R 4.4.0)\n#>  lmtest          0.9-40     2022-03-21 [1] CRAN (R 4.4.0)\n#>  magrittr        2.0.3      2022-03-30 [1] CRAN (R 4.4.0)\n#>  markdown        1.12       2023-12-06 [1] CRAN (R 4.4.0)\n#>  MASS            7.3-60.2   2024-04-24 [1] local\n#>  Matrix          1.7-0      2024-03-22 [1] CRAN (R 4.4.0)\n#>  MatrixModels    0.5-3      2023-11-06 [1] CRAN (R 4.4.0)\n#>  mgcv            1.9-1      2023-12-21 [1] CRAN (R 4.4.0)\n#>  moonBook        0.3.1      2022-01-05 [1] CRAN (R 4.4.0)\n#>  mosaicCore      0.9.4.0    2023-11-05 [1] CRAN (R 4.4.0)\n#>  multcomp        1.4-25     2023-06-20 [1] CRAN (R 4.4.0)\n#>  munsell         0.5.1      2024-04-01 [1] CRAN (R 4.4.0)\n#>  mvtnorm         1.2-4      2023-11-27 [1] CRAN (R 4.4.0)\n#>  nhstplot        1.3.0      2024-03-01 [1] CRAN (R 4.4.0)\n#>  nlme            3.1-164    2023-11-27 [1] CRAN (R 4.4.0)\n#>  nnet            7.3-19     2023-05-03 [1] CRAN (R 4.4.0)\n#>  odds.n.ends     0.1.4      2021-09-17 [1] CRAN (R 4.4.0)\n#>  performance     0.11.0     2024-03-22 [1] CRAN (R 4.4.0)\n#>  pillar          1.9.0      2023-03-22 [1] CRAN (R 4.4.0)\n#>  pkgconfig       2.0.3      2019-09-22 [1] CRAN (R 4.4.0)\n#>  polspline       1.1.24     2023-10-26 [1] CRAN (R 4.4.0)\n#>  proxy           0.4-27     2022-06-09 [1] CRAN (R 4.4.0)\n#>  pscl            1.5.9      2024-01-31 [1] CRAN (R 4.4.0)\n#>  pubh            1.3.2      2024-01-11 [1] CRAN (R 4.4.0)\n#>  purrr           1.0.2      2023-08-10 [1] CRAN (R 4.4.0)\n#>  quantreg        5.97       2023-08-19 [1] CRAN (R 4.4.0)\n#>  R6              2.5.1      2021-08-19 [1] CRAN (R 4.4.0)\n#>  Rcpp            1.0.12     2024-01-09 [1] CRAN (R 4.4.0)\n#>  readxl          1.4.3      2023-07-06 [1] CRAN (R 4.4.0)\n#>  repr            1.1.7      2024-03-22 [1] CRAN (R 4.4.0)\n#>  rlang           1.1.3      2024-01-10 [1] CRAN (R 4.4.0)\n#>  rmarkdown       2.26       2024-03-05 [1] CRAN (R 4.4.0)\n#>  rms             6.8-0      2024-03-11 [1] CRAN (R 4.4.0)\n#>  rootSolve       1.8.2.4    2023-09-21 [1] CRAN (R 4.4.0)\n#>  rpart           4.1.23     2023-12-05 [1] CRAN (R 4.4.0)\n#>  rprojroot       2.0.4      2023-11-05 [1] CRAN (R 4.4.0)\n#>  rstudioapi      0.16.0     2024-03-24 [1] CRAN (R 4.4.0)\n#>  rversions       2.1.2      2022-08-31 [1] CRAN (R 4.4.0)\n#>  sandwich        3.1-0      2023-12-11 [1] CRAN (R 4.4.0)\n#>  scales          1.3.0      2023-11-28 [1] CRAN (R 4.4.0)\n#>  sessioninfo     1.2.2      2021-12-06 [1] CRAN (R 4.4.0)\n#>  sjlabelled      1.2.0      2022-04-10 [1] CRAN (R 4.4.0)\n#>  sjmisc          2.8.9      2021-12-03 [1] CRAN (R 4.4.0)\n#>  skimr           2.1.5      2022-12-23 [1] CRAN (R 4.4.0)\n#>  SparseM         1.81       2021-02-18 [1] CRAN (R 4.4.0)\n#>  stringi         1.8.3      2023-12-11 [1] CRAN (R 4.4.0)\n#>  stringr         1.5.1      2023-11-14 [1] CRAN (R 4.4.0)\n#>  survival        3.6-4      2024-04-24 [1] CRAN (R 4.4.0)\n#>  svglite         2.1.3      2023-12-08 [1] CRAN (R 4.4.0)\n#>  systemfonts     1.0.6      2024-03-07 [1] CRAN (R 4.4.0)\n#>  TH.data         1.1-2      2023-04-17 [1] CRAN (R 4.4.0)\n#>  tibble          3.2.1      2023-03-20 [1] CRAN (R 4.4.0)\n#>  tidyr           1.3.1      2024-01-24 [1] CRAN (R 4.4.0)\n#>  tidyselect      1.2.1      2024-03-11 [1] CRAN (R 4.4.0)\n#>  utf8            1.2.4      2023-10-22 [1] CRAN (R 4.4.0)\n#>  vctrs           0.6.5      2023-12-01 [1] CRAN (R 4.4.0)\n#>  viridisLite     0.4.2      2023-05-02 [1] CRAN (R 4.4.0)\n#>  withr           3.0.0      2024-01-16 [1] CRAN (R 4.4.0)\n#>  xfun            0.43       2024-03-25 [1] CRAN (R 4.4.0)\n#>  xml2            1.3.6      2023-12-04 [1] CRAN (R 4.4.0)\n#>  xtable          1.8-4      2019-04-21 [1] CRAN (R 4.4.0)\n#>  yaml            2.3.8      2023-12-11 [1] CRAN (R 4.4.0)\n#>  zoo             1.8-12     2023-04-13 [1] CRAN (R 4.4.0)\n#> \n#>  [1] /Library/Frameworks/R.framework/Versions/4.4-x86_64/Resources/library\n#> \n#> ──────────────────────────────────────────────────────────────────────────────\n```\n\n\n:::\n:::\n\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}