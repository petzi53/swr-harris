<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<head>

<meta charset="utf-8" />
<meta name="generator" content="quarto-1.4.549" />

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />


<title>Notes on Statistics with R (SwR) – 1  Preparing Data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<!-- htmldependencies:E3FAD763 -->
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="quarto.css" />
<link rel="stylesheet" href="glossary.css" />
</head>

<body>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn"
      data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" 
      aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation"
      onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <h1 class="quarto-secondary-nav-title no-breadcrumbs"></h1>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" 
        aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation"
        onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="/">
      Notes on Statistics with R (SwR)
      </a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/petzi53/swr-harris"  title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/01-preparing-data.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class='chapter-number'>1</span>  <span class='chapter-title'>Preparing Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/02-descriptive-statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class='chapter-number'>2</span>  <span class='chapter-title'>Descriptive statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/03-data-visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class='chapter-number'>3</span>  <span class='chapter-title'>Data visualization</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/95-references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" ></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <div id="quarto-toc-target"></div>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-chap01" class="quarto-section-identifier"><span class="chapter-number">1</span>  <span class="chapter-title">Preparing Data</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>

<nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#achievements-to-unlock" id="toc-achievements-to-unlock"><span class="header-section-number">1.1</span> Achievements to unlock</a></li>
  <li><a href="#sec-chap01-reproducibility" id="toc-sec-chap01-reproducibility"><span class="header-section-number">1.2</span> Using reproducible research practices</a>
  <ul>
  <li><a href="#script-files" id="toc-script-files"><span class="header-section-number">1.2.1</span> Script files</a></li>
  <li><a href="#naming-objects" id="toc-naming-objects"><span class="header-section-number">1.2.2</span> Naming objects</a></li>
  </ul></li>
  <li><a href="#sec-chap01-import-data" id="toc-sec-chap01-import-data"><span class="header-section-number">1.3</span> Import data frames from outside resources</a>
  <ul>
  <li><a href="#some-common-file-extensions" id="toc-some-common-file-extensions"><span class="header-section-number">1.3.1</span> Some common file extensions</a></li>
  <li><a href="#some-packages-for-import-data-sources" id="toc-some-packages-for-import-data-sources"><span class="header-section-number">1.3.2</span> Some packages for import data sources</a></li>
  <li><a href="#import-data-with-a-.csv-file" id="toc-import-data-with-a-.csv-file"><span class="header-section-number">1.3.3</span> Import data with a .csv file</a></li>
  </ul></li>
  <li><a href="#sec-chap01-data-wrangling" id="toc-sec-chap01-data-wrangling"><span class="header-section-number">1.4</span> Data Wrangling</a>
  <ul>
  <li><a href="#todo-list" id="toc-todo-list"><span class="header-section-number">1.4.1</span> ToDo List</a></li>
  <li><a href="#replicating-data-structure-for-bar-charts" id="toc-replicating-data-structure-for-bar-charts"><span class="header-section-number">1.4.2</span> Replicating data structure for bar charts</a></li>
  </ul></li>
  <li><a href="#sec-chap01-repr-bar-charts" id="toc-sec-chap01-repr-bar-charts"><span class="header-section-number">1.5</span> Reproducing bar charts</a></li>
  <li><a href="#exercises" id="toc-exercises"><span class="header-section-number">1.6</span> Exercises</a>
  <ul>
  <li><a href="#sec-visit-nhanes-website" id="toc-sec-visit-nhanes-website"><span class="header-section-number">1.6.1</span> Visiting the NHANES website</a></li>
  <li><a href="#sec-download-xpt-file" id="toc-sec-download-xpt-file"><span class="header-section-number">1.6.2</span> Download NHANES SAS .xpt file data (Demo)</a></li>
  <li><a href="#sec-chap01-import-clean-data" id="toc-sec-chap01-import-clean-data"><span class="header-section-number">1.6.3</span> Import &amp; clean data</a></li>
  <li><a href="#sec-chap01-bar-chart-grass" id="toc-sec-chap01-bar-chart-grass"><span class="header-section-number">1.6.4</span> Bar chart for marijuana use</a></li>
  <li><a href="#sec-chap01-grass-age-sex" id="toc-sec-chap01-grass-age-sex"><span class="header-section-number">1.6.5</span> Marijuana use per age and sex</a></li>
  <li><a href="#sec-chap01-data-interpretation" id="toc-sec-chap01-data-interpretation"><span class="header-section-number">1.6.6</span> Data interpretation</a></li>
  </ul></li>
  <li><a href="#sec-chap01-get-gss-data" id="toc-sec-chap01-get-gss-data"><span class="header-section-number">1.7</span> Get the GSS data</a>
  <ul>
  <li><a href="#working-with-the-gss" id="toc-working-with-the-gss"><span class="header-section-number">1.7.1</span> Working with the GSS</a></li>
  <li><a href="#five-strategies-to-get-gss-data" id="toc-five-strategies-to-get-gss-data"><span class="header-section-number">1.7.2</span> Five strategies to get GSS data</a></li>
  </ul></li>
  <li><a href="#sec-chap01-labelled-data" id="toc-sec-chap01-labelled-data"><span class="header-section-number">1.8</span> Working with Labelled Data</a>
  <ul>
  <li><a href="#how-to-work-with-labelled-data-resources" id="toc-how-to-work-with-labelled-data-resources"><span class="header-section-number">1.8.1</span> How to work with labelled data? — Resources</a></li>
  <li><a href="#sec-chap01-labelled-data-2" id="toc-sec-chap01-labelled-data-2"><span class="header-section-number">1.8.2</span> Displaying data including labelled vectors</a></li>
  <li><a href="#sec-chap01-labelled-data-3" id="toc-sec-chap01-labelled-data-3"><span class="header-section-number">1.8.3</span> Working with labelled data</a>
  <ul>
  <li><a href="#two-different-approaches" id="toc-two-different-approaches"><span class="header-section-number">1.8.3.1</span> Two different approaches</a></li>
  <li><a href="#inspecting-labelled-data" id="toc-inspecting-labelled-data"><span class="header-section-number">1.8.3.2</span> Inspecting labelled data</a></li>
  <li><a href="#working-with-labelled-data" id="toc-working-with-labelled-data"><span class="header-section-number">1.8.3.3</span> Working with labelled data</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#table-excursion" id="toc-table-excursion"><span class="header-section-number">1.9</span> Table excursion</a>
  <ul>
  <li><a href="#sec-chap01-review-table-packages" id="toc-sec-chap01-review-table-packages"><span class="header-section-number">1.9.1</span> Review several table packages</a></li>
  <li><a href="#sec-chap01-experiments-gtsummary" id="toc-sec-chap01-experiments-gtsummary"><span class="header-section-number">1.9.2</span> Experiments with the gtsummary package</a></li>
  </ul></li>
  <li><a href="#sec-chap01-grass-timeline" id="toc-sec-chap01-grass-timeline"><span class="header-section-number">1.10</span> Opinions about legalizing marijuana (1973-2022)</a></li>
  <li><a href="#packages-introduced-in-this-chapter" id="toc-packages-introduced-in-this-chapter"><span class="header-section-number">1.11</span> Packages introduced in this chapter</a>
  <ul>
  <li><a href="#dplyr" id="toc-dplyr"><span class="header-section-number">1.11.1</span> dplyr</a></li>
  <li><a href="#dt-1" id="toc-dt-1"><span class="header-section-number">1.11.2</span> DT</a></li>
  <li><a href="#forcats" id="toc-forcats"><span class="header-section-number">1.11.3</span> forcats</a></li>
  <li><a href="#ggplot2" id="toc-ggplot2"><span class="header-section-number">1.11.4</span> ggplot2</a></li>
  <li><a href="#gssr-1" id="toc-gssr-1"><span class="header-section-number">1.11.5</span> gssr</a></li>
  <li><a href="#gt-1" id="toc-gt-1"><span class="header-section-number">1.11.6</span> gt</a></li>
  <li><a href="#gtsummary-1" id="toc-gtsummary-1"><span class="header-section-number">1.11.7</span> gtsummary</a></li>
  <li><a href="#haven" id="toc-haven"><span class="header-section-number">1.11.8</span> haven</a></li>
  <li><a href="#kableextra-1" id="toc-kableextra-1"><span class="header-section-number">1.11.9</span> kableExtra</a></li>
  <li><a href="#knitr" id="toc-knitr"><span class="header-section-number">1.11.10</span> knitr</a></li>
  <li><a href="#labelled" id="toc-labelled"><span class="header-section-number">1.11.11</span> labelled</a></li>
  <li><a href="#sjlabelled" id="toc-sjlabelled"><span class="header-section-number">1.11.12</span> sjlabelled</a></li>
  <li><a href="#readr" id="toc-readr"><span class="header-section-number">1.11.13</span> readr</a></li>
  <li><a href="#skimr" id="toc-skimr"><span class="header-section-number">1.11.14</span> skimr</a></li>
  <li><a href="#tibble-1" id="toc-tibble-1"><span class="header-section-number">1.11.15</span> tibble</a></li>
  <li><a href="#tidyr" id="toc-tidyr"><span class="header-section-number">1.11.16</span> tidyr</a></li>
  <li><a href="#tidyverse" id="toc-tidyverse"><span class="header-section-number">1.11.17</span> tidyverse</a></li>
  </ul></li>
  <li><a href="#glossary" id="toc-glossary">Glossary</a></li>
  <li><a href="#session-info" id="toc-session-info">Session Info</a></li>
  </ul>
</nav>
<section id="achievements-to-unlock" class="level2" data-number="1.1">
<h2 data-number="1.1"><span class="header-section-number">1.1</span> Achievements to unlock</h2>
<div class="my-objectives">
<div class="my-objectives-header">
<p>Achievements:</p>
</div>
<div class="my-objectives-container">
<p><strong>SwR Achievements</strong></p>
<ul>
<li>(<del>Observations and variables</del>)</li>
<li>Using reproducible research practices (<a href="#sec-chap01-reproducibility" class="quarto-xref"><span class="quarto-unresolved-ref">sec-chap01-reproducibility</span></a>)</li>
<li>(<del>Understanding and changing data types</del>)</li>
<li>Entering or loading data into R (<a href="#sec-chap01-import-data" class="quarto-xref"><span class="quarto-unresolved-ref">sec-chap01-import-data</span></a>)</li>
<li>Identifying and treating missing values (Data wrangling) (<a href="#sec-chap01-data-wrangling" class="quarto-xref"><span class="quarto-unresolved-ref">sec-chap01-data-wrangling</span></a>)</li>
<li>Building a basic bar chart (Replicate Figure 1.1 and 1.2) (<a href="#sec-chap01-repr-bar-charts" class="quarto-xref"><span class="quarto-unresolved-ref">sec-chap01-repr-bar-charts</span></a>)</li>
</ul>
<p>I will skip the crossed out learning objectives in parenthesis as I know already these procedures. However I will modify and elaborate some of these achievements as mentioned in the parentheses.</p>
<p>I will add other objectives that resulted from questions that arose during reading the book.</p>
<p><strong>Questions that resulted to additional objectives</strong></p>
<ul>
<li>How to download data directly from the <a class='glossary' title='A large survey of a sample of people in the United States conducted regularly since 1972; the General Social Survey is abbreviated GSS and is conducted by the National Opinion Research Center at the University of Chicago. (Harris, Glossary)'>General Social Survey</a> (GSS) web page? {<a href="#sec-chap01-get-gss-data" class="quarto-xref"><span class="quarto-unresolved-ref">sec-chap01-get-gss-data</span></a>}</li>
<li>How to work with labelled data? {<a href="#sec-chap01-labelled-data" class="quarto-xref"><span class="quarto-unresolved-ref">sec-chap01-labelled-data</span></a>}</li>
<li>Reviewing different packages for creating tables (<a href="#sec-chap01-review-table-packages" class="quarto-xref"><span class="quarto-unresolved-ref">sec-chap01-review-table-packages</span></a>)</li>
<li>Introducing {<strong>gtsummary</strong>}, a packages for presentation-ready data summary and analytic result tables (see: <a href="#pak-gtsummary" class="quarto-xref">Package Profile <span class="quarto-unresolved-ref">pak-gtsummary</span></a> <a href="#sec-chap01-experiments-gtsummary" class="quarto-xref"><span class="quarto-unresolved-ref">sec-chap01-experiments-gtsummary</span></a>)</li>
<li>Developing timeline graph (1973-2022) about opinions of respondents from <a class='glossary' title='A large survey of a sample of people in the United States conducted regularly since 1972; the General Social Survey is abbreviated GSS and is conducted by the National Opinion Research Center at the University of Chicago. (Harris, Glossary)'>GSS</a> surveys about legalizing marijuana (<a href="#sec-chap01-grass-timeline" class="quarto-xref"><span class="quarto-unresolved-ref">sec-chap01-grass-timeline</span></a>)</li>
</ul>
</div>
</div>
</section>
<section id="sec-chap01-reproducibility" class="level2" data-number="1.2">
<h2 data-number="1.2"><span class="header-section-number">1.2</span> Using reproducible research practices</h2>
<section id="script-files" class="level3" data-number="1.2.1">
<h3 data-number="1.2.1"><span class="header-section-number">1.2.1</span> Script files</h3>
<p>SwR explains writing script files, but I am using <a class='glossary' title='Literate programming is a methodology that combines a programming language with a documentation language, thereby making programs more robust, more portable, more easily maintained, and arguably more fun to write than programs that are written only in a high-level language. The main idea is to treat a program as a piece of literature, addressed to human beings rather than to a computer.(Donald Knuth)'>Literate Programming</a> with Quarto. This has the consequence that in addition to short comments inside code cells I have the possibility to write extensively in the other parts of the file about approach, code, results etc.</p>
<p>A practical advice for scripts is to include a <a class='glossary' title='A set of comments at the top of a code file that provides information about what is in the file (SwR, Glossary)'>prolog</a>. Possible prolog sections:</p>
<ul>
<li>Project name</li>
<li>Project purpose</li>
<li>Name(s) of data set(s) used in the project</li>
<li>Location(s) of data set(s) used in the project</li>
<li>Code author name (you!)</li>
<li>Date code created</li>
<li>Date last time code was edited</li>
</ul>
<p>Most of these information are naturally occurring in the writing process of Quarto books.</p>
<div class="my-resource">
<div class="my-resource-header">
<p>Literate Statistical Programming</p>
</div>
<div class="my-resource-container">
<ul>
<li>Literate Programming: (<a href="https://en.wikipedia.org/wiki/Literate_programming">Wikipedia</a>)</li>
<li>Introduction to Literate Programming with Quarto (<a href="https://gesiscss.github.io/quarto-workshop/material/slides/01_introduction.html#/title-slide">Online Slides</a>)</li>
<li>Reproducibility and literate programming in R (<a href="https://exeter-data-analytics.github.io/LitProg/index.html">bookdown course</a>)</li>
<li>Introduction to Data Science in R for Biologists (Module on <a href="https://mbutler808.github.io/rclass/posts/2023-01-26-intro-quarto/index.html">Literate Statistical Programming and Quarto</a>)</li>
<li>Let’s build a blog with Quarto <a href="https://ivelasq.quarto.pub/building-a-blog-with-quarto/workflow/write-docs/">Literate programming in Quarto</a>) by Isabella Velásquez. The site has other material (for Quarto blogs) as well: <a href="https://ivelasq.quarto.pub/building-a-blog-with-quarto/learn-more/migrate-blog/">Migrate from R Markdown</a>, <a href="https://ivelasq.quarto.pub/building-a-blog-with-quarto/learn-more/resources/">Additional resources</a></li>
<li>Introduction to literate programming with Quarto and Markdown by Gesis (<a href="https://gesiscss.github.io/quarto-workshop/material/slides/01_introduction.html#/title-slide">Slides</a>)</li>
</ul>
</div>
</div>
</section>
<section id="naming-objects" class="level3" data-number="1.2.2">
<h3 data-number="1.2.2"><span class="header-section-number">1.2.2</span> Naming objects</h3>
<p>I am used to apply the <a href="https://style.tidyverse.org/">tidyverse style guide</a>. It requires to use underlines (“snake_code”) as separators in object names. (In contrast to “camelCase” code style). But reading the book I thought it might be a good idea to use special additional styles for certain specific objects.</p>
<ul>
<li><strong>Naming constants</strong>: Prefix name of constants with <code>k_</code>.</li>
<li><strong>Naming variables</strong>: Standard snake code.</li>
<li><strong>Naming functions</strong>: Prefix name of private functions with a dot <code>.</code>. I had already experienced that didn’t know from which package a function was. Only to learn after looking around for minutes that it was a function I wrote myself!</li>
<li><strong>Naming data frames</strong>: Prefix name with <code>df_</code> for data.frame and <code>dt_</code> for tibble. I might also use a suffix to refer to the status e.g., <code>_raw</code> (raw data), <code>_clean</code> (cleaned data), <code>_v2</code> (version number).</li>
<li><strong>Naming files</strong>: It could be helpful to add at the start the chapter number e.g. <code>chap02_</code>. And maybe also — as in naming data frames — the status as suffix.</li>
</ul>
</section>
</section>
<section id="sec-chap01-import-data" class="level2" data-number="1.3">
<h2 data-number="1.3"><span class="header-section-number">1.3</span> Import data frames from outside resources</h2>
<p>R has many possibilities to import data from other statistical packages.</p>
<section id="some-common-file-extensions" class="level3" data-number="1.3.1">
<h3 data-number="1.3.1"><span class="header-section-number">1.3.1</span> Some common file extensions</h3>
<ul>
<li><strong>.csv</strong>: comma separated values</li>
<li><strong>.txt</strong>: text file</li>
<li><strong>.xls or .xlsx</strong>: Excel file</li>
<li><strong>.sav</strong>: SPSS file</li>
<li><strong>.sasb7dat</strong>: SAS file</li>
<li><strong>.xpt</strong>: SAS transfer file</li>
<li><strong>.dta</strong>: Stata file</li>
</ul>
</section>
<section id="some-packages-for-import-data-sources" class="level3" data-number="1.3.2">
<h3 data-number="1.3.2"><span class="header-section-number">1.3.2</span> Some packages for import data sources</h3>
<ul>
<li>{<strong>readr</strong>}: Read Rectangular Text Data (see: <a href="#pak-readr" class="quarto-xref">Package Profile <span class="quarto-unresolved-ref">pak-readr</span></a>), it is part of {<strong>tidyverse</strong>}</li>
<li>{<strong>vroom</strong>}: Read and Write Rectangular Text Data Quickly</li>
<li>{<strong>haven</strong>}: Import and Export ‘SPSS’, ‘Stata’ and ‘SAS’ Files (see: <a href="#pak-haven" class="quarto-xref">Package Profile <span class="quarto-unresolved-ref">pak-haven</span></a>)</li>
<li>{<strong>foreign</strong>}: Read Data Stored by ‘Minitab’, ‘S’, ‘SAS’, ‘SPSS’, ‘Stata’, ‘Systat’, ‘Weka’, ‘dBase’, …</li>
<li>{<strong>readxl</strong>}: Read Excel Files</li>
<li>{<strong>openxslx</strong>}: Read, Write and Edit xslx Files</li>
<li>{<strong>readODS</strong>}: Read and Write ODS Files (e.g. LibreOffice)</li>
<li>{<strong>clipr</strong>}: Read and Write from the System Clipboard</li>
</ul>
<p>I will not go into the import details of all the different packages here, because my focus is on the <a class='glossary' title='A large survey of a sample of people in the United States conducted regularly since 1972; the General Social Survey is abbreviated GSS and is conducted by the National Opinion Research Center at the University of Chicago. (Harris, Glossary)'>General Social Survey</a> (GSS) data.</p>
</section>
<section id="import-data-with-a-.csv-file" class="level3" data-number="1.3.3">
<h3 data-number="1.3.3"><span class="header-section-number">1.3.3</span> Import data with a .csv file</h3>
<blockquote>
<p>“While the GSS data can be read into R directly from the GSS website, Kiara had experienced this and knew that it could be frustrating.” (<a href="zotero://select/groups/5254842/items/9N29QMJB">Harris, 2020</a>) (<a href="zotero://open-pdf/groups/5254842/items/3NDRGBBW?page=107&amp;annotation=SFD9FHQD">pdf</a>)</p>
</blockquote>
<p>The author therefore offers for this chapter a <a class='glossary' title='Text files where the values are separated with commas (Comma Separated Values = CSV). These files have the file extension .csv'>.csv</a> file with the data. In later chapters learner can choose to use the provided files from the <a href="https://edge.sagepub.com/harris1e/student-resources/datasets-and-r-code">SAGE webpage</a>. Even if these data files are not yet cleaned, it is a kind of cheating, because it bypasses downloading data from the original source.</p>
<div class="my-example">
<div class="my-example-header">
<div id="exm-chap01-read-csv-show-data" class="theorem example">
<p><span class="theorem-title"><strong>Example 1.1</strong></span> : Read data from a .csv file into R</p>
</div>
</div>
<div class="my-example-container">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">summary()</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">glance_data()</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">glance_data</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-code-name-a" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.1</strong></span> : Read .csv file and show data summary</p>
</div>
</div>
<div class="my-r-code-container">
<div id="lst-chap01-read-csv-show-summary" class="listing quarto-float">
<figure class="quarto-float quarto-float-lst">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-chap01-read-csv-show-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing 1.1: Read the provided dataset as a .csv file into R and show <code>base::summary()</code>
</figcaption>
<div aria-describedby="lst-chap01-read-csv-show-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb1"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>gss_2016_book <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">file =</span> <span class="st">&quot;data-harris/legal_weed_age_GSS2016_ch1.csv&quot;</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gss_2016_book)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;     grass               age           
#&gt;  Length:2867        Length:2867       
#&gt;  Class :character   Class :character  
#&gt;  Mode  :character   Mode  :character</code></pre>
</div>
</div>
</div>
</figure>
</div>
<hr />
<p><strong>Some comments</strong></p>
<ol type="1">
<li>In contrast to <code>base::read.csv()</code> in the book I used with <code>readr::read_csv()</code> a function from the {<strong>tidyverse</strong>} package collection.</li>
<li>I added the <code>show_col_types = FALSE</code> argument to prevent a message about the column specification.</li>
</ol>
</div>
</div>
<p>The output of <code>base::summary</code> is in this case not very informative. Looking around for appropriate reporting function I developed with <code>glance_data()</code> my private command. (See <a href="#lst-chap01-read-csv-glance-data" class="quarto-xref">Listing <span class="quarto-unresolved-ref">lst-chap01-read-csv-glance-data</span></a> in next tab.)</p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-code-name-b" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.2</strong></span> Look at data with my private function <code>glance_data()</code></p>
</div>
</div>
<div class="my-r-code-container">
<div id="lst-chap01-read-csv-glance-data" class="listing quarto-float">
<figure class="quarto-float quarto-float-lst">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-chap01-read-csv-glance-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing 1.2: Display 8 randomly chosen rows in addition to the first and last row
</figcaption>
<div aria-describedby="lst-chap01-read-csv-glance-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb3"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>gss_2016_book <span class="sc">|&gt;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(age, grass)) <span class="sc">|&gt;</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glance_data</span>(<span class="at">N =</span> <span class="dv">8</span>, <span class="at">seed =</span> <span class="dv">2016</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 10 × 3
#&gt;      obs age   grass    
#&gt;    &lt;int&gt; &lt;chr&gt; &lt;chr&gt;    
#&gt;  1     1 47    IAP      
#&gt;  2   172 27    LEGAL    
#&gt;  3   562 70    NOT LEGAL
#&gt;  4   898 60    NOT LEGAL
#&gt;  5  1019 30    LEGAL    
#&gt;  6  1176 80    NOT LEGAL
#&gt;  7  1505 53    IAP      
#&gt;  8  1911 54    NOT LEGAL
#&gt;  9  2622 62    IAP      
#&gt; 10  2867 72    NOT LEGAL</code></pre>
</div>
</div>
</div>
</figure>
</div>
</div>
</div>
<p>I developed a private function <code>glance_data()</code> to provide a first impression about the data. The function prints the first and last row of the dataset, so you know implicitly how many rows the dataset has. Between the first and last row the function adds randomly <code>N</code> other rows (default is 8). Additionally it provides the row number of the data in a separate column. (The column header <code>obs</code> stands for “observation”.) For reproducibility purposes you can also add a number for the <code>set.seed()</code> command.</p>
<p>The idea of <code>glance_data()</code> is to get a first impression of the dataset. Other printing methods show only the first (or last) rows of the dataset. This could be misleading, giving a wrong impression about typical data.</p>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p>Maybe you are interested to use <code>glance_data()</code> yourself? It isn’t available through a package, but you can copy the source code from the next R chunk.</p>
<p>I have saved the function in a <code>.qmd</code> file one level higher as this book (and all my other R projects). With <code></code> I have the code integrated in this book. (For the <code>include</code> shortcode see the section <a href="https://quarto.org/docs/authoring/includes.html">Includes</a> of the Quarto documentation.)</p>
<div id="lst-chap01-show-function-glance-data" class="listing quarto-float">
<figure class="quarto-float quarto-float-lst">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-chap01-show-function-glance-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing 1.3: Code of my private function <code>glance_date()</code>
</figcaption>
<div aria-describedby="lst-chap01-show-function-glance-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<details open class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb5"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">### function glance_data ##############</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>glance_data <span class="ot">&lt;-</span> <span class="cf">function</span>(df, <span class="at">N =</span> <span class="dv">8</span>, <span class="at">seed =</span> <span class="dv">42</span>){</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    df_temp <span class="ot">&lt;-</span> <span class="fu">first_and_last_row</span>(df)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set.seed</span>(seed)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    df <span class="sc">|&gt;</span> </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">obs =</span> dplyr<span class="sc">::</span><span class="fu">row_number</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">relocate</span>(obs) <span class="sc">|&gt;</span> </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">slice_sample</span>(<span class="at">n =</span> N) <span class="sc">|&gt;</span> </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(df_temp) <span class="sc">|&gt;</span> </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">arrange</span>(obs)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>first_and_last_row <span class="ot">&lt;-</span>  <span class="cf">function</span>(df) {</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    df <span class="sc">|&gt;</span> </span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">obs =</span> dplyr<span class="sc">::</span><span class="fu">row_number</span>()) <span class="sc">|&gt;</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(dplyr<span class="sc">::</span><span class="fu">row_number</span>() <span class="sc">%in%</span> base<span class="sc">::</span><span class="fu">c</span>(<span class="dv">1</span>, dplyr<span class="sc">::</span><span class="fu">n</span>()))</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</details>
</div>
</div>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<hr />
</section>
</section>
<section id="sec-chap01-data-wrangling" class="level2" data-number="1.4">
<h2 data-number="1.4"><span class="header-section-number">1.4</span> Data Wrangling</h2>
<section id="todo-list" class="level3" data-number="1.4.1">
<h3 data-number="1.4.1"><span class="header-section-number">1.4.1</span> ToDo List</h3>
<p>After we saved the data we need to do some data wrangling. To replicate the data structure for the book Figure 1.2 we need to:</p>
<ul>
<li>filter the dataset to the year 2016 (in the case you work with the full GSS dataset 1972-2022, which we won’t)</li>
<li>select only the variables <code>age</code> and <code>grass</code> to work with</li>
<li>drop all NA’s</li>
<li>convert <code>grass</code> into factor</li>
<li>recode <code>grass</code> labels</li>
<li>convert <code>age</code> from double to numeric</li>
<li>divide <code>age</code> into appropriate age intervals and label them accordingly</li>
</ul>
<hr />
<div id="fig-chap01-bar-charts" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-chap01-bar-charts-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-chap01-bar-charts" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-01-01" class="quarto-figure quarto-figure-center quarto-float">
<figure class="quarto-float quarto-subfloat-fig">
<div aria-describedby="fig-01-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="img/chap01/fig-01-01-min.png" class="lightbox" data-glightbox="description: .lightbox-desc-1" data-gallery="fig-chap01-bar-charts"><img src="img/chap01/fig-01-01-min.png" class="img-fluid" data-ref-parent="fig-chap01-bar-charts" /></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-01-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Support for marijuana legalization among participants in the 2016 General Social Survey (Figure 1.1)
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-chap01-bar-charts" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-01-02" class="quarto-figure quarto-figure-center quarto-float">
<figure class="quarto-float quarto-subfloat-fig">
<div aria-describedby="fig-01-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="img/chap01/fig-01-02-min.png" class="lightbox" data-glightbox="description: .lightbox-desc-2" data-gallery="fig-chap01-bar-charts"><img src="img/chap01/fig-01-02-min.png" class="img-fluid" data-ref-parent="fig-chap01-bar-charts" /></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-01-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Support for marijuana legalization by age group among participants in the 2016 General Social Survey (Figure 1.2)
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-chap01-bar-charts-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Graph 1.1: We will replicate these two bar charts (Figure 1.1 and Figure 1.2 in the book)
</figcaption>
</figure>
</div>
<hr />
</section>
<section id="replicating-data-structure-for-bar-charts" class="level3" data-number="1.4.2">
<h3 data-number="1.4.2"><span class="header-section-number">1.4.2</span> Replicating data structure for bar charts</h3>
<div class="my-example">
<div class="my-example-header">
<div id="exm-chap01-repl-data-bar-charts" class="theorem example">
<p><span class="theorem-title"><strong>Example 1.2</strong></span> : Replicate data structure for bar charts</p>
</div>
</div>
<div class="my-example-container">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-repl-data-fig-book" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.3</strong></span> : Replicate data structure for Figures 1.1 and 1.2 (Book)</p>
</div>
</div>
<div class="my-r-code-container">
<div id="lst-repl-data-fig-book" class="listing quarto-float">
<figure class="quarto-float quarto-float-lst">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-repl-data-fig-book-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing 1.4: Replicate data structure for Figures 1.1 and 1.2 f the book)
</figcaption>
<div aria-describedby="lst-repl-data-fig-book-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb6"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>chap01_gss_2016 <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">file =</span> <span class="st">&quot;data-harris/legal_weed_age_GSS2016_ch1.csv&quot;</span>,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>chap01_gss_2016_clean <span class="ot">&lt;-</span> chap01_gss_2016 <span class="sc">|&gt;</span> </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="do">#### (A) rework grass ##################</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="do">## convert grass to factor</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">grass =</span> forcats<span class="sc">::</span><span class="fu">as_factor</span>(grass))  <span class="sc">|&gt;</span> </span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="do">## change DK and IAP to NA</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">grass =</span> dplyr<span class="sc">::</span><span class="fu">na_if</span>(<span class="at">x =</span> grass, <span class="at">y =</span> <span class="st">&quot;DK&quot;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">grass =</span> dplyr<span class="sc">::</span><span class="fu">na_if</span>(<span class="at">x =</span> grass, <span class="at">y =</span> <span class="st">&quot;IAP&quot;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="do">## drop unused levels &quot;DK&quot; and &quot;IAP&quot;</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">grass =</span> forcats<span class="sc">::</span><span class="fu">fct_drop</span>(grass)) <span class="sc">|&gt;</span> </span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="do">## convert to factor and recode it</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">grass =</span> forcats<span class="sc">::</span><span class="fu">fct_recode</span>(</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>      grass, <span class="st">&quot;Yes&quot;</span> <span class="ot">=</span> <span class="st">&quot;LEGAL&quot;</span>, <span class="st">&quot;No&quot;</span> <span class="ot">=</span> <span class="st">&quot;NOT LEGAL&quot;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="do">#### (B) rework age #########################</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="do">## change data types and recode</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="do">## turn character type of age into factor and recode &quot;89 OR OLDER&quot; to &quot;89&quot;</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># dplyr::mutate(age = dplyr::recode(age, &quot;89 OR OLDER&quot; = &quot;89&quot;)) |&gt; </span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">age =</span> dplyr<span class="sc">::</span><span class="fu">case_match</span>(age, </span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;89 OR OLDER&quot;</span> <span class="sc">~</span> <span class="st">&quot;89&quot;</span>,</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">.default =</span> age)) <span class="sc">|&gt;</span> </span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a><span class="do">## convert data type of age from factor to numeric</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">age =</span> base<span class="sc">::</span><span class="fu">as.numeric</span>(age)) <span class="sc">|&gt;</span> </span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a><span class="do">## cut age into several defined age groups</span></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">age_cat =</span> base<span class="sc">::</span><span class="fu">cut</span>(age, </span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>                       <span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="dv">29</span>, <span class="dv">59</span>, <span class="dv">74</span>, <span class="cn">Inf</span>),</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;&lt; 30&quot;</span>, <span class="st">&quot;30 - 59&quot;</span>, <span class="st">&quot;60 - 74&quot;</span>, <span class="st">&quot;75+&quot;</span> ))) <span class="sc">|&gt;</span>  </span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a><span class="do">## drop NA&#39;s</span></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">drop_na</span>()</span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a><span class="do">## save cleaned data gss_2016</span></span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(chap01_gss_2016_clean, <span class="st">&quot;data-clean/chap01_gss_2016_clean.rds&quot;</span>)</span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a><span class="do">## (C) check result #########</span></span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a><span class="do">## summarize</span></span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;************************   SUMMARY   ****************************&quot;</span>)</span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">summary</span>(chap01_gss_2016_clean)</span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a><span class="do">## glance at the data</span></span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;*******************   GLANCE AT SOME DATA  **********************&quot;</span>)</span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>chap01_gss_2016_clean <span class="sc">|&gt;</span></span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(age_cat, grass)) <span class="sc">|&gt;</span> </span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glance_data</span>(<span class="at">N =</span> <span class="dv">8</span>, <span class="at">seed =</span> <span class="dv">2016</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] &quot;************************   SUMMARY   ****************************&quot;
#&gt;  grass           age           age_cat   
#&gt;  Yes:1123   Min.   :18.00   &lt; 30   :332  
#&gt;  No : 713   1st Qu.:33.00   30 - 59:989  
#&gt;             Median :48.00   60 - 74:364  
#&gt;             Mean   :48.26   75+    :151  
#&gt;             3rd Qu.:61.00                
#&gt;             Max.   :89.00                
#&gt; [1] &quot;*******************   GLANCE AT SOME DATA  **********************&quot;
#&gt; # A tibble: 10 × 3
#&gt;      obs age_cat grass
#&gt;    &lt;int&gt; &lt;fct&gt;   &lt;fct&gt;
#&gt;  1     1 60 - 74 Yes  
#&gt;  2   172 30 - 59 No   
#&gt;  3   562 75+     No   
#&gt;  4   574 30 - 59 Yes  
#&gt;  5  1019 30 - 59 No   
#&gt;  6  1176 30 - 59 Yes  
#&gt;  7  1500 &lt; 30    Yes  
#&gt;  8  1568 75+     No   
#&gt;  9  1803 75+     Yes  
#&gt; 10  1836 60 - 74 No</code></pre>
</div>
</div>
</div>
</figure>
</div>
<hr />
<p>The somewhat strange cut decision for age groups was motivated by the question if there is a difference between young and old voters about marijuana legalization.</p>
<p>Compare the result of the recoding with the original data structure in <a href="#lst-chap01-read-csv-show-summary" class="quarto-xref">Listing <span class="quarto-unresolved-ref">lst-chap01-read-csv-show-summary</span></a>.</p>
</div>
</div>
<p><strong>Some comments</strong></p>
<ol type="1">
<li>I have included all data wrangling changes for the Figure 1.1 even if they appeared in the book section where the graph is prepared.</li>
<li>I have used <code>|&gt;</code> form the native R pipe instead of <code>%&gt;%</code> exported into tidyverse from the {<strong>magrittr</strong>} package.</li>
<li>Otherwise whenever possible I have used {<strong>tidyverse</strong>} code. For <code>base::as.numeric()</code> and <code>base::cut()</code> I couldn’t find {<strong>tidyverse</strong>} equivalents.</li>
</ol>
<div class="my-watch-out">
<div class="my-watch-out-header">
<p>WATCH OUT! Difference between <code>forcats::fct_recode()</code> and <code>dplyr::recode()</code>. Use <code>dplyr::case_match()</code>!</p>
</div>
<div class="my-watch-out-container">
<p>To recode <code>age</code> from “89 OR OLDER” to “89” I used at first <code>forcats::fct_recode()</code>. But this function changes the 72 <em>levels</em> of the factor <code>age</code> and resulted — after I changed <code>age</code> to numeric in the next line — in a data frame where <code>age</code> ranged from 1 to 72!</p>
<p>After I noticed the problem and wanted to replace the {<strong>forcats</strong>}-line with <code>dplyr::mutate(age = dplyr::recode(age, "89 OR OLDER" = "89"))</code> I saw in the help file that</p>
<blockquote>
<p><code>recode()</code> is superseded in favor of <code>case_match()</code>, which handles the most important cases of <code>recode()</code> with a more elegant interface. (<a href="https://dplyr.tidyverse.org/reference/recode.html">Recode values</a>) and</p>
</blockquote>
<blockquote>
<p>[<code>dplyr::case_match()</code>] allows you to vectorise multiple switch() statements. Each case is evaluated sequentially and the first match for each element determines the corresponding value in the output vector. If no cases match, the .default is used. (<a href="https://dplyr.tidyverse.org/reference/case_match.html">A general verctorized switch()</a>)</p>
</blockquote>
</div>
</div>
<p><a href="#lst-repl-data-fig-book" class="quarto-xref">Listing <span class="quarto-unresolved-ref">lst-repl-data-fig-book</span></a> used some important packages:</p>
<p>I used {<strong>dplyr</strong>} in the above code heavily (see: <a href="#pak-dplyr" class="quarto-xref">Package Profile <span class="quarto-unresolved-ref">pak-dplyr</span></a>). {<strong>dplyr</strong>} is part of the {<strong>tidyverse</strong>} core collection (see: <a href="#pak-tidyverse" class="quarto-xref">Package Profile <span class="quarto-unresolved-ref">pak-tidyverse</span></a>), together with {<strong>forcats</strong>} (see: <a href="#pak-forcats" class="quarto-xref">Package Profile <span class="quarto-unresolved-ref">pak-forcats</span></a>), {<strong>ggplot2</strong>} (see <a href="#pak-ggplot2" class="quarto-xref">Package Profile <span class="quarto-unresolved-ref">pak-ggplot2</span></a>), {<strong>readr</strong>} (see: <a href="#pak-ggplot2" class="quarto-xref">Package Profile <span class="quarto-unresolved-ref">pak-ggplot2</span></a>), {<strong>tibble</strong>} (see: <a href="#pak-tibble" class="quarto-xref">Package Profile <span class="quarto-unresolved-ref">pak-tibble</span></a>), {<strong>tidyr</strong>} (see: <a href="#pak-tidyr" class="quarto-xref">Package Profile <span class="quarto-unresolved-ref">pak-tidyr</span></a>), {<strong>string</strong>} and {<strong>purrr</strong>}.</p>
<p>The last two packages ({<strong>string</strong>} and {<strong>purrr</strong>}) I will profile when I use them the first time.</p>
</div>
</div>
</section>
</section>
<section id="sec-chap01-repr-bar-charts" class="level2" data-number="1.5">
<h2 data-number="1.5"><span class="header-section-number">1.5</span> Reproducing bar charts</h2>
<div class="my-example">
<div class="my-example-header">
<div id="exm-chap01-repr-bar-charts" class="theorem example">
<p><span class="theorem-title"><strong>Example 1.3</strong></span> : Reproducing bar charts</p>
</div>
</div>
<div class="my-example-container">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Figure 1.1</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Figure 1.2</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-fig-chap01-repr-fig-1-1" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.4</strong></span> a: Reproducing bar chart Figure 1.1 using <code>geom_bar()</code></p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb8"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>chap01_gss_2016_clean <span class="ot">&lt;-</span>  <span class="fu">readRDS</span>(<span class="st">&quot;data-clean/chap01_gss_2016_clean.rds&quot;</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="do">## create figure 1.1 #######</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>chap01_gss_2016_clean <span class="sc">|&gt;</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> grass,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> <span class="dv">100</span> <span class="sc">*</span> ggplot2<span class="sc">::</span><span class="fu">after_stat</span>(count) <span class="sc">/</span> </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>                 base<span class="sc">::</span><span class="fu">sum</span>(ggplot2<span class="sc">::</span><span class="fu">after_stat</span>(count)),</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> grass)) <span class="sc">+</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#79a778&quot;</span>, <span class="st">&#39;#7662aa&#39;</span>),</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Should marijuana be legal?&quot;</span>,</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Percent of responses&quot;</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-chap01-repr-fig-1-1" class="quarto-figure quarto-figure-center quarto-float">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-chap01-repr-fig-1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="01-preparing-data_files/figure-html/fig-chap01-repr-fig-1-1-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-3" data-gallery="quarto-lightbox-gallery-3"><img src="01-preparing-data_files/figure-html/fig-chap01-repr-fig-1-1-1.png" class="img-fluid" width="384" /></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-chap01-repr-fig-1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Graph 1.2: Support for marijuana legalization among participants in the 2016 General Social Survey (Figure 1.1)
</figcaption>
</figure>
</div>
</div>
</div>
<hr />
<p>I changed the code slightly because of two warnings. Newer versions of {<strong>ggplot2</strong>} have deprecated some older functions:</p>
<ul>
<li>Warning: The dot-dot notation (<code>..count..</code>) was deprecated in {<strong>ggplot2</strong>} version 3.4.0. Please use <code>after_stat(count)</code> instead.</li>
<li>Warning: The <code>guide</code> argument in <code>scale_*()</code> cannot be <code>FALSE</code>. This was deprecated in {<strong>ggplot2</strong>} version 3.3.4. Please use “none” instead. (I have slightly edited both warnings)</li>
</ul>
</div>
</div>
<p>Compare the reproduction with the original <a href="#fig-01-01" class="quarto-xref">Graph <span class="quarto-unresolved-ref">fig-01-01</span></a>.</p>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-fig-chap01-repr-fig-1-2" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.5</strong></span> b: Reproducing bar chart Figure 1.2 using <code>geom_col()</code></p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb9"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>chap01_gss_2016_clean <span class="ot">&lt;-</span>  <span class="fu">readRDS</span>(<span class="st">&quot;data-clean/chap01_gss_2016_clean.rds&quot;</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="do">## create figure 1.2 ########</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>chap01_gss_2016_clean <span class="sc">|&gt;</span> </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(grass, age_cat) <span class="sc">|&gt;</span> </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">count</span>() <span class="sc">|&gt;</span> </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(age_cat) <span class="sc">|&gt;</span> </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">perc_grass =</span> <span class="dv">100</span> <span class="sc">*</span> n <span class="sc">/</span> base<span class="sc">::</span><span class="fu">sum</span>(n)) <span class="sc">|&gt;</span> </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> age_cat, <span class="at">fill =</span> grass,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> perc_grass)) <span class="sc">+</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">&#39;dodge&#39;</span>) <span class="sc">+</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;#79a778&#39;</span>, <span class="st">&#39;#7662aa&#39;</span>),</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">name =</span> <span class="st">&quot;Should marijuana</span><span class="sc">\n</span><span class="st">be legal?&quot;</span>) <span class="sc">+</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Age group (in years)&quot;</span>,</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Percent of responses in age group&quot;</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-chap01-repr-fig-1-2" class="quarto-figure quarto-figure-center quarto-float">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-chap01-repr-fig-1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="01-preparing-data_files/figure-html/fig-chap01-repr-fig-1-2-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-4" data-gallery="quarto-lightbox-gallery-4"><img src="01-preparing-data_files/figure-html/fig-chap01-repr-fig-1-2-1.png" class="img-fluid" width="672" /></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-chap01-repr-fig-1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Graph 1.3: Support for marijuana legalization by age group among participants in the 2016 General Social Survey (Figure 1.2)
</figcaption>
</figure>
</div>
</div>
</div>
<hr />
<p><a href="#fig-chap01-repr-fig-1-1" class="quarto-xref">Graph <span class="quarto-unresolved-ref">fig-chap01-repr-fig-1-1</span></a> uses <code>ggplot2::geom_bar()</code> whereas this figure here calls the <code>ggplot2::geom_col()</code> function.</p>
<blockquote>
<p>There are two types of bar charts: <code>geom_bar()</code> and <code>geom_col()</code>. <code>geom_bar()</code> makes the height of the bar proportional to the number of cases in each group … . If you want the heights of the bars to represent values in the data, use <code>geom_col()</code> instead. <code>geom_bar()</code> uses <code>stat_count()</code> by default: it counts the number of cases at each x position. <code>geom_col()</code> uses <code>stat_identity()</code>: it leaves the data as is. (<a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">Bar charts</a> with {<strong>ggplot2</strong>})</p>
</blockquote>
</div>
</div>
<p>Compare the reproduction with the original <a href="#fig-01-02" class="quarto-xref">Graph <span class="quarto-unresolved-ref">fig-01-02</span></a>.</p>
</div>
</div>
</div>
</div>
</div>
<hr />
</section>
<section id="exercises" class="level2" data-number="1.6">
<h2 data-number="1.6"><span class="header-section-number">1.6</span> Exercises</h2>
<div class="my-objectives">
<div class="my-objectives-header">
<p>Exercises for the Coder &amp; Hacker edition</p>
</div>
<div class="my-objectives-container">
<p><strong>SwR objectives</strong></p>
<ol type="1">
<li>Visit the NHANES website and find the online codebook for the 2013–2014 data (<a href="#sec-visit-nhanes-website" class="quarto-xref"><span class="quarto-unresolved-ref">sec-visit-nhanes-website</span></a>)</li>
<li>Open the 2013–2014 NHANES data file saved as <code>nhanes_2013_ch1.csv</code> with the book materials at <a href="https://edge.sagepub.com/harris1e">edge.sagepub.com/harris1e</a> (Achievement 1) (<a href="#sec-chap01-import-clean-data" class="quarto-xref"><span class="quarto-unresolved-ref">sec-chap01-import-clean-data</span></a> in tab “read_csv()”)</li>
<li>Examine the data types for DUQ200, RIDAGEYR, and RIAGENDR, and fix data types if needed based on the NHANES codebook (Achievements 2 and 3) (<a href="#sec-chap01-import-clean-data" class="quarto-xref"><span class="quarto-unresolved-ref">sec-chap01-import-clean-data</span></a> in tab “View data” and tab “Codebook”)</li>
<li>Based on the online NHANES codebook, code missing values appropriately for DUQ200, RIDAGEYR, and RIAGENDR (Achievement 4) (<a href="#sec-chap01-import-clean-data" class="quarto-xref"><span class="quarto-unresolved-ref">sec-chap01-import-clean-data</span></a> in tab “Data cleaning”)</li>
<li>Create a bar chart showing the percentage of NHANES participants answering yes and no to marijuana use (Achievement 5) (<a href="#sec-chap01-bar-chart-grass" class="quarto-xref"><span class="quarto-unresolved-ref">sec-chap01-bar-chart-grass</span></a> in tab “Solution”)</li>
<li>Recode age into a new variable called <code>age_cat</code> with 4 categories: 18–29, 30–39, 40–49, 50–59 (Achievement 7) (<a href="#sec-chap01-grass-age-sex" class="quarto-xref"><span class="quarto-unresolved-ref">sec-chap01-grass-age-sex</span></a> in tab “Numbers”)</li>
<li>Create a bar chart of marijuana use by age group (Achievement 6) (<a href="#sec-chap01-grass-age-sex" class="quarto-xref"><span class="quarto-unresolved-ref">sec-chap01-grass-age-sex</span></a> in tab “Age”)</li>
<li><del>Add a prolog and comments to your code (Achievement 1)</del> (I am using <a class='glossary' title='Literate programming is a methodology that combines a programming language with a documentation language, thereby making programs more robust, more portable, more easily maintained, and arguably more fun to write than programs that are written only in a high-level language. The main idea is to treat a program as a piece of literature, addressed to human beings rather than to a computer.(Donald Knuth)'>literate programming</a> in writing this book.)</li>
<li>Create a bar chart of marijuana use by age group and sex with side-by-side bars (Achievement 5) (<a href="#sec-chap01-grass-age-sex" class="quarto-xref"><span class="quarto-unresolved-ref">sec-chap01-grass-age-sex</span></a> in tab “Age and sex”)</li>
<li>Following the R code in your code file, use comments to describe what you found. Given what you found and the information in the chapter, what do you predict will happen with marijuana legalization in the next 10 years? Discuss how the omission of older people from the marijuana use question for NHANES influenced your prediction. Write your prediction and discussion in comments at the end of your code file (<a href="#sec-chap01-data-interpretation" class="quarto-xref"><span class="quarto-unresolved-ref">sec-chap01-data-interpretation</span></a>).</li>
</ol>
<p><strong>My own additional exercises</strong></p>
<ol start="11" type="1">
<li>Download and work with SAS .xpt file data (Demo) {<a href="#sec-download-xpt-file" class="quarto-xref"><span class="quarto-unresolved-ref">sec-download-xpt-file</span></a>}</li>
<li>Show table of frequencies and percentages (<a href="#sec-chap01-bar-chart-grass" class="quarto-xref"><span class="quarto-unresolved-ref">sec-chap01-bar-chart-grass</span></a> in Tab “Numbers”)</li>
<li>Make bars thinner (<a href="#sec-chap01-bar-chart-grass" class="quarto-xref"><span class="quarto-unresolved-ref">sec-chap01-bar-chart-grass</span></a> in Tab “Thin bars”)</li>
<li>Make bars thinner and adjust spacing accordingly (<a href="#sec-chap01-bar-chart-grass" class="quarto-xref"><span class="quarto-unresolved-ref">sec-chap01-bar-chart-grass</span></a> in Tab “Solution”)</li>
</ol>
</div>
</div>
<section id="sec-visit-nhanes-website" class="level3" data-number="1.6.1">
<h3 data-number="1.6.1"><span class="header-section-number">1.6.1</span> Visiting the NHANES website</h3>
<p>Use the National Health and Nutrition Examination Survey (<a class='glossary' title='The National Health and Nutrition Examination Survey (NHANES) is a program of studies designed to assess the health and nutritional status of adults and children in the United States. The survey is unique in that it combines interviews and physical examinations. (NHANES)'>NHANES</a>) data to examine marijuana use in the United States. Spend a few minutes looking through the NHANES website (<a href="https://www.cdc.gov/nchs/nhanes/index.htm">https://www.cdc.gov/nchs/nhanes/index.htm</a>) before you begin, including finding the online codebook for the 2013–2014 data. Complete the following tasks to explore whether age is related to marijuana use in the United States.</p>
<p>The 2013–2014 codebook is on the page <a href="https://wwwn.cdc.gov/nchs/nhanes/continuousnhanes/default.aspx?BeginYear=2013">NHANES 2013-2014</a>. On this page are the links to different types of data, documentations or codebooks.</p>
<p>You can choose from</p>
<div id="bul-NAHNES-data-sections" class="quarto-float">
<figure class="quarto-float quarto-float-bul">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-bul" id="bul-NAHNES-data-sections-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Bullet List 1.1: NHANES has six different data sections
</figcaption>
<div aria-describedby="bul-NAHNES-data-sections-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<ul>
<li>Demographics Data</li>
<li>Dietary Data</li>
<li>Examination Data</li>
<li>Laboratory Data</li>
<li>Questionnaire Data</li>
<li>Limited Access Data</li>
</ul>
</div>
</figure>
</div>
<p>Clicking of one of these links opens a page where a table contains the following information:</p>
<div id="bul-NHANES-data-pages" class="quarto-float">
<figure class="quarto-float quarto-float-bul">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-bul" id="bul-NHANES-data-pages-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Bullet List 1.2: NHANES data pages has download links for documentation and data files
</figcaption>
<div aria-describedby="bul-NHANES-data-pages-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<ul>
<li>Data File Name</li>
<li>Doc File</li>
<li>Data File</li>
<li>Data Published</li>
</ul>
</div>
</figure>
</div>
<p><a href="https://wwwn.cdc.gov/nchs/nhanes/tutorials/Datasets.aspx">Datasets and Documentation</a> and <a href="https://wwwn.cdc.gov/nchs/nhanes/continuousnhanes/faq.aspx">Frequently Asked Questions (FAQs)</a> are important introductory pages.</p>
<p>NHANES data are saved in a <a href="https://www.loc.gov/preservation/digital/formats/fdd/fdd000464.shtml">SAS transport (.XPT) file</a>. These file can be read with <code>foreign::read.xport()</code> and <code>haven::read_xpt()</code>. There is also a <a href="https://wwwn.cdc.gov/nchs/nhanes/tutorials/Datasets.aspx">page with example code</a> to download/import NHANES data files. I will use {<strong>haven</strong>} instead of the recommended {<strong>foreign</strong>} package.</p>
</section>
<section id="sec-download-xpt-file" class="level3" data-number="1.6.2">
<h3 data-number="1.6.2"><span class="header-section-number">1.6.2</span> Download NHANES SAS .xpt file data (Demo)</h3>
<div class="my-experiment">
<div class="my-experiment-header">
<div id="def-chap01-xpt-file-download" class="theorem definition">
<p><span class="theorem-title"><strong>Experiment 1.1</strong></span> : Download and work with NHANES SAS .xpt file data (Demo)</p>
</div>
</div>
<div class="my-experiment-container">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Get .xpt file</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">str()</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">summary()</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false">skim()</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-5" role="tab" aria-controls="tabset-3-5" aria-selected="false">glance_data()</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-save-xpt-file-demo" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.6</strong></span> : Save a SAS transport (.xpt) file from the NHANES site for demo purposes and display the structure of the file</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell">
<div id="lst-chap01-downloadfile" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-chap01-downloadfile-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing 1.5: Download a file and save it as R object
</figcaption>
<div aria-describedby="lst-chap01-downloadfile-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-chap01-downloadfile"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="lst-chap01-downloadfile-1"><a href="#lst-chap01-downloadfile-1" aria-hidden="true" tabindex="-1"></a><span class="do">## download only once (manually)</span></span>
<span id="lst-chap01-downloadfile-2"><a href="#lst-chap01-downloadfile-2" aria-hidden="true" tabindex="-1"></a>utils<span class="sc">::</span><span class="fu">download.file</span>(</span>
<span id="lst-chap01-downloadfile-3"><a href="#lst-chap01-downloadfile-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;https://wwwn.cdc.gov/Nchs/Nhanes/2017-2018/P_BPXO.XPT&quot;</span>,</span>
<span id="lst-chap01-downloadfile-4"><a href="#lst-chap01-downloadfile-4" aria-hidden="true" tabindex="-1"></a>    tf <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">tempfile</span>(),</span>
<span id="lst-chap01-downloadfile-5"><a href="#lst-chap01-downloadfile-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">mode =</span> <span class="st">&quot;wb&quot;</span></span>
<span id="lst-chap01-downloadfile-6"><a href="#lst-chap01-downloadfile-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="lst-chap01-downloadfile-7"><a href="#lst-chap01-downloadfile-7" aria-hidden="true" tabindex="-1"></a>blood_pressure_demo <span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">read_xpt</span>(tf)</span>
<span id="lst-chap01-downloadfile-8"><a href="#lst-chap01-downloadfile-8" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(blood_pressure_demo, <span class="at">file =</span> <span class="st">&quot;data-raw/blood_pressure_demo.rds&quot;</span>)</span></code></pre></div>
</div>
</figure>
</div>
</div>
<p>(<em>This code chunk has no visible output</em>)</p>
<p>With the exception of using (<strong>haven</strong>) instead of {<strong>foreign</strong>}, I followed the instruction from the <a href="https://wwwn.cdc.gov/nchs/data/tutorials/file_download_import_R.R">NHANES recommendation</a>. We see labelled data as it was expected from the import with {<strong>haven</strong>}.</p>
<p>In <a href="#lst-chap01-get-gss2016-automated" class="quarto-xref">Listing <span class="quarto-unresolved-ref">lst-chap01-get-gss2016-automated</span></a> I have already used the <code>utils::download.file()</code> function: There are some differences:</p>
<ul>
<li><a href="#lst-chap01-get-gss2016-automated" class="quarto-xref">Listing <span class="quarto-unresolved-ref">lst-chap01-get-gss2016-automated</span></a> downloaded a STATA <code>.zip</code> file, therefore I used <code>unz()</code> to unzip the file and to read <code>haven::read_dta()</code> instead <code>haven::read_xpt()</code>.</li>
<li>More important however was the <code>base::unlink(temp)</code> command to unlink the temporary file, which is not done here.</li>
<li>Another difference was using the argument <code>mode = "wb"</code> for writing binary files. As I understood this is only important for Windows user. On my Mac I could stick with the default value <code>mode = "w"</code>. But for reproducibility it would be better to use in the future the more general option with <code>mode = "wb"</code>.</li>
</ul>
</div>
</div>
<div class="my-important">
<div class="my-important-header">
<p>{<strong>nhanesA</strong>} package facilitates downloading NHANES data</p>
</div>
<div class="my-important-container">
<p>I just learned that there is a {<strong>nhanesA</strong>} package that facilitates downloading data to R. (2024-01-20) The latest package release is brand-new (2024-01-09).</p>
<p>I am planning to use this package when I am working with again with NHANES data in <a href="#sec-chap03" class="quarto-xref"><span class="quarto-unresolved-ref">sec-chap03</span></a> and <a href="#sec-chap06" class="quarto-xref"><span class="quarto-unresolved-ref">sec-chap06</span></a>. Just for me to remember:</p>
<ul>
<li>The packages is <a href="https://cran.r-project.org/web/packages/nhanesA/index.html">on CRAN</a></li>
<li>There is a <a href="https://github.com/cjendres1/nhanes">GitHub repository</a>.</li>
<li>A very informative <a href="https://cran.r-project.org/web/packages/nhanesA/vignettes/Introducing_nhanesA.html">introductory vignette</a> does not only explain the package but also the structure of the NAHNES data and codebook.</li>
</ul>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-str-blood-pressure-demo" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.7</strong></span> : Show data summary of three blood pressure variables with <code>utils::str()</code> (Demo)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb10"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>blood_pressure_demo <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="st">&quot;data-raw/blood_pressure_demo.rds&quot;</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>blood_pressure_demo <span class="sc">|&gt;</span> </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    utils<span class="sc">::</span><span class="fu">str</span>()</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; tibble [11,656 × 3] (S3: tbl_df/tbl/data.frame)
#&gt;  $ BPAOARM: chr [1:11656] &quot;R&quot; &quot;R&quot; &quot;R&quot; &quot;R&quot; ...
#&gt;   ..- attr(*, &quot;label&quot;)= chr &quot;Arm selected - oscillometric&quot;
#&gt;  $ BPXOSY1: num [1:11656] 109 99 123 102 116 138 104 100 141 NA ...
#&gt;   ..- attr(*, &quot;label&quot;)= chr &quot;Systolic - 1st oscillometric reading&quot;
#&gt;  $ BPXODI1: num [1:11656] 67 56 73 65 68 70 58 64 77 NA ...
#&gt;   ..- attr(*, &quot;label&quot;)= chr &quot;Diastolic - 1st oscillometric reading&quot;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-summary-blood-pressure-demo" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.8</strong></span> : Show data summary of three blood pressure variables with <code>summary()</code> (Demo)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb12"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>blood_pressure_demo <span class="sc">|&gt;</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    base<span class="sc">::</span><span class="fu">summary</span>()</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;    BPAOARM             BPXOSY1        BPXODI1      
#&gt;  Length:11656       Min.   : 52    Min.   : 31.00  
#&gt;  Class :character   1st Qu.:106    1st Qu.: 63.00  
#&gt;  Mode  :character   Median :117    Median : 71.00  
#&gt;                     Mean   :120    Mean   : 72.04  
#&gt;                     3rd Qu.:130    3rd Qu.: 80.00  
#&gt;                     Max.   :225    Max.   :151.00  
#&gt;                     NA&#39;s   :1304   NA&#39;s   :1304</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-skim-blood-pressure-demo" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.9</strong></span> : Show data summary of three blood pressure variables with <code>skim()</code> (Demo)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb14"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>blood_pressure_demo <span class="sc">|&gt;</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    skimr<span class="sc">::</span><span class="fu">skim</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<table>
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">dplyr::select(blood_press…</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">11656</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table>
<colgroup>
<col style="width: 19%" />
<col style="width: 13%" />
<col style="width: 19%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 8%" />
<col style="width: 12%" />
<col style="width: 15%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">BPAOARM</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2152</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<colgroup>
<col style="width: 18%" />
<col style="width: 12%" />
<col style="width: 18%" />
<col style="width: 9%" />
<col style="width: 7%" />
<col style="width: 3%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 6%" />
<col style="width: 7%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">BPXOSY1</td>
<td style="text-align: right;">1304</td>
<td style="text-align: right;">0.89</td>
<td style="text-align: right;">120.00</td>
<td style="text-align: right;">19.95</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">106</td>
<td style="text-align: right;">117</td>
<td style="text-align: right;">130</td>
<td style="text-align: right;">225</td>
<td style="text-align: left;">▁▇▅▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">BPXODI1</td>
<td style="text-align: right;">1304</td>
<td style="text-align: right;">0.89</td>
<td style="text-align: right;">72.04</td>
<td style="text-align: right;">12.42</td>
<td style="text-align: right;">31</td>
<td style="text-align: right;">63</td>
<td style="text-align: right;">71</td>
<td style="text-align: right;">80</td>
<td style="text-align: right;">151</td>
<td style="text-align: left;">▁▇▃▁▁</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-3-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-5-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-show-random-blood-pressure-demo" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.10</strong></span> : Show some blood pressure data with my private function <code>glance_data()</code></p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb15"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>blood_pressure_demo <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="st">&quot;data-raw/blood_pressure_demo.rds&quot;</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="do">## display some values</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>blood_pressure_demo <span class="sc">|&gt;</span> </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">arm_selected =</span> BPAOARM) <span class="sc">|&gt;</span> </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">systolic =</span> BPXOSY1) <span class="sc">|&gt;</span> </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">diastolic =</span> BPXODI1) <span class="sc">|&gt;</span> </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glance_data</span>()</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 10 × 4
#&gt;      obs arm_selected systolic diastolic
#&gt;    &lt;int&gt; &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;
#&gt;  1     1 R                 109        67
#&gt;  2   356 R                 131        64
#&gt;  3  1252 R                 100        54
#&gt;  4  2369 R                 173        82
#&gt;  5  5273 R                 131        77
#&gt;  6  8826 R                 111        74
#&gt;  7  9290 R                 112        69
#&gt;  8 10289 R                 141        74
#&gt;  9 10801 R                 112        71
#&gt; 10 11656 R                 122        55</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="sec-chap01-import-clean-data" class="level3" data-number="1.6.3">
<h3 data-number="1.6.3"><span class="header-section-number">1.6.3</span> Import &amp; clean data</h3>
<div class="my-exercise">
<div class="my-exercise-header">
<div id="exr-chap01-read-nhanes-csv" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 1.1</strong></span> : Coder exercises: Import &amp; clean data</p>
</div>
</div>
<div class="my-exercise-container">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">read_csv()</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">View data</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">Codebook</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-4" role="tab" aria-controls="tabset-4-4" aria-selected="false">Data cleaning</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-read-nhanes-csv" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.11</strong></span> : Open the 2013–2014 NHANES data file that comes with the book</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb17"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="do">## load and save it only once (manually) ########</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>nhanes_2013_ch1 <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">&quot;data-harris/nhanes_2013_ch1.csv&quot;</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(nhanes_2013_ch1, <span class="at">file =</span> <span class="st">&quot;data-raw/nhanes_2013_ch1.rds&quot;</span> )</span></code></pre></div>
</details>
</div>
<p>(<em>This R Code chunk has no visible output.</em>)</p>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-NHANES-view-data" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.12</strong></span> : Look at the data with <code>utils::str()</code> and <code>skimr::skim()</code></p>
</div>
</div>
<div class="my-r-code-container">
<div id="lst-chap01-NHANES-view-data" class="listing quarto-float">
<figure class="quarto-float quarto-float-lst">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-chap01-NHANES-view-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing 1.6: Look at the data with <code>utils::str()</code> and <code>skimr::skim()</code>
</figcaption>
<div aria-describedby="lst-chap01-NHANES-view-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb18"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>nhanes_2013_ch1 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;data-raw/nhanes_2013_ch1.rds&quot;</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">summary</span>(nhanes_2013_ch1)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;       ...1          DUQ200        RIDAGEYR        RIAGENDR    
#&gt;  Min.   :   1   Min.   :1.00   Min.   :18.00   Min.   :1.000  
#&gt;  1st Qu.:1265   1st Qu.:1.00   1st Qu.:30.00   1st Qu.:1.000  
#&gt;  Median :2529   Median :1.00   Median :42.00   Median :2.000  
#&gt;  Mean   :2529   Mean   :1.48   Mean   :42.49   Mean   :1.522  
#&gt;  3rd Qu.:3793   3rd Qu.:2.00   3rd Qu.:56.00   3rd Qu.:2.000  
#&gt;  Max.   :5057   Max.   :9.00   Max.   :69.00   Max.   :2.000  
#&gt;                 NA&#39;s   :1356</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb20"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>utils<span class="sc">::</span><span class="fu">str</span>(nhanes_2013_ch1)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; spc_tbl_ [5,057 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
#&gt;  $ ...1    : num [1:5057] 1 2 3 4 5 6 7 8 9 10 ...
#&gt;  $ DUQ200  : num [1:5057] NA 1 1 NA 1 NA 2 2 1 2 ...
#&gt;  $ RIDAGEYR: num [1:5057] 69 54 56 61 56 65 26 33 32 18 ...
#&gt;  $ RIAGENDR: num [1:5057] 1 1 1 2 2 1 2 2 1 1 ...
#&gt;  - attr(*, &quot;spec&quot;)=
#&gt;   .. cols(
#&gt;   ..   ...1 = col_double(),
#&gt;   ..   DUQ200 = col_double(),
#&gt;   ..   RIDAGEYR = col_double(),
#&gt;   ..   RIAGENDR = col_double()
#&gt;   .. )
#&gt;  - attr(*, &quot;problems&quot;)=&lt;externalptr&gt;</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb22"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>skimr<span class="sc">::</span><span class="fu">skim</span>(nhanes_2013_ch1)</span></code></pre></div>
</details>
<div class="cell-output-display">
<table>
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">nhanes_2013_ch1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">5057</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table style="width:100%;">
<colgroup>
<col style="width: 16%" />
<col style="width: 12%" />
<col style="width: 16%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 3%" />
<col style="width: 6%" />
<col style="width: 6%" />
<col style="width: 6%" />
<col style="width: 6%" />
<col style="width: 7%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">…1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">2529.00</td>
<td style="text-align: right;">1459.97</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1265</td>
<td style="text-align: right;">2529</td>
<td style="text-align: right;">3793</td>
<td style="text-align: right;">5057</td>
<td style="text-align: left;">▇▇▇▇▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">DUQ200</td>
<td style="text-align: right;">1356</td>
<td style="text-align: right;">0.73</td>
<td style="text-align: right;">1.48</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RIDAGEYR</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">42.49</td>
<td style="text-align: right;">15.16</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">56</td>
<td style="text-align: right;">69</td>
<td style="text-align: left;">▇▆▇▆▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">RIAGENDR</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.52</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">▇▁▁▁▇</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</figure>
</div>
<p>As one of the packages for displaying summaries I am using the {<strong>skimr</strong>} package (see <a href="#pak-skimr" class="quarto-xref">Package Profile <span class="quarto-unresolved-ref">pak-skimr</span></a>).</p>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<p>Unfortunately the .csv files does not include labelled data. Therefore I had to look for the variable names in all different NHANES sections as outlined in <a href="#bul-NAHNES-data-sections" class="quarto-xref">Bullet List <span class="quarto-unresolved-ref">bul-NAHNES-data-sections</span></a>. Inspecting the accompanying NHANES download pages (see: <a href="#bul-NHANES-data-pages" class="quarto-xref">Bullet List <span class="quarto-unresolved-ref">bul-NHANES-data-pages</span></a>) I could look for the variable names in the download links for the documentation.</p>
<ul>
<li><a href="https://wwwn.cdc.gov/Nchs/Nhanes/2013-2014/DUQ_H.htm#DUQ200">DUQ200</a>: Ever used marijuana or hashish</li>
<li><a href="https://wwwn.cdc.gov/Nchs/Nhanes/2013-2014/DEMO_H.htm#RIAGENDR">RIAGENDR</a>: Gender</li>
<li><a href="https://wwwn.cdc.gov/Nchs/Nhanes/2013-2014/DEMO_H.htm#RIDAGEYR">RIDAGEYR</a>: Age in years at screening</li>
</ul>
<p>There is an additional column <code>...1</code> (see <a href="#lst-chap01-NHANES-view-data" class="quarto-xref">Listing <span class="quarto-unresolved-ref">lst-chap01-NHANES-view-data</span></a>) providing row numbers. Maybe this column works as an ID, a kind sequence number, so that one could merge other data files identified by this number. (See <a href="https://wwwn.cdc.gov/Nchs/Nhanes/2013-2014/DEMO_H.htm#SEQN">SEQN</a>: Respondent Sequence Number). Why this column has lost its name, I do not know. Perhaps it has to do with the data import done by the book author?</p>
<p>To facilitate the work I made screenshots from these four variables:</p>
<p><a href="img/chap01/codebook-NHANES-DUQ200-marijuana-min.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="img/chap01/codebook-NHANES-DUQ200-marijuana-min.png" class="img-fluid" /></a></p>
<p><a href="img/chap01/codebook-NHANES-RIAGENDR-RIDAGEYR-gender-age-min.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="img/chap01/codebook-NHANES-RIAGENDR-RIDAGEYR-gender-age-min.png" class="img-fluid" /></a></p>
<p><a href="img/chap01/codebook-NHANES-SEQN-sequence-number-min.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="img/chap01/codebook-NHANES-SEQN-sequence-number-min.png" class="img-fluid" /></a></p>
</div>
<div id="tabset-4-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-4-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-NHANES-data-cleaning" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.13</strong></span> : Look at the data after data cleaning</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb23"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>nhanes_2013_ch1 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;data-raw/nhanes_2013_ch1.rds&quot;</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>chap01_nhanes_2013_clean <span class="ot">&lt;-</span> nhanes_2013_ch1 <span class="sc">|&gt;</span> </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">nr =</span> ...<span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">sex =</span> RIAGENDR,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">age =</span> RIDAGEYR,</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">grass =</span> DUQ200</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">|&gt;</span> </span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">grass =</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">na_if</span>(<span class="at">x =</span> grass, <span class="at">y =</span> <span class="dv">7</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">grass =</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">na_if</span>(<span class="at">x =</span> grass, <span class="at">y =</span> <span class="dv">9</span>)) <span class="sc">|&gt;</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">drop_na</span>() <span class="sc">|&gt;</span> </span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">sex =</span> forcats<span class="sc">::</span><span class="fu">as_factor</span>(sex)) <span class="sc">|&gt;</span> </span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">grass =</span> forcats<span class="sc">::</span><span class="fu">as_factor</span>(grass)) <span class="sc">|&gt;</span> </span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">grass =</span> </span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>          forcats<span class="sc">::</span><span class="fu">fct_recode</span>(grass, </span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;Yes&quot;</span> <span class="ot">=</span> <span class="st">&quot;1&quot;</span>, <span class="st">&quot;No&quot;</span> <span class="ot">=</span> <span class="st">&quot;2&quot;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">sex =</span> </span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>          forcats<span class="sc">::</span><span class="fu">fct_recode</span>(sex, </span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;Male&quot;</span> <span class="ot">=</span> <span class="st">&quot;1&quot;</span>, <span class="st">&quot;Female&quot;</span> <span class="ot">=</span> <span class="st">&quot;2&quot;</span>))</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a><span class="do">## save cleaned data ###############</span></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(chap01_nhanes_2013_clean, <span class="st">&quot;data-clean/chap01_nhanes_2013_clean.rds&quot;</span>)</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">summary</span>(chap01_nhanes_2013_clean)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;        nr       grass           age            sex      
#&gt;  Min.   :   2   Yes:1991   Min.   :18.00   Male  :1792  
#&gt;  1st Qu.:1288   No :1699   1st Qu.:26.00   Female:1898  
#&gt;  Median :2546              Median :38.00                
#&gt;  Mean   :2536              Mean   :37.48                
#&gt;  3rd Qu.:3784              3rd Qu.:48.00                
#&gt;  Max.   :5056              Max.   :59.00</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb25"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>skimr<span class="sc">::</span><span class="fu">skim</span>(chap01_nhanes_2013_clean)</span></code></pre></div>
</details>
<div class="cell-output-display">
<table>
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">chap01_nhanes_2013_clean</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">3690</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">factor</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: factor</strong></p>
<table>
<colgroup>
<col style="width: 18%" />
<col style="width: 13%" />
<col style="width: 18%" />
<col style="width: 10%" />
<col style="width: 11%" />
<col style="width: 27%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: left;">ordered</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: left;">top_counts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">grass</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Yes: 1991, No: 1699</td>
</tr>
<tr class="even">
<td style="text-align: left;">sex</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Fem: 1898, Mal: 1792</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<colgroup>
<col style="width: 15%" />
<col style="width: 10%" />
<col style="width: 15%" />
<col style="width: 8%" />
<col style="width: 8%" />
<col style="width: 3%" />
<col style="width: 8%" />
<col style="width: 7%" />
<col style="width: 8%" />
<col style="width: 5%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">nr</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2535.51</td>
<td style="text-align: right;">1450.33</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1288.25</td>
<td style="text-align: right;">2546.5</td>
<td style="text-align: right;">3784.25</td>
<td style="text-align: right;">5056</td>
<td style="text-align: left;">▇▇▇▇▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">age</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">37.48</td>
<td style="text-align: right;">12.43</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">26.00</td>
<td style="text-align: right;">38.0</td>
<td style="text-align: right;">48.00</td>
<td style="text-align: right;">59</td>
<td style="text-align: left;">▇▆▆▆▆</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="my-important">
<div class="my-important-header">
<p>Recoded <code>gender</code> to <code>sex</code></p>
</div>
<div class="my-important-container">
<p>In all R code chunks and text passages I have changed the <code>gender</code> category to <code>sex</code>. “Sex” refers only to biology but “gender” is a broader concepts: It refers to identity construction, that include biological, psycho-social, and cultural factors.</p>
<blockquote>
<p>Gender refers to the characteristics of women, men, girls and boys that are socially constructed. This includes norms, behaviours and roles associated with being a woman, man, girl or boy, as well as relationships with each other. As a social construct, gender varies from society to society and can change over time. … Gender interacts with but is different from sex, which refers to the different biological and physiological characteristics of females, males and intersex persons, such as chromosomes, hormones and reproductive organs. Gender and sex are related to but different from gender identity. Gender identity refers to a person’s deeply felt, internal and individual experience of gender, which may or may not correspond to the person’s physiology or designated sex at birth. (<a href="https://www.who.int/health-topics/gender#tab=tab_1">WHO</a>)</p>
</blockquote>
</div>
</div>
<div class="my-note">
<div class="my-note-header">
<p>My learning from the above procedure of data cleaning</p>
</div>
<div class="my-note-container">
<ol type="1">
<li>It is wrong to put the column name <code>...1</code> into accents.</li>
<li>There exists a shortcut for several <code>dplyr::rename()</code> but not for <code>dplyr::na_if()</code> and <code>forcats::as_factor()</code> because here we need to change the column values with the command.</li>
<li>Sequence of commands is important:
<ul>
<li>Start with the renaming of variables, This is not mandatory but it helps to address the correct column in the following commands.</li>
<li>Recode different missing values to NA’s with <code>dplyr::na_if()</code></li>
<li>Then drop (all) NA’s with <code>tidyr::drop_na()</code>.</li>
</ul></li>
<li><code>forcats::as_factor()</code> needs to rewrite the column as factor with <code>dplyr::mutate()</code></li>
</ol>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="sec-chap01-bar-chart-grass" class="level3" data-number="1.6.4">
<h3 data-number="1.6.4"><span class="header-section-number">1.6.4</span> Bar chart for marijuana use</h3>
<div class="my-exercise">
<div class="my-exercise-header">
<div id="exr-chap01-bar-chart-grass-percentage" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 1.2</strong></span> : Bar chart (with different bar width ans space) showing the percentage of NHANES participants answering yes and no to marijuana use</p>
</div>
</div>
<div class="my-exercise-container">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Numbers</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Standard</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">Thin bars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-4" role="tab" aria-controls="tabset-5-4" aria-selected="false">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-compute-grass-percentage" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.14</strong></span> : Show frequencies and percentages of NHANES participants answering yes and no to “Ever used marijuana or hashish”</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb26"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>chap01_nhanes_2013_clean <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;data-clean/chap01_nhanes_2013_clean.rds&quot;</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>tibble<span class="sc">::</span><span class="fu">enframe</span>(<span class="fu">table</span>(chap01_nhanes_2013_clean<span class="sc">$</span>grass)) <span class="sc">|&gt;</span> </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">`</span><span class="at">Ever used grass or hash</span><span class="st">`</span> <span class="ot">=</span> name, <span class="at">Freq =</span> value) <span class="sc">|&gt;</span> </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Perc =</span> <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> Freq <span class="sc">/</span> <span class="fu">sum</span>(Freq), <span class="dv">2</span>))</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 2 × 3
#&gt;   `Ever used grass or hash` Freq        Perc       
#&gt;   &lt;chr&gt;                     &lt;table[1d]&gt; &lt;table[1d]&gt;
#&gt; 1 Yes                       1991        53.96      
#&gt; 2 No                        1699        46.04</code></pre>
</div>
</div>
<hr />
<p>Instead of using <code>name</code> and <code>value</code> I could have used the position of the column numbers <code>1</code> and <code>2</code> (all names without the `-sign.)</p>
</div>
</div>
<p>This is a manual calculation using the {<strong>tidyverse</strong>} approach: I am sure there are some packages that may facilitate this computation (e.g., {<strong>Janitor</strong>} or {<strong>DescTools</strong>}), but I had difficulties to apply the appropriate functions.</p>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-grass-bar-chart-percentage" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.15</strong></span> : Percentage of NHANES participants answering yes and no to marijuana use</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb28"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>chap01_nhanes_2013_clean <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;data-clean/chap01_nhanes_2013_clean.rds&quot;</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(chap01_nhanes_2013_clean,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">aes</span>(grass, </span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="dv">100</span> <span class="sc">*</span> ggplot2<span class="sc">::</span><span class="fu">after_stat</span>(count) <span class="sc">/</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>             base<span class="sc">::</span><span class="fu">sum</span>(ggplot2<span class="sc">::</span><span class="fu">after_stat</span>(count)),</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> grass</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>        )) <span class="sc">+</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_bar</span>() <span class="sc">+</span> </span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>, <span class="st">&#39;darkred&#39;</span>),</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">scale_y_continuous</span>(</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">breaks =</span> base<span class="sc">::</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">50</span>, <span class="at">by =</span> <span class="dv">10</span>),</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_percent</span>(<span class="at">scale =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Did you ever use marijuana or hashish?&quot;</span>,</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Percent of responses&quot;</span>) </span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-grass-bar-chart-percentage-standard" class="quarto-figure quarto-figure-center quarto-float">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-grass-bar-chart-percentage-standard-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="01-preparing-data_files/figure-html/fig-grass-bar-chart-percentage-standard-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-8" data-gallery="quarto-lightbox-gallery-8"><img src="01-preparing-data_files/figure-html/fig-grass-bar-chart-percentage-standard-1.png" class="img-fluid" width="384" /></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-grass-bar-chart-percentage-standard-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Graph 1.4: Proportion of marijuana use of the participant in the NHANES 2013 survey
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
<p>The bars are very thick. I tried with <code>ggplot2::geom_bar(width = 0.5)</code> to make them thinner. But I failed. (See <a href="#lst-chap01-grass-bar-chart-width" class="quarto-xref">Listing <span class="quarto-unresolved-ref">lst-chap01-grass-bar-chart-width</span></a>)</p>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-grass-bar-chart-thin-bars" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.16</strong></span> : Percentage of NHANES participants answering yes and no to marijuana use</p>
</div>
</div>
<div class="my-r-code-container">
<div id="lst-chap01-grass-bar-chart-width" class="listing quarto-float">
<figure class="quarto-float quarto-float-lst">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-chap01-grass-bar-chart-width-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing 1.7: Reducing the thickness of the bars
</figcaption>
<div aria-describedby="lst-chap01-grass-bar-chart-width-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb29"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>chap01_nhanes_2013_clean <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;data-clean/chap01_nhanes_2013_clean.rds&quot;</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(chap01_nhanes_2013_clean,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">aes</span>(grass, </span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="dv">100</span> <span class="sc">*</span> ggplot2<span class="sc">::</span><span class="fu">after_stat</span>(count) <span class="sc">/</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>             base<span class="sc">::</span><span class="fu">sum</span>(ggplot2<span class="sc">::</span><span class="fu">after_stat</span>(count)),</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> grass</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>        )) <span class="sc">+</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    <span class="do">## provide thinner bars, standard = 0.9</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>, <span class="st">&#39;darkred&#39;</span>),</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">scale_y_continuous</span>(</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">breaks =</span> base<span class="sc">::</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">50</span>, <span class="at">by =</span> <span class="dv">10</span>),</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_percent</span>(<span class="at">scale =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Did you ever use marijuana or hashish?&quot;</span>,</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Percent of responses&quot;</span>) </span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-grass-bar-chart-thin-bars" class="quarto-figure quarto-figure-center quarto-float">
<figure class="quarto-float quarto-subfloat-fig">
<div aria-describedby="fig-grass-bar-chart-thin-bars-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="01-preparing-data_files/figure-html/fig-grass-bar-chart-thin-bars-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-9" data-gallery="lst-chap01-grass-bar-chart-width"><img src="01-preparing-data_files/figure-html/fig-grass-bar-chart-thin-bars-1.png" class="img-fluid" data-ref-parent="lst-chap01-grass-bar-chart-width" width="384" /></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-grass-bar-chart-thin-bars-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Proportion of marijuana use of the participant in the NHANES 2013 survey
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</div>
</div>
<p>The bars are now thin but the space between didn’t change. I tried several options with the position argument to <a href="https://r-graphics.org/recipe-bar-graph-adjust-width">adjust bar width <em>and</em> spacing</a>:</p>
<blockquote>
<p>Dodging preserves the vertical position of an geom while adjusting the horizontal position. position_dodge() requires the grouping variable to be be specified in the global or geom_* layer. Unlike position_dodge(), position_dodge2() works without a grouping variable in a layer. position_dodge2() works with bars and rectangles, but is particulary useful for arranging box plots, which can have variable widths.</p>
</blockquote>
<p>All my trials with <code>position_dodge()</code> and <code>position_dodge2()</code> failed. The only two strategies I could reduce the spacing was:</p>
<ul>
<li>reducing the width of the graphic (and adapting the title of the graphic to fit into the smaller space)</li>
<li>using ggplot2::theme(aspect.ratio = 3/1) as shown in <a href="#lst-fig-chap01-grass-bar-chart-solution" class="quarto-xref">Listing <span class="quarto-unresolved-ref">lst-fig-chap01-grass-bar-chart-solution</span></a>.</li>
</ul>
</div>
<div id="tabset-5-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-4-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-grass-bar-chart-solution" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.17</strong></span> : Percentage of NHANES participants answering yes and no to marijuana use</p>
</div>
</div>
<div class="my-r-code-container">
<div id="lst-fig-chap01-grass-bar-chart-solution" class="listing quarto-float">
<figure class="quarto-float quarto-float-lst">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-fig-chap01-grass-bar-chart-solution-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing 1.8: My solution for creating a bar chart showing the percentage of NHANES participants answering yes and no to marijuana use
</figcaption>
<div aria-describedby="lst-fig-chap01-grass-bar-chart-solution-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb30"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>chap01_nhanes_2013_clean <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;data-clean/chap01_nhanes_2013_clean.rds&quot;</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(chap01_nhanes_2013_clean,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">aes</span>(grass, </span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="dv">100</span> <span class="sc">*</span> ggplot2<span class="sc">::</span><span class="fu">after_stat</span>(count) <span class="sc">/</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>             base<span class="sc">::</span><span class="fu">sum</span>(ggplot2<span class="sc">::</span><span class="fu">after_stat</span>(count)),</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> grass</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>        )) <span class="sc">+</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_bar</span>() <span class="sc">+</span> </span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>, <span class="st">&#39;darkred&#39;</span>),</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">scale_y_continuous</span>(</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># n.breaks = 10, </span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">breaks =</span> base<span class="sc">::</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">50</span>, <span class="at">by =</span> <span class="dv">5</span>),</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_percent</span>(<span class="at">scale =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Did you ever use marijuana or hashish?&quot;</span>,</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Percent of responses&quot;</span>) <span class="sc">+</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">1</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-grass-bar-chart-solution" class="quarto-figure quarto-figure-center quarto-float">
<figure class="quarto-float quarto-subfloat-fig">
<div aria-describedby="fig-grass-bar-chart-solution-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="01-preparing-data_files/figure-html/fig-grass-bar-chart-solution-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-10" data-gallery="lst-fig-chap01-grass-bar-chart-solution"><img src="01-preparing-data_files/figure-html/fig-grass-bar-chart-solution-1.png" class="img-fluid" data-ref-parent="lst-fig-chap01-grass-bar-chart-solution" width="384" /></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-grass-bar-chart-solution-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Proportion of marijuana use of the participant in the NHANES 2013 survey
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
<div class="my-note">
<div class="my-note-header">
<p>What I learned from creating the bar chart</p>
</div>
<div class="my-note-container">
<p>Even with this simple example of a bar chart I learned some new options:</p>
<ol type="1">
<li>Use <code>ggplot2::after_stat()</code> inside the aesthetics of the first layer to convert frequencies to percentages.</li>
<li>Adding breaks with <code>n.breaks = &lt;number&gt;</code> or <code>breaks = base::seq(from, to, by = &lt;number&gt;)</code> inside the appropriate scale.</li>
<li>Use the {<strong>scales</strong>} package to add the <code>%</code>-sign after the values. As I have already calculated the percentages I need to reduce the default value of <code>scale = 100</code> to <code>scale = 1</code>.</li>
<li>Use <code>ggplot2::theme(aspect.ratio = &lt;number&gt;/1)</code> creating thinner bars <em>and</em> reducing the spacing between the bars accordingly. In my case I changed the aspect ratio to <code>3/1</code>. A bigger front number compresses the graph, a smaller front number extends it. Aspect ratio of <code>1/1</code> is the standard (= no change).</li>
</ol>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="sec-chap01-grass-age-sex" class="level3" data-number="1.6.5">
<h3 data-number="1.6.5"><span class="header-section-number">1.6.5</span> Marijuana use per age and sex</h3>
<div class="my-exercise">
<div class="my-exercise-header">
<div id="exr-chap01-bar-chart-grass-age-group" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 1.3</strong></span> : Exploring the percentage of NHANES participants answering yes or no to marijuana use by age category and sex</p>
</div>
</div>
<div class="my-exercise-container">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">Summary Table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Age 1</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false">Age 2</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-4" role="tab" aria-controls="tabset-6-4" aria-selected="false">Age &amp; Sex</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-compute-grass-age-group-percentage" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.18</strong></span> : Show frequencies and percentages of NHANES participants answering yes and no to “Ever used marijuana or hashish”</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb31"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>chap01_nhanes_2013_clean <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;data-clean/chap01_nhanes_2013_clean.rds&quot;</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>chap01_nhanes_2013_grouped <span class="ot">&lt;-</span> chap01_nhanes_2013_clean <span class="sc">|&gt;</span> </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="do">## cut age into several defined age groups</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">age_cat =</span> base<span class="sc">::</span><span class="fu">cut</span>(age,</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="dv">29</span>, <span class="dv">39</span>, <span class="dv">49</span>, <span class="dv">59</span>),</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;18 - 29&quot;</span>, <span class="st">&quot;30 - 39&quot;</span>, <span class="st">&quot;40 - 49&quot;</span>, <span class="st">&quot;50 - 59&quot;</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(grass, sex, age_cat)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="do">## older trial, without the knowledge of {gtsummary}</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="co"># tibble::enframe(table(chap01_nhanes_2013_grouped$age_cat)) |&gt;  </span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="co">#     dplyr::rename(`Ever used grass or hash` = 1, Freq = 2) |&gt; </span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="co">#     dplyr::mutate(Perc = round(100 * Freq / sum(Freq), 2))</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>chap01_nhanes_2013_grouped <span class="sc">|&gt;</span> </span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>    labelled<span class="sc">::</span><span class="fu">set_variable_labels</span>(</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">grass =</span> <span class="st">&quot;Ever used grass or hash?&quot;</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>    gtsummary<span class="sc">::</span><span class="fu">tbl_summary</span>(</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="fu">list</span>(</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">age_cat =</span> <span class="st">&quot;Age Category&quot;</span>,</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">sex =</span> <span class="st">&quot;Sex&quot;</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> grass <span class="sc">~</span> <span class="st">&quot;categorical&quot;</span></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>    gtsummary<span class="sc">::</span><span class="fu">bold_labels</span>()</span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(chap01_nhanes_2013_grouped, <span class="st">&quot;data-clean/chap01_nhanes_2013_grouped.rds&quot;</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="yentzrociy" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#yentzrociy table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#yentzrociy thead, #yentzrociy tbody, #yentzrociy tfoot, #yentzrociy tr, #yentzrociy td, #yentzrociy th {
  border-style: none;
}

#yentzrociy p {
  margin: 0;
  padding: 0;
}

#yentzrociy .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#yentzrociy .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#yentzrociy .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#yentzrociy .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#yentzrociy .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yentzrociy .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yentzrociy .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yentzrociy .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#yentzrociy .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#yentzrociy .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#yentzrociy .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#yentzrociy .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#yentzrociy .gt_spanner_row {
  border-bottom-style: hidden;
}

#yentzrociy .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#yentzrociy .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#yentzrociy .gt_from_md > :first-child {
  margin-top: 0;
}

#yentzrociy .gt_from_md > :last-child {
  margin-bottom: 0;
}

#yentzrociy .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#yentzrociy .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#yentzrociy .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#yentzrociy .gt_row_group_first td {
  border-top-width: 2px;
}

#yentzrociy .gt_row_group_first th {
  border-top-width: 2px;
}

#yentzrociy .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yentzrociy .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#yentzrociy .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#yentzrociy .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yentzrociy .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yentzrociy .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#yentzrociy .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#yentzrociy .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#yentzrociy .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yentzrociy .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yentzrociy .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yentzrociy .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yentzrociy .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yentzrociy .gt_left {
  text-align: left;
}

#yentzrociy .gt_center {
  text-align: center;
}

#yentzrociy .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#yentzrociy .gt_font_normal {
  font-weight: normal;
}

#yentzrociy .gt_font_bold {
  font-weight: bold;
}

#yentzrociy .gt_font_italic {
  font-style: italic;
}

#yentzrociy .gt_super {
  font-size: 65%;
}

#yentzrociy .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#yentzrociy .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#yentzrociy .gt_indent_1 {
  text-indent: 5px;
}

#yentzrociy .gt_indent_2 {
  text-indent: 10px;
}

#yentzrociy .gt_indent_3 {
  text-indent: 15px;
}

#yentzrociy .gt_indent_4 {
  text-indent: 20px;
}

#yentzrociy .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header gt_col_headings">
<th id="&lt;strong&gt;Characteristic&lt;/strong&gt;" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="&lt;strong&gt;N = 3,690&lt;/strong&gt;&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>N = 3,690</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Ever used grass or hash?</td>
<td class="gt_row gt_center" headers="stat_0"><br />
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">    Yes</td>
<td class="gt_row gt_center" headers="stat_0">1,991 (54%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">    No</td>
<td class="gt_row gt_center" headers="stat_0">1,699 (46%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Sex</td>
<td class="gt_row gt_center" headers="stat_0"><br />
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">    Male</td>
<td class="gt_row gt_center" headers="stat_0">1,792 (49%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">    Female</td>
<td class="gt_row gt_center" headers="stat_0">1,898 (51%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Age Category</td>
<td class="gt_row gt_center" headers="stat_0"><br />
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">    18 - 29</td>
<td class="gt_row gt_center" headers="stat_0">1,154 (31%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">    30 - 39</td>
<td class="gt_row gt_center" headers="stat_0">859 (23%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">    40 - 49</td>
<td class="gt_row gt_center" headers="stat_0">855 (23%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">    50 - 59</td>
<td class="gt_row gt_center" headers="stat_0">822 (22%)</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="even">
<td colspan="2" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> n (%)</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<hr />
<p>Instead of using <code>1</code> and <code>2</code> I could have used the position of the column numbers <code>name</code> and <code>value</code> (all names without the `-sign.)</p>
</div>
</div>
<p>This is a manual calculation using the {<strong>tidyverse</strong>} approach: I am sure there are some packages that may facilitate this computation (e.g., {<strong>Janitor</strong>} or {<strong>DescTools</strong>}), but I had difficulties to apply the appropriate functions.</p>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-grass-age-group1" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.19</strong></span> : Table: Percentage of NHANES participants by age group answering yes and no to marijuana use in percent of total responses</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb32"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>chap01_nhanes_2013_grouped <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;data-clean/chap01_nhanes_2013_grouped.rds&quot;</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>chap01_nhanes_2013_grouped <span class="sc">|&gt;</span> </span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    labelled<span class="sc">::</span><span class="fu">set_variable_labels</span>(</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">grass =</span> <span class="st">&quot;**Ever used grass or hash?**&quot;</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    gtsummary<span class="sc">::</span><span class="fu">tbl_cross</span>(</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="fu">list</span>(</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">age_cat =</span> <span class="st">&quot;Age Category&quot;</span>,</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">sex =</span> <span class="st">&quot;Sex&quot;</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">row =</span> age_cat,</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> grass,</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">percent =</span> <span class="st">&quot;cell&quot;</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>    gtsummary<span class="sc">::</span><span class="fu">modify_header</span>(</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">stat_1 =</span> <span class="st">&#39;**Yes**&#39;</span>,</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">stat_2 =</span> <span class="st">&#39;**No**&#39;</span>,</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">stat_0 =</span> <span class="st">&#39;**Total**&#39;</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>    gtsummary<span class="sc">::</span><span class="fu">bold_labels</span>()</span></code></pre></div>
</details>
<div id="tbl-grass-age-group1" class="cell quarto-float">
<figure class="quarto-float quarto-float-tbl">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-grass-age-group1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table 1.1: Proportion of marijuana use of the participant by age group in percent of total responses in the NHANES 2013 survey
</figcaption>
<div aria-describedby="tbl-grass-age-group1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="ddvrmedbxr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ddvrmedbxr table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ddvrmedbxr thead, #ddvrmedbxr tbody, #ddvrmedbxr tfoot, #ddvrmedbxr tr, #ddvrmedbxr td, #ddvrmedbxr th {
  border-style: none;
}

#ddvrmedbxr p {
  margin: 0;
  padding: 0;
}

#ddvrmedbxr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ddvrmedbxr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ddvrmedbxr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ddvrmedbxr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ddvrmedbxr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ddvrmedbxr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ddvrmedbxr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ddvrmedbxr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ddvrmedbxr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ddvrmedbxr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ddvrmedbxr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ddvrmedbxr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ddvrmedbxr .gt_spanner_row {
  border-bottom-style: hidden;
}

#ddvrmedbxr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ddvrmedbxr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ddvrmedbxr .gt_from_md > :first-child {
  margin-top: 0;
}

#ddvrmedbxr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ddvrmedbxr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ddvrmedbxr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ddvrmedbxr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ddvrmedbxr .gt_row_group_first td {
  border-top-width: 2px;
}

#ddvrmedbxr .gt_row_group_first th {
  border-top-width: 2px;
}

#ddvrmedbxr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ddvrmedbxr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ddvrmedbxr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ddvrmedbxr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ddvrmedbxr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ddvrmedbxr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ddvrmedbxr .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ddvrmedbxr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ddvrmedbxr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ddvrmedbxr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ddvrmedbxr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ddvrmedbxr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ddvrmedbxr .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ddvrmedbxr .gt_left {
  text-align: left;
}

#ddvrmedbxr .gt_center {
  text-align: center;
}

#ddvrmedbxr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ddvrmedbxr .gt_font_normal {
  font-weight: normal;
}

#ddvrmedbxr .gt_font_bold {
  font-weight: bold;
}

#ddvrmedbxr .gt_font_italic {
  font-style: italic;
}

#ddvrmedbxr .gt_super {
  font-size: 65%;
}

#ddvrmedbxr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ddvrmedbxr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ddvrmedbxr .gt_indent_1 {
  text-indent: 5px;
}

#ddvrmedbxr .gt_indent_2 {
  text-indent: 10px;
}

#ddvrmedbxr .gt_indent_3 {
  text-indent: 15px;
}

#ddvrmedbxr .gt_indent_4 {
  text-indent: 20px;
}

#ddvrmedbxr .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table do-not-create-environment cell" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header gt_col_headings gt_spanner_row">
<th rowspan="2" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
<th colspan="2" id="&lt;strong&gt;&lt;strong&gt;Ever used grass or hash?&lt;/strong&gt;&lt;/strong&gt;" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><span class="gt_column_spanner"><strong><strong>Ever used grass or hash?</strong></strong></span></th>
<th rowspan="2" id="&lt;strong&gt;&lt;strong&gt;Total&lt;/strong&gt;&lt;/strong&gt;" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong><strong>Total</strong></strong></th>
</tr>
<tr class="odd gt_col_headings">
<th id="&lt;strong&gt;Yes&lt;/strong&gt;" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Yes</strong></th>
<th id="&lt;strong&gt;No&lt;/strong&gt;" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>No</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Age Category</td>
<td class="gt_row gt_center" headers="stat_1"><br />
</td>
<td class="gt_row gt_center" headers="stat_2"><br />
</td>
<td class="gt_row gt_center" headers="stat_0"><br />
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">    18 - 29</td>
<td class="gt_row gt_center" headers="stat_1">662 (18%)</td>
<td class="gt_row gt_center" headers="stat_2">492 (13%)</td>
<td class="gt_row gt_center" headers="stat_0">1,154 (31%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">    30 - 39</td>
<td class="gt_row gt_center" headers="stat_1">466 (13%)</td>
<td class="gt_row gt_center" headers="stat_2">393 (11%)</td>
<td class="gt_row gt_center" headers="stat_0">859 (23%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">    40 - 49</td>
<td class="gt_row gt_center" headers="stat_1">405 (11%)</td>
<td class="gt_row gt_center" headers="stat_2">450 (12%)</td>
<td class="gt_row gt_center" headers="stat_0">855 (23%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">    50 - 59</td>
<td class="gt_row gt_center" headers="stat_1">458 (12%)</td>
<td class="gt_row gt_center" headers="stat_2">364 (9.9%)</td>
<td class="gt_row gt_center" headers="stat_0">822 (22%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Total</td>
<td class="gt_row gt_center" headers="stat_1">1,991 (54%)</td>
<td class="gt_row gt_center" headers="stat_2">1,699 (46%)</td>
<td class="gt_row gt_center" headers="stat_0">3,690 (100%)</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<hr />
<p>I have required {<strong>gtsummary</strong>} to calculate the percentage with one decimal place. The reason was that the graphic did not match the table. For instance: Without decimal places the “No”-proportion of the age group 18-29 was with 13% equal to the “Yes”-proportion of the age group 30-39. But in the figure these two bars have a different height. The reason was a rounding error: Both values 13.3% and 12.6% were rounded to 13%. But in the figure one could see the difference of 0.7% in the length of the bars.</p>
</div>
</div>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-fig-grass-age-group1" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.20</strong></span> : Figure: Percentage of NHANES participants by age group answering yes and no to marijuana use in percent of total responses</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb33"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="do">## age groups bar chart 1 ########</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>chap01_nhanes_2013_grouped <span class="sc">|&gt;</span> </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> age_cat, </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">fill =</span> grass,</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="dv">100</span> <span class="sc">*</span> ggplot2<span class="sc">::</span><span class="fu">after_stat</span>(count) <span class="sc">/</span> </span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>             base<span class="sc">::</span><span class="fu">sum</span>(ggplot2<span class="sc">::</span><span class="fu">after_stat</span>(count))</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span> </span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">&#39;dodge&#39;</span>) <span class="sc">+</span>    </span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;darkgreen&#39;</span>, <span class="st">&#39;darkred&#39;</span>),</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">name =</span> <span class="st">&quot;Ever used</span><span class="sc">\n</span><span class="st">grass or hash?&quot;</span>) <span class="sc">+</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Age group (in years)&quot;</span>,</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Percent of total responses&quot;</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-grass-age-group1" class="quarto-figure quarto-figure-center quarto-float">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-grass-age-group1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="01-preparing-data_files/figure-html/fig-grass-age-group1-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-11" data-gallery="quarto-lightbox-gallery-11"><img src="01-preparing-data_files/figure-html/fig-grass-age-group1-1.png" class="img-fluid" width="672" /></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-grass-age-group1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Graph 1.5: Percentage of NHANES participants by age group answering yes and no to marijuana use in percent of total responses
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-grass-age-group2" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.21</strong></span> : Table:: Percentage of NHANES 2013 survey participants by age group answering yes and no to marijuana use in percent of age group</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb34"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>chap01_nhanes_2013_grouped <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;data-clean/chap01_nhanes_2013_grouped.rds&quot;</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>chap01_nhanes_2013_grouped <span class="sc">|&gt;</span> </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    labelled<span class="sc">::</span><span class="fu">set_variable_labels</span>(</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">grass =</span> <span class="st">&quot;**Ever used grass or hash?**&quot;</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">|&gt;</span> </span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    gtsummary<span class="sc">::</span><span class="fu">tbl_cross</span>(</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="fu">list</span>(</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">age_cat =</span> <span class="st">&quot;Age Category&quot;</span>,</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">sex =</span> <span class="st">&quot;Sex&quot;</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">row =</span> age_cat,</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> grass,</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">percent =</span> <span class="st">&quot;row&quot;</span>,</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">margin =</span> <span class="st">&quot;column&quot;</span>,</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>    gtsummary<span class="sc">::</span><span class="fu">modify_header</span>(</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">stat_1 =</span> <span class="st">&#39;**Yes**&#39;</span>,</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">stat_2 =</span> <span class="st">&#39;**No**&#39;</span>,</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">stat_0 =</span> <span class="st">&#39;**Total**&#39;</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>    gtsummary<span class="sc">::</span><span class="fu">bold_labels</span>()</span></code></pre></div>
</details>
<div id="tbl-grass-age-group2" class="cell quarto-float">
<figure class="quarto-float quarto-float-tbl">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-grass-age-group2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table 1.2: Proportion of marijuana use of the participant by age group in the NHANES 2013 survey
</figcaption>
<div aria-describedby="tbl-grass-age-group2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="exnevbrxqr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#exnevbrxqr table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#exnevbrxqr thead, #exnevbrxqr tbody, #exnevbrxqr tfoot, #exnevbrxqr tr, #exnevbrxqr td, #exnevbrxqr th {
  border-style: none;
}

#exnevbrxqr p {
  margin: 0;
  padding: 0;
}

#exnevbrxqr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#exnevbrxqr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#exnevbrxqr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#exnevbrxqr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#exnevbrxqr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#exnevbrxqr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#exnevbrxqr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#exnevbrxqr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#exnevbrxqr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#exnevbrxqr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#exnevbrxqr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#exnevbrxqr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#exnevbrxqr .gt_spanner_row {
  border-bottom-style: hidden;
}

#exnevbrxqr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#exnevbrxqr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#exnevbrxqr .gt_from_md > :first-child {
  margin-top: 0;
}

#exnevbrxqr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#exnevbrxqr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#exnevbrxqr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#exnevbrxqr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#exnevbrxqr .gt_row_group_first td {
  border-top-width: 2px;
}

#exnevbrxqr .gt_row_group_first th {
  border-top-width: 2px;
}

#exnevbrxqr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#exnevbrxqr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#exnevbrxqr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#exnevbrxqr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#exnevbrxqr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#exnevbrxqr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#exnevbrxqr .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#exnevbrxqr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#exnevbrxqr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#exnevbrxqr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#exnevbrxqr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#exnevbrxqr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#exnevbrxqr .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#exnevbrxqr .gt_left {
  text-align: left;
}

#exnevbrxqr .gt_center {
  text-align: center;
}

#exnevbrxqr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#exnevbrxqr .gt_font_normal {
  font-weight: normal;
}

#exnevbrxqr .gt_font_bold {
  font-weight: bold;
}

#exnevbrxqr .gt_font_italic {
  font-style: italic;
}

#exnevbrxqr .gt_super {
  font-size: 65%;
}

#exnevbrxqr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#exnevbrxqr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#exnevbrxqr .gt_indent_1 {
  text-indent: 5px;
}

#exnevbrxqr .gt_indent_2 {
  text-indent: 10px;
}

#exnevbrxqr .gt_indent_3 {
  text-indent: 15px;
}

#exnevbrxqr .gt_indent_4 {
  text-indent: 20px;
}

#exnevbrxqr .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table do-not-create-environment cell" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header gt_col_headings gt_spanner_row">
<th rowspan="2" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
<th colspan="2" id="&lt;strong&gt;&lt;strong&gt;Ever used grass or hash?&lt;/strong&gt;&lt;/strong&gt;" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><span class="gt_column_spanner"><strong><strong>Ever used grass or hash?</strong></strong></span></th>
<th rowspan="2" id="&lt;strong&gt;&lt;strong&gt;Total&lt;/strong&gt;&lt;/strong&gt;" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong><strong>Total</strong></strong></th>
</tr>
<tr class="odd gt_col_headings">
<th id="&lt;strong&gt;Yes&lt;/strong&gt;" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Yes</strong></th>
<th id="&lt;strong&gt;No&lt;/strong&gt;" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>No</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Age Category</td>
<td class="gt_row gt_center" headers="stat_1"><br />
</td>
<td class="gt_row gt_center" headers="stat_2"><br />
</td>
<td class="gt_row gt_center" headers="stat_0"><br />
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">    18 - 29</td>
<td class="gt_row gt_center" headers="stat_1">662 (57.4%)</td>
<td class="gt_row gt_center" headers="stat_2">492 (42.6%)</td>
<td class="gt_row gt_center" headers="stat_0">1,154 (100.0%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">    30 - 39</td>
<td class="gt_row gt_center" headers="stat_1">466 (54.2%)</td>
<td class="gt_row gt_center" headers="stat_2">393 (45.8%)</td>
<td class="gt_row gt_center" headers="stat_0">859 (100.0%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">    40 - 49</td>
<td class="gt_row gt_center" headers="stat_1">405 (47.4%)</td>
<td class="gt_row gt_center" headers="stat_2">450 (52.6%)</td>
<td class="gt_row gt_center" headers="stat_0">855 (100.0%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">    50 - 59</td>
<td class="gt_row gt_center" headers="stat_1">458 (55.7%)</td>
<td class="gt_row gt_center" headers="stat_2">364 (44.3%)</td>
<td class="gt_row gt_center" headers="stat_0">822 (100.0%)</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
</div>
</div>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-fig-grass-age-group2" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.22</strong></span> : Figure: Percentage of NHANES participants of the 2013 survey answering yes and no to marijuana use in percent of age group</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb35"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="do">## age groups bar chart 2 ########</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>chap01_nhanes_2013_grouped <span class="sc">|&gt;</span> </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(grass, age_cat) <span class="sc">|&gt;</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">count</span>() <span class="sc">|&gt;</span> </span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(age_cat) <span class="sc">|&gt;</span> </span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">perc_grass =</span> <span class="dv">100</span> <span class="sc">*</span> n <span class="sc">/</span> base<span class="sc">::</span><span class="fu">sum</span>(n)) <span class="sc">|&gt;</span> </span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> age_cat, <span class="at">fill =</span> grass,</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> perc_grass)) <span class="sc">+</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">&#39;dodge&#39;</span>) <span class="sc">+</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;darkgreen&#39;</span>, <span class="st">&#39;darkred&#39;</span>),</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">name =</span> <span class="st">&quot;Ever used</span><span class="sc">\n</span><span class="st">grass or hash?&quot;</span>) <span class="sc">+</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Age group (in years)&quot;</span>,</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Percent of responses in age group&quot;</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-grass-age-group2" class="quarto-figure quarto-figure-center quarto-float">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-grass-age-group2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="01-preparing-data_files/figure-html/fig-grass-age-group2-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-12" data-gallery="quarto-lightbox-gallery-12"><img src="01-preparing-data_files/figure-html/fig-grass-age-group2-1.png" class="img-fluid" width="672" /></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-grass-age-group2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Graph 1.6: Percentage of NHANES participants of the 2013 survey answering yes and no to marijuana use in percent of age group
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-6-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-4-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-grass-age-sex" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.23</strong></span> : Percentage of NHANES participants 2013 survey by age group and sex answering yes and no to marijuana use</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb36"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>chap01_nhanes_2013_grouped <span class="ot">&lt;-</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">readRDS</span>(<span class="st">&quot;data-clean/chap01_nhanes_2013_grouped.rds&quot;</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="do">## age and sex bar chart ########</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>chap01_nhanes_2013_grouped <span class="sc">|&gt;</span> </span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(grass, age_cat, sex) <span class="sc">|&gt;</span> </span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">count</span>() <span class="sc">|&gt;</span> </span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(age_cat, sex) <span class="sc">|&gt;</span> </span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">perc_grass_2 =</span> <span class="dv">100</span> <span class="sc">*</span> n <span class="sc">/</span> base<span class="sc">::</span><span class="fu">sum</span>(n)) <span class="sc">|&gt;</span> </span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> age_cat, </span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> perc_grass_2,</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> sex)) <span class="sc">+</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">&#39;dodge&#39;</span>) <span class="sc">+</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;#f98e31&#39;</span>, <span class="st">&#39;#730b6d&#39;</span>),</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>                             <span class="at">name =</span> <span class="st">&quot;sex&quot;</span>) <span class="sc">+</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">&quot;Age group (in years)&quot;</span>,</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">&quot;Percent of males/females that used marijuana or hashish&quot;</span></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>      )</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-grass-age-sex" class="quarto-figure quarto-figure-center quarto-float">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-grass-age-sex-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="01-preparing-data_files/figure-html/fig-grass-age-sex-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-13" data-gallery="quarto-lightbox-gallery-13"><img src="01-preparing-data_files/figure-html/fig-grass-age-sex-1.png" class="img-fluid" width="672" /></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-grass-age-sex-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Graph 1.7: Proportion of marijuana use of the participant by age group and sex in the NHANES 2013 survey
</figcaption>
</figure>
</div>
</div>
</div>
<hr />
<p>With the exception of the oldest age group the graphic shows that the proportion of marijuana / hashish user increases with younger people. One possible explanation for the untypical high use in the oldest age group could be that people between 50-59 of the 2013 survey were born between 1954-1963 and were young adults during the time of the <a href="https://en.wikipedia.org/wiki/Flower_power">Flower Power</a> generation part of the <a href="Counterculture%20of%20the%201960s">counterculture of the 1960s</a>-1970s.</p>
</div>
</div>
<p><a href="#fig-grass-age-sex" class="quarto-xref">Graph <span class="quarto-unresolved-ref">fig-grass-age-sex</span></a> is a little difficult to interpret. Both bars colors shows the proportion of “Yes”-respondents in the appropriate age group. For instance: About 62% of males and about 51% of women of the age group 18-29 said “Yes”.</p>
<p>Therefore the bars to not sum up to 100%. The figures shows only the “Yes” part of the dichotomous <code>grass</code> variable for men and women in a certain age group. The other “No” part is missing.</p>
<p>To distinguish the sex colors in <a href="#fig-grass-age-sex" class="quarto-xref">Graph <span class="quarto-unresolved-ref">fig-grass-age-sex</span></a> from the Yes/No colors in <a href="#fig-grass-age-group1" class="quarto-xref">Graph <span class="quarto-unresolved-ref">fig-grass-age-group1</span></a> and <a href="#fig-grass-age-group2" class="quarto-xref">Graph <span class="quarto-unresolved-ref">fig-grass-age-group2</span></a> I chose at first some kind of blue for men and red for females. But I learned from <a href="https://blog.datawrapper.de/gendercolor/">An alternative to pink &amp; blue: Colors for gender data</a> that one should avoid this stereotypical colors.</p>
<blockquote>
<p>In our western culture, these colors come with the whole gender stereotype baggage. Pink means weak, shy girls who play with dolls and don’t deserve as much as boys. Blue stands for boys who need to be strong &amp; rough. <strong>When we create a chart with pink &amp; blue, we endorse gender stereotypes</strong>.</p>
</blockquote>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="sec-chap01-data-interpretation" class="level3" data-number="1.6.6">
<h3 data-number="1.6.6"><span class="header-section-number">1.6.6</span> Data interpretation</h3>
<div id="rep-chap01-gss-nhanes" class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class='callout-icon'></i>
</div>
<div class="callout-title-container flex-fill">
Report 1.1: Marijuana usage and opinions to legalize it (<a class='glossary' title='A large survey of a sample of people in the United States conducted regularly since 1972; the General Social Survey is abbreviated GSS and is conducted by the National Opinion Research Center at the University of Chicago. (Harris, Glossary)'>GSS</a> and <a class='glossary' title='The National Health and Nutrition Examination Survey (NHANES) is a program of studies designed to assess the health and nutritional status of adults and children in the United States. The survey is unique in that it combines interviews and physical examinations. (NHANES)'>NHANES</a> data)
</div>
</div>
<div class="callout-body-container callout-body">
<p><a href="#fig-chap01-repr-fig-1-2" class="quarto-xref">Graph <span class="quarto-unresolved-ref">fig-chap01-repr-fig-1-2</span></a> with <a class='glossary' title='A large survey of a sample of people in the United States conducted regularly since 1972; the General Social Survey is abbreviated GSS and is conducted by the National Opinion Research Center at the University of Chicago. (Harris, Glossary)'>GSS</a> data 2016 shows that younger people support the legalizing of marijuana. Therefore we can expect that in the future the proportion of people that approve legalizing will increase. With a small project on my own I have backed up this thesis. <a href="#fig-gss-grass-timeline" class="quarto-xref">Graph <span class="quarto-unresolved-ref">fig-gss-grass-timeline</span></a> demonstrates that the percentage of supporters has increased very strongly in the last years and has now hit the 70% mark. This trend is very clear even I have not distinguished in the longitudinal study between different age groups.</p>
<p>The graphs of the <a class='glossary' title='The National Health and Nutrition Examination Survey (NHANES) is a program of studies designed to assess the health and nutritional status of adults and children in the United States. The survey is unique in that it combines interviews and physical examinations. (NHANES)'>NHANES</a> 2013 data in <a href="#fig-grass-age-group1" class="quarto-xref">Graph <span class="quarto-unresolved-ref">fig-grass-age-group1</span></a> and fig-grass-age-group2 show that the highest proportion of people ever used marijuana or hashish lies in youngest age. The age trend is not very clear, because we have only figures for person equal or under 59 years. (Here would be necessary another small project with longitudinal analysis including newer data.)</p>
<p>With the exception of the age group 40-49 the proportion of males ever used in their respective age group is higher than the percentage of women. (See <a href="#fig-grass-age-sex" class="quarto-xref">Graph <span class="quarto-unresolved-ref">fig-grass-age-sex</span></a>). But this is only a snapshot and difficult to interpret. Another possible thesis could be that there is a tiny upward trend from old top young in marijuana use. One possible explanation for the untypical higher use in the oldest age group could be that people between 50-59 of the 2013 survey were born between 1954-1963 and were young adults during the time of the <a href="https://en.wikipedia.org/wiki/Flower_power">Flower Power</a> generation part of the <a href="Counterculture%20of%20the%201960s">counterculture of the 1960s</a>-1970s.</p>
</div>
</div>
<hr />
</section>
</section>
<section id="sec-chap01-get-gss-data" class="level2" data-number="1.7">
<h2 data-number="1.7"><span class="header-section-number">1.7</span> Get the GSS data</h2>
<section id="working-with-the-gss" class="level3" data-number="1.7.1">
<h3 data-number="1.7.1"><span class="header-section-number">1.7.1</span> Working with the GSS</h3>
<p>I am very interested how to get <a class='glossary' title='A large survey of a sample of people in the United States conducted regularly since 1972; the General Social Survey is abbreviated GSS and is conducted by the National Opinion Research Center at the University of Chicago. (Harris, Glossary)'>GSS</a> data directly from the GSS website, so that I could work on interesting research questions myself.</p>
<p>I have found several resources helping to work with the <a class='glossary' title='A large survey of a sample of people in the United States conducted regularly since 1972; the General Social Survey is abbreviated GSS and is conducted by the National Opinion Research Center at the University of Chicago. (Harris, Glossary)'>GSS</a>. The most important one is the {<strong>gssr</strong>} package (see: <a href="#pak-gssr" class="quarto-xref">Package Profile <span class="quarto-unresolved-ref">pak-gssr</span></a>)</p>
<div class="my-resource">
<div class="my-resource-header">
<p>asdfree: Analyze Survey Data for Free</p>
</div>
<div class="my-resource-container">
<p><a href="http://asdfree.com/">Analyze Survey Data for Free</a> is a bookdown website by <a href="https://www.youtube.com/@anthonyjosephdamico/playlists">Anthony Damico</a> with currently 64 locations to grab free survey data. As expected it features also a <a href="http://asdfree.com/general-social-survey-gss.html">description of the GSS</a> including analysis examples with the {<strong>survey</strong>} package and — especially important for my purpose here — {<strong>lodown</strong>}, a <a href="https://github.com/ajdamico/lodown">package on GitHub</a> that is not maintained anymore.</p>
</div>
</div>
<p><a href="#def-chap01-get-gss-data" class="quarto-xref">Experiment <span class="quarto-unresolved-ref">def-chap01-get-gss-data</span></a> features five different strategies to download GSS data:</p>
<ol type="1">
<li>Download extract by using the GSS Data Explorer — Tab: “Explorer”</li>
<li>Download files manually — Tab: “by hand”</li>
<li>Download files programmatically — Tab: “automated”</li>
<li>Download via the {<strong>lodown</strong>} package — Tab: “lodown”</li>
<li>Download via the {<strong>gssr</strong>} package — Tab: “gssr”</li>
</ol>
</section>
<section id="five-strategies-to-get-gss-data" class="level3" data-number="1.7.2">
<h3 data-number="1.7.2"><span class="header-section-number">1.7.2</span> Five strategies to get GSS data</h3>
<div class="my-experiment">
<div class="my-experiment-header">
<div id="def-chap01-get-gss-data" class="theorem definition">
<p><span class="theorem-title"><strong>Experiment 1.2</strong></span> : How to get the General Social Survey (GSS) data</p>
</div>
</div>
<div class="my-experiment-container">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">Explore</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">by hand</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false">automated</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-4" role="tab" aria-controls="tabset-7-4" aria-selected="false">lodown</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-5" role="tab" aria-controls="tabset-7-5" aria-selected="false">gssr</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<p>To use all the facilities of the GSS Data Explorer (tagging, tabulating, data extracting) you need to register for a free account. The good thing is: This is a onetime procedure.</p>
<div class="my-procedure">
<div class="my-procedure-header">
<div id="prp-chap01-get-gss-data-explorer" class="theorem proposition">
<p><span class="theorem-title"><strong>Procedure 1.1</strong></span> : Downloading data extracts with the GSS Data Explorer</p>
</div>
</div>
<div class="my-procedure-container">
<ol type="1">
<li>Create a free account for the <a href="https://gssdataexplorer.norc.org/">GSS Data Explorer</a>, a tool that allows to browse the data that have been collected in the surveys.
<ul>
<li>Fill out the form</li>
<li>Wait for an email with the verification code</li>
<li>Confirm the registration with the verification code</li>
</ul></li>
<li>Go for the tour to learn the interface (Link “Tour Guide”)</li>
<li>Now you are ready to follow the advises in the slides. If you prefer you can view the slide show in a <a href="https://petzi53.quarto.pub/gss-data-explorer/#/title-slide">standalone browser</a>.</li>
</ol>
</div>
</div>
<iframe width="650" height="400" class="slide-deck" src="https://petzi53.quarto.pub/gss-data-explorer/#/title-slide">
</iframe>
<p>As one can see this is a somewhat cumbersome procedure to download the desired data. Following the proposed strategies in the other tabs are much easier for importing GSS data. But using the GSS Data Explorer is very helpful to <em>explore</em> the dataset. Apply the first three steps of the above list to find the correct variable names, to read the exact wording of the question asked and to inspect the different codes that are used for the variable. Otherwise you have to skim the more than 700 pages of the GSS codebook.😭</p>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<p>Another approach is to download the complete dataset (or all variables of those years you are interested in) and manage the data in such a way that it can be easily used for your research question. (See <a href="#sec-chap01-data-wrangling" class="quarto-xref"><span class="quarto-unresolved-ref">sec-chap01-data-wrangling</span></a>)</p>
<div class="my-procedure">
<div class="my-procedure-header">
<div id="prp-chap01-get-gss-data-manually" class="theorem proposition">
<p><span class="theorem-title"><strong>Procedure 1.2</strong></span> : Download GSS individual year data sets (cross-section only)</p>
</div>
</div>
<div class="my-procedure-container">
<ol type="1">
<li>Visit <a href="https://gss.norc.org/Get-The-Data" class="uri">https://gss.norc.org/Get-The-Data</a> and choose under the section “Download the Data” the “STATA” format. I read elsewhere that this is the preferred format to convert the data into R with the {<strong>haven</strong>} package.</li>
<li>From the <a href="https://gss.norc.org/get-the-data/stata">STATA-page</a> choose the appropriate link (<code>2016</code> in our case) under the section “Individual Year Data Sets (cross-section only)” and download the file <code>2016_stata.zip</code> (994 MB) into your preferred folder on your hard disk. After you extract the .zip file you will get the STAT file <code>GSS2016.dta</code> (4.4 MB).</li>
<li>You can now apply <a href="#cnj-chap01-import-stata-data" class="quarto-xref">R Code <span class="quarto-unresolved-ref">cnj-chap01-import-stata-data</span></a>.</li>
</ol>
</div>
</div>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-import-stata-data" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.24</strong></span> : Import STATA GSS 2016 file into R using (<strong>haven</strong>)</p>
</div>
</div>
<div class="my-r-code-container">
<div id="lst-chap01-import-stata-2016-file" class="listing quarto-float">
<figure class="quarto-float quarto-float-lst">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-chap01-import-stata-2016-file-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing 1.9: Import STATA GSS 2016 file into R using (<strong>haven</strong>) and glance at the data
</figcaption>
<div aria-describedby="lst-chap01-import-stata-2016-file-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb37"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="do">## run only once (manually) ###########</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>gss_2016_man <span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">read_dta</span>(<span class="st">&quot;data-raw/GSS2016.dta&quot;</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(gss_2016_man, <span class="at">file =</span> <span class="st">&quot;data-raw/gss_2016_man.rds&quot;</span> )</span></code></pre></div>
</details>
</div>
<p>(<em>This R code chunk has no visible output</em>)</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb38"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>gss_2016_man <span class="ot">&lt;-</span> </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">readRDS</span>(<span class="st">&quot;data-raw/gss_2016_man.rds&quot;</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>gss_2016_man <span class="sc">|&gt;</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(age, grass)) <span class="sc">|&gt;</span> </span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glance_data</span>(<span class="at">N =</span> <span class="dv">8</span>, <span class="at">seed =</span> <span class="dv">2016</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 10 × 3
#&gt;      obs age       grass                      
#&gt;    &lt;int&gt; &lt;dbl+lbl&gt; &lt;dbl+lbl&gt;                  
#&gt;  1     1 47        NA(i) [iap]                
#&gt;  2   172 27            1 [should be legal]    
#&gt;  3   562 70            2 [should not be legal]
#&gt;  4   898 60            2 [should not be legal]
#&gt;  5  1019 30            1 [should be legal]    
#&gt;  6  1176 80            2 [should not be legal]
#&gt;  7  1505 53        NA(i) [iap]                
#&gt;  8  1911 54            2 [should not be legal]
#&gt;  9  2622 62        NA(i) [iap]                
#&gt; 10  2867 72            2 [should not be legal]</code></pre>
</div>
</div>
</div>
</figure>
</div>
<div class="my-important">
<div class="my-important-header">
<p>{<strong>haven</strong>} imports data as labelled vectors</p>
</div>
<div class="my-important-container">
<p>The data structure we have found here is very different from the Excel data file provided with the book.</p>
</div>
</div>
<p>Labelled vectors is a completely new feature for me. I learned that value labels and other metadata tags that are commonly seen when working with other statistical software like SAS, STATA or SPSS (cf. <a href="https://socialresearchcentre.github.io/r_survey_datasets/">Survey Research and Datasets in R</a>, here section 3 <a href="https://socialresearchcentre.github.io/r_survey_datasets/labelled-data.html">Labelled Data</a>)</p>
<blockquote>
<p>A labelled vector is a common data structure in other statistical environments, allowing you to assign text labels to specific values. This class makes it possible to import such labelled vectors in to R without loss of fidelity. (<a href="https://haven.tidyverse.org/reference/labelled.html">Create a labelled vector</a>)</p>
</blockquote>
<p>I will go into more details in <a href="#sec-chap01-labelled-data" class="quarto-xref"><span class="quarto-unresolved-ref">sec-chap01-labelled-data</span></a>. The important thing here is to notice that the variable <code>grass</code> has labelled values that explain the short code. Code <code>1</code> represents the respondent option that marijuana should be legalized and <code>2</code> the opposite. We also learn that there is with <code>NA i</code> a special kind of <code>NA</code> value:</p>
<blockquote>
<p>.i: Inapplicable (IAP). Respondents who are not asked to answer a specific question are assigned to IAP. (See <a href="https://gss.norc.org/get-the-data/stata">Alert on the STATA download page</a>)</p>
</blockquote>
<p>On the website we see under the “Alert” section that there other kind of NA’s as well. And the 2022 GSS Codebook describes still other, less common missing values.</p>
</div>
</div>
<p><strong>Additional comments</strong></p>
<p>I chose for file saving the <code>base::saveRDS()</code> option (and not <code>base::save()</code>) because when later reading into R again with <code>base::readRDS()</code> it does not overwrite a variable with the same name respectively I can assign the file to another variable name.</p>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-get-gss2016-data" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.25</strong></span> : Get year 2016 of GSS data set with <code>base::download.file()</code></p>
</div>
</div>
<div class="my-r-code-container">
<div id="lst-chap01-get-gss2016-automated" class="listing quarto-float">
<figure class="quarto-float quarto-float-lst">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-chap01-get-gss2016-automated-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing 1.10: Get year 2016 of GSS data set with <code>base::download.file()</code>
</figcaption>
<div aria-describedby="lst-chap01-get-gss2016-automated-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<details open class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb40"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="do">## run only once (manually) ###########</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">tempfile</span>()</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>utils<span class="sc">::</span><span class="fu">download.file</span>(<span class="st">&quot;https://gss.norc.org/documents/stata/2016_stata.zip&quot;</span>,temp)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>gss_2016_aut <span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">read_dta</span>(base<span class="sc">::</span><span class="fu">unz</span>(temp, <span class="st">&quot;GSS2016.dta&quot;</span>))</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">unlink</span>(temp)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">saveRDS</span>(gss_2016_aut, <span class="at">file =</span> <span class="st">&quot;data-raw/gss_2016_aut.rds&quot;</span> )</span></code></pre></div>
</details>
</div>
</div>
</figure>
</div>
<p>(<em>This R code chunk has no visible output</em>)</p>
<p>This time we have the file downloaded programmatically which is much better in term of reproducibility. We don’t need now to import the data {<strong>haven</strong>} but can call base::readRDS().</p>
<div id="lst-chap01-read-rds-data" class="listing quarto-float">
<figure class="quarto-float quarto-float-lst">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-chap01-read-rds-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing 1.11: Read previously saved <code>.rds</code> file into R and glance at the data
</figcaption>
<div aria-describedby="lst-chap01-read-rds-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb41"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>gss_2016_aut <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="st">&quot;data-raw/gss_2016_aut.rds&quot;</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>gss_2016_aut <span class="sc">|&gt;</span> </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(age, grass)) <span class="sc">|&gt;</span> </span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glance_data</span>(<span class="at">N =</span> <span class="dv">8</span>, <span class="at">seed =</span> <span class="dv">2016</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 10 × 3
#&gt;      obs age       grass                      
#&gt;    &lt;int&gt; &lt;dbl+lbl&gt; &lt;dbl+lbl&gt;                  
#&gt;  1     1 47        NA(i) [iap]                
#&gt;  2   172 27            1 [should be legal]    
#&gt;  3   562 70            2 [should not be legal]
#&gt;  4   898 60            2 [should not be legal]
#&gt;  5  1019 30            1 [should be legal]    
#&gt;  6  1176 80            2 [should not be legal]
#&gt;  7  1505 53        NA(i) [iap]                
#&gt;  8  1911 54            2 [should not be legal]
#&gt;  9  2622 62        NA(i) [iap]                
#&gt; 10  2867 72            2 [should not be legal]</code></pre>
</div>
</div>
</div>
</figure>
</div>
</div>
</div>
<p>Data now have a more R like appearance, even if the variable classes with <hvn_lbll> “<em>haven_labelled, vctrs_vctr, double</em>” are unfamiliar. But we have now lost some information, especially we have to consult the codebook to know what the codes <code>1</code> and <code>2</code> mean.</p>
</div>
<div id="tabset-7-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-4-tab">
<p>The following strategy I have taken from the bookdown book <a href="http://asdfree.com/">Analyze Survey Data for Free</a> (asdf.com) It gives step by step instructions to explore public <a class='glossary' title='Microdata are unit-level data obtained from sample surveys, censuses, and administrative systems. They provide information about characteristics of individual people or entities such as households, business enterprises, facilities, farms or even geographical areas such as villages or towns. They allow in-depth understanding of socio-economic issues by studying relationships and interactions among phenomena. Microdata are thus key to designing projects and formulating policies, targeting interventions and monitoring and measuring the impact and results of projects, interventions and policies. (The World Bank)'>Microdata</a>. Here I refer to the <a class='glossary' title='A large survey of a sample of people in the United States conducted regularly since 1972; the General Social Survey is abbreviated GSS and is conducted by the National Opinion Research Center at the University of Chicago. (Harris, Glossary)'>General Social Survey</a> (GSS) section of the book.</p>
<div class="my-procedure">
<div class="my-procedure-header">
<div id="prp-chap01-get-gss2016-lodown" class="theorem proposition">
<p><span class="theorem-title"><strong>Procedure 1.3</strong></span> : Get the GSS data with the {<strong>lodown</strong>} package and glance at the data</p>
</div>
</div>
<div class="my-procedure-container">
<p>Working with {<strong>lodown</strong>} is a three step procedure:</p>
<ol type="1">
<li>Retrieve a listing of all available extracts for the GSS data.</li>
<li>Choose what files you want to download. In our case data for the year 2016.</li>
<li>Download the specified dataset in the offered SPSS file format, but {<strong>lodown</strong>} produces with <code>.rds</code> a native R file format with the name <code>2016.rds</code>.</li>
</ol>
</div>
</div>
<p>The second step has to be done manually but I have the result of my inspection already integrated in <a href="#lst-chap01-get-gss2016-lodown" class="quarto-xref">Listing <span class="quarto-unresolved-ref">lst-chap01-get-gss2016-lodown</span></a>.</p>
<p>As additional steps I renamed the downloaded file, so that I can distinguish it from similar files of the other approaches. Finally I glanced at the <code>grass</code> and <code>age</code> data.</p>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-get-gss2016-lodown" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.26</strong></span> : Get GSS data via {<strong>lodown</strong>} package</p>
</div>
</div>
<div class="my-r-code-container">
<div id="lst-chap01-get-gss2016-lodown" class="listing quarto-float">
<figure class="quarto-float quarto-float-lst">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-chap01-get-gss2016-lodown-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing 1.12: Get GSS data for the year 2016 via the {<strong>lodown</strong>} package
</figcaption>
<div aria-describedby="lst-chap01-get-gss2016-lodown-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb43"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="do">## can&#39;t suppress messages, tried several options</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="do">## run only once (manually) ############</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>my_folder <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">paste0</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;/data-raw&quot;</span>)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="co"># (1) retrieve a listing of all available extracts for the GSS data</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>gss_cat <span class="ot">&lt;-</span> lodown<span class="sc">::</span><span class="fu">get_catalog</span>(<span class="at">data_name =</span> <span class="st">&quot;gss&quot;</span>,</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">output_dir =</span> my_folder,</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;GSS&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="do">## (2) choose the catalog part to download</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>        output_filename <span class="sc">==</span> base<span class="sc">::</span><span class="fu">paste0</span>(my_folder, <span class="st">&quot;/2016.rds&quot;</span>))</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a><span class="do">## (3) download the GSS microdata as 2016.rds</span></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>lodown<span class="sc">::</span><span class="fu">lodown</span>(<span class="st">&quot;gss&quot;</span> , gss_cat)</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a><span class="do">## rename dataset to distinguish from other download approaches</span></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>old_filename <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">paste0</span>(my_folder, <span class="st">&quot;/2016.rds&quot;</span>)</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>new_filename <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">paste0</span>(my_folder, <span class="st">&quot;/gss_2016_cat.rds&quot;</span>)</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">file.rename</span>(<span class="at">from =</span> old_filename, <span class="at">to =</span> new_filename)</span></code></pre></div>
</details>
</div>
<p>(<em>This R code chunk has no visible output beside the warning message.</em>)</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb44"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="do">## load and glance at data</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>gss_2016_cat <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="st">&quot;data-raw/gss_2016_cat.rds&quot;</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>gss_2016_cat <span class="sc">|&gt;</span> </span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(age, grass)) <span class="sc">|&gt;</span> </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glance_data</span>(<span class="at">N =</span> <span class="dv">8</span>, <span class="at">seed =</span> <span class="dv">2016</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;     obs age grass
#&gt; 1     1  47    NA
#&gt; 2   172  27     1
#&gt; 3   562  70     2
#&gt; 4   898  60     2
#&gt; 5  1019  30     1
#&gt; 6  1176  80     2
#&gt; 7  1505  53    NA
#&gt; 8  1911  54     2
#&gt; 9  2622  62    NA
#&gt; 10 2867  72     2</code></pre>
</div>
</div>
</div>
</figure>
</div>
</div>
</div>
<p>The result is a pure <code>.rds</code> file where the columns are still of class “<em>haven_labelled, vctrs_vctr, double</em>” as in <a href="#lst-chap01-read-rds-data" class="quarto-xref">Listing <span class="quarto-unresolved-ref">lst-chap01-read-rds-data</span></a>.</p>
</div>
<div id="tabset-7-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-5-tab">
<p>Finally I will download the 2016 data with the help of the {<strong>gssr</strong>} package (see <a href="#pak-gssr" class="quarto-xref">Package Profile <span class="quarto-unresolved-ref">pak-gssr</span></a>). This takes some minutes. At first I missed the vignette, so I had to download the package again with the additional argument <code>build_vignettes = TRUE</code>. Whereas the vignette explains how to analyse data the GitHub is very helpful how to get the desired data.</p>
<blockquote>
<p>You can quickly get the data for any single GSS year by using <code>gssr::gss_get_yr()</code> to download the data file from NORC and put it directly into a tibble.</p>
</blockquote>
<p>After downloaded the file we can — as in the other tabs already done — load the file and glance at the grass/age data.</p>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-get-gss2016-gssr" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.27</strong></span> : Get GSS 2016 Year Data Set (cross-section only) and glance at the data</p>
</div>
</div>
<div class="my-r-code-container">
<div id="lst-chap01-get-gss2016-gssr-and-glance-at-data" class="listing quarto-float">
<figure class="quarto-float quarto-float-lst">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-chap01-get-gss2016-gssr-and-glance-at-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing 1.13: Get GSS 2016 Year Data Set (cross-section only) and glance at the data
</figcaption>
<div aria-describedby="lst-chap01-get-gss2016-gssr-and-glance-at-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb46"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="do">## run only once (manually) ####################</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>gss_2016_gssr <span class="ot">&lt;-</span> gssr<span class="sc">::</span><span class="fu">gss_get_yr</span>(<span class="at">year =</span> <span class="dv">2016</span>)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>gss_2016_gssr <span class="ot">&lt;-</span> gss_2016_gssr <span class="sc">|&gt;</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(age, grass))</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">saveRDS</span>(gss_2016_gssr, <span class="at">file =</span> <span class="st">&quot;data-raw/gss_2016_gssr.rds&quot;</span> )</span></code></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb47"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="do">## load data ####################</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>gss_2016_gssr <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="st">&quot;data-raw/gss_2016_gssr.rds&quot;</span>)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="do">## glance at data</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>gss_2016_gssr <span class="sc">|&gt;</span> </span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glance_data</span>(<span class="at">N =</span> <span class="dv">8</span>, <span class="at">seed =</span> <span class="dv">2016</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 10 × 3
#&gt;      obs age       grass                      
#&gt;    &lt;int&gt; &lt;dbl+lbl&gt; &lt;dbl+lbl&gt;                  
#&gt;  1     1 47        NA(i) [iap]                
#&gt;  2   172 27            1 [should be legal]    
#&gt;  3   562 70            2 [should not be legal]
#&gt;  4   898 60            2 [should not be legal]
#&gt;  5  1019 30            1 [should be legal]    
#&gt;  6  1176 80            2 [should not be legal]
#&gt;  7  1505 53        NA(i) [iap]                
#&gt;  8  1911 54            2 [should not be legal]
#&gt;  9  2622 62        NA(i) [iap]                
#&gt; 10  2867 72            2 [should not be legal]</code></pre>
</div>
</div>
</div>
</figure>
</div>
</div>
</div>
<p>Downloading data with {<strong>gssr</strong>} results in exactly the same format as in listing <a href="#lst-chap01-import-stata-2016-file" class="quarto-xref">Listing <span class="quarto-unresolved-ref">lst-chap01-import-stata-2016-file</span></a> from the manual download. But it has now the advantages from the {<strong>gssr</strong>} package. For instance with the integrated help it is much easier to</p>
<ul>
<li>find the variables</li>
<li>to read the question text of the variable</li>
<li>to see in which year the questions was asked</li>
<li>what the code - including the different types of NA’s mean</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="my-important">
<div class="my-important-header">
<p>Six different approaches to get the GSS data</p>
</div>
<div class="my-important-container">
<p>Using the {<strong>gssr</strong>} packages seems to me by far the best approach.</p>
</div>
</div>
</section>
</section>
<section id="sec-chap01-labelled-data" class="level2" data-number="1.8">
<h2 data-number="1.8"><span class="header-section-number">1.8</span> Working with Labelled Data</h2>
<section id="how-to-work-with-labelled-data-resources" class="level3" data-number="1.8.1">
<h3 data-number="1.8.1"><span class="header-section-number">1.8.1</span> How to work with labelled data? — Resources</h3>
<p>During downloading GSS data I mentioned that {<strong>haven</strong>} imports data as labelled vectors. As a completely new feature for me I looked at the Internet for their advantages and how to work with them. I found four important resources:</p>
<div class="my-resource">
<div class="my-resource-header">
<p>How to work with labelled data?</p>
</div>
<div class="my-resource-container">
<p><a href="https://socialresearchcentre.github.io/r_survey_datasets/">Survey Research Datasets and R</a></p>
<p>A book accompanying a workshop delivered for the 7th Biennial <a class='glossary' title='Australian Consortium for Social and Political Research Inc. oganizes conferences and delivers course. (ACSPRI)'>ACSPRI</a> Social Science Methodology Conference. It provides a practical demonstration of several packages for accessing and working with survey data, associated metadata and official statistics in R. The short book demonstrates</p>
<ul>
<li>Working with external data sources from common statistical packages (SPSS, SAS, Stata, Excel) and their quirks</li>
<li>Easily working with categorical data in R with the {<strong>labelled</strong>} R package</li>
<li>Accessing external databases in an R native way using {<strong>DBI</strong>} and {<strong>dbplyr</strong>} (The <a href="https://dbi.r-dbi.org/">DBI package</a> helps connecting R to database management systems (DBMS). <a href="https://dbplyr.tidyverse.org/">dbplyr</a> is a {<strong>dplyr</strong>} backend for data bases)</li>
<li>Accessing publicly available data in R scripts via the web</li>
<li>Resources for accessing official statistics data in R</li>
</ul>
<p>Here I am interested only in the first two demonstration. I will refer especially to the section on <a href="https://socialresearchcentre.github.io/r_survey_datasets/labelled-data.html">Labelled data</a>.</p>
<hr />
<div class="my-watch-out">
<div class="my-watch-out-header">
<p>WATCH OUT! {<strong>labelled</strong>} and {<strong>sjlabelled</strong>} have similar purposes and functions</p>
</div>
<div class="my-watch-out-container">
<p>{<strong>labelled</strong>} and {<strong>sjlabelled</strong>} are very similar. As far as I understand is the main difference that {<strong>sjlabelled</strong>} supports not only working with labelled data but also offers functions to benefit from these features. {<strong>labelled</strong>} in contrast manipulates labelled data only as an intermediate data structure that should be converted to common R classes, loosing these kind of meta-data.</p>
</div>
</div>
</div>
</div>
</section>
<section id="sec-chap01-labelled-data-2" class="level3" data-number="1.8.2">
<h3 data-number="1.8.2"><span class="header-section-number">1.8.2</span> Displaying data including labelled vectors</h3>
<p>To get comfortable with labelled data <a href="#def-chap01-show-labelled-data" class="quarto-xref">Experiment <span class="quarto-unresolved-ref">def-chap01-show-labelled-data</span></a> I will show how labelled data appear in different viewing functions. To inspect the possibilities of the {<strong>labelled</strong>} package see <a href="#def-chap01-use-labelled-haven-package" class="quarto-xref">Experiment <span class="quarto-unresolved-ref">def-chap01-use-labelled-haven-package</span></a>.</p>
<div class="my-experiment">
<div class="my-experiment-header">
<div id="def-chap01-show-labelled-data" class="theorem definition">
<p><span class="theorem-title"><strong>Experiment 1.3</strong></span> : Different types of data views with labelled data</p>
</div>
</div>
<div class="my-experiment-container">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">str()</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">attributes()</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-3" role="tab" aria-controls="tabset-8-3" aria-selected="false">head()</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-4" role="tab" aria-controls="tabset-8-4" aria-selected="false">tibble()</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-5" role="tab" aria-controls="tabset-8-5" aria-selected="false">glimpse()</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-6" role="tab" aria-controls="tabset-8-6" aria-selected="false">print()</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-7" role="tab" aria-controls="tabset-8-7" aria-selected="false">glance_data()</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-8" role="tab" aria-controls="tabset-8-8" aria-selected="false">RStudio</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-str-labelled-data" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.28</strong></span> : Display the internal structure of labelled data</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb49"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>utils<span class="sc">::</span><span class="fu">str</span>(gss_2016_gssr)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; tibble [2,867 × 2] (S3: tbl_df/tbl/data.frame)
#&gt;  $ age  : dbl+lbl [1:2867] 47, 61, 72, 43, 55, 53, 50, 23, 45, 71, 33, 86, 32, 6...
#&gt;    ..@ label       : chr &quot;age of respondent&quot;
#&gt;    ..@ format.stata: chr &quot;%29.0g&quot;
#&gt;    ..@ labels      : Named num [1:14] 89 NA NA NA NA NA NA NA NA NA ...
#&gt;    .. ..- attr(*, &quot;names&quot;)= chr [1:14] &quot;89 or older&quot; &quot;don&#39;t know&quot; &quot;iap&quot; &quot;I don&#39;t have a job&quot; ...
#&gt;  $ grass: dbl+lbl [1:2867] NA(i),     1,     2, NA(i),     1,     1, NA(i),     ...
#&gt;    ..@ label       : chr &quot;should marijuana be made legal&quot;
#&gt;    ..@ format.stata: chr &quot;%29.0g&quot;
#&gt;    ..@ labels      : Named num [1:15] 1 2 NA NA NA NA NA NA NA NA ...
#&gt;    .. ..- attr(*, &quot;names&quot;)= chr [1:15] &quot;should be legal&quot; &quot;should not be legal&quot; &quot;don&#39;t know&quot; &quot;iap&quot; ...</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-attributes-labelled-data" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.29</strong></span> : Show attributes of labelled data</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb51"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">attributes</span>(gss_2016_gssr<span class="sc">$</span>grass)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; $label
#&gt; [1] &quot;should marijuana be made legal&quot;
#&gt; 
#&gt; $format.stata
#&gt; [1] &quot;%29.0g&quot;
#&gt; 
#&gt; $class
#&gt; [1] &quot;haven_labelled&quot; &quot;vctrs_vctr&quot;     &quot;double&quot;        
#&gt; 
#&gt; $labels
#&gt;               should be legal           should not be legal 
#&gt;                             1                             2 
#&gt;                    don&#39;t know                           iap 
#&gt;                            NA                            NA 
#&gt;            I don&#39;t have a job                   dk, na, iap 
#&gt;                            NA                            NA 
#&gt;                     no answer                 not imputable 
#&gt;                            NA                            NA 
#&gt;                 not imputable                       refused 
#&gt;                            NA                            NA 
#&gt;                skipped on web                    uncodeable 
#&gt;                            NA                            NA 
#&gt; not available in this release    not available in this year 
#&gt;                            NA                            NA 
#&gt;                  see codebook 
#&gt;                            NA</code></pre>
</div>
</div>
<p>This works only with vectors (variables), but not with data frames. You can display specific list values with numbers (e.g., <code>attributes(gss_2016_gssr$grass)[[4]]</code>) or names (e.g., <code>attributes(gss_2016_gssr$grass)[["labels"]]</code>).</p>
</div>
</div>
</div>
<div id="tabset-8-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-3-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-head-labelled-data" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.30</strong></span> : Show first six records of the labelled variable</p>
</div>
</div>
<div class="my-r-code-container">
<div id="lst-chap01-head-labelled-data" class="listing quarto-float">
<figure class="quarto-float quarto-float-lst">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-chap01-head-labelled-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing 1.14: Use <code>head()</code> to show the first six records of the labelled variable.
</figcaption>
<div aria-describedby="lst-chap01-head-labelled-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb53"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(gss_2016_gssr<span class="sc">$</span>grass)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; &lt;labelled&lt;double&gt;[6]&gt;: should marijuana be made legal
#&gt; [1] NA(i)     1     2 NA(i)     1     1
#&gt; 
#&gt; Labels:
#&gt;  value                         label
#&gt;      1               should be legal
#&gt;      2           should not be legal
#&gt;  NA(d)                    don&#39;t know
#&gt;  NA(i)                           iap
#&gt;  NA(j)            I don&#39;t have a job
#&gt;  NA(m)                   dk, na, iap
#&gt;  NA(n)                     no answer
#&gt;  NA(p)                 not imputable
#&gt;  NA(q)                 not imputable
#&gt;  NA(r)                       refused
#&gt;  NA(s)                skipped on web
#&gt;  NA(u)                    uncodeable
#&gt;  NA(x) not available in this release
#&gt;  NA(y)    not available in this year
#&gt;  NA(z)                  see codebook</code></pre>
</div>
</div>
</div>
</figure>
</div>
<hr />
<p>This works only with labelled vectors (variables), but not with data frames.</p>
</div>
</div>
</div>
<div id="tabset-8-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-4-tab">
<blockquote>
<p>One immediate advantage of labelled vectors is that value labels are used in data frame printing when using <a href="https://tibble.tidyverse.org/">tibble</a> (and by extension the wider tidyverse) and other packages using the <a href="https://cran.r-project.org/web/packages/pillar/index.html">pillar</a> printing methods. (<a href="https://socialresearchcentre.github.io/r_survey_datasets/what-is-labelled-data.html">Survey Research Datasets and R</a>)</p>
</blockquote>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-tibble-labelled-data" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.31</strong></span> : Using <code>tibble</code> resp. <code>pillar</code> printing methods</p>
</div>
</div>
<div class="my-r-code-container">
<div id="lst-chap01-tibble-labelled-data" class="listing quarto-float">
<figure class="quarto-float quarto-float-lst">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-chap01-tibble-labelled-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing 1.15: Using <code>tibble</code> resp. <code>pillar</code> printing methods to display NA’s
</figcaption>
<div aria-describedby="lst-chap01-tibble-labelled-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb55"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>gss_2016_gssr <span class="sc">|&gt;</span> </span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">count</span>(grass)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 3 × 2
#&gt;   grass                           n
#&gt;   &lt;dbl+lbl&gt;                   &lt;int&gt;
#&gt; 1     1 [should be legal]      1126
#&gt; 2     2 [should not be legal]   717
#&gt; 3 NA(i) [iap]                  1024</code></pre>
</div>
</div>
</div>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-8-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-5-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-glimpse-labelled-data" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.32</strong></span> : Get a glimpse of labelled data</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb57"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(gss_2016_gssr)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; Rows: 2,867
#&gt; Columns: 2
#&gt; $ age   &lt;dbl+lbl&gt; 47, 61, 72, 43, 55, 53, 50, 23, 45, 71, 33, 86, 32, 60, 76, …
#&gt; $ grass &lt;dbl+lbl&gt; NA(i),     1,     2, NA(i),     1,     1, NA(i),     2, NA(i…</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-8-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-6-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-print-labelled-data" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.33</strong></span> : Print values as <code>tibble()</code> with labelled data</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb59"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">print</span>(gss_2016_gssr)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 2,867 × 2
#&gt;    age       grass                      
#&gt;    &lt;dbl+lbl&gt; &lt;dbl+lbl&gt;                  
#&gt;  1 47        NA(i) [iap]                
#&gt;  2 61            1 [should be legal]    
#&gt;  3 72            2 [should not be legal]
#&gt;  4 43        NA(i) [iap]                
#&gt;  5 55            1 [should be legal]    
#&gt;  6 53            1 [should be legal]    
#&gt;  7 50        NA(i) [iap]                
#&gt;  8 23            2 [should not be legal]
#&gt;  9 45        NA(i) [iap]                
#&gt; 10 71            2 [should not be legal]
#&gt; # ℹ 2,857 more rows</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-8-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-7-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-glance-labelled-data" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.34</strong></span> : Glance randomly at some records with labelled data</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb61"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>gss_2016_gssr <span class="sc">|&gt;</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glance_data</span>(<span class="at">N =</span> <span class="dv">8</span>, <span class="at">seed =</span> <span class="dv">2016</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 10 × 3
#&gt;      obs age       grass                      
#&gt;    &lt;int&gt; &lt;dbl+lbl&gt; &lt;dbl+lbl&gt;                  
#&gt;  1     1 47        NA(i) [iap]                
#&gt;  2   172 27            1 [should be legal]    
#&gt;  3   562 70            2 [should not be legal]
#&gt;  4   898 60            2 [should not be legal]
#&gt;  5  1019 30            1 [should be legal]    
#&gt;  6  1176 80            2 [should not be legal]
#&gt;  7  1505 53        NA(i) [iap]                
#&gt;  8  1911 54            2 [should not be legal]
#&gt;  9  2622 62        NA(i) [iap]                
#&gt; 10  2867 72            2 [should not be legal]</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-8-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-8-tab">
<p>In RStudio you can see part of the labels by supplying additional information about NAs in R code chunks and variable labels in the RStudio viewer.</p>
<div id="fig-rstudio-labelled-data" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-rstudio-labelled-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-rstudio-labelled-data" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-rstudio-chunk" class="quarto-figure quarto-figure-center quarto-float">
<figure class="quarto-float quarto-subfloat-fig">
<div aria-describedby="fig-rstudio-chunk-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="img/chap01/rstudio-r-chunk-labelled-data-min.png" class="lightbox" data-glightbox="description: .lightbox-desc-14" data-gallery="fig-rstudio-labelled-data"><img src="img/chap01/rstudio-r-chunk-labelled-data-min.png" class="img-fluid" data-ref-parent="fig-rstudio-labelled-data" /></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-rstudio-chunk-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Labelled data as a R code chunk result in RStudio
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-rstudio-labelled-data" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-rstudio-viewer" class="quarto-figure quarto-figure-center quarto-float">
<figure class="quarto-float quarto-subfloat-fig">
<div aria-describedby="fig-rstudio-viewer-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="img/chap01/rstudio-viewer-labelled-data-min.png" class="lightbox" data-glightbox="description: .lightbox-desc-15" data-gallery="fig-rstudio-labelled-data"><img src="img/chap01/rstudio-viewer-labelled-data-min.png" class="img-fluid" data-ref-parent="fig-rstudio-labelled-data" /></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-rstudio-viewer-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Labelled data in RStudio data viewer
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-rstudio-labelled-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Graph 1.8: RStudio display of labelled data
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p><code>base::summary()</code> with data frames that contain labelled data generates an error when {<strong>haven</strong>} is not loaded:</p>
<blockquote>
<p>! <code>summary.haven_labelled()</code> not implemented.</p>
</blockquote>
<div class="my-important">
<div class="my-important-header">
<p>Labelled meta data not visible in most base R viewing functions</p>
</div>
<div class="my-important-container">
<p>With the exception of <code>base::str()</code> labelled meta data are not visible when viewing at the printed data.</p>
<p>And even more important: You can’t see the different types of NA’s without specialized functions. “Tagged” (labelled) missing values behaves exactly like regular R missing values. For more information see <a href="#def-chap01-use-labelled-haven-package" class="quarto-xref">Experiment <span class="quarto-unresolved-ref">def-chap01-use-labelled-haven-package</span></a>.</p>
</div>
</div>
</section>
<section id="sec-chap01-labelled-data-3" class="level3" data-number="1.8.3">
<h3 data-number="1.8.3"><span class="header-section-number">1.8.3</span> Working with labelled data</h3>
<section id="two-different-approaches" class="level4" data-number="1.8.3.1">
<h4 data-number="1.8.3.1"><span class="header-section-number">1.8.3.1</span> Two different approaches</h4>
<blockquote>
<p>The purpose of the labelled package is to provide functions to manipulate metadata as variable labels, value labels and defined missing values using the <code>haven_labelled</code> and <code>haven_labelled_spss</code> classes introduced in haven package. (<a href="https://cran.r-project.org/web/packages/labelled/vignettes/intro_labelled.html">Introduction to labelled</a>)</p>
</blockquote>
<p>Until now I have not worked in this book with <code>haven_labelled_spss</code> classes. This class comes from imports of SPSS data files via the {<strong>haven</strong>} package.</p>
<blockquote>
<p>This class is only used when <code>user_na = TRUE</code> in <code>read_sav()</code>. It is similar to the <code>labelled()</code> class but it also models SPSS’s user-defined missings, which can be up to three distinct values, or for numeric vectors a range. (<a href="https://haven.tidyverse.org/reference/labelled_spss.html">Labelled vector for SPSS</a>) <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
</blockquote>
<p>As user-defined missing values are not important here I will stick with STATA imports.</p>
<p>My main interest with <a href="#def-chap01-use-labelled-haven-package" class="quarto-xref">Experiment <span class="quarto-unresolved-ref">def-chap01-use-labelled-haven-package</span></a> is to prepare and/or use the labelled data to work with R. There are principal two approaches:</p>
<div class="my-procedure">
<div class="my-procedure-header">
<div id="prp-chap01-labelled-data-in-r" class="theorem proposition">
<p><span class="theorem-title"><strong>Procedure 1.4</strong></span> : Two different procedures to work in R with labelled data</p>
</div>
</div>
<div class="my-procedure-container">
<p><strong>Approach A</strong></p>
<blockquote>
<p>In approach A, <code>haven_labelled</code> vectors are converted into factors or into numeric/character vectors just after data import, using <code>unlabelled()</code>, <code>to_factor()</code> or <code>unclass()</code>. Then, data cleaning, recoding and analysis are performed using classic R vector types.</p>
</blockquote>
<ol type="1">
<li>Data import</li>
<li><em>Conversion to factor / numeric</em></li>
<li>Data cleaning / data recoding</li>
<li>Data analysis</li>
</ol>
<p><strong>Approach B</strong></p>
<blockquote>
<p>In approach B, <code>haven_labelled</code> vectors are kept for data cleaning and coding, allowing to preserved original recoding, in particular if data should be reexported after that step. Functions provided by labelled will be useful for managing value labels. However, as in approach A, <code>haven_labelled</code> vectors will have to be converted into classic factors or numeric vectors before data analysis (in particular modeling) as this is the way categorical and continuous variables should be coded for analysis functions. (<a href="https://cran.r-project.org/web/packages/labelled/vignettes/intro_labelled.html">Introduction to labelled</a>)</p>
</blockquote>
<ol type="1">
<li>Data import</li>
<li>Data cleaning / data recoding (-&gt; Data export to SPSS / SAS / STATA )</li>
<li><em>Conversion to factor / numeric</em></li>
<li>Data analysis</li>
</ol>
<div id="fig-chap01-two-approaches-with-labelled-data" class="quarto-figure quarto-figure-center quarto-float">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-chap01-two-approaches-with-labelled-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="https://cran.r-project.org/web/packages/labelled/vignettes/intro_labelled.html"><span class="lightbox" data-glightbox="description: .lightbox-desc-16" data-gallery="quarto-lightbox-gallery-16"><img src="img/chap01/labelled-approaches-min.png" class="img-fluid" /></span></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-chap01-two-approaches-with-labelled-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Graph 1.9: Two different approaches to work in R with labelled data
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="inspecting-labelled-data" class="level4" data-number="1.8.3.2">
<h4 data-number="1.8.3.2"><span class="header-section-number">1.8.3.2</span> Inspecting labelled data</h4>
<div class="my-experiment">
<div class="my-experiment-header">
<div id="def-chap01-use-labelled-haven-package" class="theorem definition">
<p><span class="theorem-title"><strong>Experiment 1.4</strong></span> : Inspecting labelled data</p>
</div>
</div>
<div class="my-experiment-container">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">var_label()</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">val_labels()</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-3" role="tab" aria-controls="tabset-9-3" aria-selected="false">head()</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-4" role="tab" aria-controls="tabset-9-4" aria-selected="false">Print labels</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-5" role="tab" aria-controls="tabset-9-5" aria-selected="false">Unique NA’s</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-6" role="tab" aria-controls="tabset-9-6" aria-selected="false">NA composition</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-labelled-var-label" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.35</strong></span> : Get variable labels of a labelled data frame</p>
</div>
</div>
<div class="my-r-code-container">
<div id="lst-chap01-labelled-var-label" class="listing quarto-float">
<figure class="quarto-float quarto-float-lst">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-chap01-labelled-var-label-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing 1.16: Use <code>labelled::var_label()</code> to get variables labels of a data frame
</figcaption>
<div aria-describedby="lst-chap01-labelled-var-label-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb63"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>labelled<span class="sc">::</span><span class="fu">var_label</span>(gss_2016_gssr) </span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; $age
#&gt; [1] &quot;age of respondent&quot;
#&gt; 
#&gt; $grass
#&gt; [1] &quot;should marijuana be made legal&quot;</code></pre>
</div>
</div>
</div>
</figure>
</div>
<p>The labels of the two variable specifies in more detail their content. For the <code>grass</code> variable we get the question asked in the survey. This is very helpful and saves consulting the codebook.</p>
<hr />
</div>
</div>
<p>I am using here the short form with <code>labelled::var_label()</code> but there exist also with <code>labelled::get_variable_labels()</code> a long form which has with it plural form a more consistent syntax.</p>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-labelled-val-labels" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.36</strong></span> : Get value labels of data frame variables</p>
</div>
</div>
<div class="my-r-code-container">
<div id="lst-chap01-labelled-val-labels" class="listing quarto-float">
<figure class="quarto-float quarto-float-lst">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-chap01-labelled-val-labels-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing 1.17: Use <code>labelled::val_labels()</code> to get value labels of data frame variables
</figcaption>
<div aria-describedby="lst-chap01-labelled-val-labels-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb65"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>labelled<span class="sc">::</span><span class="fu">val_labels</span>(gss_2016_gssr)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; $age
#&gt;                   89 or older                    don&#39;t know 
#&gt;                            89                            NA 
#&gt;                           iap            I don&#39;t have a job 
#&gt;                            NA                            NA 
#&gt;                   dk, na, iap                     no answer 
#&gt;                            NA                            NA 
#&gt;                 not imputable                 not imputable 
#&gt;                            NA                            NA 
#&gt;                       refused                skipped on web 
#&gt;                            NA                            NA 
#&gt;                    uncodeable not available in this release 
#&gt;                            NA                            NA 
#&gt;    not available in this year                  see codebook 
#&gt;                            NA                            NA 
#&gt; 
#&gt; $grass
#&gt;               should be legal           should not be legal 
#&gt;                             1                             2 
#&gt;                    don&#39;t know                           iap 
#&gt;                            NA                            NA 
#&gt;            I don&#39;t have a job                   dk, na, iap 
#&gt;                            NA                            NA 
#&gt;                     no answer                 not imputable 
#&gt;                            NA                            NA 
#&gt;                 not imputable                       refused 
#&gt;                            NA                            NA 
#&gt;                skipped on web                    uncodeable 
#&gt;                            NA                            NA 
#&gt; not available in this release    not available in this year 
#&gt;                            NA                            NA 
#&gt;                  see codebook 
#&gt;                            NA</code></pre>
</div>
</div>
</div>
</figure>
</div>
</div>
</div>
<p>Important is the start of the list of value labels.</p>
<ul>
<li><strong>age</strong>: It shows that the value <code>89</code> of variable <code>age</code> includes values of <code>89 and older</code>. This is important for the analysis and saves the work of recoding as done in
<ol class="example" type="1">
<li></li>
</ol></li>
<li><strong>grass</strong>: For the <code>grass</code> variable we learn that <code>1</code> stands for the opinion that Marijuana “should be legal” and two for the opposite.</li>
</ul>
<p>What follows is a comprehensive list of NA values used in the survey, even if many of these values are not used for the two variables considered here.</p>
<p>We know from <a href="#cnj-chap01-tibble-labelled-data" class="quarto-xref">R Code <span class="quarto-unresolved-ref">cnj-chap01-tibble-labelled-data</span></a> that the <code>grass</code> variable has 1024 NA’s, but we do not know their composition of different NA values. See <a href="#lst-chap01-haven-na-tag" class="quarto-xref">Listing <span class="quarto-unresolved-ref">lst-chap01-haven-na-tag</span></a> how to get this information.</p>
<hr />
<div class="my-watch-out">
<div class="my-watch-out-header">
<p>WATCH OUT! Inconsistency in the function names</p>
</div>
<div class="my-watch-out-container">
<p>There is an inconsistency in the singular vs. plural form between <code>labelled::var_label()</code> and <code>labelled::val_labels()</code>. Both functions show a <em>list of values</em> (= plural) if there are more than one label available.</p>
<p>For value labels exist also a singular version with <code>labelled::val_label()</code> to get a specific value label of a variable.</p>
</div>
</div>
</div>
<div id="tabset-9-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-3-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-labelled-head" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.37</strong></span> : Using <code>utils::head()</code> on a labelled variable after {<strong>labelled</strong>} is loaded</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb67"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="do">## {**labelled**} is loaded through a call in the previous chunk</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>utils<span class="sc">::</span><span class="fu">head</span>(gss_2016_gssr<span class="sc">$</span>grass, <span class="dv">10</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; &lt;labelled&lt;double&gt;[10]&gt;: should marijuana be made legal
#&gt;  [1] NA(i)     1     2 NA(i)     1     1 NA(i)     2 NA(i)     2
#&gt; 
#&gt; Labels:
#&gt;  value                         label
#&gt;      1               should be legal
#&gt;      2           should not be legal
#&gt;  NA(d)                    don&#39;t know
#&gt;  NA(i)                           iap
#&gt;  NA(j)            I don&#39;t have a job
#&gt;  NA(m)                   dk, na, iap
#&gt;  NA(n)                     no answer
#&gt;  NA(p)                 not imputable
#&gt;  NA(q)                 not imputable
#&gt;  NA(r)                       refused
#&gt;  NA(s)                skipped on web
#&gt;  NA(u)                    uncodeable
#&gt;  NA(x) not available in this release
#&gt;  NA(y)    not available in this year
#&gt;  NA(z)                  see codebook</code></pre>
</div>
</div>
<hr />
<p>Using <code>utils::head()</code> on a variable when {<strong>labelled</strong>} is loaded prints a nicely formatted summary of the attached metadata, excluding formats. It shows all NA value labels in the data frame used in the survey, even only some of them is used here. (See <a href="#lst-chap01-haven-na-tag" class="quarto-xref">Listing <span class="quarto-unresolved-ref">lst-chap01-haven-na-tag</span></a> to get type of NA’s used for a variable.)</p>
<p>We see in the first 10 records of the variable <code>grass</code></p>
<ul>
<li>three <code>1</code> (“should be legal”)</li>
<li>three <code>2</code> (“should not be legal”) and</li>
<li>four <code>NA(i)</code> (“iap”)</li>
</ul>
<p>Until now it is not clear what “iap” for the <code>NA(i)</code> type means. If we want <a href="https://gss.norc.org/get-the-data/stata">download (STATA) files directly from the GSS website</a> we see on the right side a note about the most important <code>NA</code> types. It explains the the abbreviation “iap” stands for “inapplicable”.</p>
<div id="fig-chap01-gss-na-note" class="quarto-figure quarto-figure-center quarto-float" data-fig-align="center" alt="An &quot;Alerts&quot; explains that there are three main missing values in the data; &quot;.i&quot;: Inapplicable (IAP). Respondents whor are not asked to answer a specific question are assigned to IAP.&quot;.d&quot;: Don&#39;t know (DK). &quot;.n&quot;: No answer (NA).">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-chap01-gss-na-note-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="https://gss.norc.org/get-the-data/stata"><span class="lightbox" data-glightbox="description: .lightbox-desc-17" data-gallery="quarto-lightbox-gallery-17"><img src="img/chap01/na-gss-website-note-min.png" class="img-fluid quarto-figure quarto-figure-center" alt="An &quot;Alerts&quot; explains that there are three main missing values in the data; &quot;.i&quot;: Inapplicable (IAP). Respondents whor are not asked to answer a specific question are assigned to IAP.&quot;.d&quot;: Don&#39;t know (DK). &quot;.n&quot;: No answer (NA)." /></span></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-chap01-gss-na-note-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Graph 1.10: GSS Information about the most important NA types
</figcaption>
</figure>
</div>
<div class="my-note">
<div class="my-note-header">
<p>Two different meanings of “NA”</p>
</div>
<div class="my-note-container">
<p>With the <code>NA(n)</code> type of missing value “NA” does not mean “Not Applicable” but “No answer”.</p>
</div>
</div>
<p>Returning only the <code>NA(i)</code> type of a missing value does not mean that there aren’t any other NA types in the data. (See <a href="#lst-chap01-labelled-print-unique-tagged" class="quarto-xref">Listing <span class="quarto-unresolved-ref">lst-chap01-labelled-print-unique-tagged</span></a> to get the types of tagged NA’s of a variable.)</p>
</div>
</div>
<p>This formatted result of labelled data is better readable as with <a href="#lst-chap01-labelled-val-labels" class="quarto-xref">Listing <span class="quarto-unresolved-ref">lst-chap01-labelled-val-labels</span></a>, because category and value are in the same line. Compare the result of this code ({<strong>labelled</strong>} is loaded) with <a href="#lst-chap01-head-labelled-data" class="quarto-xref">Listing <span class="quarto-unresolved-ref">lst-chap01-head-labelled-data</span></a> ({<strong>labelled</strong>} is not loaded).</p>
<div class="my-note">
<div class="my-note-header">
<p>haven::print_labels() as equivalent of head() with {<strong>labelled</strong>} loaded</p>
</div>
<div class="my-note-container">
<p>With the exception of the specified rows in the <code>head()</code> function, you can get the same nicely formatted list of NA types with <code>haven::print_labels()</code>. (See next tab “Print labels”.)</p>
</div>
</div>
</div>
<div id="tabset-9-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-4-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-haven-print-labels" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.38</strong></span> : Print labels</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb69"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>haven<span class="sc">::</span><span class="fu">print_labels</span>(gss_2016_gssr<span class="sc">$</span>grass)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt; Labels:
#&gt;  value                         label
#&gt;      1               should be legal
#&gt;      2           should not be legal
#&gt;  NA(d)                    don&#39;t know
#&gt;  NA(i)                           iap
#&gt;  NA(j)            I don&#39;t have a job
#&gt;  NA(m)                   dk, na, iap
#&gt;  NA(n)                     no answer
#&gt;  NA(p)                 not imputable
#&gt;  NA(q)                 not imputable
#&gt;  NA(r)                       refused
#&gt;  NA(s)                skipped on web
#&gt;  NA(u)                    uncodeable
#&gt;  NA(x) not available in this release
#&gt;  NA(y)    not available in this year
#&gt;  NA(z)                  see codebook</code></pre>
</div>
</div>
</div>
</div>
<p>For a detailed explication see previous tab “head()”.</p>
</div>
<div id="tabset-9-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-5-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-labelled-print-unique-tagged" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.39</strong></span> : Print unique tagged NA’s</p>
</div>
</div>
<div class="my-r-code-container">
<div id="lst-chap01-labelled-print-unique-tagged" class="listing quarto-float">
<figure class="quarto-float quarto-float-lst">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-chap01-labelled-print-unique-tagged-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing 1.18: Show the unique types of NA’s of a variable
</figcaption>
<div aria-describedby="lst-chap01-labelled-print-unique-tagged-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb71"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>labelled<span class="sc">::</span><span class="fu">unique_tagged_na</span>(gss_2016_gssr<span class="sc">$</span>grass) <span class="sc">|&gt;</span> </span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>    labelled<span class="sc">::</span><span class="fu">sort_tagged_na</span>() <span class="sc">|&gt;</span> </span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>    haven<span class="sc">::</span><span class="fu">print_tagged_na</span>()</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1]     1     2 NA(d) NA(i) NA(n)</code></pre>
</div>
</div>
</div>
</figure>
</div>
<hr />
<p>We see that variable <code>grass</code> has three types of NA’s:</p>
<p><code>NA(d)</code>: Don’t know. <code>NA(i)</code>: Inapplicable, e.g., these respondents were not asked the marijuana question. <code>NA(n)</code>: No answer</p>
<p>Here I have used <code>haven::print_tagged_na()</code> to format tagged NA’s as <code>NA(a)</code>, <code>NA(b)</code>, etc. (See <a href="https://haven.tidyverse.org/reference/tagged_na.html">“Tagged” missing values</a>)</p>
</div>
</div>
<p>It would be interesting to know the composition of these different NA types. One could reason that there is a big difference between “question not asked” and “no answer”. (See <a href="#lst-chap01-haven-na-tag" class="quarto-xref">Listing <span class="quarto-unresolved-ref">lst-chap01-haven-na-tag</span></a> to get the composition of the NA types.)</p>
</div>
<div id="tabset-9-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-6-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-haven-na-tag" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.40</strong></span> : Get the composition of the different types of tagged NA’s</p>
</div>
</div>
<div class="my-r-code-container">
<div id="lst-chap01-haven-na-tag" class="listing quarto-float">
<figure class="quarto-float quarto-float-lst">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-chap01-haven-na-tag-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing 1.19: Get the composition of the different types of tagged NA’s
</figcaption>
<div aria-describedby="lst-chap01-haven-na-tag-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb73"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>gss_2016_gssr <span class="sc">|&gt;</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">count</span>(</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>    grass,</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>    haven<span class="sc">::</span><span class="fu">na_tag</span>(grass)</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 5 × 3
#&gt;   grass                       `haven::na_tag(grass)`     n
#&gt;   &lt;dbl+lbl&gt;                   &lt;chr&gt;                  &lt;int&gt;
#&gt; 1     1 [should be legal]     &lt;NA&gt;                    1126
#&gt; 2     2 [should not be legal] &lt;NA&gt;                     717
#&gt; 3 NA(d) [don&#39;t know]          d                        110
#&gt; 4 NA(i) [iap]                 i                        911
#&gt; 5 NA(n) [no answer]           n                          3</code></pre>
</div>
</div>
</div>
</figure>
</div>
<hr />
<p>We already know from <a href="#lst-chap01-tibble-labelled-data" class="quarto-xref">Listing <span class="quarto-unresolved-ref">lst-chap01-tibble-labelled-data</span></a> that the variable <code>grass</code> has 1024 NA’s. Now we know also the type composition of these NA’s.</p>
</div>
</div>
<p>I could not find a similar function in {<strong>labelled</strong>}, so I have used here <code>haven::na_tag()</code>.</p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="working-with-labelled-data" class="level4" data-number="1.8.3.3">
<h4 data-number="1.8.3.3"><span class="header-section-number">1.8.3.3</span> Working with labelled data</h4>
<p>There are two ways to work with labelled data in R:</p>
<blockquote>
<p>The goal of haven is not to provide a labelled vector that you can use everywhere in your analysis. The goal is to provide an intermediate datastructure that you can convert into a regular R data frame. You can do this by either converting to a factor or stripping the labels ({<strong>Haven</strong>} vignette <a href="https://haven.tidyverse.org/articles/semantics.html">Conversion semantics</a>)</p>
</blockquote>
<div class="my-experiment">
<div class="my-experiment-header">
<div id="def-conversion-labelled-data" class="theorem definition">
<p><span class="theorem-title"><strong>Experiment 1.5</strong></span> : How to convert labelled data for data analysis in R</p>
</div>
</div>
<div class="my-experiment-container">
<p>The second variable <code>grass</code> is the labelled original variable. The third variable (last column to the right) is the modified <code>grass</code> variable.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">as_factor()</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">zap_labels()</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-3" role="tab" aria-controls="tabset-10-3" aria-selected="false">zap_missing()</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-4" role="tab" aria-controls="tabset-10-4" aria-selected="false">zap_label()</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-haven-as-factor" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.41</strong></span> : Convert labelled vectors to factors</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb75"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>gss_2016_grass <span class="ot">&lt;-</span> gss_2016_gssr <span class="sc">|&gt;</span> </span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(grass)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>gss_2016_grass <span class="sc">|&gt;</span> </span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">grass_factor =</span> haven<span class="sc">::</span><span class="fu">as_factor</span>(grass)) <span class="sc">|&gt;</span> </span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glance_data</span>(<span class="at">N =</span> <span class="dv">8</span>, <span class="at">seed =</span> <span class="dv">42</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 10 × 3
#&gt;      obs grass                       grass_factor       
#&gt;    &lt;int&gt; &lt;dbl+lbl&gt;                   &lt;fct&gt;              
#&gt;  1     1 NA(i) [iap]                 iap                
#&gt;  2   634 NA(i) [iap]                 iap                
#&gt;  3  1098     1 [should be legal]     should be legal    
#&gt;  4  1152     1 [should be legal]     should be legal    
#&gt;  5  1177 NA(i) [iap]                 iap                
#&gt;  6  1252 NA(i) [iap]                 iap                
#&gt;  7  2097     1 [should be legal]     should be legal    
#&gt;  8  2369     1 [should be legal]     should be legal    
#&gt;  9  2609     1 [should be legal]     should be legal    
#&gt; 10  2867     2 [should not be legal] should not be legal</code></pre>
</div>
</div>
<p>Here I am using <code>haven::as_factor()</code>. This function also knows how to re-label missing values.</p>
</div>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-haven-zap-labels" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.42</strong></span> : Remove labels</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb77"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>gss_2016_grass <span class="sc">|&gt;</span> </span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">grass_unlabelled =</span> haven<span class="sc">::</span><span class="fu">zap_labels</span>(grass)) <span class="sc">|&gt;</span> </span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glance_data</span>(<span class="at">N =</span> <span class="dv">8</span>, <span class="at">seed =</span> <span class="dv">42</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 10 × 3
#&gt;      obs grass                       grass_unlabelled
#&gt;    &lt;int&gt; &lt;dbl+lbl&gt;                              &lt;dbl&gt;
#&gt;  1     1 NA(i) [iap]                               NA
#&gt;  2   634 NA(i) [iap]                               NA
#&gt;  3  1098     1 [should be legal]                    1
#&gt;  4  1152     1 [should be legal]                    1
#&gt;  5  1177 NA(i) [iap]                               NA
#&gt;  6  1252 NA(i) [iap]                               NA
#&gt;  7  2097     1 [should be legal]                    1
#&gt;  8  2369     1 [should be legal]                    1
#&gt;  9  2609     1 [should be legal]                    1
#&gt; 10  2867     2 [should not be legal]                2</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-10-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-3-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-haven-zap-missing" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.43</strong></span> : Convert special missings to regular R missings</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb79"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>gss_2016_grass <span class="sc">|&gt;</span> </span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">grass_rgular_na =</span> haven<span class="sc">::</span><span class="fu">zap_missing</span>(grass)) <span class="sc">|&gt;</span> </span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glance_data</span>(<span class="at">N =</span> <span class="dv">8</span>, <span class="at">seed =</span> <span class="dv">42</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 10 × 3
#&gt;      obs grass                       grass_rgular_na         
#&gt;    &lt;int&gt; &lt;dbl+lbl&gt;                   &lt;dbl+lbl&gt;               
#&gt;  1     1 NA(i) [iap]                 NA                      
#&gt;  2   634 NA(i) [iap]                 NA                      
#&gt;  3  1098     1 [should be legal]      1 [should be legal]    
#&gt;  4  1152     1 [should be legal]      1 [should be legal]    
#&gt;  5  1177 NA(i) [iap]                 NA                      
#&gt;  6  1252 NA(i) [iap]                 NA                      
#&gt;  7  2097     1 [should be legal]      1 [should be legal]    
#&gt;  8  2369     1 [should be legal]      1 [should be legal]    
#&gt;  9  2609     1 [should be legal]      1 [should be legal]    
#&gt; 10  2867     2 [should not be legal]  2 [should not be legal]</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-10-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-4-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-haven-zap-label" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.44</strong></span> : Remove variable labels from a data frame</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb81"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;*******   Original data frame   ********&quot;</span>)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>labelled<span class="sc">::</span><span class="fu">var_label</span>(gss_2016_gssr)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;*******   Data frame after variable zapped   *******&quot;</span>)</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>gss_2016_gssr <span class="sc">|&gt;</span> </span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>    haven<span class="sc">::</span><span class="fu">zap_label</span>() <span class="sc">|&gt;</span> </span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>    labelled<span class="sc">::</span><span class="fu">var_label</span>()</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] &quot;*******   Original data frame   ********&quot;
#&gt; $age
#&gt; [1] &quot;age of respondent&quot;
#&gt; 
#&gt; $grass
#&gt; [1] &quot;should marijuana be made legal&quot;
#&gt; 
#&gt; [1] &quot;*******   Data frame after variable zapped   *******&quot;
#&gt; $age
#&gt; NULL
#&gt; 
#&gt; $grass
#&gt; NULL</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<p>You can combine all three zap-commands.</p>
</div>
</div>
</section>
</section>
</section>
<section id="table-excursion" class="level2" data-number="1.9">
<h2 data-number="1.9"><span class="header-section-number">1.9</span> Table excursion</h2>
<section id="sec-chap01-review-table-packages" class="level3" data-number="1.9.1">
<h3 data-number="1.9.1"><span class="header-section-number">1.9.1</span> Review several table packages</h3>
<p>Creating tables is an important result of preparing data — the main subject of this section. In my research I came up with eight packages that seems to me the most important ones. What follows is a short introduction into these packages.</p>
<div class="my-experiment">
<div class="my-experiment-header">
<div id="def-chap01-review-table-packages" class="theorem definition">
<p><span class="theorem-title"><strong>Experiment 1.6</strong></span> : Review table packages: {<strong>DT</strong>}, {<strong>flextable</strong>}, {<strong>gt</strong>}, {<strong>gtsummary</strong>}, {<strong>htmlTable</strong>}, {<strong>kableExtra</strong>}, {<strong>tableone</strong>}, {<strong>xtable</strong>}</p>
</div>
</div>
<div class="my-experiment-container">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true">DT</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false">flextable</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-3" role="tab" aria-controls="tabset-11-3" aria-selected="false">gt</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-4" role="tab" aria-controls="tabset-11-4" aria-selected="false">gtsummary</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-5" role="tab" aria-controls="tabset-11-5" aria-selected="false">htmlTable</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-6" role="tab" aria-controls="tabset-11-6" aria-selected="false">kableExtra</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-7" role="tab" aria-controls="tabset-11-7" aria-selected="false">tableone</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-8" role="tab" aria-controls="tabset-11-8" aria-selected="false">xtable</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<p><a href="https://rstudio.github.io/DT/">{<strong>DT</strong>}</a></p>
<p>DT is an abbreviation of ‘DataTables.’ Data objects in R can be rendered as HTML tables using the JavaScript library ‘DataTables’ (typically via R Markdown or Shiny).</p>
<p>This R package provides an enhanced version of data.frames with more options for authors and users:</p>
<p><strong>Authors</strong>: DT supports data wrangling beside subsetting rows and selecting columns (e.g., computing on columns, sort, grouping). I am not sure if this is really an advantage because it requires the somewhat complex square brackets notation. Using {<strong>dplyr</strong>} with other {<strong>tidyverse</strong>} packages seems — for me at least — easier to use. <strong>Users</strong>: The really advantage of {<strong>DT</strong>} in my opinion is that the interface allows users to change values and display formats interactively. There are some option in the standard installations and much more with extensions.</p>
<ul>
<li><strong>Standard</strong>: Out of the box {<strong>DT</strong>} allows user to
<ul>
<li>search,</li>
<li>sort,</li>
<li>choose the number of rows shown per page,</li>
<li>filter columns</li>
<li>add/remove row names and even</li>
<li>edit cells individually.</li>
</ul></li>
<li><strong>Extensions</strong>: There are also some extension to enhance the interactive options: Extensions allow users to
<ul>
<li>edit groups of cells,</li>
<li>provide buttons for copying or downloading the table in different formats,</li>
<li>to re-order and/or hide columns,</li>
<li>to fix columns and/or header if the table is too wide and/or to long and you have to scroll,</li>
<li>moving around with arrow keys like in Excel tables,</li>
<li>making the table responsive to smaller screens by collapsing columns,</li>
<li>grouping values by a column,</li>
<li>reordering rows,</li>
<li>scrolling through the rows and</li>
<li>selecting parts of variables interactively.</li>
</ul></li>
</ul>
<div class="my-note">
<div class="my-note-header">
<p>My conclusion to {<strong>DT</strong>}</p>
</div>
<div class="my-note-container">
<p>{<strong>DT</strong>} is my first choice for interactive data exploring and very useful for Explorative Data Analysis (<a class='glossary' title='Explorative Data Analysis is an approach of analyzing data sets to summarize their main characteristics, often using statistical graphics and other data visualization methods. A statistical model can be used or not, but primarily EDA is for seeing what the data can tell us beyond the formal modeling and thereby contrasts traditional hypothesis testing. (Wikipedia)'>EDA</a>). I have already some experiences with this package but haven’t use it lastly.</p>
<p>Compared with the other table packages {<strong>DT</strong>} is not in the same category: The following packages are developed as <a class='glossary' title='Display Tables are in constrast to Data Tables. You would find them in a web page, a journal article, or in a magazine. Such tables are for presentation, often to facilitate the construction of “Table 1”, i.e., baseline characteristics table commonly found in research papers. (Introduction to Creating gt Tables)'>Display Tables</a> (in contrast to <a class='glossary' title='Data Tables are — in contrast to Display Tables — for analysis and not for presentation. Another purpose of Data Tables is to store, retrieve and share information digitally. In R they are tibbles, data.frames etc.'>Data Tables</a>. Beside of the interactive use {<strong>DT</strong>}s are Data Tables.</p>
</div>
</div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<p><a href="https://davidgohel.github.io/flextable/">{<strong>flextable</strong>}</a></p>
<p>This package helps you to create reporting table from a data frame easily. You can</p>
<ul>
<li>merge cells,</li>
<li>add headers,</li>
<li>add footers,</li>
<li>change formatting,</li>
<li>set how data in cells is displayed</li>
<li>Table content can also contain mixed types of text and image content.</li>
<li>Tables can be embedded from R Markdown documents into HTML, PDF, Word, and PowerPoint documents and can be embedded using Package Officer for Microsoft Word or PowerPoint documents.</li>
<li>Tables can also be exported as R plots or graphic files, e.g., png, pdf, and jpeg.</li>
</ul>
<p>It is said that {<strong>flextable</strong>} — together with the sparsely used <a href="https://hughjonesd.github.io/huxtable/">{<strong>huxtable</strong>}</a> — “supports the widest range of output formats … [both] support HTML, <span class="math inline">\(\LaTeX\)</span>, and Office formats, and contain most common table features (e.g., conditional formatting).” (Yihui: <a href="https://bookdown.org/yihui/rmarkdown-cookbook/table-other.html">R Markdown Coobook</a>)</p>
<div class="my-note">
<div class="my-note-header">
<p>My conclusion to {<strong>flextable</strong>}</p>
</div>
<div class="my-note-container">
<p>{<strong>flextable</strong>} seems pretty well suited to create sophisticated tables for publications. It is often especially mentioned for exporting into Word files. Maybe I will look into this package in the near future, but currently my priority is {<strong>gtsummary</strong>}.</p>
</div>
</div>
</div>
<div id="tabset-11-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-3-tab">
<p><a href="https://gt.rstudio.com/">{<strong>gt</strong>}</a></p>
<p>{<strong>gt</strong>} stands for “grammar of tables”. It aims to do for tables what {<strong>ggplot2</strong>} did for graphics. (<a href="https://twitter.com/hadleywickham/status/1247997744469295104?ref_src=twsrc%5Etfw%7Ctwcamp%5Etweetembed%7Ctwterm%5E1247997744469295104%7Ctwgr%5Edb446e88f95e2f0e4a5e791da84f82d626ceee1c%7Ctwcon%5Es1_&amp;ref_url=https%3A%2F%2Fcdn.embedly.com%2Fwidgets%2Fmedia.html%3Ftype%3Dtext2Fhtmlkey%3Da19fcc184b9711e1b4764040d3dc5c07schema%3Dtwitterurl%3Dhttps3A%2F%2Ftwitter.com%2Fhadleywickham%2Fstatus%2F1247997744469295104image%3D">Hadley Wickham on X</a>)</p>
<p>{<strong>gt</strong>} offers a different and easy-to-use set of functions that helps to build display tables from tabular data. The {<strong>gt</strong>} philosophy states that a comprehensive collection of table parts can be used to create a broad range of functional tables.</p>
<p>It allows you to compose a table by putting together different parts of the table, such as</p>
<ul>
<li>the table header (title and subtitle),</li>
<li>the column labels,</li>
<li>the table body,</li>
<li>row group labels,</li>
<li>and the table footer.</li>
</ul>
<p>Some parts are optional. You can also format numbers and add background shading to cells.</p>
<p><a href="https://gt.rstudio.com/index.html"><img src="https://gt.rstudio.com/reference/figures/gt_parts_of_a_table.svg" id="fig-gt-table-parts" class="img-fluid" alt="The table shows all the different parts of a gt table: The TABLE HEADER consists of TITLE and SUBTITLE. The next part is called STUB HEAD and consists of STUBHEAD LABEL on the left, above the row names and SPANNER COLUMN LABEL with COLUMN LABELs below. The third part is called STUB and consists of ROW GROUP LABEL, ROW LABELs and SUMMARY LABEL on the left. On the right side are the values of the table in cells respectively summary cells. The last part is called TABLE FOOTER and consists of FOOTNOTES and SOURCE NOTES." /></a>.</p>
<p>At the beginning of the development process {<strong>gt</strong>} supported only HTML, but now you can also use it for LATEX and RTF outputs.</p>
<p>{<strong>gt</strong>} is developed by the RStudio/Posit team, that stands not only for high quality but also for {<strong>tidyverse</strong>} compatibility. It was a little surprise for me that the download statistics does not reflect the normally very high figures of RStudio/Posit products. After trying to work with {<strong>gt</strong>} I believe I know the reasons:</p>
<ul>
<li>With {<strong>gt</strong>} you have big flexibility but you have to provide all the details. This could be cumbersome, especially when other table packages are providing not only theses details but incorporate also many other features as calculations, tests etc. {<strong>gt</strong>} is therefore better used in combination with other packages like {<strong>gtsummary</strong>}.</li>
<li>{<strong>gt</strong>} is still very early in the development process. The issue tracker show this in the relation of open / closed issue: 272 open / 633 closed (2024-01-18).</li>
</ul>
<div class="my-note">
<div class="my-note-header">
<p>My conclusion to {<strong>gt</strong>}</p>
</div>
<div class="my-note-container">
<p>I tried to work with {<strong>gt</strong>} but it is cumbersome. I noticed a <a href="https://github.com/rstudio/gt/issues/1535">bug even following the official online tutorial</a>. Maybe {<strong>gt</strong>} (together with {<strong>gtsummary</strong>} is better suited for creating easily complex tables in many formats.</p>
</div>
</div>
</div>
<div id="tabset-11-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-4-tab">
<p>The {<strong>gtsummary</strong>} package provides an efficient way to create publication-ready analytical and summary tables using the R programming language. {<strong>gtsummary</strong>} summarizes data sets, regression models, and more, using sensible defaults with highly customizable capabilities.</p>
<p>{<strong>gtsummary</strong>} “was written to be a companion to the {<strong>gt</strong>} package from RStudio. But not all output types are supported by the {<strong>gt</strong>} package. Therefore, [the developers] have made it possible to print {<strong>gtsummary</strong>} tables with various engines.” (<a href="https://www.danieldsjoberg.com/gtsummary/articles/rmarkdown.html">gtsummary + Quarto/R Markdown</a>)</p>
<div id="fig-chap01-gtsummary-outputs" class="quarto-figure quarto-figure-center quarto-float" data-fig-align="center" alt="Table of summaries for output formats: The table header reads from left to the right: Print Engine, Function, HTML, Word, PDF, RTF.  As print engines feature in this table: gt, flextable, huxtable, kableExtra, kable and tibble. All functions start with &#39;as_&#39; followed by the name of the package, e.g., as_gt(), as_flex_table(), as_kable_extra() etc. The table states that gt is still working on RTF output, flextable and kableExtra does not support RTF, kableExtra also has no output format for Word. Kable has all four options in a very reduced form (missing indentation, footnotes and spanning headers) and tibble fails on all four formats.">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-chap01-gtsummary-outputs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="https://www.danieldsjoberg.com/gtsummary/articles/rmarkdown.html"><span class="lightbox" data-glightbox="description: .lightbox-desc-18" data-gallery="quarto-lightbox-gallery-18"><img src="img/chap01/gtsummary-output-formats-min.png" class="img-fluid quarto-figure quarto-figure-center" alt="Table of summaries for output formats: The table header reads from left to the right: Print Engine, Function, HTML, Word, PDF, RTF.  As print engines feature in this table: gt, flextable, huxtable, kableExtra, kable and tibble. All functions start with &#39;as_&#39; followed by the name of the package, e.g., as_gt(), as_flex_table(), as_kable_extra() etc. The table states that gt is still working on RTF output, flextable and kableExtra does not support RTF, kableExtra also has no output format for Word. Kable has all four options in a very reduced form (missing indentation, footnotes and spanning headers) and tibble fails on all four formats." /></span></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-chap01-gtsummary-outputs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Graph 1.11: Summary of the various Quarto and R Markdown output types and the print engines supporting them
</figcaption>
</figure>
</div>
<div class="my-note">
<div class="my-note-header">
<p>My conclusion to {<strong>gtsummary</strong>}</p>
</div>
<div class="my-note-container">
<p>I have tried out {<strong>gtsummary</strong>} and I am enthusiastic about it! I wrote an introduction with some examples (<a href="#sec-chap01-experiments-gtsummary" class="quarto-xref"><span class="quarto-unresolved-ref">sec-chap01-experiments-gtsummary</span></a>) Now that I understand how it works I will definitely use it. (By the way: Besides the extensive documentation I found that the most effective introduction for me was watching the <a href="https://www.youtube.com/watch?v=tANo9E1SYJE">Youtube video presentation</a> by the developer Daniel D. Sjoberg).</p>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/tANo9E1SYJE" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div>
</div>
</div>
</div>
<div id="tabset-11-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-5-tab">
<p><a href="https://cran.r-project.org/web/packages/htmlTable/vignettes/complex_tables.html">{<strong>htmlTable</strong>}</a></p>
<p>I found {<strong>htmlTable</strong>} per accident searching the Internet with “r creating complex table”. This package is not mentioned in the literature I have read so far, but it seems not only able to produce complex tables but is also used quite often. Maybe it is the HTML limitation which reduces it application for Online journals because it requires a separate step to produce <span class="math inline">\(\LaTeX\)</span> tables ready for printing.</p>
<p>It is a pretty old package (version 1.0 appeared already in 2014) but still currently in active development. The <a href="https://cran.r-project.org/web/packages/htmlTable/index.html">last change</a> today (2024-01-18) was version 2.4.2 from 2023-10-29.</p>
<p>From the package documentation:</p>
<p><strong>Advanced Tables for Markdown/HTML</strong></p>
<blockquote>
<p>Tables with state-of-the-art layout elements such as row spanners, column spanners, table spanners, zebra striping, and more. While allowing advanced layout, the underlying css-structure is simple in order to maximize compatibility with common word processors. The package also contains a few text formatting functions that help outputting text compatible with HTML/LaTeX.</p>
</blockquote>
<p>Beside the extensive vignette documentation there are also some blog articles:</p>
<ul>
<li><a href="https://gforge.se/2015/04/introducing-the-htmltable-package/">Introducing the htmlTable-package</a></li>
<li><a href="https://gforge.se/2013/02/tables-from-r-into-word/">Tables form R into Word</a></li>
<li><a href="https://gforge.se/2014/01/fast-track-publishing-using-knitr-part-iv/">Fast-track publishing using knitr: table mania (part IV)</a></li>
</ul>
<div class="my-note">
<div class="my-note-header">
<p>My conclusion to {<strong>htmlTable</strong>}</p>
</div>
<div class="my-note-container">
<p>{<strong>htmlTable</strong>} seems an interesting package not only for creating complex tables but also for exporting them into Word. But to learn this package is at the moment not on my task list.</p>
</div>
</div>
</div>
<div id="tabset-11-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-6-tab">
<p><a href="https://haozhu233.github.io/kableExtra/">{<strong>kableExtra</strong>}</a></p>
<p>{<strong>kableExtra</strong>} extends the basic functionality of <code>knitr::kable()</code> tables. Although <code>knitr::kable()</code> is simple by design, it has many features missing which are usually available in other packages. {<strong>kableExtra</strong>} has filled the gap nicely. One of the best thing about {<strong>kableExtra</strong>} is that most of its table capabilities work for both HTML and PDF formats.</p>
<div class="my-note">
<div class="my-note-header">
<p>My conclusion to {<strong>kableExtra</strong>}</p>
</div>
<div class="my-note-container">
<p>I have already some experiences with {<strong>kableExtra</strong>}. I used it quasi as an add-on to <code>knitr::kable()</code> during personal HTML publications (Blog, bookdown, Quarto). I believe that other “Table 1” packages like {<strong>gtsummary</strong>} or maybe also {<strong>tableOne</strong>) are better suited for display and publication.</p>
</div>
</div>
</div>
<div id="tabset-11-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-7-tab">
<p><a href="https://cran.r-project.org/web/packages/tableone/index.html">{<strong>tableone</strong>}</a></p>
<p>The first time I learned about the existence of {<strong>tableone</strong>} was in <a href="#sec-chap02" class="quarto-xref"><span class="quarto-unresolved-ref">sec-chap02</span></a> of Statistics with R. Consulting the online documentation it says:</p>
<blockquote>
<p>Creates “Table 1”, i.e., description of baseline patient characteristics, which is essential in every medical research. Supports both continuous and categorical variables, as well as p-values and standardized mean differences. Weighted data are supported via the {<strong>survey</strong>} package. … Most important functions are <code>CreateTableOne()</code> and <code>svyCreateTableOne()</code>.</p>
</blockquote>
<div class="my-note">
<div class="my-note-header">
<p>My conclusion to {<strong>tableone</strong>}</p>
</div>
<div class="my-note-container">
<p>The package is completely new for me. I have to check it out to see how and when to use. But my priority now is {<strong>gtsummary</strong>} because</p>
<ul>
<li>{<strong>gtsummary</strong>} is much more used than {<strong>tableone</strong>}: over 2000 versus under 500 downloads per day</li>
<li>last release of {<strong>gtsummary</strong>} was version 1.7.2 from July 15, 2023 versus release 26 from July 26, 2020.</li>
</ul>
</div>
</div>
</div>
<div id="tabset-11-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-8-tab">
<p><a href="https://cran.r-project.org/web/packages/xtable/vignettes/xtableGallery.pdf">{<strong>xtable</strong>}</a></p>
<p>{<strong>xtable</strong>} is the oldest package and still the table package most used! From the documentation it is clear that it is very useful for the creation of publication ready tables. But I am little hesitant to learn it, because it is not mentioned in current literature and the last change was in April 2019.</p>
<div class="my-note">
<div class="my-note-header">
<p>My conclusion to {<strong>xtable</strong>}</p>
</div>
<div class="my-note-container">
<p>Learning {<strong>xtable</strong>} is not on my agenda: It is not clear for me if {<strong>xtable</strong>} is still in developments and if it is supporting newer approaches. Learning other table packages, especially {<strong>gtsummary</strong>} probabily together with {<strong>gt</strong>} has priority for me.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<p>There are other packages as well. But the above eight packages are a first starting point for everybody to learn creating and displaying sophisticated data tables in R. It is good to know about different packages but lastly one has to decide which one to learn and use in daily practice. At the moment my favorites is {<strong>gtsummary</strong>}.</p>
<div class="my-resource">
<div class="my-resource-header">
<p>Other interesting table packages, but currently not considered for my personal purposes</p>
</div>
<div class="my-resource-container">
<p>Just for a possible later reference I will add some other table packages I know of.</p>
<ul>
<li><p><a href="https://glin.github.io/reactable/">{<strong>reactable</strong>}</a>: <code>reactable()</code> creates a data table from tabular data with sorting and pagination by default. The data table is an HTML widget that can be used in R Markdown documents and Shiny applications or viewed from an R console. It is based on the React Table library and made with reactR. Features are:</p>
<ul>
<li>It creates a data table with sorting, filtering, and pagination</li>
<li>It has built-in column formatting</li>
<li>It supports custom rendering via R or JavaScript</li>
<li>It works seamlessly within R Markdown documents and the Shiny app</li>
</ul></li>
<li><p><a href="https://kcuilla.github.io/reactablefmtr/index.html">{<strong>ractablefmtr</strong>}</a>: The package improves the appearance and formatting of tables created using the reactable R library. It includes many conditional formatters that are highly customizable and easy to use.</p></li>
</ul>
<p>The authors of R Markdown Cookbook (Yihui Xie, Christophe Dervieux, Emily Riederer) mention also several other table packages in the section <a href="https://bookdown.org/yihui/rmarkdown-cookbook/table-other.html">Other packages for creating tables</a>:</p>
<ul>
<li>{<strong>rhandsontable</strong>}: <a href="https://jrowen.github.io/rhandsontable/">Interface to the Handsontable.js Library.</a>). Similar to {<strong>DT</strong>}, and has an Excel feel (e.g., you can edit data directly in the table). Visit <a href="https://jrowen.github.io/rhandsontable/" class="uri">https://jrowen.github.io/rhandsontable/</a> to learn more about it.</li>
<li>{<strong>pixiedust</strong>}: <a href="https://github.com/nutterb/pixiedust">Tables so Beautifully Fine-Tuned You Will Believe It’s Magic</a>: Features creating tables for models (such as linear models) converted through the {<strong>broom</strong>} package (<a href="https://broom.tidymodels.org/">Broom: Convert Statistical Objects into Tidy Tibbles</a>). It supports Markdown, HTML, and <span class="math inline">\(\LaTeX\)</span> output formats.</li>
<li><strong>stargazer</strong>: (<a href="https://cran.r-project.org/web/packages/stargazer/vignettes/stargazer.pdf">beautiful <span class="math inline">\(\LaTeX\)</span>, HTML and ASCII tables from R statistical output</a>): Features formatting regression models and summary statistics tables.</li>
<li><strong>xtable</strong> (<a href="https://bookdown.org/yihui/rmarkdown-cookbook/table-other.html#ref-R-xtable">Dahl et al. 2019</a>): Perhaps the oldest package for creating tables—the first release was made in 2000. It supports both <span class="math inline">\(\LaTeX\)</span> and HTML formats.</li>
</ul>
<p>I’m not going to introduce the rest of packages, but will just list them here:</p>
<ul>
<li><strong>tables</strong>: <a href="https://dmurdoch.github.io/tables/">Formula-Driven Table Generation</a>),</li>
<li><strong>pander</strong> (<a href="https://bookdown.org/yihui/rmarkdown-cookbook/table-other.html#ref-R-pander">Daróczi and Tsegelskyi 2022</a>),</li>
<li><strong>tangram</strong> (<a href="https://bookdown.org/yihui/rmarkdown-cookbook/table-other.html#ref-R-tangram">S. Garbett 2023</a>),</li>
<li><strong>ztable</strong> (<a href="https://bookdown.org/yihui/rmarkdown-cookbook/table-other.html#ref-R-ztable">Moon 2021</a>), and</li>
<li><strong>condformat</strong> (<a href="https://zeehio.github.io/condformat/">Introduction to condformat</a>).</li>
</ul>
</div>
</div>
<div class="my-important">
<div class="my-important-header">
<p>Summary of my table packages review</p>
</div>
<div class="my-important-container">
<p>It does not make sense to learn every package. SO I will concentrate on five packages with different usage:</p>
<ul>
<li>{<strong>DT</strong>}, see: <a href="#pak-DT" class="quarto-xref">Package Profile <span class="quarto-unresolved-ref">pak-DT</span></a>: An important package for interactive HTML tables. It also manages quite good big datasets</li>
<li>{<strong>gt</strong>}, see <a href="#pak-gt" class="quarto-xref">Package Profile <span class="quarto-unresolved-ref">pak-gt</span></a>: Although this package is still lacking many features in follows a systematic approach (“Grammar of Tables”) that allows to make fine grained changes. It is there somewhat cumbersome to apply it in everyday use. But it is especially valuable when you have another package for the standard features and you need some specialized change. I plan to use {<strong>gt</strong>} together with {<strong>gtsummary</strong>}.</li>
<li>{<strong>gtsummary</strong>}, see: <a href="#pak-gtsummary" class="quarto-xref">Package Profile <span class="quarto-unresolved-ref">pak-gtsummary</span></a>: I just learned this package and I am enthusiastic about it! I will use it as replacement for {<strong>tableone</strong>} that is used by Harris for the book to prepare publishing ready <a class='glossary' title='Descriptive statistics are often displayed in the first table in a published article or report and are therefore often called Table 1 statistics or the descriptives. (SwR)'>Table 1</a> tables.</li>
<li>{<strong>kableExtra</strong>}, see: <a href="#pak-kableExtra" class="quarto-xref">Package Profile <span class="quarto-unresolved-ref">pak-kableExtra</span></a>: It uses the <code>kable()</code> function from {<strong>knitr</strong>} (see: <a href="#pak-knitr" class="quarto-xref">Package Profile <span class="quarto-unresolved-ref">pak-knitr</span></a>), which is an essential part of the publishing infrastructure for <a class='glossary' title='Literate programming is a methodology that combines a programming language with a documentation language, thereby making programs more robust, more portable, more easily maintained, and arguably more fun to write than programs that are written only in a high-level language. The main idea is to treat a program as a piece of literature, addressed to human beings rather than to a computer.(Donald Knuth)'>literate programming</a>. It is pretty flexible and could be used in tandem with {<strong>gtsummary</strong>}.</li>
</ul>
<p>For simple tables one can also use <code>knitr::kable()</code> or just printing the tibble.</p>
</div>
</div>
<p>As a consequence of my table packages review I experimented with the {<strong>gtsummary</strong>}. I wanted to create a table where I have information by the variables grass, age in four categories and sex with all their levels in absolute numbers and in percents.</p>
</section>
<section id="sec-chap01-experiments-gtsummary" class="level3" data-number="1.9.2">
<h3 data-number="1.9.2"><span class="header-section-number">1.9.2</span> Experiments with the gtsummary package</h3>
<div class="my-experiment">
<div class="my-experiment-header">
<div id="def-chap01-gtsummary-intro" class="theorem definition">
<p><span class="theorem-title"><strong>Experiment 1.7</strong></span> : Experiments with {<strong>gtsummary</strong>}</p>
</div>
</div>
<div class="my-experiment-container">
<ol start="0" type="1">
<li>Display dataset used for the {<strong>gtsummary</strong>} introduction.</li>
<li>A very basic summary table without any adaptions or modifications.</li>
<li>Changing dichotomous to a categorical variable.</li>
<li>Ditto with a different method.</li>
<li>Changing variable labels with two different methods.</li>
<li>Output grouped by the <code>grass</code> variable.</li>
<li>Header modified.</li>
<li>two cross tables of summary statistics stacked.</li>
<li>Table stratified by the <code>grass</code> variable.</li>
</ol>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true">0</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false">1</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-3" role="tab" aria-controls="tabset-12-3" aria-selected="false">2</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-4" role="tab" aria-controls="tabset-12-4" aria-selected="false">3</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-5" role="tab" aria-controls="tabset-12-5" aria-selected="false">4</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-6" role="tab" aria-controls="tabset-12-6" aria-selected="false">5</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-7" role="tab" aria-controls="tabset-12-7" aria-selected="false">6</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-8" role="tab" aria-controls="tabset-12-8" aria-selected="false">7</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-9-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-9" role="tab" aria-controls="tabset-12-9" aria-selected="false">8</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-gtsummary-data" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.45</strong></span> : Data used in this {<strong>gtsummary</strong>} introduction</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb83"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>chap01_nhanes_2013_clean <span class="ot">&lt;-</span> </span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>    base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="st">&quot;data-clean/chap01_nhanes_2013_clean.rds&quot;</span>)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>chap01_gtsummary_basic <span class="ot">&lt;-</span> chap01_nhanes_2013_clean <span class="sc">|&gt;</span> </span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>    <span class="do">## cut age into several defined age groups</span></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">age_cat =</span> base<span class="sc">::</span><span class="fu">cut</span>(age,</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="dv">29</span>, <span class="dv">39</span>, <span class="dv">49</span>, <span class="dv">59</span>),</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;18 - 29&quot;</span>, <span class="st">&quot;30 - 39&quot;</span>, <span class="st">&quot;40 - 49&quot;</span>, <span class="st">&quot;50 - 59&quot;</span>))) <span class="sc">|&gt;</span></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(nr, age))</span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">saveRDS</span>(chap01_gtsummary_basic, <span class="st">&quot;data-clean/chap01_gtsummary_clean.rds&quot;</span>)</span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">summary</span>(chap01_gtsummary_basic)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;  grass          sex          age_cat    
#&gt;  Yes:1991   Male  :1792   18 - 29:1154  
#&gt;  No :1699   Female:1898   30 - 39: 859  
#&gt;                           40 - 49: 855  
#&gt;                           50 - 59: 822</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb85"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>chap01_gtsummary_basic</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 3,690 × 3
#&gt;    grass sex    age_cat
#&gt;    &lt;fct&gt; &lt;fct&gt;  &lt;fct&gt;  
#&gt;  1 Yes   Male   50 - 59
#&gt;  2 Yes   Male   50 - 59
#&gt;  3 Yes   Female 50 - 59
#&gt;  4 No    Female 18 - 29
#&gt;  5 No    Female 30 - 39
#&gt;  6 Yes   Male   30 - 39
#&gt;  7 No    Male   18 - 29
#&gt;  8 Yes   Female 30 - 39
#&gt;  9 No    Male   50 - 59
#&gt; 10 Yes   Male   18 - 29
#&gt; # ℹ 3,680 more rows</code></pre>
</div>
</div>
</div>
</div>
<p>I am going to use this dataset to experiment with {<strong>gtsummary</strong>}.</p>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-gtsummary-basic" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.46</strong></span> : A very basic summary without any adaptions or modifications</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb87"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>chap01_gtsummary_basic <span class="ot">&lt;-</span> </span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>    base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="st">&quot;data-clean/chap01_gtsummary_clean.rds&quot;</span>)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>chap01_gtsummary_basic <span class="sc">|&gt;</span> </span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>    gtsummary<span class="sc">::</span><span class="fu">tbl_summary</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="zrociydeme" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#zrociydeme table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#zrociydeme thead, #zrociydeme tbody, #zrociydeme tfoot, #zrociydeme tr, #zrociydeme td, #zrociydeme th {
  border-style: none;
}

#zrociydeme p {
  margin: 0;
  padding: 0;
}

#zrociydeme .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#zrociydeme .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#zrociydeme .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#zrociydeme .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#zrociydeme .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zrociydeme .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zrociydeme .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zrociydeme .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#zrociydeme .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#zrociydeme .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#zrociydeme .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#zrociydeme .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#zrociydeme .gt_spanner_row {
  border-bottom-style: hidden;
}

#zrociydeme .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#zrociydeme .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#zrociydeme .gt_from_md > :first-child {
  margin-top: 0;
}

#zrociydeme .gt_from_md > :last-child {
  margin-bottom: 0;
}

#zrociydeme .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#zrociydeme .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#zrociydeme .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#zrociydeme .gt_row_group_first td {
  border-top-width: 2px;
}

#zrociydeme .gt_row_group_first th {
  border-top-width: 2px;
}

#zrociydeme .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zrociydeme .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#zrociydeme .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#zrociydeme .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zrociydeme .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zrociydeme .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#zrociydeme .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#zrociydeme .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#zrociydeme .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zrociydeme .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zrociydeme .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zrociydeme .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zrociydeme .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zrociydeme .gt_left {
  text-align: left;
}

#zrociydeme .gt_center {
  text-align: center;
}

#zrociydeme .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#zrociydeme .gt_font_normal {
  font-weight: normal;
}

#zrociydeme .gt_font_bold {
  font-weight: bold;
}

#zrociydeme .gt_font_italic {
  font-style: italic;
}

#zrociydeme .gt_super {
  font-size: 65%;
}

#zrociydeme .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#zrociydeme .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#zrociydeme .gt_indent_1 {
  text-indent: 5px;
}

#zrociydeme .gt_indent_2 {
  text-indent: 10px;
}

#zrociydeme .gt_indent_3 {
  text-indent: 15px;
}

#zrociydeme .gt_indent_4 {
  text-indent: 20px;
}

#zrociydeme .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header gt_col_headings">
<th id="&lt;strong&gt;Characteristic&lt;/strong&gt;" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="&lt;strong&gt;N = 3,690&lt;/strong&gt;&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>N = 3,690</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">grass</td>
<td class="gt_row gt_center" headers="stat_0">1,991 (54%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">gender</td>
<td class="gt_row gt_center" headers="stat_0"><br />
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">    Male</td>
<td class="gt_row gt_center" headers="stat_0">1,792 (49%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">    Female</td>
<td class="gt_row gt_center" headers="stat_0">1,898 (51%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">age_cat</td>
<td class="gt_row gt_center" headers="stat_0"><br />
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">    18 - 29</td>
<td class="gt_row gt_center" headers="stat_0">1,154 (31%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">    30 - 39</td>
<td class="gt_row gt_center" headers="stat_0">859 (23%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">    40 - 49</td>
<td class="gt_row gt_center" headers="stat_0">855 (23%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">    50 - 59</td>
<td class="gt_row gt_center" headers="stat_0">822 (22%)</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="even">
<td colspan="2" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> n (%)</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</div>
</div>
<p>This is a very basic summary without any adaptions or modifications. It is strange, that there are for <code>grass</code> not separated levels presented. From a <a href="https://www.youtube.com/watch?v=tANo9E1SYJE">video of an introduction to {<strong>gtsummary</strong>}</a> by the package author Daniel D. Sjoberg I learned that a categorical variable with two levels is interpreted as dichotomous whenever the two levels are labelled <code>1</code> and <code>0</code>, <code>true</code> and <code>false</code> or <code>Yes</code> and <code>No</code>. And dichotomous variable are different as other categorical variables as they are reported by {<strong>gtsummary</strong>} only with one number (the <code>1</code>, <code>true</code> or <code>yes</code> value).</p>
</div>
<div id="tabset-12-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-3-tab">
<p>Here I am going to change level names of the <code>grass</code> variable to prevent that it is interpreted as a dichotomous variable.</p>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-gtsummary-no-dichotomous1" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.47</strong></span> : Numbered R Code Title</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb88"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>chap01_gtsummary_basic2 <span class="ot">&lt;-</span> </span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>    base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="st">&quot;data-clean/chap01_gtsummary_clean.rds&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">grass =</span> </span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>      forcats<span class="sc">::</span><span class="fu">fct_recode</span>(grass,</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;used&quot;</span> <span class="ot">=</span> <span class="st">&quot;Yes&quot;</span>, </span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;not used&quot;</span> <span class="ot">=</span> <span class="st">&quot;No&quot;</span>)</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>            ) </span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>chap01_gtsummary_basic2 <span class="sc">|&gt;</span></span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>    gtsummary<span class="sc">::</span><span class="fu">tbl_summary</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="medbxrcxwq" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#medbxrcxwq table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#medbxrcxwq thead, #medbxrcxwq tbody, #medbxrcxwq tfoot, #medbxrcxwq tr, #medbxrcxwq td, #medbxrcxwq th {
  border-style: none;
}

#medbxrcxwq p {
  margin: 0;
  padding: 0;
}

#medbxrcxwq .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#medbxrcxwq .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#medbxrcxwq .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#medbxrcxwq .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#medbxrcxwq .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#medbxrcxwq .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#medbxrcxwq .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#medbxrcxwq .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#medbxrcxwq .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#medbxrcxwq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#medbxrcxwq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#medbxrcxwq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#medbxrcxwq .gt_spanner_row {
  border-bottom-style: hidden;
}

#medbxrcxwq .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#medbxrcxwq .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#medbxrcxwq .gt_from_md > :first-child {
  margin-top: 0;
}

#medbxrcxwq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#medbxrcxwq .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#medbxrcxwq .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#medbxrcxwq .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#medbxrcxwq .gt_row_group_first td {
  border-top-width: 2px;
}

#medbxrcxwq .gt_row_group_first th {
  border-top-width: 2px;
}

#medbxrcxwq .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#medbxrcxwq .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#medbxrcxwq .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#medbxrcxwq .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#medbxrcxwq .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#medbxrcxwq .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#medbxrcxwq .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#medbxrcxwq .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#medbxrcxwq .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#medbxrcxwq .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#medbxrcxwq .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#medbxrcxwq .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#medbxrcxwq .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#medbxrcxwq .gt_left {
  text-align: left;
}

#medbxrcxwq .gt_center {
  text-align: center;
}

#medbxrcxwq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#medbxrcxwq .gt_font_normal {
  font-weight: normal;
}

#medbxrcxwq .gt_font_bold {
  font-weight: bold;
}

#medbxrcxwq .gt_font_italic {
  font-style: italic;
}

#medbxrcxwq .gt_super {
  font-size: 65%;
}

#medbxrcxwq .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#medbxrcxwq .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#medbxrcxwq .gt_indent_1 {
  text-indent: 5px;
}

#medbxrcxwq .gt_indent_2 {
  text-indent: 10px;
}

#medbxrcxwq .gt_indent_3 {
  text-indent: 15px;
}

#medbxrcxwq .gt_indent_4 {
  text-indent: 20px;
}

#medbxrcxwq .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header gt_col_headings">
<th id="&lt;strong&gt;Characteristic&lt;/strong&gt;" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="&lt;strong&gt;N = 3,690&lt;/strong&gt;&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>N = 3,690</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">grass</td>
<td class="gt_row gt_center" headers="stat_0"><br />
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">    used</td>
<td class="gt_row gt_center" headers="stat_0">1,991 (54%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">    not used</td>
<td class="gt_row gt_center" headers="stat_0">1,699 (46%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">gender</td>
<td class="gt_row gt_center" headers="stat_0"><br />
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">    Male</td>
<td class="gt_row gt_center" headers="stat_0">1,792 (49%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">    Female</td>
<td class="gt_row gt_center" headers="stat_0">1,898 (51%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">age_cat</td>
<td class="gt_row gt_center" headers="stat_0"><br />
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">    18 - 29</td>
<td class="gt_row gt_center" headers="stat_0">1,154 (31%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">    30 - 39</td>
<td class="gt_row gt_center" headers="stat_0">859 (23%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">    40 - 49</td>
<td class="gt_row gt_center" headers="stat_0">855 (23%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">    50 - 59</td>
<td class="gt_row gt_center" headers="stat_0">822 (22%)</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="even">
<td colspan="2" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> n (%)</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</div>
</div>
<p>This time we can see both levels of <code>grass</code>. But we loose the nice Yes/No answer of the survey.</p>
</div>
<div id="tabset-12-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-4-tab">
<p>Another strategy to prevent a dichotomous interpretation is to tell {<strong>gtsummary</strong>} expressively with the <code>type =</code> argument how a variable has to be interpreted.</p>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-gtsummary-no-dichotomous2" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.48</strong></span> : Preventing a dichotomous interpretation</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb89"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>chap01_gtsummary_basic <span class="sc">|&gt;</span> </span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>    gtsummary<span class="sc">::</span><span class="fu">tbl_summary</span>(</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> grass <span class="sc">~</span> <span class="st">&quot;categorical&quot;</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="ltikcpexne" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ltikcpexne table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ltikcpexne thead, #ltikcpexne tbody, #ltikcpexne tfoot, #ltikcpexne tr, #ltikcpexne td, #ltikcpexne th {
  border-style: none;
}

#ltikcpexne p {
  margin: 0;
  padding: 0;
}

#ltikcpexne .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ltikcpexne .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ltikcpexne .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ltikcpexne .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ltikcpexne .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ltikcpexne .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ltikcpexne .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ltikcpexne .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ltikcpexne .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ltikcpexne .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ltikcpexne .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ltikcpexne .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ltikcpexne .gt_spanner_row {
  border-bottom-style: hidden;
}

#ltikcpexne .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ltikcpexne .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ltikcpexne .gt_from_md > :first-child {
  margin-top: 0;
}

#ltikcpexne .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ltikcpexne .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ltikcpexne .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ltikcpexne .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ltikcpexne .gt_row_group_first td {
  border-top-width: 2px;
}

#ltikcpexne .gt_row_group_first th {
  border-top-width: 2px;
}

#ltikcpexne .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ltikcpexne .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ltikcpexne .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ltikcpexne .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ltikcpexne .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ltikcpexne .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ltikcpexne .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ltikcpexne .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ltikcpexne .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ltikcpexne .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ltikcpexne .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ltikcpexne .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ltikcpexne .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ltikcpexne .gt_left {
  text-align: left;
}

#ltikcpexne .gt_center {
  text-align: center;
}

#ltikcpexne .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ltikcpexne .gt_font_normal {
  font-weight: normal;
}

#ltikcpexne .gt_font_bold {
  font-weight: bold;
}

#ltikcpexne .gt_font_italic {
  font-style: italic;
}

#ltikcpexne .gt_super {
  font-size: 65%;
}

#ltikcpexne .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ltikcpexne .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ltikcpexne .gt_indent_1 {
  text-indent: 5px;
}

#ltikcpexne .gt_indent_2 {
  text-indent: 10px;
}

#ltikcpexne .gt_indent_3 {
  text-indent: 15px;
}

#ltikcpexne .gt_indent_4 {
  text-indent: 20px;
}

#ltikcpexne .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header gt_col_headings">
<th id="&lt;strong&gt;Characteristic&lt;/strong&gt;" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="&lt;strong&gt;N = 3,690&lt;/strong&gt;&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>N = 3,690</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">grass</td>
<td class="gt_row gt_center" headers="stat_0"><br />
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">    Yes</td>
<td class="gt_row gt_center" headers="stat_0">1,991 (54%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">    No</td>
<td class="gt_row gt_center" headers="stat_0">1,699 (46%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">age_cat</td>
<td class="gt_row gt_center" headers="stat_0"><br />
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">    18 - 29</td>
<td class="gt_row gt_center" headers="stat_0">1,154 (31%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">    30 - 39</td>
<td class="gt_row gt_center" headers="stat_0">859 (23%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">    40 - 49</td>
<td class="gt_row gt_center" headers="stat_0">855 (23%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">    50 - 59</td>
<td class="gt_row gt_center" headers="stat_0">822 (22%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">gender</td>
<td class="gt_row gt_center" headers="stat_0"><br />
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">    Male</td>
<td class="gt_row gt_center" headers="stat_0">1,792 (49%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">    Female</td>
<td class="gt_row gt_center" headers="stat_0">1,898 (51%)</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="even">
<td colspan="2" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> n (%)</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</div>
</div>
<p>The same output as in the previous tab, but now with the desired Yes/No answer categories.</p>
</div>
<div id="tabset-12-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-5-tab">
<p>If there are labelled data {gtsummary} uses them as variable labels. This is a big advantages, especially if the data are already labelled and imported with {<strong>haven</strong>}. But you can use the {<strong>labelled</strong>} package to label the variables.</p>
<p>If there are no labelled metadata then the variable name is taken, e.g., in most of the cases you have to provide a better name for the table display.</p>
<p>I am using both methods in following code chunk: I provided labelled metadata for the <code>grass</code> variable but used new variable names for <code>age_cat</code> and <code>sex</code>.</p>
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-gtsummary-label" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.49</strong></span> : Changing variable labels</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb90"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="do">## variant 1 to label variables</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="co"># labelled::var_label(</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     chap01_gtsummary_basic$grass) &lt;- &quot;Ever used grass or hash?&quot;</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="do">## variant 2 to label variables</span></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>chap01_gtsummary_basic <span class="sc">|&gt;</span> </span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>    labelled<span class="sc">::</span><span class="fu">set_variable_labels</span>(</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">grass =</span> <span class="st">&quot;Ever used grass or hash?&quot;</span></span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>    gtsummary<span class="sc">::</span><span class="fu">tbl_summary</span>(</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># by = grass,</span></span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> grass <span class="sc">~</span> <span class="st">&quot;categorical&quot;</span>,</span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="fu">list</span>(</span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">age_cat =</span> <span class="st">&quot;Age Category&quot;</span>,</span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">sex =</span> <span class="st">&quot;Sex&quot;</span></span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="pvqliyukyz" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#pvqliyukyz table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#pvqliyukyz thead, #pvqliyukyz tbody, #pvqliyukyz tfoot, #pvqliyukyz tr, #pvqliyukyz td, #pvqliyukyz th {
  border-style: none;
}

#pvqliyukyz p {
  margin: 0;
  padding: 0;
}

#pvqliyukyz .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#pvqliyukyz .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#pvqliyukyz .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#pvqliyukyz .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#pvqliyukyz .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pvqliyukyz .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pvqliyukyz .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pvqliyukyz .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#pvqliyukyz .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#pvqliyukyz .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#pvqliyukyz .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#pvqliyukyz .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#pvqliyukyz .gt_spanner_row {
  border-bottom-style: hidden;
}

#pvqliyukyz .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#pvqliyukyz .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#pvqliyukyz .gt_from_md > :first-child {
  margin-top: 0;
}

#pvqliyukyz .gt_from_md > :last-child {
  margin-bottom: 0;
}

#pvqliyukyz .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#pvqliyukyz .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#pvqliyukyz .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#pvqliyukyz .gt_row_group_first td {
  border-top-width: 2px;
}

#pvqliyukyz .gt_row_group_first th {
  border-top-width: 2px;
}

#pvqliyukyz .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pvqliyukyz .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#pvqliyukyz .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#pvqliyukyz .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pvqliyukyz .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pvqliyukyz .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#pvqliyukyz .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#pvqliyukyz .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#pvqliyukyz .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pvqliyukyz .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pvqliyukyz .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pvqliyukyz .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pvqliyukyz .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pvqliyukyz .gt_left {
  text-align: left;
}

#pvqliyukyz .gt_center {
  text-align: center;
}

#pvqliyukyz .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#pvqliyukyz .gt_font_normal {
  font-weight: normal;
}

#pvqliyukyz .gt_font_bold {
  font-weight: bold;
}

#pvqliyukyz .gt_font_italic {
  font-style: italic;
}

#pvqliyukyz .gt_super {
  font-size: 65%;
}

#pvqliyukyz .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#pvqliyukyz .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#pvqliyukyz .gt_indent_1 {
  text-indent: 5px;
}

#pvqliyukyz .gt_indent_2 {
  text-indent: 10px;
}

#pvqliyukyz .gt_indent_3 {
  text-indent: 15px;
}

#pvqliyukyz .gt_indent_4 {
  text-indent: 20px;
}

#pvqliyukyz .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header gt_col_headings">
<th id="&lt;strong&gt;Characteristic&lt;/strong&gt;" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="&lt;strong&gt;N = 3,690&lt;/strong&gt;&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>N = 3,690</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">Ever used grass or hash?</td>
<td class="gt_row gt_center" headers="stat_0"><br />
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">    Yes</td>
<td class="gt_row gt_center" headers="stat_0">1,991 (54%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">    No</td>
<td class="gt_row gt_center" headers="stat_0">1,699 (46%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">gender</td>
<td class="gt_row gt_center" headers="stat_0"><br />
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">    Male</td>
<td class="gt_row gt_center" headers="stat_0">1,792 (49%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">    Female</td>
<td class="gt_row gt_center" headers="stat_0">1,898 (51%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Age Category</td>
<td class="gt_row gt_center" headers="stat_0"><br />
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">    18 - 29</td>
<td class="gt_row gt_center" headers="stat_0">1,154 (31%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">    30 - 39</td>
<td class="gt_row gt_center" headers="stat_0">859 (23%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">    40 - 49</td>
<td class="gt_row gt_center" headers="stat_0">855 (23%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">    50 - 59</td>
<td class="gt_row gt_center" headers="stat_0">822 (22%)</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="even">
<td colspan="2" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> n (%)</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-12-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-6-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-gtsummary-group" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.50</strong></span> : Summarize data by a grouped variable</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb91"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>chap01_gtsummary_group <span class="ot">&lt;-</span>  chap01_gtsummary_basic <span class="sc">|&gt;</span> </span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>    labelled<span class="sc">::</span><span class="fu">set_variable_labels</span>(</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">grass =</span> <span class="st">&quot;Ever used grass or hash?&quot;</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>    gtsummary<span class="sc">::</span><span class="fu">tbl_summary</span>(</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">by =</span> grass,</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> grass <span class="sc">~</span> <span class="st">&quot;categorical&quot;</span>,</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="fu">list</span>(</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">age_cat =</span> <span class="st">&quot;Age Category&quot;</span>,</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">sex =</span> <span class="st">&quot;Sex&quot;</span></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>chap01_gtsummary_group</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="sqnnofxoke" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#sqnnofxoke table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#sqnnofxoke thead, #sqnnofxoke tbody, #sqnnofxoke tfoot, #sqnnofxoke tr, #sqnnofxoke td, #sqnnofxoke th {
  border-style: none;
}

#sqnnofxoke p {
  margin: 0;
  padding: 0;
}

#sqnnofxoke .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#sqnnofxoke .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#sqnnofxoke .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#sqnnofxoke .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#sqnnofxoke .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#sqnnofxoke .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sqnnofxoke .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#sqnnofxoke .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#sqnnofxoke .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#sqnnofxoke .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#sqnnofxoke .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#sqnnofxoke .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#sqnnofxoke .gt_spanner_row {
  border-bottom-style: hidden;
}

#sqnnofxoke .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#sqnnofxoke .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#sqnnofxoke .gt_from_md > :first-child {
  margin-top: 0;
}

#sqnnofxoke .gt_from_md > :last-child {
  margin-bottom: 0;
}

#sqnnofxoke .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#sqnnofxoke .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#sqnnofxoke .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#sqnnofxoke .gt_row_group_first td {
  border-top-width: 2px;
}

#sqnnofxoke .gt_row_group_first th {
  border-top-width: 2px;
}

#sqnnofxoke .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#sqnnofxoke .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#sqnnofxoke .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#sqnnofxoke .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sqnnofxoke .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#sqnnofxoke .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#sqnnofxoke .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#sqnnofxoke .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#sqnnofxoke .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sqnnofxoke .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#sqnnofxoke .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#sqnnofxoke .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#sqnnofxoke .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#sqnnofxoke .gt_left {
  text-align: left;
}

#sqnnofxoke .gt_center {
  text-align: center;
}

#sqnnofxoke .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#sqnnofxoke .gt_font_normal {
  font-weight: normal;
}

#sqnnofxoke .gt_font_bold {
  font-weight: bold;
}

#sqnnofxoke .gt_font_italic {
  font-style: italic;
}

#sqnnofxoke .gt_super {
  font-size: 65%;
}

#sqnnofxoke .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#sqnnofxoke .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#sqnnofxoke .gt_indent_1 {
  text-indent: 5px;
}

#sqnnofxoke .gt_indent_2 {
  text-indent: 10px;
}

#sqnnofxoke .gt_indent_3 {
  text-indent: 15px;
}

#sqnnofxoke .gt_indent_4 {
  text-indent: 20px;
}

#sqnnofxoke .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header gt_col_headings">
<th id="&lt;strong&gt;Characteristic&lt;/strong&gt;" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="&lt;strong&gt;Yes&lt;/strong&gt;, N = 1,991&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Yes</strong>, N = 1,991<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
<th id="&lt;strong&gt;No&lt;/strong&gt;, N = 1,699&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>No</strong>, N = 1,699<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">gender</td>
<td class="gt_row gt_center" headers="stat_1"><br />
</td>
<td class="gt_row gt_center" headers="stat_2"><br />
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">    Male</td>
<td class="gt_row gt_center" headers="stat_1">1,072 (54%)</td>
<td class="gt_row gt_center" headers="stat_2">720 (42%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">    Female</td>
<td class="gt_row gt_center" headers="stat_1">919 (46%)</td>
<td class="gt_row gt_center" headers="stat_2">979 (58%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Age Category</td>
<td class="gt_row gt_center" headers="stat_1"><br />
</td>
<td class="gt_row gt_center" headers="stat_2"><br />
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">    18 - 29</td>
<td class="gt_row gt_center" headers="stat_1">662 (33%)</td>
<td class="gt_row gt_center" headers="stat_2">492 (29%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">    30 - 39</td>
<td class="gt_row gt_center" headers="stat_1">466 (23%)</td>
<td class="gt_row gt_center" headers="stat_2">393 (23%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">    40 - 49</td>
<td class="gt_row gt_center" headers="stat_1">405 (20%)</td>
<td class="gt_row gt_center" headers="stat_2">450 (26%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">    50 - 59</td>
<td class="gt_row gt_center" headers="stat_1">458 (23%)</td>
<td class="gt_row gt_center" headers="stat_2">364 (21%)</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="3" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> n (%)</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p>The variable <code>grass</code> is not grouped <code>dplyr::group_by()</code> but inside <code>gtsummary::tbl_summary()</code>.</p>
</div>
</div>
</div>
<div id="tabset-12-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-7-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-gtsummary-header" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.51</strong></span> : Change table header</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb92"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>chap01_gtsummary_group <span class="sc">|&gt;</span> </span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>  gtsummary<span class="sc">::</span><span class="fu">modify_header</span>(label <span class="sc">~</span> <span class="st">&quot;**Variable**&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>  gtsummary<span class="sc">::</span><span class="fu">modify_spanning_header</span>(</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="st">&quot;stat_1&quot;</span>, <span class="st">&quot;stat_2&quot;</span>) <span class="sc">~</span> <span class="st">&quot;**Ever used grass or hash?**&quot;</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="byknbbjyve" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#byknbbjyve table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#byknbbjyve thead, #byknbbjyve tbody, #byknbbjyve tfoot, #byknbbjyve tr, #byknbbjyve td, #byknbbjyve th {
  border-style: none;
}

#byknbbjyve p {
  margin: 0;
  padding: 0;
}

#byknbbjyve .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#byknbbjyve .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#byknbbjyve .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#byknbbjyve .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#byknbbjyve .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#byknbbjyve .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#byknbbjyve .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#byknbbjyve .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#byknbbjyve .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#byknbbjyve .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#byknbbjyve .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#byknbbjyve .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#byknbbjyve .gt_spanner_row {
  border-bottom-style: hidden;
}

#byknbbjyve .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#byknbbjyve .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#byknbbjyve .gt_from_md > :first-child {
  margin-top: 0;
}

#byknbbjyve .gt_from_md > :last-child {
  margin-bottom: 0;
}

#byknbbjyve .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#byknbbjyve .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#byknbbjyve .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#byknbbjyve .gt_row_group_first td {
  border-top-width: 2px;
}

#byknbbjyve .gt_row_group_first th {
  border-top-width: 2px;
}

#byknbbjyve .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#byknbbjyve .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#byknbbjyve .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#byknbbjyve .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#byknbbjyve .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#byknbbjyve .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#byknbbjyve .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#byknbbjyve .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#byknbbjyve .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#byknbbjyve .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#byknbbjyve .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#byknbbjyve .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#byknbbjyve .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#byknbbjyve .gt_left {
  text-align: left;
}

#byknbbjyve .gt_center {
  text-align: center;
}

#byknbbjyve .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#byknbbjyve .gt_font_normal {
  font-weight: normal;
}

#byknbbjyve .gt_font_bold {
  font-weight: bold;
}

#byknbbjyve .gt_font_italic {
  font-style: italic;
}

#byknbbjyve .gt_super {
  font-size: 65%;
}

#byknbbjyve .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#byknbbjyve .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#byknbbjyve .gt_indent_1 {
  text-indent: 5px;
}

#byknbbjyve .gt_indent_2 {
  text-indent: 10px;
}

#byknbbjyve .gt_indent_3 {
  text-indent: 15px;
}

#byknbbjyve .gt_indent_4 {
  text-indent: 20px;
}

#byknbbjyve .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header gt_col_headings gt_spanner_row">
<th rowspan="2" id="&lt;strong&gt;Variable&lt;/strong&gt;" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Variable</strong></th>
<th colspan="2" id="&lt;strong&gt;Ever used grass or hash?&lt;/strong&gt;" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><span class="gt_column_spanner"><strong>Ever used grass or hash?</strong></span></th>
</tr>
<tr class="odd gt_col_headings">
<th id="&lt;strong&gt;Yes&lt;/strong&gt;, N = 1,991&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Yes</strong>, N = 1,991<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
<th id="&lt;strong&gt;No&lt;/strong&gt;, N = 1,699&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>No</strong>, N = 1,699<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">Age Category</td>
<td class="gt_row gt_center" headers="stat_1"><br />
</td>
<td class="gt_row gt_center" headers="stat_2"><br />
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">    18 - 29</td>
<td class="gt_row gt_center" headers="stat_1">662 (33%)</td>
<td class="gt_row gt_center" headers="stat_2">492 (29%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">    30 - 39</td>
<td class="gt_row gt_center" headers="stat_1">466 (23%)</td>
<td class="gt_row gt_center" headers="stat_2">393 (23%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">    40 - 49</td>
<td class="gt_row gt_center" headers="stat_1">405 (20%)</td>
<td class="gt_row gt_center" headers="stat_2">450 (26%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">    50 - 59</td>
<td class="gt_row gt_center" headers="stat_1">458 (23%)</td>
<td class="gt_row gt_center" headers="stat_2">364 (21%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Gender</td>
<td class="gt_row gt_center" headers="stat_1"><br />
</td>
<td class="gt_row gt_center" headers="stat_2"><br />
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">    Male</td>
<td class="gt_row gt_center" headers="stat_1">1,072 (54%)</td>
<td class="gt_row gt_center" headers="stat_2">720 (42%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">    Female</td>
<td class="gt_row gt_center" headers="stat_1">919 (46%)</td>
<td class="gt_row gt_center" headers="stat_2">979 (58%)</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="even">
<td colspan="3" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> n (%)</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-12-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-8-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-gtsummary-cross-table" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.52</strong></span> : Prepare cross tables and stack them</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb93"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>chap01_gtsummary_basic <span class="ot">&lt;-</span> </span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">readRDS</span>(<span class="st">&quot;data-clean/chap01_gtsummary_clean.rds&quot;</span>)</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>chap01_gtsummary_cross1 <span class="ot">&lt;-</span> chap01_gtsummary_basic <span class="sc">|&gt;</span> </span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>    labelled<span class="sc">::</span><span class="fu">set_variable_labels</span>(</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">grass =</span> <span class="st">&quot;**Ever used grass or hash?**&quot;</span></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">|&gt;</span> </span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>    gtsummary<span class="sc">::</span><span class="fu">tbl_cross</span>(</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="fu">list</span>(</span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">age_cat =</span> <span class="st">&quot;Age Category&quot;</span>,</span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">sex =</span> <span class="st">&quot;Sex&quot;</span></span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">row =</span> age_cat,</span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> grass,</span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">percent =</span> <span class="st">&quot;cell&quot;</span></span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb93-17"><a href="#cb93-17" aria-hidden="true" tabindex="-1"></a>    gtsummary<span class="sc">::</span><span class="fu">modify_header</span>(</span>
<span id="cb93-18"><a href="#cb93-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">stat_1 =</span> <span class="st">&#39;**Yes**&#39;</span>,</span>
<span id="cb93-19"><a href="#cb93-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">stat_2 =</span> <span class="st">&#39;**No**&#39;</span>,</span>
<span id="cb93-20"><a href="#cb93-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">stat_0 =</span> <span class="st">&#39;**Total**&#39;</span></span>
<span id="cb93-21"><a href="#cb93-21" aria-hidden="true" tabindex="-1"></a>    ) </span>
<span id="cb93-22"><a href="#cb93-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-23"><a href="#cb93-23" aria-hidden="true" tabindex="-1"></a>chap01_gtsummary_cross2 <span class="ot">&lt;-</span> chap01_gtsummary_basic <span class="sc">|&gt;</span> </span>
<span id="cb93-24"><a href="#cb93-24" aria-hidden="true" tabindex="-1"></a>    labelled<span class="sc">::</span><span class="fu">set_variable_labels</span>(</span>
<span id="cb93-25"><a href="#cb93-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">grass =</span> <span class="st">&quot;**Ever used grass or hash?**&quot;</span></span>
<span id="cb93-26"><a href="#cb93-26" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">|&gt;</span> </span>
<span id="cb93-27"><a href="#cb93-27" aria-hidden="true" tabindex="-1"></a>    gtsummary<span class="sc">::</span><span class="fu">tbl_cross</span>(</span>
<span id="cb93-28"><a href="#cb93-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="fu">list</span>(</span>
<span id="cb93-29"><a href="#cb93-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">age_cat =</span> <span class="st">&quot;Age Category&quot;</span>,</span>
<span id="cb93-30"><a href="#cb93-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">sex =</span> <span class="st">&quot;Sex&quot;</span></span>
<span id="cb93-31"><a href="#cb93-31" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb93-32"><a href="#cb93-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">row =</span> sex,</span>
<span id="cb93-33"><a href="#cb93-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> grass,</span>
<span id="cb93-34"><a href="#cb93-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">percent =</span> <span class="st">&quot;cell&quot;</span></span>
<span id="cb93-35"><a href="#cb93-35" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb93-36"><a href="#cb93-36" aria-hidden="true" tabindex="-1"></a>    gtsummary<span class="sc">::</span><span class="fu">modify_header</span>(</span>
<span id="cb93-37"><a href="#cb93-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">stat_1 =</span> <span class="st">&#39;**Yes**&#39;</span>,</span>
<span id="cb93-38"><a href="#cb93-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">stat_2 =</span> <span class="st">&#39;**No**&#39;</span>,</span>
<span id="cb93-39"><a href="#cb93-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">stat_0 =</span> <span class="st">&#39;**Total**&#39;</span></span>
<span id="cb93-40"><a href="#cb93-40" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb93-41"><a href="#cb93-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-42"><a href="#cb93-42" aria-hidden="true" tabindex="-1"></a>gtsummary<span class="sc">::</span><span class="fu">tbl_stack</span>(</span>
<span id="cb93-43"><a href="#cb93-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(chap01_gtsummary_cross1,</span>
<span id="cb93-44"><a href="#cb93-44" aria-hidden="true" tabindex="-1"></a>         chap01_gtsummary_cross2)</span>
<span id="cb93-45"><a href="#cb93-45" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb93-46"><a href="#cb93-46" aria-hidden="true" tabindex="-1"></a>    gtsummary<span class="sc">::</span><span class="fu">bold_labels</span>() </span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="taqabhpcem" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#taqabhpcem table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#taqabhpcem thead, #taqabhpcem tbody, #taqabhpcem tfoot, #taqabhpcem tr, #taqabhpcem td, #taqabhpcem th {
  border-style: none;
}

#taqabhpcem p {
  margin: 0;
  padding: 0;
}

#taqabhpcem .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#taqabhpcem .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#taqabhpcem .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#taqabhpcem .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#taqabhpcem .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#taqabhpcem .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#taqabhpcem .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#taqabhpcem .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#taqabhpcem .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#taqabhpcem .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#taqabhpcem .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#taqabhpcem .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#taqabhpcem .gt_spanner_row {
  border-bottom-style: hidden;
}

#taqabhpcem .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#taqabhpcem .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#taqabhpcem .gt_from_md > :first-child {
  margin-top: 0;
}

#taqabhpcem .gt_from_md > :last-child {
  margin-bottom: 0;
}

#taqabhpcem .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#taqabhpcem .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#taqabhpcem .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#taqabhpcem .gt_row_group_first td {
  border-top-width: 2px;
}

#taqabhpcem .gt_row_group_first th {
  border-top-width: 2px;
}

#taqabhpcem .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#taqabhpcem .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#taqabhpcem .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#taqabhpcem .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#taqabhpcem .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#taqabhpcem .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#taqabhpcem .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#taqabhpcem .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#taqabhpcem .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#taqabhpcem .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#taqabhpcem .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#taqabhpcem .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#taqabhpcem .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#taqabhpcem .gt_left {
  text-align: left;
}

#taqabhpcem .gt_center {
  text-align: center;
}

#taqabhpcem .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#taqabhpcem .gt_font_normal {
  font-weight: normal;
}

#taqabhpcem .gt_font_bold {
  font-weight: bold;
}

#taqabhpcem .gt_font_italic {
  font-style: italic;
}

#taqabhpcem .gt_super {
  font-size: 65%;
}

#taqabhpcem .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#taqabhpcem .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#taqabhpcem .gt_indent_1 {
  text-indent: 5px;
}

#taqabhpcem .gt_indent_2 {
  text-indent: 10px;
}

#taqabhpcem .gt_indent_3 {
  text-indent: 15px;
}

#taqabhpcem .gt_indent_4 {
  text-indent: 20px;
}

#taqabhpcem .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header gt_col_headings gt_spanner_row">
<th rowspan="2" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
<th colspan="2" id="&lt;strong&gt;Ever used grass or hash?&lt;/strong&gt;" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><span class="gt_column_spanner"><strong>Ever used grass or hash?</strong></span></th>
<th rowspan="2" id="&lt;strong&gt;Total&lt;/strong&gt;" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Total</strong></th>
</tr>
<tr class="odd gt_col_headings">
<th id="&lt;strong&gt;Yes&lt;/strong&gt;" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Yes</strong></th>
<th id="&lt;strong&gt;No&lt;/strong&gt;" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>No</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Age Category</td>
<td class="gt_row gt_center" headers="stat_1"><br />
</td>
<td class="gt_row gt_center" headers="stat_2"><br />
</td>
<td class="gt_row gt_center" headers="stat_0"><br />
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">    18 - 29</td>
<td class="gt_row gt_center" headers="stat_1">662 (18%)</td>
<td class="gt_row gt_center" headers="stat_2">492 (13%)</td>
<td class="gt_row gt_center" headers="stat_0">1,154 (31%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">    30 - 39</td>
<td class="gt_row gt_center" headers="stat_1">466 (13%)</td>
<td class="gt_row gt_center" headers="stat_2">393 (11%)</td>
<td class="gt_row gt_center" headers="stat_0">859 (23%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">    40 - 49</td>
<td class="gt_row gt_center" headers="stat_1">405 (11%)</td>
<td class="gt_row gt_center" headers="stat_2">450 (12%)</td>
<td class="gt_row gt_center" headers="stat_0">855 (23%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">    50 - 59</td>
<td class="gt_row gt_center" headers="stat_1">458 (12%)</td>
<td class="gt_row gt_center" headers="stat_2">364 (9.9%)</td>
<td class="gt_row gt_center" headers="stat_0">822 (22%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Total</td>
<td class="gt_row gt_center" headers="stat_1">1,991 (54%)</td>
<td class="gt_row gt_center" headers="stat_2">1,699 (46%)</td>
<td class="gt_row gt_center" headers="stat_0">3,690 (100%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Sex</td>
<td class="gt_row gt_center" headers="stat_1"><br />
</td>
<td class="gt_row gt_center" headers="stat_2"><br />
</td>
<td class="gt_row gt_center" headers="stat_0"><br />
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">    Male</td>
<td class="gt_row gt_center" headers="stat_1">1,072 (29%)</td>
<td class="gt_row gt_center" headers="stat_2">720 (20%)</td>
<td class="gt_row gt_center" headers="stat_0">1,792 (49%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">    Female</td>
<td class="gt_row gt_center" headers="stat_1">919 (25%)</td>
<td class="gt_row gt_center" headers="stat_2">979 (27%)</td>
<td class="gt_row gt_center" headers="stat_0">1,898 (51%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Total</td>
<td class="gt_row gt_center" headers="stat_1">1,991 (54%)</td>
<td class="gt_row gt_center" headers="stat_2">1,699 (46%)</td>
<td class="gt_row gt_center" headers="stat_0">3,690 (100%)</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-12-9" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-9-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-ID-chap01-gtsummary-stratify" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.53</strong></span> : Stratify tables</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb94"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>chap01_gtsummary_basic <span class="ot">&lt;-</span> </span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">readRDS</span>(<span class="st">&quot;data-clean/chap01_gtsummary_clean.rds&quot;</span>)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>chap01_gtsummary_basic <span class="sc">|&gt;</span> </span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>    gtsummary<span class="sc">::</span><span class="fu">tbl_strata</span>(</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">strata =</span> grass,</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>        <span class="sc">~</span> .x <span class="sc">|&gt;</span> </span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>    gtsummary<span class="sc">::</span><span class="fu">tbl_summary</span>(</span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">by =</span> sex,</span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> age_cat <span class="sc">~</span> <span class="st">&quot;Age Category&quot;</span></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">|&gt;</span> </span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>    gtsummary<span class="sc">::</span><span class="fu">add_overall</span>() <span class="sc">|&gt;</span> </span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a>    gtsummary<span class="sc">::</span><span class="fu">modify_header</span>(</span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="st">&quot;**Variables**&quot;</span>,</span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a>        gtsummary<span class="sc">::</span><span class="fu">all_stat_cols</span>() <span class="sc">~</span> <span class="st">&quot;**{level}**&quot;</span></span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb94-18"><a href="#cb94-18" aria-hidden="true" tabindex="-1"></a>  gtsummary<span class="sc">::</span><span class="fu">bold_labels</span>() </span></code></pre></div>
</details>
<div id="tbl-gts-stratify" class="cell quarto-float">
<figure class="quarto-float quarto-float-tbl">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-gts-stratify-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table 1.3: Did you ever use marijuana or hashish?
</figcaption>
<div aria-describedby="tbl-gts-stratify-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="vtwvzmekou" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#vtwvzmekou table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#vtwvzmekou thead, #vtwvzmekou tbody, #vtwvzmekou tfoot, #vtwvzmekou tr, #vtwvzmekou td, #vtwvzmekou th {
  border-style: none;
}

#vtwvzmekou p {
  margin: 0;
  padding: 0;
}

#vtwvzmekou .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#vtwvzmekou .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#vtwvzmekou .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#vtwvzmekou .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#vtwvzmekou .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vtwvzmekou .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vtwvzmekou .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vtwvzmekou .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#vtwvzmekou .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#vtwvzmekou .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#vtwvzmekou .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#vtwvzmekou .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#vtwvzmekou .gt_spanner_row {
  border-bottom-style: hidden;
}

#vtwvzmekou .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#vtwvzmekou .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#vtwvzmekou .gt_from_md > :first-child {
  margin-top: 0;
}

#vtwvzmekou .gt_from_md > :last-child {
  margin-bottom: 0;
}

#vtwvzmekou .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#vtwvzmekou .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#vtwvzmekou .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#vtwvzmekou .gt_row_group_first td {
  border-top-width: 2px;
}

#vtwvzmekou .gt_row_group_first th {
  border-top-width: 2px;
}

#vtwvzmekou .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vtwvzmekou .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#vtwvzmekou .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#vtwvzmekou .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vtwvzmekou .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vtwvzmekou .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#vtwvzmekou .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#vtwvzmekou .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#vtwvzmekou .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vtwvzmekou .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vtwvzmekou .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vtwvzmekou .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vtwvzmekou .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vtwvzmekou .gt_left {
  text-align: left;
}

#vtwvzmekou .gt_center {
  text-align: center;
}

#vtwvzmekou .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#vtwvzmekou .gt_font_normal {
  font-weight: normal;
}

#vtwvzmekou .gt_font_bold {
  font-weight: bold;
}

#vtwvzmekou .gt_font_italic {
  font-style: italic;
}

#vtwvzmekou .gt_super {
  font-size: 65%;
}

#vtwvzmekou .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#vtwvzmekou .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#vtwvzmekou .gt_indent_1 {
  text-indent: 5px;
}

#vtwvzmekou .gt_indent_2 {
  text-indent: 10px;
}

#vtwvzmekou .gt_indent_3 {
  text-indent: 15px;
}

#vtwvzmekou .gt_indent_4 {
  text-indent: 20px;
}

#vtwvzmekou .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table do-not-create-environment cell" style="width:100%;" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 14%" />
<col style="width: 14%" />
<col style="width: 14%" />
<col style="width: 14%" />
<col style="width: 14%" />
<col style="width: 14%" />
<col style="width: 14%" />
</colgroup>
<thead>
<tr class="header gt_col_headings gt_spanner_row">
<th rowspan="2" id="&lt;strong&gt;Variables&lt;/strong&gt;" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Variables</strong></th>
<th colspan="3" id="&lt;strong&gt;Yes&lt;/strong&gt;" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><span class="gt_column_spanner"><strong>Yes</strong></span></th>
<th colspan="3" id="&lt;strong&gt;No&lt;/strong&gt;" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><span class="gt_column_spanner"><strong>No</strong></span></th>
</tr>
<tr class="odd gt_col_headings">
<th id="&lt;strong&gt;Overall&lt;/strong&gt;&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Overall</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
<th id="&lt;strong&gt;Male&lt;/strong&gt;&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Male</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
<th id="&lt;strong&gt;Female&lt;/strong&gt;&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Female</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
<th id="&lt;strong&gt;Overall&lt;/strong&gt;&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Overall</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
<th id="&lt;strong&gt;Male&lt;/strong&gt;&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Male</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
<th id="&lt;strong&gt;Female&lt;/strong&gt;&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Female</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Age Category</td>
<td class="gt_row gt_center" headers="stat_0_1"><br />
</td>
<td class="gt_row gt_center" headers="stat_1_1"><br />
</td>
<td class="gt_row gt_center" headers="stat_2_1"><br />
</td>
<td class="gt_row gt_center" headers="stat_0_2"><br />
</td>
<td class="gt_row gt_center" headers="stat_1_2"><br />
</td>
<td class="gt_row gt_center" headers="stat_2_2"><br />
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">    18 - 29</td>
<td class="gt_row gt_center" headers="stat_0_1">662 (33%)</td>
<td class="gt_row gt_center" headers="stat_1_1">360 (34%)</td>
<td class="gt_row gt_center" headers="stat_2_1">302 (33%)</td>
<td class="gt_row gt_center" headers="stat_0_2">492 (29%)</td>
<td class="gt_row gt_center" headers="stat_1_2">208 (29%)</td>
<td class="gt_row gt_center" headers="stat_2_2">284 (29%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">    30 - 39</td>
<td class="gt_row gt_center" headers="stat_0_1">466 (23%)</td>
<td class="gt_row gt_center" headers="stat_1_1">267 (25%)</td>
<td class="gt_row gt_center" headers="stat_2_1">199 (22%)</td>
<td class="gt_row gt_center" headers="stat_0_2">393 (23%)</td>
<td class="gt_row gt_center" headers="stat_1_2">163 (23%)</td>
<td class="gt_row gt_center" headers="stat_2_2">230 (23%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">    40 - 49</td>
<td class="gt_row gt_center" headers="stat_0_1">405 (20%)</td>
<td class="gt_row gt_center" headers="stat_1_1">202 (19%)</td>
<td class="gt_row gt_center" headers="stat_2_1">203 (22%)</td>
<td class="gt_row gt_center" headers="stat_0_2">450 (26%)</td>
<td class="gt_row gt_center" headers="stat_1_2">198 (28%)</td>
<td class="gt_row gt_center" headers="stat_2_2">252 (26%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">    50 - 59</td>
<td class="gt_row gt_center" headers="stat_0_1">458 (23%)</td>
<td class="gt_row gt_center" headers="stat_1_1">243 (23%)</td>
<td class="gt_row gt_center" headers="stat_2_1">215 (23%)</td>
<td class="gt_row gt_center" headers="stat_0_2">364 (21%)</td>
<td class="gt_row gt_center" headers="stat_1_2">151 (21%)</td>
<td class="gt_row gt_center" headers="stat_2_2">213 (22%)</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="7" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> n (%)</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<hr />
</section>
</section>
<section id="sec-chap01-grass-timeline" class="level2" data-number="1.10">
<h2 data-number="1.10"><span class="header-section-number">1.10</span> Opinions about legalizing marijuana (1973-2022)</h2>
<div class="my-experiment">
<div class="my-experiment-header">
<div id="def-chap01-timeline-grass" class="theorem definition">
<p><span class="theorem-title"><strong>Experiment 1.8</strong></span> : Developing a graph showing the timeline of respondents opinion about legalizing marijuana (1973-2022)</p>
</div>
</div>
<div class="my-experiment-container">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true">Load data</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false">Clean data</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-3" role="tab" aria-controls="tabset-13-3" aria-selected="false">Show summary</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-4" role="tab" aria-controls="tabset-13-4" aria-selected="false">Prepare data</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-5" role="tab" aria-controls="tabset-13-5" aria-selected="false">Timeline</a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-load-gss-grass-legal" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.54</strong></span> : Load the GSS data from 1972-2022 and select appropriate variables</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb95"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="do">## run only once (manually) #########</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gssr)   <span class="do">## load package</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(gss_all)   <span class="do">## attach GSS data </span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(gss_dict)  <span class="do">## attach codebook</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>chap01_gss_grass_legal <span class="ot">&lt;-</span> gss_all <span class="sc">|&gt;</span> </span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(year, age, grass) </span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">saveRDS</span>(chap01_gss_grass_legal, <span class="st">&quot;data-raw/chap01_gss_grass_legal.rds&quot;</span>)</span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">unloadNamespace</span>(<span class="st">&quot;gssr&quot;</span>)</span></code></pre></div>
</details>
</div>
</div>
</div>
<p>(<em>This R code chunk has no visible output</em>)</p>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-clean-gss-grass-legal" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.55</strong></span> : Clean <code>grass-legal</code> dataset</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb96"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="do">## run only once (manually) ##########</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>chap01_gss_grass_legal <span class="ot">&lt;-</span> </span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>    base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="st">&quot;data-raw/chap01_gss_grass_legal.rds&quot;</span>)</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>chap01_gss_grass_legal_clean <span class="ot">&lt;-</span> chap01_gss_grass_legal <span class="sc">|&gt;</span> </span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">drop_na</span>() <span class="sc">|&gt;</span> </span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">grass =</span> forcats<span class="sc">::</span><span class="fu">as_factor</span>(grass),</span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">grass =</span> forcats<span class="sc">::</span><span class="fu">fct_drop</span>(grass),</span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">year =</span> base<span class="sc">::</span><span class="fu">as.numeric</span>(year),</span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">age =</span> base<span class="sc">::</span><span class="fu">as.numeric</span>(age)</span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">saveRDS</span>(chap01_gss_grass_legal_clean, <span class="at">file =</span> </span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;data-clean/chap01_gss_grass_legal_clean.rds&quot;</span>)</span></code></pre></div>
</details>
</div>
</div>
</div>
<p>(<em>This R code chunk has no visible output</em>)</p>
</div>
<div id="tabset-13-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-3-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-gss-grass-clean-data" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.56</strong></span> : Show summary of cleaned dataset</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb97"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>grass_legal <span class="ot">&lt;-</span> </span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>    base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="st">&quot;data-clean/chap01_gss_grass_legal_clean.rds&quot;</span>)</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="do">## remove comma from big numbers</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>gtsummary<span class="sc">::</span><span class="fu">theme_gtsummary_language</span>(<span class="st">&quot;en&quot;</span>, <span class="at">big.mark =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>grass_legal <span class="sc">|&gt;</span> </span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>  gtsummary<span class="sc">::</span><span class="fu">tbl_summary</span>(</span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">list</span>(</span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a>        year <span class="sc">~</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a>        age <span class="sc">~</span> <span class="st">&quot;Age&quot;</span>,</span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a>        grass <span class="sc">~</span> <span class="st">&quot;Should marijuana be legal?&quot;</span></span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="fu">list</span>(age <span class="sc">~</span> <span class="st">&quot;continuous2&quot;</span>, year <span class="sc">~</span> <span class="st">&quot;continuous2&quot;</span>),</span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">statistic =</span> </span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a>         <span class="fu">list</span>(</span>
<span id="cb97-18"><a href="#cb97-18" aria-hidden="true" tabindex="-1"></a>            age <span class="sc">~</span> <span class="fu">c</span>(</span>
<span id="cb97-19"><a href="#cb97-19" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;{mean} ({sd})&quot;</span>,</span>
<span id="cb97-20"><a href="#cb97-20" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;{median} ({p25}, {p75})&quot;</span>,</span>
<span id="cb97-21"><a href="#cb97-21" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;{min}, {max}&quot;</span></span>
<span id="cb97-22"><a href="#cb97-22" aria-hidden="true" tabindex="-1"></a>         ), </span>
<span id="cb97-23"><a href="#cb97-23" aria-hidden="true" tabindex="-1"></a>            year <span class="sc">~</span> <span class="fu">c</span>(<span class="st">&quot;{min}, {max}&quot;</span>)</span>
<span id="cb97-24"><a href="#cb97-24" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb97-25"><a href="#cb97-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb97-26"><a href="#cb97-26" aria-hidden="true" tabindex="-1"></a>  gtsummary<span class="sc">::</span><span class="fu">italicize_levels</span>() <span class="sc">|&gt;</span> </span>
<span id="cb97-27"><a href="#cb97-27" aria-hidden="true" tabindex="-1"></a>  gtsummary<span class="sc">::</span><span class="fu">bold_labels</span>()</span></code></pre></div>
</details>
<div id="tbl-gtsummary-gss-grass-legal" class="cell quarto-float">
<figure class="quarto-float quarto-float-tbl">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-gtsummary-gss-grass-legal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table 1.4: Summary of GSS surveys about opinion about legalizing marijuana between 1972-2022
</figcaption>
<div aria-describedby="tbl-gtsummary-gss-grass-legal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="ijxrwgnlus" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ijxrwgnlus table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ijxrwgnlus thead, #ijxrwgnlus tbody, #ijxrwgnlus tfoot, #ijxrwgnlus tr, #ijxrwgnlus td, #ijxrwgnlus th {
  border-style: none;
}

#ijxrwgnlus p {
  margin: 0;
  padding: 0;
}

#ijxrwgnlus .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ijxrwgnlus .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ijxrwgnlus .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ijxrwgnlus .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ijxrwgnlus .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ijxrwgnlus .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ijxrwgnlus .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ijxrwgnlus .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ijxrwgnlus .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ijxrwgnlus .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ijxrwgnlus .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ijxrwgnlus .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ijxrwgnlus .gt_spanner_row {
  border-bottom-style: hidden;
}

#ijxrwgnlus .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ijxrwgnlus .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ijxrwgnlus .gt_from_md > :first-child {
  margin-top: 0;
}

#ijxrwgnlus .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ijxrwgnlus .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ijxrwgnlus .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ijxrwgnlus .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ijxrwgnlus .gt_row_group_first td {
  border-top-width: 2px;
}

#ijxrwgnlus .gt_row_group_first th {
  border-top-width: 2px;
}

#ijxrwgnlus .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ijxrwgnlus .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ijxrwgnlus .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ijxrwgnlus .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ijxrwgnlus .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ijxrwgnlus .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ijxrwgnlus .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ijxrwgnlus .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ijxrwgnlus .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ijxrwgnlus .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ijxrwgnlus .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ijxrwgnlus .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ijxrwgnlus .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ijxrwgnlus .gt_left {
  text-align: left;
}

#ijxrwgnlus .gt_center {
  text-align: center;
}

#ijxrwgnlus .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ijxrwgnlus .gt_font_normal {
  font-weight: normal;
}

#ijxrwgnlus .gt_font_bold {
  font-weight: bold;
}

#ijxrwgnlus .gt_font_italic {
  font-style: italic;
}

#ijxrwgnlus .gt_super {
  font-size: 65%;
}

#ijxrwgnlus .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ijxrwgnlus .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ijxrwgnlus .gt_indent_1 {
  text-indent: 5px;
}

#ijxrwgnlus .gt_indent_2 {
  text-indent: 10px;
}

#ijxrwgnlus .gt_indent_3 {
  text-indent: 15px;
}

#ijxrwgnlus .gt_indent_4 {
  text-indent: 20px;
}

#ijxrwgnlus .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table do-not-create-environment cell" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header gt_col_headings">
<th id="&lt;strong&gt;Characteristic&lt;/strong&gt;" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="&lt;strong&gt;N = 38479&lt;/strong&gt;&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>N = 38479</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Year</td>
<td class="gt_row gt_center" headers="stat_0"><br />
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label" style="font-style: italic">    Range</td>
<td class="gt_row gt_center" headers="stat_0">1973, 2022</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Age</td>
<td class="gt_row gt_center" headers="stat_0"><br />
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label" style="font-style: italic">    Mean (SD)</td>
<td class="gt_row gt_center" headers="stat_0">46 (18)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-style: italic">    Median (IQR)</td>
<td class="gt_row gt_center" headers="stat_0">43 (31, 59)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label" style="font-style: italic">    Range</td>
<td class="gt_row gt_center" headers="stat_0">18, 89</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Should marijuana be legal?</td>
<td class="gt_row gt_center" headers="stat_0"><br />
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label" style="font-style: italic">    should be legal</td>
<td class="gt_row gt_center" headers="stat_0">12589 (33%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-style: italic">    should not be legal</td>
<td class="gt_row gt_center" headers="stat_0">25890 (67%)</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="even">
<td colspan="2" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> n (%)</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</figure>
</div>
</div>
</div>
</div>
<div class="my-watch-out">
<div class="my-watch-out-header">
<p>WATCH OUT! Summary with labelled data</p>
</div>
<div class="my-watch-out-container">
<p>I used for the summary the labelled data from the {<strong>gssr</strong>} package. This has the big advantage that I didn’t recode the variable names and could use the variable and value metadata!</p>
<p>But {<strong>gtsummary</strong>} warned me to see that this is only “an intermediate data structure not meant for analysis”.</p>
<blockquote>
<p>Column(s) age are class “haven_labelled”. This is an intermediate datastructure not meant for analysis. Convert columns with <code>haven::as_factor()</code>, <code>labelled::to_factor()</code>, <code>labelled::unlabelled()</code>, and <code>unclass()</code>. “haven_labelled” value labels are ignored when columns are not converted. Failure to convert may have unintended consequences or result in error.</p>
<ul>
<li><a href="https://haven.tidyverse.org/articles/semantics.html">https://haven.tidyverse.org/articles/semantics.html</a></li>
<li><a href="https://haven.tidyverse.org/articles/semantics.html">https://larmarange.github.io/labelled/articles/intro_labelled.html#unlabelled</a></li>
</ul>
</blockquote>
</div>
</div>
</div>
<div id="tabset-13-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-4-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-gss-grass-prepare-data" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.57</strong></span> : Prepare data for timeline graph</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb98"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>grass_legal <span class="ot">&lt;-</span> </span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>    base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="st">&quot;data-clean/chap01_gss_grass_legal_clean.rds&quot;</span>)</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>grass_legal2 <span class="ot">&lt;-</span> grass_legal <span class="sc">|&gt;</span> </span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># labelled::remove_labels() |&gt; </span></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(year) <span class="sc">|&gt;</span> </span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">add_count</span>(<span class="at">name =</span> <span class="st">&quot;N&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">add_count</span>(grass) <span class="sc">|&gt;</span> </span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">perc =</span> n <span class="sc">/</span> N <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">|&gt;</span> </span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">ungroup</span>()</span></code></pre></div>
</details>
</div>
</div>
</div>
<p>(<em>This R code chunk has no visible output</em>)</p>
</div>
<div id="tabset-13-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-5-tab">
<div class="my-r-code">
<div class="my-r-code-header">
<div id="cnj-chap01-gss-grass-timeline" class="theorem conjecture">
<p><span class="theorem-title"><strong>R Code 1.58</strong></span> : Timeline of respondents opinion about legalizing marijuana (1973-2022)</p>
</div>
</div>
<div class="my-r-code-container">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb99"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>grass_legal2 <span class="sc">|&gt;</span> </span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># dplyr::group_by(year) |&gt; </span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> year, </span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> perc,</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> grass)) <span class="sc">+</span></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">scale_color_manual</span>(</span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#79a778&quot;</span>, <span class="st">&#39;#7662aa&#39;</span>)</span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">+</span></span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">scale_x_continuous</span>(</span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1973</span>, <span class="fu">seq</span>(<span class="dv">1978</span>, <span class="dv">2022</span>, <span class="dv">4</span>), <span class="dv">2022</span>)</span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">+</span></span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">axis.text.x =</span></span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a>          ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">&quot;Should marijuana be legal?&quot;</span>,</span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">&quot;Percent of responses&quot;</span>,</span>
<span id="cb99-20"><a href="#cb99-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">&quot;Marijuana&quot;</span>) <span class="sc">+</span></span>
<span id="cb99-21"><a href="#cb99-21" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">82</span>, .<span class="dv">85</span>))</span></code></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-gss-grass-timeline" class="quarto-figure quarto-figure-center quarto-float">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-gss-grass-timeline-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="01-preparing-data_files/figure-html/fig-gss-grass-timeline-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-19" data-gallery="quarto-lightbox-gallery-19"><img src="01-preparing-data_files/figure-html/fig-gss-grass-timeline-1.png" class="img-fluid" width="672" /></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gss-grass-timeline-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Graph 1.12: Timeline of respondents opinion about legalizing marijuana between 1972-2022 of the GSS data
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-gss-grass-timeline" class="quarto-xref">Graph <span class="quarto-unresolved-ref">fig-gss-grass-timeline</span></a> shows that the proportion of people that support legalizing marijuana is (with the exception of 1978-1990) continuously rising. Starting from 19% support in 1973 approval hits 70% in 2022, the last date where data are available. The turning point where the proportion of affirmation was the first time greater than the disapproval was in 2014 (55/45).</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="packages-introduced-in-this-chapter" class="level2" data-number="1.11">
<h2 data-number="1.11"><span class="header-section-number">1.11</span> Packages introduced in this chapter</h2>
<section id="dplyr" class="level3" data-number="1.11.1">
<h3 data-number="1.11.1"><span class="header-section-number">1.11.1</span> dplyr</h3>
<div class="my-resource">
<div class="my-resource-header">
<p>dplyr:: A Grammar of Data Manipulation</p>
</div>
<div class="my-resource-container">
<hr />
<div id="pak-dplyr" class="quarto-float">
<figure class="quarto-float quarto-float-pak">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-pak" id="pak-dplyr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Package Profile 1.1: Package for Data Manipulation
</figcaption>
<div aria-describedby="pak-dplyr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<hr />
<p>{<strong>package</strong>}: <a href="https://dplyr.tidyverse.org/">A Grammar of Data Manipulation</a></p>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[10, 30]">
<div class="quarto-layout-row quarto-layout-valign-center">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="img/chap01/logoi/logo-dplyr-min.png" class="lightbox" data-glightbox="description: .lightbox-desc-20" data-gallery="quarto-lightbox-gallery-20"><img src="img/chap01/logoi/logo-dplyr-min.png" class="img-fluid" width="176" /></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 75.0%;justify-content: flex-start;">
<p>{<strong>dplyr</strong>} is a grammar of data manipulation, providing a consistent set of verbs that help you solve the most common data manipulation challenges: - mutate() adds new variables that are functions of existing variables - select() picks variables based on their names. - filter() picks cases based on their values. - summarise() reduces multiple values down to a single summary. - arrange() changes the ordering of the rows. <span class="citation" data-cites="dplyr">(<a href="#ref-dplyr" role="doc-biblioref">Wickham et al. 2023</a>)</span></p>
</div>
</div>
</div>
<p>These all combine naturally with group_by() which allows you to perform any operation “by group”. You can learn more about them in <a href="https://dplyr.tidyverse.org/articles/dplyr.html">vignette(“dplyr”)</a>. As well as these single-table verbs, dplyr also provides a variety of two-table verbs, which you can learn about in <a href="https://dplyr.tidyverse.org/articles/two-table.html">vignette(“two-table”)</a>. <span class="citation" data-cites="dplyr">(<a href="#ref-dplyr" role="doc-biblioref">Wickham et al. 2023</a>)</span></p>
</div>
</figure>
</div>
</div>
</div>
</section>
<section id="dt-1" class="level3" data-number="1.11.2">
<h3 data-number="1.11.2"><span class="header-section-number">1.11.2</span> DT</h3>
<div class="my-resource">
<div class="my-resource-header">
<p>DT: A Wrapper of the JavaScript Library ‘DataTables’</p>
</div>
<div class="my-resource-container">
<hr />
<div id="pak-DT" class="quarto-float">
<figure class="quarto-float quarto-float-pak">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-pak" id="pak-DT-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Package Profile 1.2: {<strong>DT</strong>}: A Package as Wrapper of the JavaScript Library ‘DataTables’
</figcaption>
<div aria-describedby="pak-DT-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<hr />
<p>{<strong>DT</strong>}: <a href="https://rstudio.github.io/DT/">https://github.com/rstudio/DT</a></p>
<p>(<em>There is no hexagon icon available for {<strong>DT</strong>}</em>)</p>
<p>Data objects in R can be rendered as HTML tables using the JavaScript library <a href="https://datatables.net/">DataTables</a> (typically via R Markdown or Shiny). The ‘DataTables’ library has been included in this R package. The package name {<strong>DT</strong>} is an abbreviation of ‘DataTables’.</p>
</div>
</figure>
</div>
<hr />
</div>
</div>
</section>
<section id="forcats" class="level3" data-number="1.11.3">
<h3 data-number="1.11.3"><span class="header-section-number">1.11.3</span> forcats</h3>
<div class="my-resource">
<div class="my-resource-header">
<p>forcats: Tools for Working with Categorical Variables</p>
</div>
<div class="my-resource-container">
<hr />
<div id="pak-forcats" class="quarto-float">
<figure class="quarto-float quarto-float-pak">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-pak" id="pak-forcats-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Package Profile 1.3: forcats: A Package with Tools for Working with Categorical Variables
</figcaption>
<div aria-describedby="pak-forcats-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<hr />
<p>{<strong>forcats</strong>}: <a href="https://forcats.tidyverse.org/">Tools for Working with Categorical Variables (Factors)</a></p>
<p>{<strong>forcats</strong>} provide a suite of useful tools that solve common problems with factors. “Forcats” is an anagram of “factors” and part of the {<strong>tidyverse</strong>} suite of packages.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[10, 30]">
<div class="quarto-layout-row quarto-layout-valign-center">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="img/chap01/logoi/logo-forcats-min.png" class="lightbox" data-glightbox="description: .lightbox-desc-21" data-gallery="quarto-lightbox-gallery-21"><img src="img/chap01/logoi/logo-forcats-min.png" class="img-fluid" width="176" /></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 75.0%;justify-content: flex-start;">
<ol type="1">
<li>reordering factor levels
<ul>
<li>moving specified levels to front,</li>
<li>ordering by first appearance,</li>
<li>reversing, and</li>
<li>randomly shuffling</li>
</ul></li>
<li>tools for modifying factor levels
<ul>
<li>collapsing rare levels into other,</li>
<li>‘anonymizing’, and</li>
<li>manually ‘recoding’</li>
</ul></li>
</ol>
</div>
</div>
</div>
</div>
</figure>
</div>
<hr />
</div>
</div>
</section>
<section id="ggplot2" class="level3" data-number="1.11.4">
<h3 data-number="1.11.4"><span class="header-section-number">1.11.4</span> ggplot2</h3>
<div class="my-resource">
<div class="my-resource-header">
<p>ggplot2: Create Elegant Data Visualisations Using the Grammar of Graphics</p>
</div>
<div class="my-resource-container">
<hr />
<div id="pak-ggplot2" class="quarto-float">
<figure class="quarto-float quarto-float-pak">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-pak" id="pak-ggplot2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Package Profile 1.4: Package for Creating Data Visualisations
</figcaption>
<div aria-describedby="pak-ggplot2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<hr />
<p>{<strong>ggplot2</strong>}: <a href="https://ggplot2.tidyverse.org/">Create Elegant Data Visualisations Using the Grammar of Graphics</a></p>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[10, 30]">
<div class="quarto-layout-row quarto-layout-valign-center">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="img/chap01/logoi/logo-ggplot2-min.png" class="lightbox" data-glightbox="description: .lightbox-desc-22" data-gallery="quarto-lightbox-gallery-22"><img src="img/chap01/logoi/logo-ggplot2-min.png" class="img-fluid" width="176" /></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 75.0%;justify-content: flex-start;">
<p>{<strong>ggplot2</strong>} is a system for declaratively creating graphics, based on <a href="https://link.springer.com/book/10.1007/0-387-28695-0">The Grammar of Graphics</a>. You provide the data, tell {<strong>ggplot2</strong>} how to map variables to aesthetics, what graphical primitives to use, and it takes care of the details. <span class="citation" data-cites="ggplot2">(<a href="#ref-ggplot2" role="doc-biblioref">Wickham 2016</a>)</span></p>
</div>
</div>
</div>
</div>
</figure>
</div>
<hr />
</div>
</div>
</section>
<section id="gssr-1" class="level3" data-number="1.11.5">
<h3 data-number="1.11.5"><span class="header-section-number">1.11.5</span> gssr</h3>
<div class="my-resource">
<div class="my-resource-header">
<p>gssr: US General Social Survey (GSS) Data for R</p>
</div>
<div class="my-resource-container">
<hr />
<div id="pak-gssr" class="quarto-float">
<figure class="quarto-float quarto-float-pak">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-pak" id="pak-gssr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Package Profile 1.5: Package for Getting the US General Social Survey (GSS) Data More Easily
</figcaption>
<div aria-describedby="pak-gssr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<hr />
<p>{<strong>gssr</strong>}: <a href="https://kjhealy.github.io/gssr/">US General Social Survey (GSS) Data for R</a></p>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[10, 30]">
<div class="quarto-layout-row quarto-layout-valign-center">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="img/chap01/logoi/logo-gssr-min.png" class="lightbox" data-glightbox="description: .lightbox-desc-23" data-gallery="quarto-lightbox-gallery-23"><img src="img/chap01/logoi/logo-gssr-min.png" class="img-fluid" width="376" /></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 75.0%;justify-content: flex-start;">
<p><a href="https://kjhealy.github.io/gssr/">GSSR Package</a>: The General Social Survey Cumulative Data (1972-2022) and Panel Data files packaged for easy use in R. {<strong>gssr</strong>} is a data package, developed and maintained by <a href="https://kieranhealy.org/">Kieran Healy</a>, the author of <a href="https://kieranhealy.org/publications/dataviz/">Data Visualization</a>. The package bundles several datasets into a convenient format. Because of its large size {<strong>gssr</strong>} is not hosted on CRAN but as a <a href="https://github.com/kjhealy/gssr/">GitHub repository</a>.</p>
</div>
</div>
</div>
<p>Instead of browsing and examining the complex dataset with the <a href="https://gssdataexplorer.norc.org/">GSS Data Explorer</a> or <a href="https://gss.norc.org/Get-The-Data">download datasets directly</a> from the The National Opinion Research Center (<a href="http://norc.org/">NORC</a>) you can now just work inside R. The current package 0.4 (see: <a href="https://kieranhealy.org/blog/archives/2023/12/02/gssr-update/">gssr Update</a>) provides the GSS Cumulative Data File (1972-2022), three GSS Three Wave Panel Data Files (for panels beginning in 2006, 2008, and 2010, respectively), and the 2020 panel file.</p>
<p>Version 0.40 also integrates survey code book information about variables directly into R’s help system, allowing them to be accessed via the help browser or from the console with ?, as if they were functions or other documented objects.</p>
</div>
</figure>
</div>
<hr />
</div>
</div>
</section>
<section id="gt-1" class="level3" data-number="1.11.6">
<h3 data-number="1.11.6"><span class="header-section-number">1.11.6</span> gt</h3>
<div class="my-resource">
<div class="my-resource-header">
<p>gt: Easily Create Presentation-Ready Display Tables</p>
</div>
<div class="my-resource-container">
<hr />
<div id="pak-gt" class="quarto-float">
<figure class="quarto-float quarto-float-pak">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-pak" id="pak-gt-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Package Profile 1.6: {<strong>gt</strong>}: A Package for Presentation-Ready Display Tables
</figcaption>
<div aria-describedby="pak-gt-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<hr />
<p>{<strong>gt</strong>}: <a href="https://gt.rstudio.com">Easily Create Presentation-Ready Display Tables</a></p>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[10, 30]">
<div class="quarto-layout-row quarto-layout-valign-center">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="img/chap02/logoi/logo-gt-min.png" class="lightbox" data-glightbox="description: .lightbox-desc-24" data-gallery="quarto-lightbox-gallery-24"><img src="img/chap02/logoi/logo-gt-min.png" class="img-fluid" width="176" /></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 75.0%;justify-content: flex-start;">
<p>With the {<strong>gt</strong>} package, anyone can make wonderful-looking tables using the R programming language. The gt philosophy: we can construct a wide variety of useful tables with a cohesive set of table parts. These include the table header, the stub, the column labels and spanner column labels, the table body, and the table footer.</p>
</div>
</div>
</div>
</div>
</figure>
</div>
<hr />
</div>
</div>
</section>
<section id="gtsummary-1" class="level3" data-number="1.11.7">
<h3 data-number="1.11.7"><span class="header-section-number">1.11.7</span> gtsummary</h3>
<div class="my-resource">
<div class="my-resource-header">
<p>gtsummary: Presentation-Ready Data Summary and Analytic Result Tables</p>
</div>
<div class="my-resource-container">
<hr />
<div id="pak-gtsummary" class="quarto-float">
<figure class="quarto-float quarto-float-pak">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-pak" id="pak-gtsummary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Package Profile 1.7: Package for Presentation-Ready Data Summary and Analytic Result Tables
</figcaption>
<div aria-describedby="pak-gtsummary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<hr />
<p>{<strong>gtsummary</strong>}: <a href="https://www.danieldsjoberg.com/gtsummary/">Presentation-Ready Data Summary and Analytic Result Tables</a></p>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[10, 30]">
<div class="quarto-layout-row quarto-layout-valign-center">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="img/chap01/logoi/logo-gtsummary-min.png" class="lightbox" data-glightbox="description: .lightbox-desc-25" data-gallery="quarto-lightbox-gallery-25"><img src="img/chap01/logoi/logo-gtsummary-min.png" class="img-fluid" width="176" /></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 75.0%;justify-content: flex-start;">
<p>Creates presentation-ready tables summarizing data sets, regression models, and more. The code to create the tables is concise and highly customizable. Data frames can be summarized with any function, e.g. mean(), median(), even user-written functions. Regression models are summarized and include the reference rows for categorical variables. Common regression models, such as logistic regression and Cox proportional hazards regression, are automatically identified and the tables are pre-filled with appropriate column headers.</p>
</div>
</div>
</div>
<ul>
<li>Summarize data frames or tibbles easily in R. Perfect for creating a <a class='glossary' title='Descriptive statistics are often displayed in the first table in a published article or report and are therefore often called Table 1 statistics or the descriptives. (SwR)'>Table 1</a>.</li>
<li>Summarize regression models in R and include reference rows for categorical variables.</li>
<li>Customize {<strong>gtsummary</strong>} tables using a growing list of formatting/styling functions.</li>
<li>Report statistics inline from summary tables and regression summary tables in R markdown. Make your reports completely reproducible!</li>
</ul>
<p>By leveraging {<strong>broom</strong>}, {<strong>gt</strong>}, and {<strong>labelled</strong>} packages, {<strong>gtsummary</strong>} creates beautifully formatted, ready-to-share summary and result tables in a single line of R code!</p>
</div>
</figure>
</div>
<hr />
</div>
</div>
</section>
<section id="haven" class="level3" data-number="1.11.8">
<h3 data-number="1.11.8"><span class="header-section-number">1.11.8</span> haven</h3>
<div class="my-resource">
<div class="my-resource-header">
<p>haven: Import and Export ‘SPSS’, ‘Stata’ and ‘SAS’ Files</p>
</div>
<div class="my-resource-container">
<hr />
<div id="pak-haven" class="quarto-float">
<figure class="quarto-float quarto-float-pak">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-pak" id="pak-haven-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Package Profile 1.8: haven: A Package for Import and Export of ‘SPSS’, ‘Stata’ and ‘SAS’ Files
</figcaption>
<div aria-describedby="pak-haven-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<hr />
<p>{<strong>haven</strong>}: <a href="https://haven.tidyverse.org/index.html">Import and Export ‘SPSS’, ‘Stata’ and ‘SAS’ Files</a></p>
<p>{<strong>haven</strong>} enables R to read and write various data formats used by other statistical packages. Currently it supports <a href="https://www.sas.com/en_us/home.html">SAS</a>, <a href="https://www.ibm.com/spss">SPSS</a> and <a href="https://www.stata.com/">STATA</a>. {<strong>haven</strong>} output object has four important features:</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[10, 30]">
<div class="quarto-layout-row quarto-layout-valign-center">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="img/chap01/logoi/logo-haven-min.png" class="lightbox" data-glightbox="description: .lightbox-desc-26" data-gallery="quarto-lightbox-gallery-26"><img src="img/chap01/logoi/logo-haven-min.png" class="img-fluid" width="176" /></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 75.0%;justify-content: flex-start;">
<ol type="1">
<li>It creates <code>tibbles::tibble()</code> which a better print method for very long and very wide files.</li>
<li>Dates and times are converted to R date/time classes.</li>
<li>Character vectors are not converted to factors.</li>
<li>Value labels are translated into a new <code>haven::labelled()</code> class, which preserves the original semantics and can easily be coerced to factors with <code>haven::as_factor()</code>. Special missing values are preserved. See details in the vignette <a href="https://haven.tidyverse.org/articles/semantics.html">Conversion semantics</a>.</li>
</ol>
</div>
</div>
</div>
</div>
</figure>
</div>
<p>I am here interested especially in the fourth feature.</p>
</div>
</div>
</section>
<section id="kableextra-1" class="level3" data-number="1.11.9">
<h3 data-number="1.11.9"><span class="header-section-number">1.11.9</span> kableExtra</h3>
<div class="my-resource">
<div class="my-resource-header">
<p>kableExtra: Construct Complex Table with <code>knitr::kable()</code> and Pipe Syntax</p>
</div>
<div class="my-resource-container">
<hr />
<div id="pak-kableExtra" class="quarto-float">
<figure class="quarto-float quarto-float-pak">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-pak" id="pak-kableExtra-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Package Profile 1.9: {<strong>pkg-name</strong>}: A Package to Construct Complex Table with ‘kable’ and Pipe Syntax
</figcaption>
<div aria-describedby="pak-kableExtra-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<hr />
<p>{<strong>kableExtra</strong>}: <a href="URL%20to%20package">Construct Complex Table with ‘kable’ and Pipe Syntax</a></p>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[10, 30]">
<div class="quarto-layout-row quarto-layout-valign-center">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="img/chap02/logoi/logo-kableExtra-min.png" class="lightbox" data-glightbox="description: .lightbox-desc-27" data-gallery="quarto-lightbox-gallery-27"><img src="img/chap02/logoi/logo-kableExtra-min.png" class="img-fluid" width="176" /></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 75.0%;justify-content: flex-start;">
<p>Build complex HTML or <span class="math inline">\(\LaTeX\)</span> tables using <code>kable()</code> from {<strong>knitr</strong>} and the piping syntax from {<strong>magrittr</strong>} Function <code>kable()</code> is a light weight table generator coming from {<strong>knitr</strong>}. This package simplifies the way to manipulate the HTML or <span class="math inline">\(\LaTeX\)</span> codes generated by <code>kable()</code> and allows users to construct complex tables and customize styles using a readable syntax.</p>
</div>
</div>
</div>
</div>
</figure>
</div>
<hr />
</div>
</div>
</section>
<section id="knitr" class="level3" data-number="1.11.10">
<h3 data-number="1.11.10"><span class="header-section-number">1.11.10</span> knitr</h3>
<div class="my-resource">
<div class="my-resource-header">
<p>knitr: A General-Purpose Package for Dynamic Report Generation in R</p>
</div>
<div class="my-resource-container">
<hr />
<div id="pak-knitr" class="quarto-float">
<figure class="quarto-float quarto-float-pak">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-pak" id="pak-knitr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Package Profile 1.10: {<strong>knitr</strong>}: A Package for Dynamic Report Generation in R
</figcaption>
<div aria-describedby="pak-knitr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<hr />
<p>{<strong>knitr</strong>}: <a href="https://yihui.org/knitr/">A General-Purpose Package for Dynamic Report Generation in R</a></p>
<p>(<em>There is no hexagon logo available</em>)</p>
<p>Provides a general-purpose tool for dynamic report generation in R using Literate Programming techniques.</p>
</div>
</figure>
</div>
<hr />
</div>
</div>
</section>
<section id="labelled" class="level3" data-number="1.11.11">
<h3 data-number="1.11.11"><span class="header-section-number">1.11.11</span> labelled</h3>
<div class="my-resource">
<div class="my-resource-header">
<p>labelled: Manipulating Labelled Data</p>
</div>
<div class="my-resource-container">
<hr />
<div id="pak-labelled" class="quarto-float">
<figure class="quarto-float quarto-float-pak">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-pak" id="pak-labelled-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Package Profile 1.11: labelled: A Package for Manipulating Labelled Data
</figcaption>
<div aria-describedby="pak-labelled-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<hr />
<p>{<strong>labelled</strong>}: <a href="https://larmarange.github.io/labelled/">Manipulating Labelled Data</a></p>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[10, 30]">
<div class="quarto-layout-row quarto-layout-valign-center">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="img/chap01/logoi/logo-labelled-min.png" class="lightbox" data-glightbox="description: .lightbox-desc-28" data-gallery="quarto-lightbox-gallery-28"><img src="img/chap01/logoi/logo-labelled-min.png" class="img-fluid" width="176" /></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 75.0%;justify-content: flex-start;">
<p>Work with labelled data imported from <a href="https://www.ibm.com/spss">IBM SPSS</a> or <a href="https://www.stata.com/">STATA</a> with {<strong>haven</strong>} or {<strong>foreign</strong>}. This package provides useful functions to deal with “haven_labelled” and “haven_labelled_spss” classes introduced by {<strong>haven</strong>} package. (With the free <a href="https://www.gnu.org/software/pspp/">gnu PSPP</a> exists also a SPSS like open source version.) See details in the vignette <a href="https://larmarange.github.io/labelled/articles/intro_labelled.html">Introduction to labelled</a> and the <a href="https://larmarange.github.io/labelled/">GitHub website for labelled</a>. There are other vignettes as well and a <a href="https://github.com/larmarange/labelled/raw/main/cheatsheet/labelled_cheatsheet.pdf">cheat sheet as PDF for download</a>.</p>
</div>
</div>
</div>
</div>
</figure>
</div>
</div>
</div>
</section>
<section id="sjlabelled" class="level3" data-number="1.11.12">
<h3 data-number="1.11.12"><span class="header-section-number">1.11.12</span> sjlabelled</h3>
<div class="my-resource">
<div class="my-resource-header">
<p>sjlabelled;</p>
</div>
<div class="my-resource-container">
<hr />
<div id="pak-sjlabelled" class="quarto-float">
<figure class="quarto-float quarto-float-pak">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-pak" id="pak-sjlabelled-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Package Profile 1.12: sjlabelled: A Package for Labelled Data Utility Functions
</figcaption>
<div aria-describedby="pak-sjlabelled-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<hr />
<p>{<strong>sjlabelled</strong>}: <a href="https://strengejacke.github.io/sjlabelled/">Labelled Data Utility Functions</a></p>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[10, 30]">
<div class="quarto-layout-row quarto-layout-valign-center">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="img/chap01/logoi/logo-sjlabelled-min.png" class="lightbox" data-glightbox="description: .lightbox-desc-29" data-gallery="quarto-lightbox-gallery-29"><img src="img/chap01/logoi/logo-sjlabelled-min.png" class="img-fluid" width="176" /></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 75.0%;justify-content: flex-start;">
<p>Basically, this package covers reading and writing data between other statistical packages (like ‘SPSS’) and R, based on the haven and foreign packages; hence, this package also includes functions to make working with labelled data easier. This includes easy ways to get, set or change value and variable label attributes, to convert labelled vectors into factors or numeric (and vice versa), or to deal with multiple declared missing values.</p>
</div>
</div>
</div>
<p>The prefix <code>sj</code> in {<strong>sjlabelled</strong>} (= in German Strenge Jacke, “strict jacket”) refers to other work of <a href="https://www.uke.de/kliniken-institute/institute/medizinische-soziologie/team/profil_daniel_luedecke_ims.html">Daniel Lüdecke</a>, who has developed many R packages. All the <code>sj</code>-packages support labelled data.</p>
</div>
</figure>
</div>
<hr />
<p>His packages are divided in two approaches:</p>
<ol type="1">
<li>Most packages are part pf the project <a href="https://easystats.github.io/easystats/">EasyStats</a>, that provides with 11 packages “An R Framework for Easy Statistical Modeling, Visualization, and Reporting”, similar to the {<strong>tidyverse</strong>} collection. The {<strong>easystats</strong>} collection is orientated more to statistics, whereas {<strong>tidyverse</strong>} is more directed to data science.</li>
<li>The other line of package development supports labelled data in combination with different R task like
<ul>
<li><a href="https://cran.r-project.org/web/packages/sjmisc/index.html">Data and Variable Transformation Functions</a> {<strong>sjmisc</strong>},</li>
<li><a href="https://cran.r-project.org/web/packages/sjPlot/index.html">Data Visualization for Statistics in Social Science</a> {<strong>sjPlot</strong>} and a</li>
<li><a href="https://cran.r-project.org/web/packages/sjstats/index.html">Collection of Convenient Functions for Common Statistical Computations</a> {<strong>sjStats</strong>}. -Additionally there exists {<strong>sjtable2df</strong>} a package to <a href="https://cran.r-project.org/web/packages/sjtable2df/index.html">Convert ‘sjPlot’ HTML-Tables to R ‘data.frame’</a>.</li>
</ul></li>
</ol>
</div>
</div>
</section>
<section id="readr" class="level3" data-number="1.11.13">
<h3 data-number="1.11.13"><span class="header-section-number">1.11.13</span> readr</h3>
<div class="my-resource">
<div class="my-resource-header">
<p>readr: Read Rectangular Text Data</p>
</div>
<div class="my-resource-container">
<hr />
<div id="pak-readr" class="quarto-float">
<figure class="quarto-float quarto-float-pak">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-pak" id="pak-readr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Package Profile 1.13: Package for Reading Rectangular Data
</figcaption>
<div aria-describedby="pak-readr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<hr />
<p>{<strong>readr</strong>}: <a href="https://readr.tidyverse.org/">Read Rectangular Text Data</a></p>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[10, 30]">
<div class="quarto-layout-row quarto-layout-valign-center">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="img/chap01/logoi/logo-readr-min.png" class="lightbox" data-glightbox="description: .lightbox-desc-30" data-gallery="quarto-lightbox-gallery-30"><img src="img/chap01/logoi/logo-readr-min.png" class="img-fluid" width="176" /></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 75.0%;justify-content: flex-start;">
<p>The goal of readr is to provide a fast and friendly way to read rectangular data from delimited files, such as comma-separated values (CSV) and tab-separated values (TSV). It is designed to parse many types of data found in the wild, while providing an informative problem report when parsing leads to unexpected results. <span class="citation" data-cites="readr">(<a href="#ref-readr" role="doc-biblioref">Wickham, Hester, and Bryan 2024</a>)</span></p>
</div>
</div>
</div>
<p>{<strong>readr</strong>} supports the following formats:</p>
<ul>
<li>read_csv(): comma-separated values (CSV)</li>
<li>read_tsv(): tab-separated values (TSV)</li>
<li>read_csv2(): semicolon-separated values with , as the decimal mark</li>
<li>read_delim(): delimited files (CSV and TSV are important special cases)</li>
<li>read_fwf(): fixed-width files</li>
<li>read_table(): whitespace-separated files</li>
<li>read_log(): web log files</li>
</ul>
</div>
</figure>
</div>
<hr />
</div>
</div>
</section>
<section id="skimr" class="level3" data-number="1.11.14">
<h3 data-number="1.11.14"><span class="header-section-number">1.11.14</span> skimr</h3>
<div class="my-resource">
<div class="my-resource-header">
<p>skimr: Compact and Flexible Summaries of Data</p>
</div>
<div class="my-resource-container">
<hr />
<div id="pak-skimr" class="quarto-float">
<figure class="quarto-float quarto-float-pak">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-pak" id="pak-skimr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Package Profile 1.14: A Package for Compact and Flexible Summaries of Data
</figcaption>
<div aria-describedby="pak-skimr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<hr />
<p>{<strong>skimr</strong>}: <a href="https://docs.ropensci.org/skimr/">Compact and Flexible Summaries of Data</a></p>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[10, 30]">
<div class="quarto-layout-row quarto-layout-valign-center">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="img/chap01/logoi/logo-skimr-min.png" class="lightbox" data-glightbox="description: .lightbox-desc-31" data-gallery="quarto-lightbox-gallery-31"><img src="img/chap01/logoi/logo-skimr-min.png" class="img-fluid" width="176" /></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 75.0%;justify-content: flex-start;">
<p>A simple to use summary function that can be used with pipes and displays nicely in the console. The default summary statistics may be modified by the user as can the default formatting. Support for data frames and vectors is included, and users can implement their own skim methods for specific object types as described in a vignette. Default summaries include support for inline spark graphs. Instructions for managing these on specific operating systems are given in the <a href="https://docs.ropensci.org/skimr/articles/skimr.html">Using skimr</a> vignette and the <a href="https://github.com/ropensci/skimr/#skimr-">README</a>.</p>
</div>
</div>
</div>
<p>At the moment I am just using the <code>skimr::skim()</code> function. I believe most of the many other functions for adaption are oriented to developers. But still: I need to have a closer look to this package.</p>
</div>
</figure>
</div>
<hr />
</div>
</div>
</section>
<section id="tibble-1" class="level3" data-number="1.11.15">
<h3 data-number="1.11.15"><span class="header-section-number">1.11.15</span> tibble</h3>
<div class="my-resource">
<div class="my-resource-header">
<p>tibble: Simple Data Frames</p>
</div>
<div class="my-resource-container">
<hr />
<div id="pak-tibble" class="quarto-float">
<figure class="quarto-float quarto-float-pak">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-pak" id="pak-tibble-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Package Profile 1.15: Package for Creating Simple Data Frames
</figcaption>
<div aria-describedby="pak-tibble-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<hr />
<p>{<strong>tibble</strong>}: <a href="https://tibble.tidyverse.org/">Simple Data Frames</a></p>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[10, 30]">
<div class="quarto-layout-row quarto-layout-valign-center">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="img/chap01/logoi/logo-tibble-min.png" class="lightbox" data-glightbox="description: .lightbox-desc-32" data-gallery="quarto-lightbox-gallery-32"><img src="img/chap01/logoi/logo-tibble-min.png" class="img-fluid" width="176" /></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 75.0%;justify-content: flex-start;">
<p>A tibble, or <code>tbl_df</code>, is a modern reimagining of the data.frame, keeping what time has proven to be effective, and throwing out what is not. Tibbles are data.frames that are lazy and surly: they do less (i.e. they don’t change variable names or types, and don’t do partial matching) and complain more (e.g. when a variable does not exist). This forces you to confront problems earlier, typically leading to cleaner, more expressive code. Tibbles also have an enhanced <code>print()</code> method which makes them easier to use with large datasets containing complex objects. <span class="citation" data-cites="tibble">(<a href="#ref-tibble" role="doc-biblioref">Müller and Wickham 2023</a>)</span></p>
</div>
</div>
</div>
</div>
</figure>
</div>
<hr />
</div>
</div>
</section>
<section id="tidyr" class="level3" data-number="1.11.16">
<h3 data-number="1.11.16"><span class="header-section-number">1.11.16</span> tidyr</h3>
<div class="my-resource">
<div class="my-resource-header">
<p>tidyr: Tidy Messy Data</p>
</div>
<div class="my-resource-container">
<hr />
<div id="pak-tidyr" class="quarto-float">
<figure class="quarto-float quarto-float-pak">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-pak" id="pak-tidyr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Package Profile 1.16: Packages for Tidying Messy Data
</figcaption>
<div aria-describedby="pak-tidyr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<hr />
<p>{<strong>tidyr</strong>}: <a href="https://tidyr.tidyverse.org/">Tidy Messy Data</a></p>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[10, 30]">
<div class="quarto-layout-row quarto-layout-valign-center">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="img/chap01/logoi/logo-tidyr-min.png" class="lightbox" data-glightbox="description: .lightbox-desc-33" data-gallery="quarto-lightbox-gallery-33"><img src="img/chap01/logoi/logo-tidyr-min.png" class="img-fluid" width="176" /></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 75.0%;justify-content: flex-start;">
<p>The goal of tidyr is to help you create tidy data. Tidy data describes a standard way of storing data that is used wherever possible throughout the tidyverse. If you ensure that your data is tidy, you’ll spend less time fighting with the tools and more time working on your analysis. <span class="citation" data-cites="tidyr">(<a href="#ref-tidyr" role="doc-biblioref">Wickham, Vaughan, and Girlich 2023</a>)</span> Tidy data is data where: - Every column is a variable. - Every row is an observation. - Every cell is a single value.</p>
</div>
</div>
</div>
</div>
</figure>
</div>
<hr />
</div>
</div>
</section>
<section id="tidyverse" class="level3" data-number="1.11.17">
<h3 data-number="1.11.17"><span class="header-section-number">1.11.17</span> tidyverse</h3>
<div class="my-resource">
<div class="my-resource-header">
<p>tidyverse: Easily Install and Load the ‘Tidyverse’</p>
</div>
<div class="my-resource-container">
<hr />
<div id="pak-tidyverse" class="quarto-float">
<figure class="quarto-float quarto-float-pak">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-pak quarto-uncaptioned" id="pak-tidyverse-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Package Profile 1.17
</figcaption>
<div aria-describedby="pak-tidyverse-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<hr />
<p>{<strong>tidyverse</strong>}: <a href="https://www.tidyverse.org/">Easily Install and Load the ‘Tidyverse’</a></p>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[10, 30]">
<div class="quarto-layout-row quarto-layout-valign-center">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="img/chap01/logoi/logo-tidyverse-min.png" class="lightbox" data-glightbox="description: .lightbox-desc-34" data-gallery="quarto-lightbox-gallery-34"><img src="img/chap01/logoi/logo-tidyverse-min.png" class="img-fluid" width="176" /></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 75.0%;justify-content: flex-start;">
<p>The {<strong>tidyverse</strong>} is an opinionated <a href="https://www.tidyverse.org/packages/">collection of R packages</a> designed for data science. All packages share an underlying design philosophy, grammar, and data structures <span class="citation" data-cites="tidyverse">(<a href="#ref-tidyverse" role="doc-biblioref">Wickham et al. 2019</a>)</span>. Read more about the philosophy and purpose: <a href="https://tidyverse.tidyverse.org/articles/manifesto.html">The tidy tools manifesto</a> and <a href="https://tidyverse.tidyverse.org/articles/paper.html">Welcome to the {<strong>tidyverse</strong>}</a></p>
</div>
</div>
</div>
<p>In this book I am not going to load {<strong>tidyverse</strong>} with all its packages. Instead I am using the <code>&lt;package&gt;::&lt;function&gt;</code> format to access the commands.</p>
<p>Metapackage: Easily Install and Load the ‘Tidyverse’</p>
<hr />
</div>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="glossary" class="level2 unnumbered">
<h2 class="unnumbered">Glossary</h2>
<div class="cell">
<div class="cell-output-display">
<table class="table" data-quarto-postprocess="true" style="margin-left: auto; margin-right: auto;">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">definition</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ACSPRI</td>
<td style="text-align: left;">Australian Consortium for Social and Political Research Inc. oganizes conferences and delivers course. (&lt;a href="https://www.acspri.org.au/"&gt;ACSPRI&lt;/a&gt;)</td>
</tr>
<tr class="even">
<td style="text-align: left;">CSV</td>
<td style="text-align: left;">Text files where the values are separated with commas (Comma Separated Values = CSV). These files have the file extension .csv</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Data Tables</td>
<td style="text-align: left;">Data Tables are --- in contrast to Display Tables --- for analysis and not for presentation. Another purpose of Data Tables is to store, retrieve and share information digitally. In R they are tibbles, data.frames etc.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Display Tables</td>
<td style="text-align: left;">Display Tables are in constrast to Data Tables. You would find them in a web page, a journal article, or in a magazine. Such tables are for presentation, often to facilitate the construction of “Table 1”, i.e., baseline characteristics table commonly found in research papers. (&lt;a href= "https://gt.rstudio.com/articles/gt.html"&gt;Introduction to Creating gt Tables&lt;/a&gt;)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">EDA</td>
<td style="text-align: left;">Explorative Data Analysis is an approach of analyzing data sets to summarize their main characteristics, often using statistical graphics and other data visualization methods. A statistical model can be used or not, but primarily EDA is for seeing what the data can tell us beyond the formal modeling and thereby contrasts traditional hypothesis testing. (&lt;a href="https://en.wikipedia.org/wiki/Exploratory_data_analysis"&gt;Wikipedia&lt;/a&gt;)</td>
</tr>
<tr class="even">
<td style="text-align: left;">General Social Survey</td>
<td style="text-align: left;">A large survey of a sample of people in the United States conducted regularly since 1972; the General Social Survey is abbreviated GSS and is conducted by the National Opinion Research Center at the University of Chicago. (Harris, Glossary)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GSS</td>
<td style="text-align: left;">A large survey of a sample of people in the United States conducted regularly since 1972; the General Social Survey is abbreviated GSS and is conducted by the National Opinion Research Center at the University of Chicago. (Harris, Glossary)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Literate Programming</td>
<td style="text-align: left;">Literate programming is a methodology that combines a programming language with a documentation language, thereby making programs more robust, more portable, more easily maintained, and arguably more fun to write than programs that are written only in a high-level language. The main idea is to treat a program as a piece of literature, addressed to human beings rather than to a computer.(&lt;a href="https://www-cs-faculty.stanford.edu/~knuth/lp.html"&gt;Donald Knuth&lt;/a&gt;)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Microdata</td>
<td style="text-align: left;">Microdata are unit-level data obtained from sample surveys, censuses, and administrative systems. They provide information about characteristics of individual people or entities such as households, business enterprises, facilities, farms or even geographical areas such as villages or towns. They allow in-depth understanding of socio-economic issues by studying relationships and interactions among phenomena. Microdata are thus key to designing projects and formulating policies, targeting interventions and monitoring and measuring the impact and results of projects, interventions and policies. ([The World Bank]</td>
</tr>
<tr class="even">
<td style="text-align: left;">NHANES</td>
<td style="text-align: left;">The National Health and Nutrition Examination Survey (NHANES) is a program of studies designed to assess the health and nutritional status of adults and children in the United States. The survey is unique in that it combines interviews and physical examinations. (&lt;a href="https://www.cdc.gov/nchs/nhanes/about_nhanes.htm"&gt;NHANES&lt;/a&gt;)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Prolog</td>
<td style="text-align: left;">A set of comments at the top of a code file that provides information about what is in the file (SwR, Glossary)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Table 1</td>
<td style="text-align: left;">Descriptive statistics are often displayed in the first table in a published article or report and are therefore often called &lt;i&gt;Table 1 statistics&lt;/i&gt; or the &lt;i&gt;descriptives&lt;/i&gt;. (SwR)</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="session-info" class="level2 unnumbered">
<h2 class="unnumbered">Session Info</h2>
<div class="my-r-code">
<div class="my-r-code-header">
<p>Session Info</p>
</div>
<div class="my-r-code-container">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb100"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>sessioninfo<span class="sc">::</span><span class="fu">session_info</span>()</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; ─ Session info ───────────────────────────────────────────────────────────────
#&gt;  setting  value
#&gt;  version  R version 4.3.2 (2023-10-31)
#&gt;  os       macOS Sonoma 14.2.1
#&gt;  system   x86_64, darwin20
#&gt;  ui       X11
#&gt;  language (EN)
#&gt;  collate  en_US.UTF-8
#&gt;  ctype    en_US.UTF-8
#&gt;  tz       Europe/Vienna
#&gt;  date     2024-02-03
#&gt;  pandoc   3.1.11.1 @ /usr/local/bin/ (via rmarkdown)
#&gt; 
#&gt; ─ Packages ───────────────────────────────────────────────────────────────────
#&gt;  package       * version    date (UTC) lib source
#&gt;  base64enc       0.1-3      2015-07-28 [1] CRAN (R 4.3.0)
#&gt;  bit             4.0.5      2022-11-15 [1] CRAN (R 4.3.0)
#&gt;  bit64           4.0.5      2020-08-30 [1] CRAN (R 4.3.0)
#&gt;  broom.helpers   1.14.0     2023-08-07 [1] CRAN (R 4.3.0)
#&gt;  cli             3.6.2      2023-12-11 [1] CRAN (R 4.3.0)
#&gt;  colorspace      2.1-0      2023-01-23 [1] CRAN (R 4.3.0)
#&gt;  commonmark      1.9.0      2023-03-17 [1] CRAN (R 4.3.0)
#&gt;  crayon          1.5.2      2022-09-29 [1] CRAN (R 4.3.0)
#&gt;  curl            5.2.0      2023-12-08 [1] CRAN (R 4.3.2)
#&gt;  digest          0.6.34     2024-01-11 [1] CRAN (R 4.3.0)
#&gt;  dplyr           1.1.4      2023-11-17 [1] CRAN (R 4.3.0)
#&gt;  evaluate        0.23       2023-11-01 [1] CRAN (R 4.3.0)
#&gt;  fansi           1.0.6      2023-12-08 [1] CRAN (R 4.3.0)
#&gt;  farver          2.1.1      2022-07-06 [1] CRAN (R 4.3.0)
#&gt;  fastmap         1.1.1      2023-02-24 [1] CRAN (R 4.3.0)
#&gt;  forcats         1.0.0      2023-01-29 [1] CRAN (R 4.3.0)
#&gt;  generics        0.1.3      2022-07-05 [1] CRAN (R 4.3.0)
#&gt;  ggplot2         3.4.4      2023-10-12 [1] CRAN (R 4.3.0)
#&gt;  glossary      * 1.0.0.9000 2023-08-12 [1] Github (debruine/glossary@819e329)
#&gt;  glue            1.7.0      2024-01-09 [1] CRAN (R 4.3.0)
#&gt;  gt              0.10.1     2024-01-17 [1] CRAN (R 4.3.0)
#&gt;  gtable          0.3.4      2023-08-21 [1] CRAN (R 4.3.0)
#&gt;  gtsummary       1.7.2      2023-07-15 [1] CRAN (R 4.3.0)
#&gt;  haven           2.5.4      2023-11-30 [1] CRAN (R 4.3.2)
#&gt;  highr           0.10       2022-12-22 [1] CRAN (R 4.3.0)
#&gt;  hms             1.1.3      2023-03-21 [1] CRAN (R 4.3.0)
#&gt;  htmltools       0.5.7      2023-11-03 [1] CRAN (R 4.3.0)
#&gt;  htmlwidgets     1.6.4      2023-12-06 [1] CRAN (R 4.3.0)
#&gt;  jsonlite        1.8.8      2023-12-04 [1] CRAN (R 4.3.0)
#&gt;  kableExtra      1.4.0      2024-01-24 [1] CRAN (R 4.3.2)
#&gt;  knitr           1.45       2023-10-30 [1] CRAN (R 4.3.0)
#&gt;  labeling        0.4.3      2023-08-29 [1] CRAN (R 4.3.0)
#&gt;  labelled        2.12.0     2023-06-21 [1] CRAN (R 4.3.0)
#&gt;  lifecycle       1.0.4      2023-11-07 [1] CRAN (R 4.3.0)
#&gt;  magrittr        2.0.3      2022-03-30 [1] CRAN (R 4.3.0)
#&gt;  markdown        1.12       2023-12-06 [1] CRAN (R 4.3.0)
#&gt;  munsell         0.5.0      2018-06-12 [1] CRAN (R 4.3.0)
#&gt;  pillar          1.9.0      2023-03-22 [1] CRAN (R 4.3.0)
#&gt;  pkgconfig       2.0.3      2019-09-22 [1] CRAN (R 4.3.0)
#&gt;  purrr           1.0.2      2023-08-10 [1] CRAN (R 4.3.0)
#&gt;  R6              2.5.1      2021-08-19 [1] CRAN (R 4.3.0)
#&gt;  readr           2.1.5      2024-01-10 [1] CRAN (R 4.3.0)
#&gt;  repr            1.1.6      2023-01-26 [1] CRAN (R 4.3.0)
#&gt;  rlang           1.1.3      2024-01-10 [1] CRAN (R 4.3.0)
#&gt;  rmarkdown       2.25       2023-09-18 [1] CRAN (R 4.3.0)
#&gt;  rstudioapi      0.15.0     2023-07-07 [1] CRAN (R 4.3.0)
#&gt;  rversions       2.1.2      2022-08-31 [1] CRAN (R 4.3.0)
#&gt;  sass            0.4.8      2023-12-06 [1] CRAN (R 4.3.0)
#&gt;  scales          1.3.0      2023-11-28 [1] CRAN (R 4.3.2)
#&gt;  sessioninfo     1.2.2      2021-12-06 [1] CRAN (R 4.3.0)
#&gt;  skimr           2.1.5      2022-12-23 [1] CRAN (R 4.3.0)
#&gt;  stringi         1.8.3      2023-12-11 [1] CRAN (R 4.3.0)
#&gt;  stringr         1.5.1      2023-11-14 [1] CRAN (R 4.3.0)
#&gt;  svglite         2.1.3      2023-12-08 [1] CRAN (R 4.3.0)
#&gt;  systemfonts     1.0.5      2023-10-09 [1] CRAN (R 4.3.0)
#&gt;  tibble          3.2.1      2023-03-20 [1] CRAN (R 4.3.0)
#&gt;  tidyr           1.3.1      2024-01-24 [1] CRAN (R 4.3.2)
#&gt;  tidyselect      1.2.0      2022-10-10 [1] CRAN (R 4.3.0)
#&gt;  tzdb            0.4.0      2023-05-12 [1] CRAN (R 4.3.0)
#&gt;  utf8            1.2.4      2023-10-22 [1] CRAN (R 4.3.0)
#&gt;  vctrs           0.6.5      2023-12-01 [1] CRAN (R 4.3.2)
#&gt;  viridisLite     0.4.2      2023-05-02 [1] CRAN (R 4.3.0)
#&gt;  vroom           1.6.5      2023-12-05 [1] CRAN (R 4.3.0)
#&gt;  withr           3.0.0      2024-01-16 [1] CRAN (R 4.3.0)
#&gt;  xfun            0.41       2023-11-01 [1] CRAN (R 4.3.0)
#&gt;  xml2            1.3.6      2023-12-04 [1] CRAN (R 4.3.0)
#&gt;  yaml            2.3.8      2023-12-11 [1] CRAN (R 4.3.0)
#&gt; 
#&gt;  [1] /Library/Frameworks/R.framework/Versions/4.3-x86_64/library
#&gt;  [2] /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/library
#&gt; 
#&gt; ──────────────────────────────────────────────────────────────────────────────</code></pre>
</div>
</div>
</div>
</div>
<div id="quarto-navigation-envelope" class="hidden">
<p><span class="hidden" data-render-id="quarto-int-sidebar-title">Notes on Statistics with R (SwR)</span> <span class="hidden" data-render-id="quarto-int-navbar-title">Notes on Statistics with R (SwR)</span> <span class="hidden" data-render-id="quarto-int-next"><span class="chapter-number">2</span>  <span class="chapter-title">Descriptive statistics</span></span> <span class="hidden" data-render-id="quarto-int-prev">Preface</span> <span class="hidden" data-render-id="quarto-int-sidebar:/index.htmlPreface">Preface</span> <span class="hidden" data-render-id="quarto-int-sidebar:/01-preparing-data.html&lt;span-class=&#39;chapter-number&#39;&gt;1&lt;/span&gt;--&lt;span-class=&#39;chapter-title&#39;&gt;Preparing-Data&lt;/span&gt;"><span class="chapter-number">1</span>  <span class="chapter-title">Preparing Data</span></span> <span class="hidden" data-render-id="quarto-int-sidebar:/02-descriptive-statistics.html&lt;span-class=&#39;chapter-number&#39;&gt;2&lt;/span&gt;--&lt;span-class=&#39;chapter-title&#39;&gt;Descriptive-statistics&lt;/span&gt;"><span class="chapter-number">2</span>  <span class="chapter-title">Descriptive statistics</span></span> <span class="hidden" data-render-id="quarto-int-sidebar:/03-data-visualization.html&lt;span-class=&#39;chapter-number&#39;&gt;3&lt;/span&gt;--&lt;span-class=&#39;chapter-title&#39;&gt;Data-visualization&lt;/span&gt;"><span class="chapter-number">3</span>  <span class="chapter-title">Data visualization</span></span> <span class="hidden" data-render-id="quarto-int-sidebar:/95-references.htmlReferences">References</span> <span class="hidden" data-render-id="quarto-breadcrumbs-&lt;span-class=&#39;chapter-number&#39;&gt;1&lt;/span&gt;--&lt;span-class=&#39;chapter-title&#39;&gt;Preparing-Data&lt;/span&gt;"><span class="chapter-number">1</span>  <span class="chapter-title">Preparing Data</span></span></p>
</div>
<div id="quarto-meta-markdown" class="hidden">
<p><span class="hidden" data-render-id="quarto-metatitle">Notes on Statistics with R (SwR) - <span id="sec-chap01" class="quarto-section-identifier"><span class="chapter-number">1</span>  <span class="chapter-title">Preparing Data</span></span></span> <span class="hidden" data-render-id="quarto-twittercardtitle">Notes on Statistics with R (SwR) - <span id="sec-chap01" class="quarto-section-identifier"><span class="chapter-number">1</span>  <span class="chapter-title">Preparing Data</span></span></span> <span class="hidden" data-render-id="quarto-ogcardtitle">Notes on Statistics with R (SwR) - <span id="sec-chap01" class="quarto-section-identifier"><span class="chapter-number">1</span>  <span class="chapter-title">Preparing Data</span></span></span> <span class="hidden" data-render-id="quarto-metasitename">Notes on Statistics with R (SwR)</span> <span class="hidden" data-render-id="quarto-twittercarddesc"></span> <span class="hidden" data-render-id="quarto-ogcardddesc"></span></p>
</div>
<!-- -->
<div class="quarto-embedded-source-code">
<div class="sourceCode" id="cb102" data-shortcodes="false"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Preparing Data {#sec-chap01}</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: setup</span></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">source</span>(<span class="at">file =</span> <span class="st">&quot;../_glance_data.R&quot;</span>)</span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a><span class="fu">## Achievements to unlock</span></span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a>::: my-objectives</span>
<span id="cb102-16"><a href="#cb102-16" aria-hidden="true" tabindex="-1"></a>::: my-objectives-header</span>
<span id="cb102-17"><a href="#cb102-17" aria-hidden="true" tabindex="-1"></a>Achievements:</span>
<span id="cb102-18"><a href="#cb102-18" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-19"><a href="#cb102-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-20"><a href="#cb102-20" aria-hidden="true" tabindex="-1"></a>::: my-objectives-container</span>
<span id="cb102-21"><a href="#cb102-21" aria-hidden="true" tabindex="-1"></a>**SwR Achievements**</span>
<span id="cb102-22"><a href="#cb102-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-23"><a href="#cb102-23" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>(~~Observations and variables~~)</span>
<span id="cb102-24"><a href="#cb102-24" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Using reproducible research practices (@sec-chap01-reproducibility)</span>
<span id="cb102-25"><a href="#cb102-25" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>(~~Understanding and changing data types~~)</span>
<span id="cb102-26"><a href="#cb102-26" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Entering or loading data into R (@sec-chap01-import-data)</span>
<span id="cb102-27"><a href="#cb102-27" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Identifying and treating missing values </span>
<span id="cb102-28"><a href="#cb102-28" aria-hidden="true" tabindex="-1"></a>(Data wrangling) (@sec-chap01-data-wrangling)</span>
<span id="cb102-29"><a href="#cb102-29" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Building a basic bar chart </span>
<span id="cb102-30"><a href="#cb102-30" aria-hidden="true" tabindex="-1"></a>(Replicate Figure 1.1 and 1.2) (@sec-chap01-repr-bar-charts)</span>
<span id="cb102-31"><a href="#cb102-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-32"><a href="#cb102-32" aria-hidden="true" tabindex="-1"></a>I will skip the crossed out learning objectives in parenthesis as I know</span>
<span id="cb102-33"><a href="#cb102-33" aria-hidden="true" tabindex="-1"></a>already these procedures. However I will modify and elaborate some of</span>
<span id="cb102-34"><a href="#cb102-34" aria-hidden="true" tabindex="-1"></a>these achievements as mentioned in the parentheses.</span>
<span id="cb102-35"><a href="#cb102-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-36"><a href="#cb102-36" aria-hidden="true" tabindex="-1"></a>I will add other objectives that resulted from questions that arose</span>
<span id="cb102-37"><a href="#cb102-37" aria-hidden="true" tabindex="-1"></a>during reading the book.</span>
<span id="cb102-38"><a href="#cb102-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-39"><a href="#cb102-39" aria-hidden="true" tabindex="-1"></a>**Questions that resulted to additional objectives**</span>
<span id="cb102-40"><a href="#cb102-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-41"><a href="#cb102-41" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>How to download data directly from the</span>
<span id="cb102-42"><a href="#cb102-42" aria-hidden="true" tabindex="-1"></a>    <span class="in">`r glossary(&quot;General Social Survey&quot;)`</span> (GSS) web page?</span>
<span id="cb102-43"><a href="#cb102-43" aria-hidden="true" tabindex="-1"></a>    {@sec-chap01-get-gss-data}</span>
<span id="cb102-44"><a href="#cb102-44" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>How to work with labelled data? {@sec-chap01-labelled-data}</span>
<span id="cb102-45"><a href="#cb102-45" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Reviewing different packages for creating tables (@sec-chap01-review-table-packages)</span>
<span id="cb102-46"><a href="#cb102-46" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Introducing {**gtsummary**}, a packages for presentation-ready data summary and analytic result tables (see: @pak-gtsummary @sec-chap01-experiments-gtsummary)</span>
<span id="cb102-47"><a href="#cb102-47" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Developing timeline graph (1973-2022) about opinions of respondents from <span class="in">`r glossary(&quot;GSS&quot;)`</span> surveys about legalizing marijuana (@sec-chap01-grass-timeline)</span>
<span id="cb102-48"><a href="#cb102-48" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-49"><a href="#cb102-49" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-50"><a href="#cb102-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-51"><a href="#cb102-51" aria-hidden="true" tabindex="-1"></a><span class="fu">## Using reproducible research practices {#sec-chap01-reproducibility}</span></span>
<span id="cb102-52"><a href="#cb102-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-53"><a href="#cb102-53" aria-hidden="true" tabindex="-1"></a><span class="fu">### Script files</span></span>
<span id="cb102-54"><a href="#cb102-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-55"><a href="#cb102-55" aria-hidden="true" tabindex="-1"></a>SwR explains writing script files, but I am using</span>
<span id="cb102-56"><a href="#cb102-56" aria-hidden="true" tabindex="-1"></a><span class="in">`r glossary(&quot;Literate Programming&quot;)`</span> with Quarto. This has the</span>
<span id="cb102-57"><a href="#cb102-57" aria-hidden="true" tabindex="-1"></a>consequence that in addition to short comments inside code cells I have</span>
<span id="cb102-58"><a href="#cb102-58" aria-hidden="true" tabindex="-1"></a>the possibility to write extensively in the other parts of the file</span>
<span id="cb102-59"><a href="#cb102-59" aria-hidden="true" tabindex="-1"></a>about approach, code, results etc.</span>
<span id="cb102-60"><a href="#cb102-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-61"><a href="#cb102-61" aria-hidden="true" tabindex="-1"></a>A practical advice for scripts is to include a <span class="in">`r glossary(&quot;prolog&quot;)`</span>.</span>
<span id="cb102-62"><a href="#cb102-62" aria-hidden="true" tabindex="-1"></a>Possible prolog sections:</span>
<span id="cb102-63"><a href="#cb102-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-64"><a href="#cb102-64" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Project name</span>
<span id="cb102-65"><a href="#cb102-65" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Project purpose</span>
<span id="cb102-66"><a href="#cb102-66" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Name(s) of data set(s) used in the project</span>
<span id="cb102-67"><a href="#cb102-67" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Location(s) of data set(s) used in the project</span>
<span id="cb102-68"><a href="#cb102-68" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Code author name (you!)</span>
<span id="cb102-69"><a href="#cb102-69" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Date code created</span>
<span id="cb102-70"><a href="#cb102-70" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Date last time code was edited</span>
<span id="cb102-71"><a href="#cb102-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-72"><a href="#cb102-72" aria-hidden="true" tabindex="-1"></a>Most of these information are naturally occurring in the writing process</span>
<span id="cb102-73"><a href="#cb102-73" aria-hidden="true" tabindex="-1"></a>of Quarto books.</span>
<span id="cb102-74"><a href="#cb102-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-75"><a href="#cb102-75" aria-hidden="true" tabindex="-1"></a>::: my-resource</span>
<span id="cb102-76"><a href="#cb102-76" aria-hidden="true" tabindex="-1"></a>::: my-resource-header</span>
<span id="cb102-77"><a href="#cb102-77" aria-hidden="true" tabindex="-1"></a>Literate Statistical Programming</span>
<span id="cb102-78"><a href="#cb102-78" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-79"><a href="#cb102-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-80"><a href="#cb102-80" aria-hidden="true" tabindex="-1"></a>::: my-resource-container</span>
<span id="cb102-81"><a href="#cb102-81" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Literate Programming:</span>
<span id="cb102-82"><a href="#cb102-82" aria-hidden="true" tabindex="-1"></a>    (<span class="co">[</span><span class="ot">Wikipedia</span><span class="co">](https://en.wikipedia.org/wiki/Literate_programming)</span>)</span>
<span id="cb102-83"><a href="#cb102-83" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Introduction to Literate Programming with Quarto ([Online</span>
<span id="cb102-84"><a href="#cb102-84" aria-hidden="true" tabindex="-1"></a>    Slides](https://gesiscss.github.io/quarto-workshop/material/slides/01_introduction.html#/title-slide))</span>
<span id="cb102-85"><a href="#cb102-85" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Reproducibility and literate programming in R ([bookdown</span>
<span id="cb102-86"><a href="#cb102-86" aria-hidden="true" tabindex="-1"></a>    course](https://exeter-data-analytics.github.io/LitProg/index.html))</span>
<span id="cb102-87"><a href="#cb102-87" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Introduction to Data Science in R for Biologists (Module on</span>
<span id="cb102-88"><a href="#cb102-88" aria-hidden="true" tabindex="-1"></a>    [Literate Statistical Programming and</span>
<span id="cb102-89"><a href="#cb102-89" aria-hidden="true" tabindex="-1"></a>    Quarto](https://mbutler808.github.io/rclass/posts/2023-01-26-intro-quarto/index.html))</span>
<span id="cb102-90"><a href="#cb102-90" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Let’s build a blog with Quarto [Literate programming in</span>
<span id="cb102-91"><a href="#cb102-91" aria-hidden="true" tabindex="-1"></a>    Quarto](https://ivelasq.quarto.pub/building-a-blog-with-quarto/workflow/write-docs/))</span>
<span id="cb102-92"><a href="#cb102-92" aria-hidden="true" tabindex="-1"></a>    by Isabella Velásquez. The site has other material (for Quarto</span>
<span id="cb102-93"><a href="#cb102-93" aria-hidden="true" tabindex="-1"></a>    blogs) as well: [Migrate from R</span>
<span id="cb102-94"><a href="#cb102-94" aria-hidden="true" tabindex="-1"></a>    Markdown](https://ivelasq.quarto.pub/building-a-blog-with-quarto/learn-more/migrate-blog/),</span>
<span id="cb102-95"><a href="#cb102-95" aria-hidden="true" tabindex="-1"></a>    [Additional</span>
<span id="cb102-96"><a href="#cb102-96" aria-hidden="true" tabindex="-1"></a>    resources](https://ivelasq.quarto.pub/building-a-blog-with-quarto/learn-more/resources/)</span>
<span id="cb102-97"><a href="#cb102-97" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Introduction to literate programming with Quarto and Markdown by</span>
<span id="cb102-98"><a href="#cb102-98" aria-hidden="true" tabindex="-1"></a>    Gesis</span>
<span id="cb102-99"><a href="#cb102-99" aria-hidden="true" tabindex="-1"></a>    (<span class="co">[</span><span class="ot">Slides</span><span class="co">](https://gesiscss.github.io/quarto-workshop/material/slides/01_introduction.html#/title-slide)</span>)</span>
<span id="cb102-100"><a href="#cb102-100" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-101"><a href="#cb102-101" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-102"><a href="#cb102-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-103"><a href="#cb102-103" aria-hidden="true" tabindex="-1"></a><span class="fu">### Naming objects</span></span>
<span id="cb102-104"><a href="#cb102-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-105"><a href="#cb102-105" aria-hidden="true" tabindex="-1"></a>I am used to apply the [tidyverse style</span>
<span id="cb102-106"><a href="#cb102-106" aria-hidden="true" tabindex="-1"></a>guide](https://style.tidyverse.org/). It requires to use underlines</span>
<span id="cb102-107"><a href="#cb102-107" aria-hidden="true" tabindex="-1"></a>(&quot;snake_code&quot;) as separators in object names. (In contrast to</span>
<span id="cb102-108"><a href="#cb102-108" aria-hidden="true" tabindex="-1"></a>&quot;camelCase&quot; code style). But reading the book I thought it might be a</span>
<span id="cb102-109"><a href="#cb102-109" aria-hidden="true" tabindex="-1"></a>good idea to use special additional styles for certain specific objects.</span>
<span id="cb102-110"><a href="#cb102-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-111"><a href="#cb102-111" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Naming constants**: Prefix name of constants with <span class="in">`k_`</span>.</span>
<span id="cb102-112"><a href="#cb102-112" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Naming variables**: Standard snake code.</span>
<span id="cb102-113"><a href="#cb102-113" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Naming functions**: Prefix name of private functions with a dot</span>
<span id="cb102-114"><a href="#cb102-114" aria-hidden="true" tabindex="-1"></a>    <span class="in">`.`</span>. I had already experienced that didn&#39;t know from which package a</span>
<span id="cb102-115"><a href="#cb102-115" aria-hidden="true" tabindex="-1"></a>    function was. Only to learn after looking around for minutes that it</span>
<span id="cb102-116"><a href="#cb102-116" aria-hidden="true" tabindex="-1"></a>    was a function I wrote myself!</span>
<span id="cb102-117"><a href="#cb102-117" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Naming data frames**: Prefix name with <span class="in">`df_`</span> for data.frame and</span>
<span id="cb102-118"><a href="#cb102-118" aria-hidden="true" tabindex="-1"></a>    <span class="in">`dt_`</span> for tibble. I might also use a suffix to refer to the status</span>
<span id="cb102-119"><a href="#cb102-119" aria-hidden="true" tabindex="-1"></a>    e.g., <span class="in">`_raw`</span> (raw data), <span class="in">`_clean`</span> (cleaned data), <span class="in">`_v2`</span> (version</span>
<span id="cb102-120"><a href="#cb102-120" aria-hidden="true" tabindex="-1"></a>    number).</span>
<span id="cb102-121"><a href="#cb102-121" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Naming files**: It could be helpful to add at the start the</span>
<span id="cb102-122"><a href="#cb102-122" aria-hidden="true" tabindex="-1"></a>    chapter number e.g. <span class="in">`chap02_`</span>. And maybe also --- as in naming data</span>
<span id="cb102-123"><a href="#cb102-123" aria-hidden="true" tabindex="-1"></a>    frames --- the status as suffix.</span>
<span id="cb102-124"><a href="#cb102-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-125"><a href="#cb102-125" aria-hidden="true" tabindex="-1"></a><span class="fu">## Import data frames from outside resources {#sec-chap01-import-data}</span></span>
<span id="cb102-126"><a href="#cb102-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-127"><a href="#cb102-127" aria-hidden="true" tabindex="-1"></a>R has many possibilities to import data from other statistical packages.</span>
<span id="cb102-128"><a href="#cb102-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-129"><a href="#cb102-129" aria-hidden="true" tabindex="-1"></a><span class="fu">### Some common file extensions</span></span>
<span id="cb102-130"><a href="#cb102-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-131"><a href="#cb102-131" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**.csv**: comma separated values</span>
<span id="cb102-132"><a href="#cb102-132" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**.txt**: text file</span>
<span id="cb102-133"><a href="#cb102-133" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**.xls or .xlsx**: Excel file</span>
<span id="cb102-134"><a href="#cb102-134" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**.sav**: SPSS file</span>
<span id="cb102-135"><a href="#cb102-135" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**.sasb7dat**: SAS file</span>
<span id="cb102-136"><a href="#cb102-136" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**.xpt**: SAS transfer file</span>
<span id="cb102-137"><a href="#cb102-137" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**.dta**: Stata file</span>
<span id="cb102-138"><a href="#cb102-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-139"><a href="#cb102-139" aria-hidden="true" tabindex="-1"></a><span class="fu">### Some packages for import data sources</span></span>
<span id="cb102-140"><a href="#cb102-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-141"><a href="#cb102-141" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>{**readr**}: Read Rectangular Text Data (see: @pak-readr), it is part of {**tidyverse**}</span>
<span id="cb102-142"><a href="#cb102-142" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>{**vroom**}: Read and Write Rectangular Text Data Quickly</span>
<span id="cb102-143"><a href="#cb102-143" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>{**haven**}: Import and Export &#39;SPSS&#39;, &#39;Stata&#39; and &#39;SAS&#39; Files (see: @pak-haven)</span>
<span id="cb102-144"><a href="#cb102-144" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>{**foreign**}: Read Data Stored by &#39;Minitab&#39;, &#39;S&#39;, &#39;SAS&#39;, &#39;SPSS&#39;,</span>
<span id="cb102-145"><a href="#cb102-145" aria-hidden="true" tabindex="-1"></a>    &#39;Stata&#39;, &#39;Systat&#39;, &#39;Weka&#39;, &#39;dBase&#39;, ...</span>
<span id="cb102-146"><a href="#cb102-146" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>{**readxl**}: Read Excel Files</span>
<span id="cb102-147"><a href="#cb102-147" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>{**openxslx**}: Read, Write and Edit xslx Files</span>
<span id="cb102-148"><a href="#cb102-148" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>{**readODS**}: Read and Write ODS Files (e.g. LibreOffice)</span>
<span id="cb102-149"><a href="#cb102-149" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>{**clipr**}: Read and Write from the System Clipboard</span>
<span id="cb102-150"><a href="#cb102-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-151"><a href="#cb102-151" aria-hidden="true" tabindex="-1"></a>I will not go into the import details of all the different packages</span>
<span id="cb102-152"><a href="#cb102-152" aria-hidden="true" tabindex="-1"></a>here, because my focus is on the <span class="in">`r glossary(&quot;General Social Survey&quot;)`</span></span>
<span id="cb102-153"><a href="#cb102-153" aria-hidden="true" tabindex="-1"></a>(GSS) data.</span>
<span id="cb102-154"><a href="#cb102-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-155"><a href="#cb102-155" aria-hidden="true" tabindex="-1"></a><span class="fu">### Import data with a .csv file</span></span>
<span id="cb102-156"><a href="#cb102-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-157"><a href="#cb102-157" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; “While the GSS data can be read into R directly from the GSS website,</span></span>
<span id="cb102-158"><a href="#cb102-158" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Kiara had experienced this and knew that it could be frustrating.”</span></span>
<span id="cb102-159"><a href="#cb102-159" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; (</span><span class="co">[</span><span class="ot">Harris, 2020</span><span class="co">](zotero://select/groups/5254842/items/9N29QMJB)</span><span class="at">)</span></span>
<span id="cb102-160"><a href="#cb102-160" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; (</span><span class="co">[</span><span class="ot">pdf</span><span class="co">](zotero://open-pdf/groups/5254842/items/3NDRGBBW?page=107&amp;annotation=SFD9FHQD)</span><span class="at">)</span></span>
<span id="cb102-161"><a href="#cb102-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-162"><a href="#cb102-162" aria-hidden="true" tabindex="-1"></a>The author therefore offers for this chapter a</span>
<span id="cb102-163"><a href="#cb102-163" aria-hidden="true" tabindex="-1"></a><span class="in">`r glossary(&quot;CSV&quot;, &quot;.csv&quot;)`</span> file with the data. In later chapters</span>
<span id="cb102-164"><a href="#cb102-164" aria-hidden="true" tabindex="-1"></a>learner can choose to use the provided files from the [SAGE</span>
<span id="cb102-165"><a href="#cb102-165" aria-hidden="true" tabindex="-1"></a>webpage](https://edge.sagepub.com/harris1e/student-resources/datasets-and-r-code).</span>
<span id="cb102-166"><a href="#cb102-166" aria-hidden="true" tabindex="-1"></a>Even if these data files are not yet cleaned, it is a kind of cheating,</span>
<span id="cb102-167"><a href="#cb102-167" aria-hidden="true" tabindex="-1"></a>because it bypasses downloading data from the original source.</span>
<span id="cb102-168"><a href="#cb102-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-169"><a href="#cb102-169" aria-hidden="true" tabindex="-1"></a>::: my-example</span>
<span id="cb102-170"><a href="#cb102-170" aria-hidden="true" tabindex="-1"></a>::: my-example-header</span>
<span id="cb102-171"><a href="#cb102-171" aria-hidden="true" tabindex="-1"></a>::: {#exm-chap01-read-csv-show-data}</span>
<span id="cb102-172"><a href="#cb102-172" aria-hidden="true" tabindex="-1"></a>: Read data from a .csv file into R</span>
<span id="cb102-173"><a href="#cb102-173" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-174"><a href="#cb102-174" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-175"><a href="#cb102-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-176"><a href="#cb102-176" aria-hidden="true" tabindex="-1"></a>::: my-example-container</span>
<span id="cb102-177"><a href="#cb102-177" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb102-178"><a href="#cb102-178" aria-hidden="true" tabindex="-1"></a><span class="fu">###### summary()</span></span>
<span id="cb102-179"><a href="#cb102-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-180"><a href="#cb102-180" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb102-181"><a href="#cb102-181" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb102-182"><a href="#cb102-182" aria-hidden="true" tabindex="-1"></a>::: {#cnj-code-name-a}</span>
<span id="cb102-183"><a href="#cb102-183" aria-hidden="true" tabindex="-1"></a>: Read .csv file and show data summary</span>
<span id="cb102-184"><a href="#cb102-184" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-185"><a href="#cb102-185" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-186"><a href="#cb102-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-187"><a href="#cb102-187" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb102-188"><a href="#cb102-188" aria-hidden="true" tabindex="-1"></a>::: {#lst-chap01-read-csv-show-summary}</span>
<span id="cb102-189"><a href="#cb102-189" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-190"><a href="#cb102-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-191"><a href="#cb102-191" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-192"><a href="#cb102-192" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: read-csv-show-summary</span></span>
<span id="cb102-193"><a href="#cb102-193" aria-hidden="true" tabindex="-1"></a><span class="co">#| cache: true</span></span>
<span id="cb102-194"><a href="#cb102-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-195"><a href="#cb102-195" aria-hidden="true" tabindex="-1"></a>gss_2016_book <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(</span>
<span id="cb102-196"><a href="#cb102-196" aria-hidden="true" tabindex="-1"></a>    <span class="at">file =</span> <span class="st">&quot;data-harris/legal_weed_age_GSS2016_ch1.csv&quot;</span>,</span>
<span id="cb102-197"><a href="#cb102-197" aria-hidden="true" tabindex="-1"></a>    <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb102-198"><a href="#cb102-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-199"><a href="#cb102-199" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gss_2016_book)</span>
<span id="cb102-200"><a href="#cb102-200" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-201"><a href="#cb102-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-202"><a href="#cb102-202" aria-hidden="true" tabindex="-1"></a>Read the provided dataset as a .csv file into R and show</span>
<span id="cb102-203"><a href="#cb102-203" aria-hidden="true" tabindex="-1"></a><span class="in">`base::summary()`</span></span>
<span id="cb102-204"><a href="#cb102-204" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-205"><a href="#cb102-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-206"><a href="#cb102-206" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb102-207"><a href="#cb102-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-208"><a href="#cb102-208" aria-hidden="true" tabindex="-1"></a>**Some comments**</span>
<span id="cb102-209"><a href="#cb102-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-210"><a href="#cb102-210" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>In contrast to <span class="in">`base::read.csv()`</span> in the book I used with</span>
<span id="cb102-211"><a href="#cb102-211" aria-hidden="true" tabindex="-1"></a>    <span class="in">`readr::read_csv()`</span> a function from the {**tidyverse**} package</span>
<span id="cb102-212"><a href="#cb102-212" aria-hidden="true" tabindex="-1"></a>    collection.</span>
<span id="cb102-213"><a href="#cb102-213" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>I added the <span class="in">`show_col_types = FALSE`</span> argument to prevent a message</span>
<span id="cb102-214"><a href="#cb102-214" aria-hidden="true" tabindex="-1"></a>    about the column specification.</span>
<span id="cb102-215"><a href="#cb102-215" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-216"><a href="#cb102-216" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-217"><a href="#cb102-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-218"><a href="#cb102-218" aria-hidden="true" tabindex="-1"></a>The output of <span class="in">`base::summary`</span> is in this case not very informative.</span>
<span id="cb102-219"><a href="#cb102-219" aria-hidden="true" tabindex="-1"></a>Looking around for appropriate reporting function I developed with</span>
<span id="cb102-220"><a href="#cb102-220" aria-hidden="true" tabindex="-1"></a><span class="in">`glance_data()`</span> my private command. (See</span>
<span id="cb102-221"><a href="#cb102-221" aria-hidden="true" tabindex="-1"></a>@lst-chap01-read-csv-glance-data in next tab.)</span>
<span id="cb102-222"><a href="#cb102-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-223"><a href="#cb102-223" aria-hidden="true" tabindex="-1"></a><span class="fu">###### glance_data()</span></span>
<span id="cb102-224"><a href="#cb102-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-225"><a href="#cb102-225" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb102-226"><a href="#cb102-226" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb102-227"><a href="#cb102-227" aria-hidden="true" tabindex="-1"></a>::: {#cnj-code-name-b}</span>
<span id="cb102-228"><a href="#cb102-228" aria-hidden="true" tabindex="-1"></a>Look at data with my private function <span class="in">`glance_data()`</span></span>
<span id="cb102-229"><a href="#cb102-229" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-230"><a href="#cb102-230" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-231"><a href="#cb102-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-232"><a href="#cb102-232" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb102-233"><a href="#cb102-233" aria-hidden="true" tabindex="-1"></a>::: {#lst-chap01-read-csv-glance-data}</span>
<span id="cb102-234"><a href="#cb102-234" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-235"><a href="#cb102-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-236"><a href="#cb102-236" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-237"><a href="#cb102-237" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: glance-data</span></span>
<span id="cb102-238"><a href="#cb102-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-239"><a href="#cb102-239" aria-hidden="true" tabindex="-1"></a>gss_2016_book <span class="sc">|&gt;</span></span>
<span id="cb102-240"><a href="#cb102-240" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(age, grass)) <span class="sc">|&gt;</span> </span>
<span id="cb102-241"><a href="#cb102-241" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glance_data</span>(<span class="at">N =</span> <span class="dv">8</span>, <span class="at">seed =</span> <span class="dv">2016</span>)</span>
<span id="cb102-242"><a href="#cb102-242" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-243"><a href="#cb102-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-244"><a href="#cb102-244" aria-hidden="true" tabindex="-1"></a>Display 8 randomly chosen rows in addition to the first and last row</span>
<span id="cb102-245"><a href="#cb102-245" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-246"><a href="#cb102-246" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-247"><a href="#cb102-247" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-248"><a href="#cb102-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-249"><a href="#cb102-249" aria-hidden="true" tabindex="-1"></a>I developed a private function <span class="in">`glance_data()`</span> to provide a first</span>
<span id="cb102-250"><a href="#cb102-250" aria-hidden="true" tabindex="-1"></a>impression about the data. The function prints the first and last row of</span>
<span id="cb102-251"><a href="#cb102-251" aria-hidden="true" tabindex="-1"></a>the dataset, so you know implicitly how many rows the dataset has.</span>
<span id="cb102-252"><a href="#cb102-252" aria-hidden="true" tabindex="-1"></a>Between the first and last row the function adds randomly <span class="in">`N`</span> other rows</span>
<span id="cb102-253"><a href="#cb102-253" aria-hidden="true" tabindex="-1"></a>(default is 8). Additionally it provides the row number of the data in a</span>
<span id="cb102-254"><a href="#cb102-254" aria-hidden="true" tabindex="-1"></a>separate column. (The column header <span class="in">`obs`</span> stands for &quot;observation&quot;.) For</span>
<span id="cb102-255"><a href="#cb102-255" aria-hidden="true" tabindex="-1"></a>reproducibility purposes you can also add a number for the <span class="in">`set.seed()`</span></span>
<span id="cb102-256"><a href="#cb102-256" aria-hidden="true" tabindex="-1"></a>command.</span>
<span id="cb102-257"><a href="#cb102-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-258"><a href="#cb102-258" aria-hidden="true" tabindex="-1"></a>The idea of <span class="in">`glance_data()`</span> is to get a first impression of the dataset.</span>
<span id="cb102-259"><a href="#cb102-259" aria-hidden="true" tabindex="-1"></a>Other printing methods show only the first (or last) rows of the</span>
<span id="cb102-260"><a href="#cb102-260" aria-hidden="true" tabindex="-1"></a>dataset. This could be misleading, giving a wrong impression about</span>
<span id="cb102-261"><a href="#cb102-261" aria-hidden="true" tabindex="-1"></a>typical data.</span>
<span id="cb102-262"><a href="#cb102-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-263"><a href="#cb102-263" aria-hidden="true" tabindex="-1"></a><span class="fu">###### glance_data</span></span>
<span id="cb102-264"><a href="#cb102-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-265"><a href="#cb102-265" aria-hidden="true" tabindex="-1"></a>Maybe you are interested to use <span class="in">`glance_data()`</span> yourself? It isn&#39;t</span>
<span id="cb102-266"><a href="#cb102-266" aria-hidden="true" tabindex="-1"></a>available through a package, but you can copy the source code from the</span>
<span id="cb102-267"><a href="#cb102-267" aria-hidden="true" tabindex="-1"></a>next R chunk.</span>
<span id="cb102-268"><a href="#cb102-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-269"><a href="#cb102-269" aria-hidden="true" tabindex="-1"></a>I have saved the function in a <span class="in">`.qmd`</span> file one level higher as this book</span>
<span id="cb102-270"><a href="#cb102-270" aria-hidden="true" tabindex="-1"></a>(and all my other R projects). With <span class="in">`{{&lt; include &quot;../_common.qmd&quot; &gt;}}`</span> I</span>
<span id="cb102-271"><a href="#cb102-271" aria-hidden="true" tabindex="-1"></a>have the code integrated in this book. (For the <span class="in">`include`</span> shortcode see</span>
<span id="cb102-272"><a href="#cb102-272" aria-hidden="true" tabindex="-1"></a>the section <span class="co">[</span><span class="ot">Includes</span><span class="co">](https://quarto.org/docs/authoring/includes.html)</span></span>
<span id="cb102-273"><a href="#cb102-273" aria-hidden="true" tabindex="-1"></a>of the Quarto documentation.)</span>
<span id="cb102-274"><a href="#cb102-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-275"><a href="#cb102-275" aria-hidden="true" tabindex="-1"></a>::: {#lst-chap01-show-function-glance-data}</span>
<span id="cb102-276"><a href="#cb102-276" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-277"><a href="#cb102-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-278"><a href="#cb102-278" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-279"><a href="#cb102-279" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: show-function-glance-data</span></span>
<span id="cb102-280"><a href="#cb102-280" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: show</span></span>
<span id="cb102-281"><a href="#cb102-281" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb102-282"><a href="#cb102-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-283"><a href="#cb102-283" aria-hidden="true" tabindex="-1"></a><span class="do">### function glance_data ##############</span></span>
<span id="cb102-284"><a href="#cb102-284" aria-hidden="true" tabindex="-1"></a>glance_data <span class="ot">&lt;-</span> <span class="cf">function</span>(df, <span class="at">N =</span> <span class="dv">8</span>, <span class="at">seed =</span> <span class="dv">42</span>){</span>
<span id="cb102-285"><a href="#cb102-285" aria-hidden="true" tabindex="-1"></a>    df_temp <span class="ot">&lt;-</span> <span class="fu">first_and_last_row</span>(df)</span>
<span id="cb102-286"><a href="#cb102-286" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb102-287"><a href="#cb102-287" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set.seed</span>(seed)</span>
<span id="cb102-288"><a href="#cb102-288" aria-hidden="true" tabindex="-1"></a>    df <span class="sc">|&gt;</span> </span>
<span id="cb102-289"><a href="#cb102-289" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">obs =</span> dplyr<span class="sc">::</span><span class="fu">row_number</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb102-290"><a href="#cb102-290" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">relocate</span>(obs) <span class="sc">|&gt;</span> </span>
<span id="cb102-291"><a href="#cb102-291" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">slice_sample</span>(<span class="at">n =</span> N) <span class="sc">|&gt;</span> </span>
<span id="cb102-292"><a href="#cb102-292" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(df_temp) <span class="sc">|&gt;</span> </span>
<span id="cb102-293"><a href="#cb102-293" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">arrange</span>(obs)</span>
<span id="cb102-294"><a href="#cb102-294" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb102-295"><a href="#cb102-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-296"><a href="#cb102-296" aria-hidden="true" tabindex="-1"></a>first_and_last_row <span class="ot">&lt;-</span>  <span class="cf">function</span>(df) {</span>
<span id="cb102-297"><a href="#cb102-297" aria-hidden="true" tabindex="-1"></a>    df <span class="sc">|&gt;</span> </span>
<span id="cb102-298"><a href="#cb102-298" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">obs =</span> dplyr<span class="sc">::</span><span class="fu">row_number</span>()) <span class="sc">|&gt;</span></span>
<span id="cb102-299"><a href="#cb102-299" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(dplyr<span class="sc">::</span><span class="fu">row_number</span>() <span class="sc">%in%</span> base<span class="sc">::</span><span class="fu">c</span>(<span class="dv">1</span>, dplyr<span class="sc">::</span><span class="fu">n</span>()))</span>
<span id="cb102-300"><a href="#cb102-300" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb102-301"><a href="#cb102-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-302"><a href="#cb102-302" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-303"><a href="#cb102-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-304"><a href="#cb102-304" aria-hidden="true" tabindex="-1"></a>Code of my private function <span class="in">`glance_date()`</span></span>
<span id="cb102-305"><a href="#cb102-305" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-306"><a href="#cb102-306" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-307"><a href="#cb102-307" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-308"><a href="#cb102-308" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-309"><a href="#cb102-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-310"><a href="#cb102-310" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb102-311"><a href="#cb102-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-312"><a href="#cb102-312" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data Wrangling {#sec-chap01-data-wrangling}</span></span>
<span id="cb102-313"><a href="#cb102-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-314"><a href="#cb102-314" aria-hidden="true" tabindex="-1"></a><span class="fu">### ToDo List</span></span>
<span id="cb102-315"><a href="#cb102-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-316"><a href="#cb102-316" aria-hidden="true" tabindex="-1"></a>After we saved the data we need to do some data wrangling. To replicate</span>
<span id="cb102-317"><a href="#cb102-317" aria-hidden="true" tabindex="-1"></a>the data structure for the book Figure 1.2 we need to:</span>
<span id="cb102-318"><a href="#cb102-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-319"><a href="#cb102-319" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>filter the dataset to the year 2016 (in the case you work with the</span>
<span id="cb102-320"><a href="#cb102-320" aria-hidden="true" tabindex="-1"></a>    full GSS dataset 1972-2022, which we won&#39;t)</span>
<span id="cb102-321"><a href="#cb102-321" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>select only the variables <span class="in">`age`</span> and <span class="in">`grass`</span> to work with</span>
<span id="cb102-322"><a href="#cb102-322" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>drop all NA’s</span>
<span id="cb102-323"><a href="#cb102-323" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>convert <span class="in">`grass`</span> into factor</span>
<span id="cb102-324"><a href="#cb102-324" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>recode <span class="in">`grass`</span> labels</span>
<span id="cb102-325"><a href="#cb102-325" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>convert <span class="in">`age`</span> from double to numeric</span>
<span id="cb102-326"><a href="#cb102-326" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>divide <span class="in">`age`</span> into appropriate age intervals and label them</span>
<span id="cb102-327"><a href="#cb102-327" aria-hidden="true" tabindex="-1"></a>    accordingly</span>
<span id="cb102-328"><a href="#cb102-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-329"><a href="#cb102-329" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb102-330"><a href="#cb102-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-331"><a href="#cb102-331" aria-hidden="true" tabindex="-1"></a>::: {#fig-chap01-bar-charts layout-ncol=&quot;2&quot;}</span>
<span id="cb102-332"><a href="#cb102-332" aria-hidden="true" tabindex="-1"></a>![Support for marijuana legalization among participants in the 2016</span>
<span id="cb102-333"><a href="#cb102-333" aria-hidden="true" tabindex="-1"></a>General Social Survey (Figure 1.1)](img/chap01/fig-01-01-min.png){#fig-01-01}</span>
<span id="cb102-334"><a href="#cb102-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-335"><a href="#cb102-335" aria-hidden="true" tabindex="-1"></a>![Support for marijuana legalization by age group among participants in</span>
<span id="cb102-336"><a href="#cb102-336" aria-hidden="true" tabindex="-1"></a>the 2016 General Social Survey (Figure</span>
<span id="cb102-337"><a href="#cb102-337" aria-hidden="true" tabindex="-1"></a>1.2)](img/chap01/fig-01-02-min.png){#fig-01-02}</span>
<span id="cb102-338"><a href="#cb102-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-339"><a href="#cb102-339" aria-hidden="true" tabindex="-1"></a>We will replicate these two bar charts (Figure 1.1 and Figure 1.2 in the</span>
<span id="cb102-340"><a href="#cb102-340" aria-hidden="true" tabindex="-1"></a>book)</span>
<span id="cb102-341"><a href="#cb102-341" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-342"><a href="#cb102-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-343"><a href="#cb102-343" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb102-344"><a href="#cb102-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-345"><a href="#cb102-345" aria-hidden="true" tabindex="-1"></a><span class="fu">### Replicating data structure for bar charts</span></span>
<span id="cb102-346"><a href="#cb102-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-347"><a href="#cb102-347" aria-hidden="true" tabindex="-1"></a>::: my-example</span>
<span id="cb102-348"><a href="#cb102-348" aria-hidden="true" tabindex="-1"></a>::: my-example-header</span>
<span id="cb102-349"><a href="#cb102-349" aria-hidden="true" tabindex="-1"></a>::: {#exm-chap01-repl-data-bar-charts}</span>
<span id="cb102-350"><a href="#cb102-350" aria-hidden="true" tabindex="-1"></a>: Replicate data structure for bar charts</span>
<span id="cb102-351"><a href="#cb102-351" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-352"><a href="#cb102-352" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-353"><a href="#cb102-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-354"><a href="#cb102-354" aria-hidden="true" tabindex="-1"></a>::: my-example-container</span>
<span id="cb102-355"><a href="#cb102-355" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb102-356"><a href="#cb102-356" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb102-357"><a href="#cb102-357" aria-hidden="true" tabindex="-1"></a>::: {#cnj-chap01-repl-data-fig-book}</span>
<span id="cb102-358"><a href="#cb102-358" aria-hidden="true" tabindex="-1"></a>: Replicate data structure for Figures 1.1 and 1.2 (Book)</span>
<span id="cb102-359"><a href="#cb102-359" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-360"><a href="#cb102-360" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-361"><a href="#cb102-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-362"><a href="#cb102-362" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb102-363"><a href="#cb102-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-364"><a href="#cb102-364" aria-hidden="true" tabindex="-1"></a>::: {#lst-repl-data-fig-book}</span>
<span id="cb102-365"><a href="#cb102-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-366"><a href="#cb102-366" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-367"><a href="#cb102-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-368"><a href="#cb102-368" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-369"><a href="#cb102-369" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: replicate-data-fig-book</span></span>
<span id="cb102-370"><a href="#cb102-370" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb102-371"><a href="#cb102-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-372"><a href="#cb102-372" aria-hidden="true" tabindex="-1"></a>chap01_gss_2016 <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(</span>
<span id="cb102-373"><a href="#cb102-373" aria-hidden="true" tabindex="-1"></a>    <span class="at">file =</span> <span class="st">&quot;data-harris/legal_weed_age_GSS2016_ch1.csv&quot;</span>,</span>
<span id="cb102-374"><a href="#cb102-374" aria-hidden="true" tabindex="-1"></a>    <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb102-375"><a href="#cb102-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-376"><a href="#cb102-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-377"><a href="#cb102-377" aria-hidden="true" tabindex="-1"></a>chap01_gss_2016_clean <span class="ot">&lt;-</span> chap01_gss_2016 <span class="sc">|&gt;</span> </span>
<span id="cb102-378"><a href="#cb102-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-379"><a href="#cb102-379" aria-hidden="true" tabindex="-1"></a><span class="do">#### (A) rework grass ##################</span></span>
<span id="cb102-380"><a href="#cb102-380" aria-hidden="true" tabindex="-1"></a><span class="do">## convert grass to factor</span></span>
<span id="cb102-381"><a href="#cb102-381" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">grass =</span> forcats<span class="sc">::</span><span class="fu">as_factor</span>(grass))  <span class="sc">|&gt;</span> </span>
<span id="cb102-382"><a href="#cb102-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-383"><a href="#cb102-383" aria-hidden="true" tabindex="-1"></a><span class="do">## change DK and IAP to NA</span></span>
<span id="cb102-384"><a href="#cb102-384" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">grass =</span> dplyr<span class="sc">::</span><span class="fu">na_if</span>(<span class="at">x =</span> grass, <span class="at">y =</span> <span class="st">&quot;DK&quot;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb102-385"><a href="#cb102-385" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">grass =</span> dplyr<span class="sc">::</span><span class="fu">na_if</span>(<span class="at">x =</span> grass, <span class="at">y =</span> <span class="st">&quot;IAP&quot;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb102-386"><a href="#cb102-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-387"><a href="#cb102-387" aria-hidden="true" tabindex="-1"></a><span class="do">## drop unused levels &quot;DK&quot; and &quot;IAP&quot;</span></span>
<span id="cb102-388"><a href="#cb102-388" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">grass =</span> forcats<span class="sc">::</span><span class="fu">fct_drop</span>(grass)) <span class="sc">|&gt;</span> </span>
<span id="cb102-389"><a href="#cb102-389" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb102-390"><a href="#cb102-390" aria-hidden="true" tabindex="-1"></a><span class="do">## convert to factor and recode it</span></span>
<span id="cb102-391"><a href="#cb102-391" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">grass =</span> forcats<span class="sc">::</span><span class="fu">fct_recode</span>(</span>
<span id="cb102-392"><a href="#cb102-392" aria-hidden="true" tabindex="-1"></a>      grass, <span class="st">&quot;Yes&quot;</span> <span class="ot">=</span> <span class="st">&quot;LEGAL&quot;</span>, <span class="st">&quot;No&quot;</span> <span class="ot">=</span> <span class="st">&quot;NOT LEGAL&quot;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb102-393"><a href="#cb102-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-394"><a href="#cb102-394" aria-hidden="true" tabindex="-1"></a><span class="do">#### (B) rework age #########################</span></span>
<span id="cb102-395"><a href="#cb102-395" aria-hidden="true" tabindex="-1"></a><span class="do">## change data types and recode</span></span>
<span id="cb102-396"><a href="#cb102-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-397"><a href="#cb102-397" aria-hidden="true" tabindex="-1"></a><span class="do">## turn character type of age into factor and recode &quot;89 OR OLDER&quot; to &quot;89&quot;</span></span>
<span id="cb102-398"><a href="#cb102-398" aria-hidden="true" tabindex="-1"></a>  <span class="co"># dplyr::mutate(age = dplyr::recode(age, &quot;89 OR OLDER&quot; = &quot;89&quot;)) |&gt; </span></span>
<span id="cb102-399"><a href="#cb102-399" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">age =</span> dplyr<span class="sc">::</span><span class="fu">case_match</span>(age, </span>
<span id="cb102-400"><a href="#cb102-400" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;89 OR OLDER&quot;</span> <span class="sc">~</span> <span class="st">&quot;89&quot;</span>,</span>
<span id="cb102-401"><a href="#cb102-401" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">.default =</span> age)) <span class="sc">|&gt;</span> </span>
<span id="cb102-402"><a href="#cb102-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-403"><a href="#cb102-403" aria-hidden="true" tabindex="-1"></a><span class="do">## convert data type of age from factor to numeric</span></span>
<span id="cb102-404"><a href="#cb102-404" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">age =</span> base<span class="sc">::</span><span class="fu">as.numeric</span>(age)) <span class="sc">|&gt;</span> </span>
<span id="cb102-405"><a href="#cb102-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-406"><a href="#cb102-406" aria-hidden="true" tabindex="-1"></a><span class="do">## cut age into several defined age groups</span></span>
<span id="cb102-407"><a href="#cb102-407" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">age_cat =</span> base<span class="sc">::</span><span class="fu">cut</span>(age, </span>
<span id="cb102-408"><a href="#cb102-408" aria-hidden="true" tabindex="-1"></a>                       <span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="dv">29</span>, <span class="dv">59</span>, <span class="dv">74</span>, <span class="cn">Inf</span>),</span>
<span id="cb102-409"><a href="#cb102-409" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;&lt; 30&quot;</span>, <span class="st">&quot;30 - 59&quot;</span>, <span class="st">&quot;60 - 74&quot;</span>, <span class="st">&quot;75+&quot;</span> ))) <span class="sc">|&gt;</span>  </span>
<span id="cb102-410"><a href="#cb102-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-411"><a href="#cb102-411" aria-hidden="true" tabindex="-1"></a><span class="do">## drop NA&#39;s</span></span>
<span id="cb102-412"><a href="#cb102-412" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">drop_na</span>()</span>
<span id="cb102-413"><a href="#cb102-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-414"><a href="#cb102-414" aria-hidden="true" tabindex="-1"></a><span class="do">## save cleaned data gss_2016</span></span>
<span id="cb102-415"><a href="#cb102-415" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(chap01_gss_2016_clean, <span class="st">&quot;data-clean/chap01_gss_2016_clean.rds&quot;</span>)</span>
<span id="cb102-416"><a href="#cb102-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-417"><a href="#cb102-417" aria-hidden="true" tabindex="-1"></a><span class="do">## (C) check result #########</span></span>
<span id="cb102-418"><a href="#cb102-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-419"><a href="#cb102-419" aria-hidden="true" tabindex="-1"></a><span class="do">## summarize</span></span>
<span id="cb102-420"><a href="#cb102-420" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;************************   SUMMARY   ****************************&quot;</span>)</span>
<span id="cb102-421"><a href="#cb102-421" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">summary</span>(chap01_gss_2016_clean)</span>
<span id="cb102-422"><a href="#cb102-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-423"><a href="#cb102-423" aria-hidden="true" tabindex="-1"></a><span class="do">## glance at the data</span></span>
<span id="cb102-424"><a href="#cb102-424" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;*******************   GLANCE AT SOME DATA  **********************&quot;</span>)</span>
<span id="cb102-425"><a href="#cb102-425" aria-hidden="true" tabindex="-1"></a>chap01_gss_2016_clean <span class="sc">|&gt;</span></span>
<span id="cb102-426"><a href="#cb102-426" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(age_cat, grass)) <span class="sc">|&gt;</span> </span>
<span id="cb102-427"><a href="#cb102-427" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glance_data</span>(<span class="at">N =</span> <span class="dv">8</span>, <span class="at">seed =</span> <span class="dv">2016</span>)</span>
<span id="cb102-428"><a href="#cb102-428" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-429"><a href="#cb102-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-430"><a href="#cb102-430" aria-hidden="true" tabindex="-1"></a>Replicate data structure for Figures 1.1 and 1.2 f the book)</span>
<span id="cb102-431"><a href="#cb102-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-432"><a href="#cb102-432" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-433"><a href="#cb102-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-434"><a href="#cb102-434" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb102-435"><a href="#cb102-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-436"><a href="#cb102-436" aria-hidden="true" tabindex="-1"></a>The somewhat strange cut decision for age groups was motivated by the</span>
<span id="cb102-437"><a href="#cb102-437" aria-hidden="true" tabindex="-1"></a>question if there is a difference between young and old voters about</span>
<span id="cb102-438"><a href="#cb102-438" aria-hidden="true" tabindex="-1"></a>marijuana legalization.</span>
<span id="cb102-439"><a href="#cb102-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-440"><a href="#cb102-440" aria-hidden="true" tabindex="-1"></a>Compare the result of the recoding with the original data structure in</span>
<span id="cb102-441"><a href="#cb102-441" aria-hidden="true" tabindex="-1"></a>@lst-chap01-read-csv-show-summary.</span>
<span id="cb102-442"><a href="#cb102-442" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-443"><a href="#cb102-443" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-444"><a href="#cb102-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-445"><a href="#cb102-445" aria-hidden="true" tabindex="-1"></a>**Some comments**</span>
<span id="cb102-446"><a href="#cb102-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-447"><a href="#cb102-447" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>I have included all data wrangling changes for the Figure 1.1 even</span>
<span id="cb102-448"><a href="#cb102-448" aria-hidden="true" tabindex="-1"></a>    if they appeared in the book section where the graph is prepared.</span>
<span id="cb102-449"><a href="#cb102-449" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>I have used <span class="in">`|&gt;`</span> form the native R pipe instead of <span class="in">`%&gt;%`</span> exported</span>
<span id="cb102-450"><a href="#cb102-450" aria-hidden="true" tabindex="-1"></a>    into tidyverse from the {**magrittr**} package.</span>
<span id="cb102-451"><a href="#cb102-451" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Otherwise whenever possible I have used {**tidyverse**} code. For</span>
<span id="cb102-452"><a href="#cb102-452" aria-hidden="true" tabindex="-1"></a>    <span class="in">`base::as.numeric()`</span> and <span class="in">`base::cut()`</span> I couldn&#39;t find</span>
<span id="cb102-453"><a href="#cb102-453" aria-hidden="true" tabindex="-1"></a>    {**tidyverse**} equivalents.</span>
<span id="cb102-454"><a href="#cb102-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-455"><a href="#cb102-455" aria-hidden="true" tabindex="-1"></a>::: my-watch-out</span>
<span id="cb102-456"><a href="#cb102-456" aria-hidden="true" tabindex="-1"></a>::: my-watch-out-header</span>
<span id="cb102-457"><a href="#cb102-457" aria-hidden="true" tabindex="-1"></a>WATCH OUT! Difference between <span class="in">`forcats::fct_recode()`</span> and</span>
<span id="cb102-458"><a href="#cb102-458" aria-hidden="true" tabindex="-1"></a><span class="in">`dplyr::recode()`</span>. Use <span class="in">`dplyr::case_match()`</span>!</span>
<span id="cb102-459"><a href="#cb102-459" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-460"><a href="#cb102-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-461"><a href="#cb102-461" aria-hidden="true" tabindex="-1"></a>::: my-watch-out-container</span>
<span id="cb102-462"><a href="#cb102-462" aria-hidden="true" tabindex="-1"></a>To recode <span class="in">`age`</span> from &quot;89 OR OLDER&quot; to &quot;89&quot; I used at first</span>
<span id="cb102-463"><a href="#cb102-463" aria-hidden="true" tabindex="-1"></a><span class="in">`forcats::fct_recode()`</span>. But this function changes the 72 *levels* of</span>
<span id="cb102-464"><a href="#cb102-464" aria-hidden="true" tabindex="-1"></a>the factor <span class="in">`age`</span> and resulted --- after I changed <span class="in">`age`</span> to numeric in</span>
<span id="cb102-465"><a href="#cb102-465" aria-hidden="true" tabindex="-1"></a>the next line --- in a data frame where <span class="in">`age`</span> ranged from 1 to 72!</span>
<span id="cb102-466"><a href="#cb102-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-467"><a href="#cb102-467" aria-hidden="true" tabindex="-1"></a>After I noticed the problem and wanted to replace the {**forcats**}-line</span>
<span id="cb102-468"><a href="#cb102-468" aria-hidden="true" tabindex="-1"></a>with <span class="in">`dplyr::mutate(age = dplyr::recode(age, &quot;89 OR OLDER&quot; = &quot;89&quot;))`</span> I</span>
<span id="cb102-469"><a href="#cb102-469" aria-hidden="true" tabindex="-1"></a>saw in the help file that</span>
<span id="cb102-470"><a href="#cb102-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-471"><a href="#cb102-471" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; </span><span class="in">`recode()`</span><span class="at"> is superseded in favor of </span><span class="in">`case_match()`</span><span class="at">, which handles the</span></span>
<span id="cb102-472"><a href="#cb102-472" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; most important cases of </span><span class="in">`recode()`</span><span class="at"> with a more elegant interface.</span></span>
<span id="cb102-473"><a href="#cb102-473" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; (</span><span class="co">[</span><span class="ot">Recode values</span><span class="co">](https://dplyr.tidyverse.org/reference/recode.html)</span><span class="at">)</span></span>
<span id="cb102-474"><a href="#cb102-474" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; and</span></span>
<span id="cb102-475"><a href="#cb102-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-476"><a href="#cb102-476" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; </span><span class="sc">\[</span><span class="in">`dplyr::case_match()`</span><span class="sc">\]</span><span class="at"> allows you to vectorise multiple switch()</span></span>
<span id="cb102-477"><a href="#cb102-477" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; statements. Each case is evaluated sequentially and the first match</span></span>
<span id="cb102-478"><a href="#cb102-478" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; for each element determines the corresponding value in the output</span></span>
<span id="cb102-479"><a href="#cb102-479" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; vector. If no cases match, the .default is used. ([A general</span></span>
<span id="cb102-480"><a href="#cb102-480" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; verctorized</span></span>
<span id="cb102-481"><a href="#cb102-481" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; switch()](https://dplyr.tidyverse.org/reference/case_match.html))</span></span>
<span id="cb102-482"><a href="#cb102-482" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb102-483"><a href="#cb102-483" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb102-484"><a href="#cb102-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-485"><a href="#cb102-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-486"><a href="#cb102-486" aria-hidden="true" tabindex="-1"></a>@lst-repl-data-fig-book used some important packages:</span>
<span id="cb102-487"><a href="#cb102-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-488"><a href="#cb102-488" aria-hidden="true" tabindex="-1"></a>I used {**dplyr**} in the above code heavily (see: @pak-dplyr). {**dplyr**} is part of the {**tidyverse**} core collection (see: @pak-tidyverse), together with {**forcats**} (see: @pak-forcats), {**ggplot2**} (see @pak-ggplot2), {**readr**} (see: @pak-ggplot2), {**tibble**} (see: @pak-tibble), {**tidyr**} (see: @pak-tidyr), {**string**} and {**purrr**}. </span>
<span id="cb102-489"><a href="#cb102-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-490"><a href="#cb102-490" aria-hidden="true" tabindex="-1"></a>The last two packages ({**string**} and {**purrr**}) I will profile when I use them the first time.</span>
<span id="cb102-491"><a href="#cb102-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-492"><a href="#cb102-492" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-493"><a href="#cb102-493" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-494"><a href="#cb102-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-495"><a href="#cb102-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-496"><a href="#cb102-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-497"><a href="#cb102-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-498"><a href="#cb102-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-499"><a href="#cb102-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-500"><a href="#cb102-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-501"><a href="#cb102-501" aria-hidden="true" tabindex="-1"></a><span class="fu">## Reproducing bar charts {#sec-chap01-repr-bar-charts}</span></span>
<span id="cb102-502"><a href="#cb102-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-503"><a href="#cb102-503" aria-hidden="true" tabindex="-1"></a>::: my-example</span>
<span id="cb102-504"><a href="#cb102-504" aria-hidden="true" tabindex="-1"></a>::: my-example-header</span>
<span id="cb102-505"><a href="#cb102-505" aria-hidden="true" tabindex="-1"></a>::: {#exm-chap01-repr-bar-charts}</span>
<span id="cb102-506"><a href="#cb102-506" aria-hidden="true" tabindex="-1"></a>: Reproducing bar charts</span>
<span id="cb102-507"><a href="#cb102-507" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-508"><a href="#cb102-508" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-509"><a href="#cb102-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-510"><a href="#cb102-510" aria-hidden="true" tabindex="-1"></a>::: my-example-container</span>
<span id="cb102-511"><a href="#cb102-511" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb102-512"><a href="#cb102-512" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Figure 1.1</span></span>
<span id="cb102-513"><a href="#cb102-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-514"><a href="#cb102-514" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb102-515"><a href="#cb102-515" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb102-516"><a href="#cb102-516" aria-hidden="true" tabindex="-1"></a>::: {#cnj-fig-chap01-repr-fig-1-1}</span>
<span id="cb102-517"><a href="#cb102-517" aria-hidden="true" tabindex="-1"></a>a: Reproducing bar chart Figure 1.1 using <span class="in">`geom_bar()`</span></span>
<span id="cb102-518"><a href="#cb102-518" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-519"><a href="#cb102-519" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-520"><a href="#cb102-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-521"><a href="#cb102-521" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb102-522"><a href="#cb102-522" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-523"><a href="#cb102-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-524"><a href="#cb102-524" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-525"><a href="#cb102-525" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-chap01-repr-fig-1-1</span></span>
<span id="cb102-526"><a href="#cb102-526" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Support for marijuana legalization among participants in the 2016 General Social Survey (Figure 1.1)</span></span>
<span id="cb102-527"><a href="#cb102-527" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 4</span></span>
<span id="cb102-528"><a href="#cb102-528" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb102-529"><a href="#cb102-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-530"><a href="#cb102-530" aria-hidden="true" tabindex="-1"></a>chap01_gss_2016_clean <span class="ot">&lt;-</span>  <span class="fu">readRDS</span>(<span class="st">&quot;data-clean/chap01_gss_2016_clean.rds&quot;</span>)</span>
<span id="cb102-531"><a href="#cb102-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-532"><a href="#cb102-532" aria-hidden="true" tabindex="-1"></a><span class="do">## create figure 1.1 #######</span></span>
<span id="cb102-533"><a href="#cb102-533" aria-hidden="true" tabindex="-1"></a>chap01_gss_2016_clean <span class="sc">|&gt;</span> </span>
<span id="cb102-534"><a href="#cb102-534" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> grass,</span>
<span id="cb102-535"><a href="#cb102-535" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> <span class="dv">100</span> <span class="sc">*</span> ggplot2<span class="sc">::</span><span class="fu">after_stat</span>(count) <span class="sc">/</span> </span>
<span id="cb102-536"><a href="#cb102-536" aria-hidden="true" tabindex="-1"></a>                 base<span class="sc">::</span><span class="fu">sum</span>(ggplot2<span class="sc">::</span><span class="fu">after_stat</span>(count)),</span>
<span id="cb102-537"><a href="#cb102-537" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> grass)) <span class="sc">+</span></span>
<span id="cb102-538"><a href="#cb102-538" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb102-539"><a href="#cb102-539" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb102-540"><a href="#cb102-540" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#79a778&quot;</span>, <span class="st">&#39;#7662aa&#39;</span>),</span>
<span id="cb102-541"><a href="#cb102-541" aria-hidden="true" tabindex="-1"></a>                    <span class="at">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb102-542"><a href="#cb102-542" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Should marijuana be legal?&quot;</span>,</span>
<span id="cb102-543"><a href="#cb102-543" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Percent of responses&quot;</span>)</span>
<span id="cb102-544"><a href="#cb102-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-545"><a href="#cb102-545" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-546"><a href="#cb102-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-547"><a href="#cb102-547" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb102-548"><a href="#cb102-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-549"><a href="#cb102-549" aria-hidden="true" tabindex="-1"></a>I changed the code slightly because of two warnings. Newer versions of</span>
<span id="cb102-550"><a href="#cb102-550" aria-hidden="true" tabindex="-1"></a>{**ggplot2**} have deprecated some older functions:</span>
<span id="cb102-551"><a href="#cb102-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-552"><a href="#cb102-552" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Warning: The dot-dot notation (<span class="in">`..count..`</span>) was deprecated in</span>
<span id="cb102-553"><a href="#cb102-553" aria-hidden="true" tabindex="-1"></a>    {**ggplot2**} version 3.4.0. Please use <span class="in">`after_stat(count)`</span> instead.</span>
<span id="cb102-554"><a href="#cb102-554" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Warning: The <span class="in">`guide`</span> argument in <span class="in">`scale_*()`</span> cannot be <span class="in">`FALSE`</span>. This</span>
<span id="cb102-555"><a href="#cb102-555" aria-hidden="true" tabindex="-1"></a>    was deprecated in {**ggplot2**} version 3.3.4. Please use &quot;none&quot; instead.</span>
<span id="cb102-556"><a href="#cb102-556" aria-hidden="true" tabindex="-1"></a>(I have slightly edited both warnings) </span>
<span id="cb102-557"><a href="#cb102-557" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-558"><a href="#cb102-558" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-559"><a href="#cb102-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-560"><a href="#cb102-560" aria-hidden="true" tabindex="-1"></a>Compare the reproduction with the original @fig-01-01.</span>
<span id="cb102-561"><a href="#cb102-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-562"><a href="#cb102-562" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Figure 1.2</span></span>
<span id="cb102-563"><a href="#cb102-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-564"><a href="#cb102-564" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb102-565"><a href="#cb102-565" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb102-566"><a href="#cb102-566" aria-hidden="true" tabindex="-1"></a>::: {#cnj-fig-chap01-repr-fig-1-2}</span>
<span id="cb102-567"><a href="#cb102-567" aria-hidden="true" tabindex="-1"></a>b: Reproducing bar chart Figure 1.2 using <span class="in">`geom_col()`</span></span>
<span id="cb102-568"><a href="#cb102-568" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-569"><a href="#cb102-569" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-570"><a href="#cb102-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-571"><a href="#cb102-571" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb102-572"><a href="#cb102-572" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-573"><a href="#cb102-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-574"><a href="#cb102-574" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-575"><a href="#cb102-575" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-chap01-repr-fig-1-2</span></span>
<span id="cb102-576"><a href="#cb102-576" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Support for marijuana legalization by age group among participants in the 2016 General Social Survey (Figure 1.2)</span></span>
<span id="cb102-577"><a href="#cb102-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-578"><a href="#cb102-578" aria-hidden="true" tabindex="-1"></a>chap01_gss_2016_clean <span class="ot">&lt;-</span>  <span class="fu">readRDS</span>(<span class="st">&quot;data-clean/chap01_gss_2016_clean.rds&quot;</span>)</span>
<span id="cb102-579"><a href="#cb102-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-580"><a href="#cb102-580" aria-hidden="true" tabindex="-1"></a><span class="do">## create figure 1.2 ########</span></span>
<span id="cb102-581"><a href="#cb102-581" aria-hidden="true" tabindex="-1"></a>chap01_gss_2016_clean <span class="sc">|&gt;</span> </span>
<span id="cb102-582"><a href="#cb102-582" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(grass, age_cat) <span class="sc">|&gt;</span> </span>
<span id="cb102-583"><a href="#cb102-583" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">count</span>() <span class="sc">|&gt;</span> </span>
<span id="cb102-584"><a href="#cb102-584" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(age_cat) <span class="sc">|&gt;</span> </span>
<span id="cb102-585"><a href="#cb102-585" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">perc_grass =</span> <span class="dv">100</span> <span class="sc">*</span> n <span class="sc">/</span> base<span class="sc">::</span><span class="fu">sum</span>(n)) <span class="sc">|&gt;</span> </span>
<span id="cb102-586"><a href="#cb102-586" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> age_cat, <span class="at">fill =</span> grass,</span>
<span id="cb102-587"><a href="#cb102-587" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> perc_grass)) <span class="sc">+</span></span>
<span id="cb102-588"><a href="#cb102-588" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">&#39;dodge&#39;</span>) <span class="sc">+</span></span>
<span id="cb102-589"><a href="#cb102-589" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb102-590"><a href="#cb102-590" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;#79a778&#39;</span>, <span class="st">&#39;#7662aa&#39;</span>),</span>
<span id="cb102-591"><a href="#cb102-591" aria-hidden="true" tabindex="-1"></a>                    <span class="at">name =</span> <span class="st">&quot;Should marijuana</span><span class="sc">\n</span><span class="st">be legal?&quot;</span>) <span class="sc">+</span></span>
<span id="cb102-592"><a href="#cb102-592" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Age group (in years)&quot;</span>,</span>
<span id="cb102-593"><a href="#cb102-593" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Percent of responses in age group&quot;</span>)</span>
<span id="cb102-594"><a href="#cb102-594" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-595"><a href="#cb102-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-596"><a href="#cb102-596" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb102-597"><a href="#cb102-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-598"><a href="#cb102-598" aria-hidden="true" tabindex="-1"></a>@fig-chap01-repr-fig-1-1 uses <span class="in">`ggplot2::geom_bar()`</span> whereas this figure</span>
<span id="cb102-599"><a href="#cb102-599" aria-hidden="true" tabindex="-1"></a>here calls the <span class="in">`ggplot2::geom_col()`</span> function.</span>
<span id="cb102-600"><a href="#cb102-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-601"><a href="#cb102-601" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; There are two types of bar charts: </span><span class="in">`geom_bar()`</span><span class="at"> and </span><span class="in">`geom_col()`</span><span class="at">.</span></span>
<span id="cb102-602"><a href="#cb102-602" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; </span><span class="in">`geom_bar()`</span><span class="at"> makes the height of the bar proportional to the number of</span></span>
<span id="cb102-603"><a href="#cb102-603" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; cases in each group … . If you want the heights of the bars to</span></span>
<span id="cb102-604"><a href="#cb102-604" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; represent values in the data, use </span><span class="in">`geom_col()`</span><span class="at"> instead. </span><span class="in">`geom_bar()`</span></span>
<span id="cb102-605"><a href="#cb102-605" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; uses </span><span class="in">`stat_count()`</span><span class="at"> by default: it counts the number of cases at each</span></span>
<span id="cb102-606"><a href="#cb102-606" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; x position. </span><span class="in">`geom_col()`</span><span class="at"> uses </span><span class="in">`stat_identity()`</span><span class="at">: it leaves the data as</span></span>
<span id="cb102-607"><a href="#cb102-607" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; is. ([Bar</span></span>
<span id="cb102-608"><a href="#cb102-608" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; charts](https://ggplot2.tidyverse.org/reference/geom_bar.html) with</span></span>
<span id="cb102-609"><a href="#cb102-609" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; {**ggplot2**})</span></span>
<span id="cb102-610"><a href="#cb102-610" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb102-611"><a href="#cb102-611" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb102-612"><a href="#cb102-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-613"><a href="#cb102-613" aria-hidden="true" tabindex="-1"></a>Compare the reproduction with the original @fig-01-02.</span>
<span id="cb102-614"><a href="#cb102-614" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-615"><a href="#cb102-615" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-616"><a href="#cb102-616" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-617"><a href="#cb102-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-618"><a href="#cb102-618" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb102-619"><a href="#cb102-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-620"><a href="#cb102-620" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercises</span></span>
<span id="cb102-621"><a href="#cb102-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-622"><a href="#cb102-622" aria-hidden="true" tabindex="-1"></a>::: my-objectives</span>
<span id="cb102-623"><a href="#cb102-623" aria-hidden="true" tabindex="-1"></a>::: my-objectives-header</span>
<span id="cb102-624"><a href="#cb102-624" aria-hidden="true" tabindex="-1"></a>Exercises for the Coder &amp; Hacker edition</span>
<span id="cb102-625"><a href="#cb102-625" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-626"><a href="#cb102-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-627"><a href="#cb102-627" aria-hidden="true" tabindex="-1"></a>::: my-objectives-container</span>
<span id="cb102-628"><a href="#cb102-628" aria-hidden="true" tabindex="-1"></a>**SwR objectives**</span>
<span id="cb102-629"><a href="#cb102-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-630"><a href="#cb102-630" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Visit the NHANES website and find the online codebook for the</span>
<span id="cb102-631"><a href="#cb102-631" aria-hidden="true" tabindex="-1"></a>    2013–2014 data (@sec-visit-nhanes-website)</span>
<span id="cb102-632"><a href="#cb102-632" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Open the 2013–2014 NHANES data file saved as <span class="in">`nhanes_2013_ch1.csv`</span></span>
<span id="cb102-633"><a href="#cb102-633" aria-hidden="true" tabindex="-1"></a>    with the book materials at</span>
<span id="cb102-634"><a href="#cb102-634" aria-hidden="true" tabindex="-1"></a>    <span class="co">[</span><span class="ot">edge.sagepub.com/harris1e</span><span class="co">](https://edge.sagepub.com/harris1e)</span></span>
<span id="cb102-635"><a href="#cb102-635" aria-hidden="true" tabindex="-1"></a>    (Achievement 1) (@sec-chap01-import-clean-data in tab &quot;read_csv()&quot;)</span>
<span id="cb102-636"><a href="#cb102-636" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Examine the data types for DUQ200, RIDAGEYR, and RIAGENDR, and fix</span>
<span id="cb102-637"><a href="#cb102-637" aria-hidden="true" tabindex="-1"></a>    data types if needed based on the NHANES codebook (Achievements 2</span>
<span id="cb102-638"><a href="#cb102-638" aria-hidden="true" tabindex="-1"></a>    and 3) (@sec-chap01-import-clean-data in tab &quot;View data&quot; and tab &quot;Codebook&quot;)</span>
<span id="cb102-639"><a href="#cb102-639" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Based on the online NHANES codebook, code missing values</span>
<span id="cb102-640"><a href="#cb102-640" aria-hidden="true" tabindex="-1"></a>    appropriately for DUQ200, RIDAGEYR, and RIAGENDR </span>
<span id="cb102-641"><a href="#cb102-641" aria-hidden="true" tabindex="-1"></a>    (Achievement 4) (@sec-chap01-import-clean-data in tab &quot;Data cleaning&quot;)</span>
<span id="cb102-642"><a href="#cb102-642" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>Create a bar chart showing the percentage of NHANES participants</span>
<span id="cb102-643"><a href="#cb102-643" aria-hidden="true" tabindex="-1"></a>    answering yes and no to marijuana use </span>
<span id="cb102-644"><a href="#cb102-644" aria-hidden="true" tabindex="-1"></a>    (Achievement 5) (@sec-chap01-bar-chart-grass in tab &quot;Solution&quot;)</span>
<span id="cb102-645"><a href="#cb102-645" aria-hidden="true" tabindex="-1"></a><span class="ss">6.  </span>Recode age into a new variable called <span class="in">`age_cat`</span> with 4 categories:</span>
<span id="cb102-646"><a href="#cb102-646" aria-hidden="true" tabindex="-1"></a>    18–29, 30–39, 40–49, 50–59 </span>
<span id="cb102-647"><a href="#cb102-647" aria-hidden="true" tabindex="-1"></a>    (Achievement 7) (@sec-chap01-grass-age-sex in tab &quot;Numbers&quot;)</span>
<span id="cb102-648"><a href="#cb102-648" aria-hidden="true" tabindex="-1"></a><span class="ss">7.  </span>Create a bar chart of marijuana use by age group</span>
<span id="cb102-649"><a href="#cb102-649" aria-hidden="true" tabindex="-1"></a>(Achievement 6) (@sec-chap01-grass-age-sex in tab &quot;Age&quot;)</span>
<span id="cb102-650"><a href="#cb102-650" aria-hidden="true" tabindex="-1"></a><span class="ss">8.  </span>~~Add a prolog and comments to your code (Achievement 1)~~ (I am</span>
<span id="cb102-651"><a href="#cb102-651" aria-hidden="true" tabindex="-1"></a>    using <span class="in">`r glossary(&quot;literate programming&quot;)`</span> in writing this book.)</span>
<span id="cb102-652"><a href="#cb102-652" aria-hidden="true" tabindex="-1"></a><span class="ss">9.  </span>Create a bar chart of marijuana use by age group and sex with side-by-side bars (Achievement 5) (@sec-chap01-grass-age-sex in tab &quot;Age and sex&quot;)</span>
<span id="cb102-653"><a href="#cb102-653" aria-hidden="true" tabindex="-1"></a><span class="ss">10. </span>Following the R code in your code file, use comments to describe</span>
<span id="cb102-654"><a href="#cb102-654" aria-hidden="true" tabindex="-1"></a>    what you found. Given what you found and the information in the</span>
<span id="cb102-655"><a href="#cb102-655" aria-hidden="true" tabindex="-1"></a>    chapter, what do you predict will happen with marijuana legalization</span>
<span id="cb102-656"><a href="#cb102-656" aria-hidden="true" tabindex="-1"></a>    in the next 10 years? Discuss how the omission of older people from</span>
<span id="cb102-657"><a href="#cb102-657" aria-hidden="true" tabindex="-1"></a>    the marijuana use question for NHANES influenced your prediction.</span>
<span id="cb102-658"><a href="#cb102-658" aria-hidden="true" tabindex="-1"></a>    Write your prediction and discussion in comments at the end of your</span>
<span id="cb102-659"><a href="#cb102-659" aria-hidden="true" tabindex="-1"></a>    code file (@sec-chap01-data-interpretation). </span>
<span id="cb102-660"><a href="#cb102-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-661"><a href="#cb102-661" aria-hidden="true" tabindex="-1"></a>**My own additional exercises**</span>
<span id="cb102-662"><a href="#cb102-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-663"><a href="#cb102-663" aria-hidden="true" tabindex="-1"></a><span class="ss">11. </span>Download and work with SAS .xpt file data (Demo)</span>
<span id="cb102-664"><a href="#cb102-664" aria-hidden="true" tabindex="-1"></a>    {@sec-download-xpt-file}</span>
<span id="cb102-665"><a href="#cb102-665" aria-hidden="true" tabindex="-1"></a><span class="ss">12. </span>Show table of frequencies and percentages (@sec-chap01-bar-chart-grass in Tab &quot;Numbers&quot;)</span>
<span id="cb102-666"><a href="#cb102-666" aria-hidden="true" tabindex="-1"></a><span class="ss">12. </span>Make bars thinner (@sec-chap01-bar-chart-grass in Tab &quot;Thin bars&quot;) </span>
<span id="cb102-667"><a href="#cb102-667" aria-hidden="true" tabindex="-1"></a><span class="ss">13. </span>Make bars thinner and adjust spacing accordingly (@sec-chap01-bar-chart-grass in Tab &quot;Solution&quot;) </span>
<span id="cb102-668"><a href="#cb102-668" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-669"><a href="#cb102-669" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-670"><a href="#cb102-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-671"><a href="#cb102-671" aria-hidden="true" tabindex="-1"></a><span class="fu">### Visiting the NHANES website {#sec-visit-nhanes-website}</span></span>
<span id="cb102-672"><a href="#cb102-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-673"><a href="#cb102-673" aria-hidden="true" tabindex="-1"></a>Use the National Health and Nutrition Examination Survey</span>
<span id="cb102-674"><a href="#cb102-674" aria-hidden="true" tabindex="-1"></a>(<span class="in">`r glossary(&quot;NHANES&quot;)`</span>) data to examine marijuana use in the United</span>
<span id="cb102-675"><a href="#cb102-675" aria-hidden="true" tabindex="-1"></a>States. Spend a few minutes looking through the NHANES website</span>
<span id="cb102-676"><a href="#cb102-676" aria-hidden="true" tabindex="-1"></a>(<span class="co">[</span><span class="ot">https://www.cdc.gov/nchs/nhanes/index.htm</span><span class="co">](https://www.cdc.gov/nchs/nhanes/index.htm)</span>) before you begin, including</span>
<span id="cb102-677"><a href="#cb102-677" aria-hidden="true" tabindex="-1"></a>finding the online codebook for the 2013–2014 data. Complete the</span>
<span id="cb102-678"><a href="#cb102-678" aria-hidden="true" tabindex="-1"></a>following tasks to explore whether age is related to marijuana use in</span>
<span id="cb102-679"><a href="#cb102-679" aria-hidden="true" tabindex="-1"></a>the United States.</span>
<span id="cb102-680"><a href="#cb102-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-681"><a href="#cb102-681" aria-hidden="true" tabindex="-1"></a>The 2013–2014 codebook is on the page [NHANES</span>
<span id="cb102-682"><a href="#cb102-682" aria-hidden="true" tabindex="-1"></a>2013-2014](https://wwwn.cdc.gov/nchs/nhanes/continuousnhanes/default.aspx?BeginYear=2013).</span>
<span id="cb102-683"><a href="#cb102-683" aria-hidden="true" tabindex="-1"></a>On this page are the links to different types of data, documentations or</span>
<span id="cb102-684"><a href="#cb102-684" aria-hidden="true" tabindex="-1"></a>codebooks.</span>
<span id="cb102-685"><a href="#cb102-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-686"><a href="#cb102-686" aria-hidden="true" tabindex="-1"></a>You can choose from</span>
<span id="cb102-687"><a href="#cb102-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-688"><a href="#cb102-688" aria-hidden="true" tabindex="-1"></a>::: {#bul-NAHNES-data-sections}</span>
<span id="cb102-689"><a href="#cb102-689" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Demographics Data</span>
<span id="cb102-690"><a href="#cb102-690" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Dietary Data</span>
<span id="cb102-691"><a href="#cb102-691" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Examination Data</span>
<span id="cb102-692"><a href="#cb102-692" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Laboratory Data</span>
<span id="cb102-693"><a href="#cb102-693" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Questionnaire Data</span>
<span id="cb102-694"><a href="#cb102-694" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Limited Access Data</span>
<span id="cb102-695"><a href="#cb102-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-696"><a href="#cb102-696" aria-hidden="true" tabindex="-1"></a>NHANES has six different data sections</span>
<span id="cb102-697"><a href="#cb102-697" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-698"><a href="#cb102-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-699"><a href="#cb102-699" aria-hidden="true" tabindex="-1"></a>Clicking of one of these links opens a page where a table contains the</span>
<span id="cb102-700"><a href="#cb102-700" aria-hidden="true" tabindex="-1"></a>following information:</span>
<span id="cb102-701"><a href="#cb102-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-702"><a href="#cb102-702" aria-hidden="true" tabindex="-1"></a>::: {#bul-NHANES-data-pages}</span>
<span id="cb102-703"><a href="#cb102-703" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Data File Name</span>
<span id="cb102-704"><a href="#cb102-704" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Doc File</span>
<span id="cb102-705"><a href="#cb102-705" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Data File</span>
<span id="cb102-706"><a href="#cb102-706" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Data Published</span>
<span id="cb102-707"><a href="#cb102-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-708"><a href="#cb102-708" aria-hidden="true" tabindex="-1"></a>NHANES data pages has download links for documentation and data files</span>
<span id="cb102-709"><a href="#cb102-709" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-710"><a href="#cb102-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-711"><a href="#cb102-711" aria-hidden="true" tabindex="-1"></a>[Datasets and</span>
<span id="cb102-712"><a href="#cb102-712" aria-hidden="true" tabindex="-1"></a>Documentation](https://wwwn.cdc.gov/nchs/nhanes/tutorials/Datasets.aspx)</span>
<span id="cb102-713"><a href="#cb102-713" aria-hidden="true" tabindex="-1"></a>and [Frequently Asked Questions</span>
<span id="cb102-714"><a href="#cb102-714" aria-hidden="true" tabindex="-1"></a>(FAQs)](https://wwwn.cdc.gov/nchs/nhanes/continuousnhanes/faq.aspx) are</span>
<span id="cb102-715"><a href="#cb102-715" aria-hidden="true" tabindex="-1"></a>important introductory pages.</span>
<span id="cb102-716"><a href="#cb102-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-717"><a href="#cb102-717" aria-hidden="true" tabindex="-1"></a>NHANES data are saved in a [SAS transport (.XPT)</span>
<span id="cb102-718"><a href="#cb102-718" aria-hidden="true" tabindex="-1"></a>file](https://www.loc.gov/preservation/digital/formats/fdd/fdd000464.shtml).</span>
<span id="cb102-719"><a href="#cb102-719" aria-hidden="true" tabindex="-1"></a>These file can be read with <span class="in">`foreign::read.xport()`</span> and</span>
<span id="cb102-720"><a href="#cb102-720" aria-hidden="true" tabindex="-1"></a><span class="in">`haven::read_xpt()`</span>. There is also a [page with example</span>
<span id="cb102-721"><a href="#cb102-721" aria-hidden="true" tabindex="-1"></a>code](https://wwwn.cdc.gov/nchs/nhanes/tutorials/Datasets.aspx) to</span>
<span id="cb102-722"><a href="#cb102-722" aria-hidden="true" tabindex="-1"></a>download/import NHANES data files. I will use {**haven**} instead of the</span>
<span id="cb102-723"><a href="#cb102-723" aria-hidden="true" tabindex="-1"></a>recommended {**foreign**} package.</span>
<span id="cb102-724"><a href="#cb102-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-725"><a href="#cb102-725" aria-hidden="true" tabindex="-1"></a><span class="fu">### Download NHANES SAS .xpt file data (Demo) {#sec-download-xpt-file}</span></span>
<span id="cb102-726"><a href="#cb102-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-727"><a href="#cb102-727" aria-hidden="true" tabindex="-1"></a>::: my-experiment</span>
<span id="cb102-728"><a href="#cb102-728" aria-hidden="true" tabindex="-1"></a>::: my-experiment-header</span>
<span id="cb102-729"><a href="#cb102-729" aria-hidden="true" tabindex="-1"></a>::: {#def-chap01-xpt-file-download}</span>
<span id="cb102-730"><a href="#cb102-730" aria-hidden="true" tabindex="-1"></a>: Download and work with NHANES SAS .xpt file data (Demo)</span>
<span id="cb102-731"><a href="#cb102-731" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-732"><a href="#cb102-732" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-733"><a href="#cb102-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-734"><a href="#cb102-734" aria-hidden="true" tabindex="-1"></a>::: my-experiment-container</span>
<span id="cb102-735"><a href="#cb102-735" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb102-736"><a href="#cb102-736" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Get .xpt file</span></span>
<span id="cb102-737"><a href="#cb102-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-738"><a href="#cb102-738" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb102-739"><a href="#cb102-739" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb102-740"><a href="#cb102-740" aria-hidden="true" tabindex="-1"></a>::: {#cnj-chap01-save-xpt-file-demo}</span>
<span id="cb102-741"><a href="#cb102-741" aria-hidden="true" tabindex="-1"></a>: Save a SAS transport (.xpt) file from the NHANES site for demo</span>
<span id="cb102-742"><a href="#cb102-742" aria-hidden="true" tabindex="-1"></a>purposes and display the structure of the file</span>
<span id="cb102-743"><a href="#cb102-743" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-744"><a href="#cb102-744" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-745"><a href="#cb102-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-746"><a href="#cb102-746" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb102-747"><a href="#cb102-747" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-748"><a href="#cb102-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-749"><a href="#cb102-749" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-750"><a href="#cb102-750" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: save-xpt-file-demo</span></span>
<span id="cb102-751"><a href="#cb102-751" aria-hidden="true" tabindex="-1"></a><span class="co">#| lst-label: lst-chap01-downloadfile</span></span>
<span id="cb102-752"><a href="#cb102-752" aria-hidden="true" tabindex="-1"></a><span class="co">#| lst-cap: &quot;Download a file and save it as R object&quot;</span></span>
<span id="cb102-753"><a href="#cb102-753" aria-hidden="true" tabindex="-1"></a><span class="co">#| cache: true</span></span>
<span id="cb102-754"><a href="#cb102-754" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb102-755"><a href="#cb102-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-756"><a href="#cb102-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-757"><a href="#cb102-757" aria-hidden="true" tabindex="-1"></a><span class="do">## download only once (manually)</span></span>
<span id="cb102-758"><a href="#cb102-758" aria-hidden="true" tabindex="-1"></a>utils<span class="sc">::</span><span class="fu">download.file</span>(</span>
<span id="cb102-759"><a href="#cb102-759" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;https://wwwn.cdc.gov/Nchs/Nhanes/2017-2018/P_BPXO.XPT&quot;</span>,</span>
<span id="cb102-760"><a href="#cb102-760" aria-hidden="true" tabindex="-1"></a>    tf <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">tempfile</span>(),</span>
<span id="cb102-761"><a href="#cb102-761" aria-hidden="true" tabindex="-1"></a>    <span class="at">mode =</span> <span class="st">&quot;wb&quot;</span></span>
<span id="cb102-762"><a href="#cb102-762" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb102-763"><a href="#cb102-763" aria-hidden="true" tabindex="-1"></a>blood_pressure_demo <span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">read_xpt</span>(tf)</span>
<span id="cb102-764"><a href="#cb102-764" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(blood_pressure_demo, <span class="at">file =</span> <span class="st">&quot;data-raw/blood_pressure_demo.rds&quot;</span>)</span>
<span id="cb102-765"><a href="#cb102-765" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-766"><a href="#cb102-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-767"><a href="#cb102-767" aria-hidden="true" tabindex="-1"></a>(*This code chunk has no visible output*)</span>
<span id="cb102-768"><a href="#cb102-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-769"><a href="#cb102-769" aria-hidden="true" tabindex="-1"></a>With the exception of using (**haven**) instead of {**foreign**}, I</span>
<span id="cb102-770"><a href="#cb102-770" aria-hidden="true" tabindex="-1"></a>followed the instruction from the [NHANES</span>
<span id="cb102-771"><a href="#cb102-771" aria-hidden="true" tabindex="-1"></a>recommendation](https://wwwn.cdc.gov/nchs/data/tutorials/file_download_import_R.R).</span>
<span id="cb102-772"><a href="#cb102-772" aria-hidden="true" tabindex="-1"></a>We see labelled data as it was expected from the import with</span>
<span id="cb102-773"><a href="#cb102-773" aria-hidden="true" tabindex="-1"></a>{**haven**}.</span>
<span id="cb102-774"><a href="#cb102-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-775"><a href="#cb102-775" aria-hidden="true" tabindex="-1"></a>In @lst-chap01-get-gss2016-automated I have already used the</span>
<span id="cb102-776"><a href="#cb102-776" aria-hidden="true" tabindex="-1"></a><span class="in">`utils::download.file()`</span> function: There are some differences:</span>
<span id="cb102-777"><a href="#cb102-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-778"><a href="#cb102-778" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>@lst-chap01-get-gss2016-automated downloaded a STATA <span class="in">`.zip`</span> file,</span>
<span id="cb102-779"><a href="#cb102-779" aria-hidden="true" tabindex="-1"></a>    therefore I used <span class="in">`unz()`</span> to unzip the file and to read</span>
<span id="cb102-780"><a href="#cb102-780" aria-hidden="true" tabindex="-1"></a>    <span class="in">`haven::read_dta()`</span> instead <span class="in">`haven::read_xpt()`</span>.</span>
<span id="cb102-781"><a href="#cb102-781" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>More important however was the <span class="in">`base::unlink(temp)`</span> command to</span>
<span id="cb102-782"><a href="#cb102-782" aria-hidden="true" tabindex="-1"></a>    unlink the temporary file, which is not done here.</span>
<span id="cb102-783"><a href="#cb102-783" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Another difference was using the argument <span class="in">`mode = &quot;wb&quot;`</span> for writing</span>
<span id="cb102-784"><a href="#cb102-784" aria-hidden="true" tabindex="-1"></a>    binary files. As I understood this is only important for Windows</span>
<span id="cb102-785"><a href="#cb102-785" aria-hidden="true" tabindex="-1"></a>    user. On my Mac I could stick with the default value <span class="in">`mode = &quot;w&quot;`</span>.</span>
<span id="cb102-786"><a href="#cb102-786" aria-hidden="true" tabindex="-1"></a>    But for reproducibility it would be better to use in the future the</span>
<span id="cb102-787"><a href="#cb102-787" aria-hidden="true" tabindex="-1"></a>    more general option with <span class="in">`mode = &quot;wb&quot;`</span>.</span>
<span id="cb102-788"><a href="#cb102-788" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-789"><a href="#cb102-789" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-790"><a href="#cb102-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-791"><a href="#cb102-791" aria-hidden="true" tabindex="-1"></a>:::::{.my-important}</span>
<span id="cb102-792"><a href="#cb102-792" aria-hidden="true" tabindex="-1"></a>:::{.my-important-header}</span>
<span id="cb102-793"><a href="#cb102-793" aria-hidden="true" tabindex="-1"></a>{**nhanesA**} package facilitates downloading NHANES data</span>
<span id="cb102-794"><a href="#cb102-794" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-795"><a href="#cb102-795" aria-hidden="true" tabindex="-1"></a>::::{.my-important-container}</span>
<span id="cb102-796"><a href="#cb102-796" aria-hidden="true" tabindex="-1"></a>I just learned that there is a {**nhanesA**} package that facilitates downloading data to R. (2024-01-20) The latest package release is brand-new (2024-01-09).</span>
<span id="cb102-797"><a href="#cb102-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-798"><a href="#cb102-798" aria-hidden="true" tabindex="-1"></a>I am planning to use this package when I am working with again with NHANES data in @sec-chap03 and @sec-chap06. Just for me to remember: </span>
<span id="cb102-799"><a href="#cb102-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-800"><a href="#cb102-800" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The packages is <span class="co">[</span><span class="ot">on CRAN</span><span class="co">](https://cran.r-project.org/web/packages/nhanesA/index.html)</span></span>
<span id="cb102-801"><a href="#cb102-801" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>There is a <span class="co">[</span><span class="ot">GitHub repository</span><span class="co">](https://github.com/cjendres1/nhanes)</span>.</span>
<span id="cb102-802"><a href="#cb102-802" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>A very informative <span class="co">[</span><span class="ot">introductory vignette</span><span class="co">](https://cran.r-project.org/web/packages/nhanesA/vignettes/Introducing_nhanesA.html)</span> does not only explain the package but also the structure of the NAHNES data and codebook.</span>
<span id="cb102-803"><a href="#cb102-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-804"><a href="#cb102-804" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-805"><a href="#cb102-805" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-806"><a href="#cb102-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-807"><a href="#cb102-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-808"><a href="#cb102-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-809"><a href="#cb102-809" aria-hidden="true" tabindex="-1"></a><span class="fu">###### str()</span></span>
<span id="cb102-810"><a href="#cb102-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-811"><a href="#cb102-811" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb102-812"><a href="#cb102-812" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb102-813"><a href="#cb102-813" aria-hidden="true" tabindex="-1"></a>::: {#cnj-chap01-str-blood-pressure-demo}</span>
<span id="cb102-814"><a href="#cb102-814" aria-hidden="true" tabindex="-1"></a>: Show data summary of three blood pressure variables with</span>
<span id="cb102-815"><a href="#cb102-815" aria-hidden="true" tabindex="-1"></a><span class="in">`utils::str()`</span> (Demo)</span>
<span id="cb102-816"><a href="#cb102-816" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-817"><a href="#cb102-817" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-818"><a href="#cb102-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-819"><a href="#cb102-819" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb102-820"><a href="#cb102-820" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-821"><a href="#cb102-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-822"><a href="#cb102-822" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-823"><a href="#cb102-823" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: str-blood-pressure-demo</span></span>
<span id="cb102-824"><a href="#cb102-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-825"><a href="#cb102-825" aria-hidden="true" tabindex="-1"></a>blood_pressure_demo <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="st">&quot;data-raw/blood_pressure_demo.rds&quot;</span>)</span>
<span id="cb102-826"><a href="#cb102-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-827"><a href="#cb102-827" aria-hidden="true" tabindex="-1"></a>blood_pressure_demo <span class="sc">|&gt;</span> </span>
<span id="cb102-828"><a href="#cb102-828" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb102-829"><a href="#cb102-829" aria-hidden="true" tabindex="-1"></a>    utils<span class="sc">::</span><span class="fu">str</span>()</span>
<span id="cb102-830"><a href="#cb102-830" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-831"><a href="#cb102-831" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-832"><a href="#cb102-832" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-833"><a href="#cb102-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-834"><a href="#cb102-834" aria-hidden="true" tabindex="-1"></a><span class="fu">###### summary()</span></span>
<span id="cb102-835"><a href="#cb102-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-836"><a href="#cb102-836" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb102-837"><a href="#cb102-837" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb102-838"><a href="#cb102-838" aria-hidden="true" tabindex="-1"></a>::: {#cnj-chap01-summary-blood-pressure-demo}</span>
<span id="cb102-839"><a href="#cb102-839" aria-hidden="true" tabindex="-1"></a>: Show data summary of three blood pressure variables with <span class="in">`summary()`</span></span>
<span id="cb102-840"><a href="#cb102-840" aria-hidden="true" tabindex="-1"></a>(Demo)</span>
<span id="cb102-841"><a href="#cb102-841" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-842"><a href="#cb102-842" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-843"><a href="#cb102-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-844"><a href="#cb102-844" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb102-845"><a href="#cb102-845" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-846"><a href="#cb102-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-847"><a href="#cb102-847" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-848"><a href="#cb102-848" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: summary-blood-pressure-demo</span></span>
<span id="cb102-849"><a href="#cb102-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-850"><a href="#cb102-850" aria-hidden="true" tabindex="-1"></a>blood_pressure_demo <span class="sc">|&gt;</span> </span>
<span id="cb102-851"><a href="#cb102-851" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb102-852"><a href="#cb102-852" aria-hidden="true" tabindex="-1"></a>    base<span class="sc">::</span><span class="fu">summary</span>()</span>
<span id="cb102-853"><a href="#cb102-853" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-854"><a href="#cb102-854" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-855"><a href="#cb102-855" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-856"><a href="#cb102-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-857"><a href="#cb102-857" aria-hidden="true" tabindex="-1"></a><span class="fu">###### skim()</span></span>
<span id="cb102-858"><a href="#cb102-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-859"><a href="#cb102-859" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb102-860"><a href="#cb102-860" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb102-861"><a href="#cb102-861" aria-hidden="true" tabindex="-1"></a>::: {#cnj-chap01-skim-blood-pressure-demo}</span>
<span id="cb102-862"><a href="#cb102-862" aria-hidden="true" tabindex="-1"></a>: Show data summary of three blood pressure variables with <span class="in">`skim()`</span></span>
<span id="cb102-863"><a href="#cb102-863" aria-hidden="true" tabindex="-1"></a>(Demo)</span>
<span id="cb102-864"><a href="#cb102-864" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-865"><a href="#cb102-865" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-866"><a href="#cb102-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-867"><a href="#cb102-867" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb102-868"><a href="#cb102-868" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-869"><a href="#cb102-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-870"><a href="#cb102-870" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-871"><a href="#cb102-871" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: skim-blood-pressure-demo</span></span>
<span id="cb102-872"><a href="#cb102-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-873"><a href="#cb102-873" aria-hidden="true" tabindex="-1"></a>blood_pressure_demo <span class="sc">|&gt;</span> </span>
<span id="cb102-874"><a href="#cb102-874" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb102-875"><a href="#cb102-875" aria-hidden="true" tabindex="-1"></a>    skimr<span class="sc">::</span><span class="fu">skim</span>()</span>
<span id="cb102-876"><a href="#cb102-876" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-877"><a href="#cb102-877" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-878"><a href="#cb102-878" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-879"><a href="#cb102-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-880"><a href="#cb102-880" aria-hidden="true" tabindex="-1"></a><span class="fu">###### glance_data()</span></span>
<span id="cb102-881"><a href="#cb102-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-882"><a href="#cb102-882" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb102-883"><a href="#cb102-883" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb102-884"><a href="#cb102-884" aria-hidden="true" tabindex="-1"></a>::: {#cnj-chap01-show-random-blood-pressure-demo}</span>
<span id="cb102-885"><a href="#cb102-885" aria-hidden="true" tabindex="-1"></a>: Show some blood pressure data with my private function <span class="in">`glance_data()`</span></span>
<span id="cb102-886"><a href="#cb102-886" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-887"><a href="#cb102-887" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-888"><a href="#cb102-888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-889"><a href="#cb102-889" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb102-890"><a href="#cb102-890" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-891"><a href="#cb102-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-892"><a href="#cb102-892" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-893"><a href="#cb102-893" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: show-random-blood-pressure-demo</span></span>
<span id="cb102-894"><a href="#cb102-894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-895"><a href="#cb102-895" aria-hidden="true" tabindex="-1"></a>blood_pressure_demo <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="st">&quot;data-raw/blood_pressure_demo.rds&quot;</span>)</span>
<span id="cb102-896"><a href="#cb102-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-897"><a href="#cb102-897" aria-hidden="true" tabindex="-1"></a><span class="do">## display some values</span></span>
<span id="cb102-898"><a href="#cb102-898" aria-hidden="true" tabindex="-1"></a>blood_pressure_demo <span class="sc">|&gt;</span> </span>
<span id="cb102-899"><a href="#cb102-899" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb102-900"><a href="#cb102-900" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">arm_selected =</span> BPAOARM) <span class="sc">|&gt;</span> </span>
<span id="cb102-901"><a href="#cb102-901" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">systolic =</span> BPXOSY1) <span class="sc">|&gt;</span> </span>
<span id="cb102-902"><a href="#cb102-902" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">diastolic =</span> BPXODI1) <span class="sc">|&gt;</span> </span>
<span id="cb102-903"><a href="#cb102-903" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glance_data</span>()</span>
<span id="cb102-904"><a href="#cb102-904" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-905"><a href="#cb102-905" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-906"><a href="#cb102-906" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-907"><a href="#cb102-907" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-908"><a href="#cb102-908" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-909"><a href="#cb102-909" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-910"><a href="#cb102-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-911"><a href="#cb102-911" aria-hidden="true" tabindex="-1"></a><span class="fu">### Import &amp; clean data {#sec-chap01-import-clean-data}</span></span>
<span id="cb102-912"><a href="#cb102-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-913"><a href="#cb102-913" aria-hidden="true" tabindex="-1"></a>::: my-exercise</span>
<span id="cb102-914"><a href="#cb102-914" aria-hidden="true" tabindex="-1"></a>::: my-exercise-header</span>
<span id="cb102-915"><a href="#cb102-915" aria-hidden="true" tabindex="-1"></a>::: {#exr-chap01-read-nhanes-csv}</span>
<span id="cb102-916"><a href="#cb102-916" aria-hidden="true" tabindex="-1"></a>: Coder exercises: Import &amp; clean data</span>
<span id="cb102-917"><a href="#cb102-917" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-918"><a href="#cb102-918" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-919"><a href="#cb102-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-920"><a href="#cb102-920" aria-hidden="true" tabindex="-1"></a>::: my-exercise-container</span>
<span id="cb102-921"><a href="#cb102-921" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb102-922"><a href="#cb102-922" aria-hidden="true" tabindex="-1"></a><span class="fu">###### read_csv()</span></span>
<span id="cb102-923"><a href="#cb102-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-924"><a href="#cb102-924" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb102-925"><a href="#cb102-925" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb102-926"><a href="#cb102-926" aria-hidden="true" tabindex="-1"></a>::: {#cnj-chap01-read-nhanes-csv}</span>
<span id="cb102-927"><a href="#cb102-927" aria-hidden="true" tabindex="-1"></a>: Open the 2013–2014 NHANES data file that comes with the book</span>
<span id="cb102-928"><a href="#cb102-928" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-929"><a href="#cb102-929" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-930"><a href="#cb102-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-931"><a href="#cb102-931" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb102-932"><a href="#cb102-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-933"><a href="#cb102-933" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-934"><a href="#cb102-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-935"><a href="#cb102-935" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-936"><a href="#cb102-936" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: read-nhanes-csv</span></span>
<span id="cb102-937"><a href="#cb102-937" aria-hidden="true" tabindex="-1"></a><span class="co">#| cache: true</span></span>
<span id="cb102-938"><a href="#cb102-938" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb102-939"><a href="#cb102-939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-940"><a href="#cb102-940" aria-hidden="true" tabindex="-1"></a><span class="do">## load and save it only once (manually) ########</span></span>
<span id="cb102-941"><a href="#cb102-941" aria-hidden="true" tabindex="-1"></a>nhanes_2013_ch1 <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">&quot;data-harris/nhanes_2013_ch1.csv&quot;</span>)</span>
<span id="cb102-942"><a href="#cb102-942" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(nhanes_2013_ch1, <span class="at">file =</span> <span class="st">&quot;data-raw/nhanes_2013_ch1.rds&quot;</span> )</span>
<span id="cb102-943"><a href="#cb102-943" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-944"><a href="#cb102-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-945"><a href="#cb102-945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-946"><a href="#cb102-946" aria-hidden="true" tabindex="-1"></a>(*This R Code chunk has no visible output.*)</span>
<span id="cb102-947"><a href="#cb102-947" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-948"><a href="#cb102-948" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-949"><a href="#cb102-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-950"><a href="#cb102-950" aria-hidden="true" tabindex="-1"></a><span class="fu">###### View data</span></span>
<span id="cb102-951"><a href="#cb102-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-952"><a href="#cb102-952" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb102-953"><a href="#cb102-953" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb102-954"><a href="#cb102-954" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-chap01-NHANES-view-data}</span>
<span id="cb102-955"><a href="#cb102-955" aria-hidden="true" tabindex="-1"></a>: Look at the data with <span class="in">`utils::str()`</span> and <span class="in">`skimr::skim()`</span></span>
<span id="cb102-956"><a href="#cb102-956" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb102-957"><a href="#cb102-957" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-958"><a href="#cb102-958" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb102-959"><a href="#cb102-959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-960"><a href="#cb102-960" aria-hidden="true" tabindex="-1"></a>::: {#lst-chap01-NHANES-view-data}</span>
<span id="cb102-961"><a href="#cb102-961" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-962"><a href="#cb102-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-963"><a href="#cb102-963" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-964"><a href="#cb102-964" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: NHANES-view-data</span></span>
<span id="cb102-965"><a href="#cb102-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-966"><a href="#cb102-966" aria-hidden="true" tabindex="-1"></a>nhanes_2013_ch1 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;data-raw/nhanes_2013_ch1.rds&quot;</span>)</span>
<span id="cb102-967"><a href="#cb102-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-968"><a href="#cb102-968" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">summary</span>(nhanes_2013_ch1)</span>
<span id="cb102-969"><a href="#cb102-969" aria-hidden="true" tabindex="-1"></a>utils<span class="sc">::</span><span class="fu">str</span>(nhanes_2013_ch1)</span>
<span id="cb102-970"><a href="#cb102-970" aria-hidden="true" tabindex="-1"></a>skimr<span class="sc">::</span><span class="fu">skim</span>(nhanes_2013_ch1)</span>
<span id="cb102-971"><a href="#cb102-971" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-972"><a href="#cb102-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-973"><a href="#cb102-973" aria-hidden="true" tabindex="-1"></a>Look at the data with <span class="in">`utils::str()`</span> and <span class="in">`skimr::skim()`</span></span>
<span id="cb102-974"><a href="#cb102-974" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-975"><a href="#cb102-975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-976"><a href="#cb102-976" aria-hidden="true" tabindex="-1"></a>As one of the packages for displaying summaries I am using the {**skimr**} package (see @pak-skimr).</span>
<span id="cb102-977"><a href="#cb102-977" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-978"><a href="#cb102-978" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-979"><a href="#cb102-979" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-980"><a href="#cb102-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-981"><a href="#cb102-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-982"><a href="#cb102-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-983"><a href="#cb102-983" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Codebook</span></span>
<span id="cb102-984"><a href="#cb102-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-985"><a href="#cb102-985" aria-hidden="true" tabindex="-1"></a>Unfortunately the .csv files does not include labelled data. Therefore I</span>
<span id="cb102-986"><a href="#cb102-986" aria-hidden="true" tabindex="-1"></a>had to look for the variable names in all different NHANES sections as</span>
<span id="cb102-987"><a href="#cb102-987" aria-hidden="true" tabindex="-1"></a>outlined in @bul-NAHNES-data-sections. Inspecting the accompanying</span>
<span id="cb102-988"><a href="#cb102-988" aria-hidden="true" tabindex="-1"></a>NHANES download pages (see: @bul-NHANES-data-pages) I could look for the</span>
<span id="cb102-989"><a href="#cb102-989" aria-hidden="true" tabindex="-1"></a>variable names in the download links for the documentation.</span>
<span id="cb102-990"><a href="#cb102-990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-991"><a href="#cb102-991" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">DUQ200</span><span class="co">](https://wwwn.cdc.gov/Nchs/Nhanes/2013-2014/DUQ_H.htm#DUQ200)</span>:</span>
<span id="cb102-992"><a href="#cb102-992" aria-hidden="true" tabindex="-1"></a>    Ever used marijuana or hashish</span>
<span id="cb102-993"><a href="#cb102-993" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">RIAGENDR</span><span class="co">](https://wwwn.cdc.gov/Nchs/Nhanes/2013-2014/DEMO_H.htm#RIAGENDR)</span>:</span>
<span id="cb102-994"><a href="#cb102-994" aria-hidden="true" tabindex="-1"></a>    Gender</span>
<span id="cb102-995"><a href="#cb102-995" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">RIDAGEYR</span><span class="co">](https://wwwn.cdc.gov/Nchs/Nhanes/2013-2014/DEMO_H.htm#RIDAGEYR)</span>:</span>
<span id="cb102-996"><a href="#cb102-996" aria-hidden="true" tabindex="-1"></a>    Age in years at screening</span>
<span id="cb102-997"><a href="#cb102-997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-998"><a href="#cb102-998" aria-hidden="true" tabindex="-1"></a>There is an additional column <span class="in">`...1`</span> (see @lst-chap01-NHANES-view-data) providing row numbers. Maybe this column works as an ID, a kind sequence number, so that one could merge other data files identified by this number. (See <span class="co">[</span><span class="ot">SEQN</span><span class="co">](https://wwwn.cdc.gov/Nchs/Nhanes/2013-2014/DEMO_H.htm#SEQN)</span>: Respondent Sequence Number). Why this column has lost its name, I do not know. Perhaps it has to do with the data import done by the book author?</span>
<span id="cb102-999"><a href="#cb102-999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1000"><a href="#cb102-1000" aria-hidden="true" tabindex="-1"></a>To facilitate the work I made screenshots from these four variables:</span>
<span id="cb102-1001"><a href="#cb102-1001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1002"><a href="#cb102-1002" aria-hidden="true" tabindex="-1"></a><span class="al">![](img/chap01/codebook-NHANES-DUQ200-marijuana-min.png)</span></span>
<span id="cb102-1003"><a href="#cb102-1003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1004"><a href="#cb102-1004" aria-hidden="true" tabindex="-1"></a><span class="al">![](img/chap01/codebook-NHANES-RIAGENDR-RIDAGEYR-gender-age-min.png)</span></span>
<span id="cb102-1005"><a href="#cb102-1005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1006"><a href="#cb102-1006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1007"><a href="#cb102-1007" aria-hidden="true" tabindex="-1"></a><span class="al">![](img/chap01/codebook-NHANES-SEQN-sequence-number-min.png)</span></span>
<span id="cb102-1008"><a href="#cb102-1008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1009"><a href="#cb102-1009" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Data cleaning</span></span>
<span id="cb102-1010"><a href="#cb102-1010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1011"><a href="#cb102-1011" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb102-1012"><a href="#cb102-1012" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb102-1013"><a href="#cb102-1013" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-chap01-NHANES-data-cleaning}</span>
<span id="cb102-1014"><a href="#cb102-1014" aria-hidden="true" tabindex="-1"></a>: Look at the data after data cleaning</span>
<span id="cb102-1015"><a href="#cb102-1015" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb102-1016"><a href="#cb102-1016" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1017"><a href="#cb102-1017" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb102-1018"><a href="#cb102-1018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1019"><a href="#cb102-1019" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-1020"><a href="#cb102-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1021"><a href="#cb102-1021" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-1022"><a href="#cb102-1022" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: NHANES-data-cleaning</span></span>
<span id="cb102-1023"><a href="#cb102-1023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1024"><a href="#cb102-1024" aria-hidden="true" tabindex="-1"></a>nhanes_2013_ch1 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;data-raw/nhanes_2013_ch1.rds&quot;</span>)</span>
<span id="cb102-1025"><a href="#cb102-1025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1026"><a href="#cb102-1026" aria-hidden="true" tabindex="-1"></a>chap01_nhanes_2013_clean <span class="ot">&lt;-</span> nhanes_2013_ch1 <span class="sc">|&gt;</span> </span>
<span id="cb102-1027"><a href="#cb102-1027" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">nr =</span> ...<span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb102-1028"><a href="#cb102-1028" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(</span>
<span id="cb102-1029"><a href="#cb102-1029" aria-hidden="true" tabindex="-1"></a>        <span class="at">sex =</span> RIAGENDR,</span>
<span id="cb102-1030"><a href="#cb102-1030" aria-hidden="true" tabindex="-1"></a>        <span class="at">age =</span> RIDAGEYR,</span>
<span id="cb102-1031"><a href="#cb102-1031" aria-hidden="true" tabindex="-1"></a>        <span class="at">grass =</span> DUQ200</span>
<span id="cb102-1032"><a href="#cb102-1032" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">|&gt;</span> </span>
<span id="cb102-1033"><a href="#cb102-1033" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">grass =</span></span>
<span id="cb102-1034"><a href="#cb102-1034" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">na_if</span>(<span class="at">x =</span> grass, <span class="at">y =</span> <span class="dv">7</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb102-1035"><a href="#cb102-1035" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">grass =</span></span>
<span id="cb102-1036"><a href="#cb102-1036" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">na_if</span>(<span class="at">x =</span> grass, <span class="at">y =</span> <span class="dv">9</span>)) <span class="sc">|&gt;</span></span>
<span id="cb102-1037"><a href="#cb102-1037" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">drop_na</span>() <span class="sc">|&gt;</span> </span>
<span id="cb102-1038"><a href="#cb102-1038" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">sex =</span> forcats<span class="sc">::</span><span class="fu">as_factor</span>(sex)) <span class="sc">|&gt;</span> </span>
<span id="cb102-1039"><a href="#cb102-1039" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">grass =</span> forcats<span class="sc">::</span><span class="fu">as_factor</span>(grass)) <span class="sc">|&gt;</span> </span>
<span id="cb102-1040"><a href="#cb102-1040" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">grass =</span> </span>
<span id="cb102-1041"><a href="#cb102-1041" aria-hidden="true" tabindex="-1"></a>          forcats<span class="sc">::</span><span class="fu">fct_recode</span>(grass, </span>
<span id="cb102-1042"><a href="#cb102-1042" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;Yes&quot;</span> <span class="ot">=</span> <span class="st">&quot;1&quot;</span>, <span class="st">&quot;No&quot;</span> <span class="ot">=</span> <span class="st">&quot;2&quot;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb102-1043"><a href="#cb102-1043" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">sex =</span> </span>
<span id="cb102-1044"><a href="#cb102-1044" aria-hidden="true" tabindex="-1"></a>          forcats<span class="sc">::</span><span class="fu">fct_recode</span>(sex, </span>
<span id="cb102-1045"><a href="#cb102-1045" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;Male&quot;</span> <span class="ot">=</span> <span class="st">&quot;1&quot;</span>, <span class="st">&quot;Female&quot;</span> <span class="ot">=</span> <span class="st">&quot;2&quot;</span>))</span>
<span id="cb102-1046"><a href="#cb102-1046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1047"><a href="#cb102-1047" aria-hidden="true" tabindex="-1"></a><span class="do">## save cleaned data ###############</span></span>
<span id="cb102-1048"><a href="#cb102-1048" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(chap01_nhanes_2013_clean, <span class="st">&quot;data-clean/chap01_nhanes_2013_clean.rds&quot;</span>)</span>
<span id="cb102-1049"><a href="#cb102-1049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1050"><a href="#cb102-1050" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">summary</span>(chap01_nhanes_2013_clean)</span>
<span id="cb102-1051"><a href="#cb102-1051" aria-hidden="true" tabindex="-1"></a>skimr<span class="sc">::</span><span class="fu">skim</span>(chap01_nhanes_2013_clean)</span>
<span id="cb102-1052"><a href="#cb102-1052" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-1053"><a href="#cb102-1053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1054"><a href="#cb102-1054" aria-hidden="true" tabindex="-1"></a>:::::{.my-important}</span>
<span id="cb102-1055"><a href="#cb102-1055" aria-hidden="true" tabindex="-1"></a>:::{.my-important-header}</span>
<span id="cb102-1056"><a href="#cb102-1056" aria-hidden="true" tabindex="-1"></a>Recoded <span class="in">`gender`</span> to <span class="in">`sex`</span></span>
<span id="cb102-1057"><a href="#cb102-1057" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1058"><a href="#cb102-1058" aria-hidden="true" tabindex="-1"></a>::::{.my-important-container}</span>
<span id="cb102-1059"><a href="#cb102-1059" aria-hidden="true" tabindex="-1"></a>In all R code chunks and text passages I have changed the <span class="in">`gender`</span> category to <span class="in">`sex`</span>. &quot;Sex&quot; refers only to biology but &quot;gender&quot; is a broader concepts: It refers to identity construction, that include biological, psycho-social, and cultural factors. </span>
<span id="cb102-1060"><a href="#cb102-1060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1061"><a href="#cb102-1061" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Gender refers to the characteristics of women, men, girls and boys that are socially constructed.  This includes norms, behaviours and roles associated with being a woman, man, girl or boy, as well as relationships with each other. As a social construct, gender varies from society to society and can change over time. ...</span></span>
<span id="cb102-1062"><a href="#cb102-1062" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Gender interacts with but is different from sex, which refers to the different biological and physiological characteristics of females, males and intersex persons, such as chromosomes, hormones and reproductive organs. Gender and sex are related to but different from gender identity. Gender identity refers to a person’s deeply felt, internal and individual experience of gender, which may or may not correspond to the person’s physiology or designated sex at birth.  (</span><span class="co">[</span><span class="ot">WHO</span><span class="co">](https://www.who.int/health-topics/gender#tab=tab_1)</span><span class="at">)</span></span>
<span id="cb102-1063"><a href="#cb102-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1064"><a href="#cb102-1064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1065"><a href="#cb102-1065" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-1066"><a href="#cb102-1066" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-1067"><a href="#cb102-1067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1068"><a href="#cb102-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1069"><a href="#cb102-1069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1070"><a href="#cb102-1070" aria-hidden="true" tabindex="-1"></a>:::::{.my-note}</span>
<span id="cb102-1071"><a href="#cb102-1071" aria-hidden="true" tabindex="-1"></a>:::{.my-note-header}</span>
<span id="cb102-1072"><a href="#cb102-1072" aria-hidden="true" tabindex="-1"></a>My learning from the above procedure of data cleaning</span>
<span id="cb102-1073"><a href="#cb102-1073" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1074"><a href="#cb102-1074" aria-hidden="true" tabindex="-1"></a>::::{.my-note-container}</span>
<span id="cb102-1075"><a href="#cb102-1075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1076"><a href="#cb102-1076" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>It is wrong to put the column name <span class="in">`...1`</span> into accents.</span>
<span id="cb102-1077"><a href="#cb102-1077" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>There exists a shortcut for several <span class="in">`dplyr::rename()`</span> but not for <span class="in">`dplyr::na_if()`</span> and <span class="in">`forcats::as_factor()`</span> because here we need to change the column values with the command.</span>
<span id="cb102-1078"><a href="#cb102-1078" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Sequence of commands is important: </span>
<span id="cb102-1079"><a href="#cb102-1079" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Start with the renaming of variables, This is not mandatory but it helps to address the correct column in the following commands.</span>
<span id="cb102-1080"><a href="#cb102-1080" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Recode different missing values to NA’s with <span class="in">`dplyr::na_if()`</span></span>
<span id="cb102-1081"><a href="#cb102-1081" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Then drop (all) NA’s with <span class="in">`tidyr::drop_na()`</span>.</span>
<span id="cb102-1082"><a href="#cb102-1082" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span><span class="in">`forcats::as_factor()`</span> needs to rewrite the column as factor with <span class="in">`dplyr::mutate()`</span> </span>
<span id="cb102-1083"><a href="#cb102-1083" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1084"><a href="#cb102-1084" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-1085"><a href="#cb102-1085" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-1086"><a href="#cb102-1086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1087"><a href="#cb102-1087" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-1088"><a href="#cb102-1088" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-1089"><a href="#cb102-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1090"><a href="#cb102-1090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1091"><a href="#cb102-1091" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1092"><a href="#cb102-1092" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1093"><a href="#cb102-1093" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1094"><a href="#cb102-1094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1095"><a href="#cb102-1095" aria-hidden="true" tabindex="-1"></a><span class="fu">### Bar chart for marijuana use {#sec-chap01-bar-chart-grass}</span></span>
<span id="cb102-1096"><a href="#cb102-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1097"><a href="#cb102-1097" aria-hidden="true" tabindex="-1"></a>:::::{.my-exercise}</span>
<span id="cb102-1098"><a href="#cb102-1098" aria-hidden="true" tabindex="-1"></a>:::{.my-exercise-header}</span>
<span id="cb102-1099"><a href="#cb102-1099" aria-hidden="true" tabindex="-1"></a>:::::: {#exr-chap01-bar-chart-grass-percentage}</span>
<span id="cb102-1100"><a href="#cb102-1100" aria-hidden="true" tabindex="-1"></a>: Bar chart (with different bar width ans space) showing the percentage of NHANES participants answering yes and no to marijuana use</span>
<span id="cb102-1101"><a href="#cb102-1101" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb102-1102"><a href="#cb102-1102" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1103"><a href="#cb102-1103" aria-hidden="true" tabindex="-1"></a>::::{.my-exercise-container}</span>
<span id="cb102-1104"><a href="#cb102-1104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1105"><a href="#cb102-1105" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb102-1106"><a href="#cb102-1106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1107"><a href="#cb102-1107" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Numbers</span></span>
<span id="cb102-1108"><a href="#cb102-1108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1109"><a href="#cb102-1109" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb102-1110"><a href="#cb102-1110" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb102-1111"><a href="#cb102-1111" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-chap01-compute-grass-percentage}</span>
<span id="cb102-1112"><a href="#cb102-1112" aria-hidden="true" tabindex="-1"></a>: Show frequencies and percentages of NHANES participants answering yes and no to &quot;Ever used marijuana or hashish&quot;</span>
<span id="cb102-1113"><a href="#cb102-1113" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb102-1114"><a href="#cb102-1114" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1115"><a href="#cb102-1115" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb102-1116"><a href="#cb102-1116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1117"><a href="#cb102-1117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1118"><a href="#cb102-1118" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-1119"><a href="#cb102-1119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1120"><a href="#cb102-1120" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-1121"><a href="#cb102-1121" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: compute-grass-percentage</span></span>
<span id="cb102-1122"><a href="#cb102-1122" aria-hidden="true" tabindex="-1"></a><span class="co">#| cache: true</span></span>
<span id="cb102-1123"><a href="#cb102-1123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1124"><a href="#cb102-1124" aria-hidden="true" tabindex="-1"></a>chap01_nhanes_2013_clean <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;data-clean/chap01_nhanes_2013_clean.rds&quot;</span>)</span>
<span id="cb102-1125"><a href="#cb102-1125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1126"><a href="#cb102-1126" aria-hidden="true" tabindex="-1"></a>tibble<span class="sc">::</span><span class="fu">enframe</span>(<span class="fu">table</span>(chap01_nhanes_2013_clean<span class="sc">$</span>grass)) <span class="sc">|&gt;</span> </span>
<span id="cb102-1127"><a href="#cb102-1127" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">`</span><span class="at">Ever used grass or hash</span><span class="st">`</span> <span class="ot">=</span> name, <span class="at">Freq =</span> value) <span class="sc">|&gt;</span> </span>
<span id="cb102-1128"><a href="#cb102-1128" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Perc =</span> <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> Freq <span class="sc">/</span> <span class="fu">sum</span>(Freq), <span class="dv">2</span>))</span>
<span id="cb102-1129"><a href="#cb102-1129" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-1130"><a href="#cb102-1130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1131"><a href="#cb102-1131" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-1132"><a href="#cb102-1132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1133"><a href="#cb102-1133" aria-hidden="true" tabindex="-1"></a>Instead of using <span class="in">`name`</span> and <span class="in">`value`</span> I could have used the position of the column numbers <span class="in">`1`</span> and <span class="in">`2`</span> (all names without the <span class="sc">\`</span>-sign.)</span>
<span id="cb102-1134"><a href="#cb102-1134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1135"><a href="#cb102-1135" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-1136"><a href="#cb102-1136" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-1137"><a href="#cb102-1137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1138"><a href="#cb102-1138" aria-hidden="true" tabindex="-1"></a>This is a manual calculation using the {**tidyverse**} approach: I am sure there are some packages that may facilitate this computation (e.g., {**Janitor**} or {**DescTools**}), but I had difficulties to apply the appropriate functions.</span>
<span id="cb102-1139"><a href="#cb102-1139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1140"><a href="#cb102-1140" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Standard</span></span>
<span id="cb102-1141"><a href="#cb102-1141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1142"><a href="#cb102-1142" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb102-1143"><a href="#cb102-1143" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb102-1144"><a href="#cb102-1144" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-chap01-grass-bar-chart-percentage}</span>
<span id="cb102-1145"><a href="#cb102-1145" aria-hidden="true" tabindex="-1"></a>: Percentage of NHANES participants answering yes and no to marijuana use</span>
<span id="cb102-1146"><a href="#cb102-1146" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb102-1147"><a href="#cb102-1147" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1148"><a href="#cb102-1148" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb102-1149"><a href="#cb102-1149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1150"><a href="#cb102-1150" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-1151"><a href="#cb102-1151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1152"><a href="#cb102-1152" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-1153"><a href="#cb102-1153" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-grass-bar-chart-percentage-standard</span></span>
<span id="cb102-1154"><a href="#cb102-1154" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;Proportion of marijuana use of the participant in the NHANES 2013 survey&quot;</span></span>
<span id="cb102-1155"><a href="#cb102-1155" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 4</span></span>
<span id="cb102-1156"><a href="#cb102-1156" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb102-1157"><a href="#cb102-1157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1158"><a href="#cb102-1158" aria-hidden="true" tabindex="-1"></a>chap01_nhanes_2013_clean <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;data-clean/chap01_nhanes_2013_clean.rds&quot;</span>)</span>
<span id="cb102-1159"><a href="#cb102-1159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1160"><a href="#cb102-1160" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(chap01_nhanes_2013_clean,</span>
<span id="cb102-1161"><a href="#cb102-1161" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">aes</span>(grass, </span>
<span id="cb102-1162"><a href="#cb102-1162" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="dv">100</span> <span class="sc">*</span> ggplot2<span class="sc">::</span><span class="fu">after_stat</span>(count) <span class="sc">/</span></span>
<span id="cb102-1163"><a href="#cb102-1163" aria-hidden="true" tabindex="-1"></a>             base<span class="sc">::</span><span class="fu">sum</span>(ggplot2<span class="sc">::</span><span class="fu">after_stat</span>(count)),</span>
<span id="cb102-1164"><a href="#cb102-1164" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> grass</span>
<span id="cb102-1165"><a href="#cb102-1165" aria-hidden="true" tabindex="-1"></a>        )) <span class="sc">+</span></span>
<span id="cb102-1166"><a href="#cb102-1166" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_bar</span>() <span class="sc">+</span> </span>
<span id="cb102-1167"><a href="#cb102-1167" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb102-1168"><a href="#cb102-1168" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>, <span class="st">&#39;darkred&#39;</span>),</span>
<span id="cb102-1169"><a href="#cb102-1169" aria-hidden="true" tabindex="-1"></a>                    <span class="at">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb102-1170"><a href="#cb102-1170" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">scale_y_continuous</span>(</span>
<span id="cb102-1171"><a href="#cb102-1171" aria-hidden="true" tabindex="-1"></a>        <span class="at">breaks =</span> base<span class="sc">::</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">50</span>, <span class="at">by =</span> <span class="dv">10</span>),</span>
<span id="cb102-1172"><a href="#cb102-1172" aria-hidden="true" tabindex="-1"></a>        <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_percent</span>(<span class="at">scale =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb102-1173"><a href="#cb102-1173" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Did you ever use marijuana or hashish?&quot;</span>,</span>
<span id="cb102-1174"><a href="#cb102-1174" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Percent of responses&quot;</span>) </span>
<span id="cb102-1175"><a href="#cb102-1175" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb102-1176"><a href="#cb102-1176" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-1177"><a href="#cb102-1177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1178"><a href="#cb102-1178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1179"><a href="#cb102-1179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1180"><a href="#cb102-1180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1181"><a href="#cb102-1181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1182"><a href="#cb102-1182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1183"><a href="#cb102-1183" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-1184"><a href="#cb102-1184" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-1185"><a href="#cb102-1185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1186"><a href="#cb102-1186" aria-hidden="true" tabindex="-1"></a>The bars are very thick. I tried with <span class="in">`ggplot2::geom_bar(width = 0.5)`</span> to make them thinner. But I failed. (See @lst-chap01-grass-bar-chart-width)</span>
<span id="cb102-1187"><a href="#cb102-1187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1188"><a href="#cb102-1188" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Thin bars</span></span>
<span id="cb102-1189"><a href="#cb102-1189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1190"><a href="#cb102-1190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1191"><a href="#cb102-1191" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb102-1192"><a href="#cb102-1192" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb102-1193"><a href="#cb102-1193" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-chap01-grass-bar-chart-thin-bars}</span>
<span id="cb102-1194"><a href="#cb102-1194" aria-hidden="true" tabindex="-1"></a>: Percentage of NHANES participants answering yes and no to marijuana use</span>
<span id="cb102-1195"><a href="#cb102-1195" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb102-1196"><a href="#cb102-1196" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1197"><a href="#cb102-1197" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb102-1198"><a href="#cb102-1198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1199"><a href="#cb102-1199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1200"><a href="#cb102-1200" aria-hidden="true" tabindex="-1"></a>::: {#lst-chap01-grass-bar-chart-width}</span>
<span id="cb102-1201"><a href="#cb102-1201" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-1202"><a href="#cb102-1202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1203"><a href="#cb102-1203" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-1204"><a href="#cb102-1204" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-grass-bar-chart-thin-bars</span></span>
<span id="cb102-1205"><a href="#cb102-1205" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;Proportion of marijuana use of the participant in the NHANES 2013 survey&quot;</span></span>
<span id="cb102-1206"><a href="#cb102-1206" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 4</span></span>
<span id="cb102-1207"><a href="#cb102-1207" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb102-1208"><a href="#cb102-1208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1209"><a href="#cb102-1209" aria-hidden="true" tabindex="-1"></a>chap01_nhanes_2013_clean <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;data-clean/chap01_nhanes_2013_clean.rds&quot;</span>)</span>
<span id="cb102-1210"><a href="#cb102-1210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1211"><a href="#cb102-1211" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(chap01_nhanes_2013_clean,</span>
<span id="cb102-1212"><a href="#cb102-1212" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">aes</span>(grass, </span>
<span id="cb102-1213"><a href="#cb102-1213" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="dv">100</span> <span class="sc">*</span> ggplot2<span class="sc">::</span><span class="fu">after_stat</span>(count) <span class="sc">/</span></span>
<span id="cb102-1214"><a href="#cb102-1214" aria-hidden="true" tabindex="-1"></a>             base<span class="sc">::</span><span class="fu">sum</span>(ggplot2<span class="sc">::</span><span class="fu">after_stat</span>(count)),</span>
<span id="cb102-1215"><a href="#cb102-1215" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> grass</span>
<span id="cb102-1216"><a href="#cb102-1216" aria-hidden="true" tabindex="-1"></a>        )) <span class="sc">+</span></span>
<span id="cb102-1217"><a href="#cb102-1217" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb102-1218"><a href="#cb102-1218" aria-hidden="true" tabindex="-1"></a>    <span class="do">## provide thinner bars, standard = 0.9</span></span>
<span id="cb102-1219"><a href="#cb102-1219" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb102-1220"><a href="#cb102-1220" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb102-1221"><a href="#cb102-1221" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb102-1222"><a href="#cb102-1222" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>, <span class="st">&#39;darkred&#39;</span>),</span>
<span id="cb102-1223"><a href="#cb102-1223" aria-hidden="true" tabindex="-1"></a>                    <span class="at">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb102-1224"><a href="#cb102-1224" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">scale_y_continuous</span>(</span>
<span id="cb102-1225"><a href="#cb102-1225" aria-hidden="true" tabindex="-1"></a>        <span class="at">breaks =</span> base<span class="sc">::</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">50</span>, <span class="at">by =</span> <span class="dv">10</span>),</span>
<span id="cb102-1226"><a href="#cb102-1226" aria-hidden="true" tabindex="-1"></a>        <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_percent</span>(<span class="at">scale =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb102-1227"><a href="#cb102-1227" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Did you ever use marijuana or hashish?&quot;</span>,</span>
<span id="cb102-1228"><a href="#cb102-1228" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Percent of responses&quot;</span>) </span>
<span id="cb102-1229"><a href="#cb102-1229" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb102-1230"><a href="#cb102-1230" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-1231"><a href="#cb102-1231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1232"><a href="#cb102-1232" aria-hidden="true" tabindex="-1"></a>Reducing the thickness of the bars</span>
<span id="cb102-1233"><a href="#cb102-1233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1234"><a href="#cb102-1234" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1235"><a href="#cb102-1235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1236"><a href="#cb102-1236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1237"><a href="#cb102-1237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1238"><a href="#cb102-1238" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-1239"><a href="#cb102-1239" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-1240"><a href="#cb102-1240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1241"><a href="#cb102-1241" aria-hidden="true" tabindex="-1"></a>The bars are now thin but the space between didn&#39;t change. I tried several options with the position argument to <span class="co">[</span><span class="ot">adjust bar width *and* spacing</span><span class="co">](https://r-graphics.org/recipe-bar-graph-adjust-width)</span>:</span>
<span id="cb102-1242"><a href="#cb102-1242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1243"><a href="#cb102-1243" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Dodging preserves the vertical position of an geom while adjusting the horizontal position. position_dodge() requires the grouping variable to be be specified in the global or geom_* layer. Unlike position_dodge(), position_dodge2() works without a grouping variable in a layer. position_dodge2() works with bars and rectangles, but is particulary useful for arranging box plots, which can have variable widths.</span></span>
<span id="cb102-1244"><a href="#cb102-1244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1245"><a href="#cb102-1245" aria-hidden="true" tabindex="-1"></a>All my trials with <span class="in">`position_dodge()`</span> and <span class="in">`position_dodge2()`</span> failed. The only two strategies I could reduce the spacing was:</span>
<span id="cb102-1246"><a href="#cb102-1246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1247"><a href="#cb102-1247" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>reducing the width of the graphic (and adapting the title of the graphic to fit into the smaller space)</span>
<span id="cb102-1248"><a href="#cb102-1248" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>using ggplot2::theme(aspect.ratio = 3/1) as shown in @lst-fig-chap01-grass-bar-chart-solution.</span>
<span id="cb102-1249"><a href="#cb102-1249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1250"><a href="#cb102-1250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1251"><a href="#cb102-1251" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Solution</span></span>
<span id="cb102-1252"><a href="#cb102-1252" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb102-1253"><a href="#cb102-1253" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb102-1254"><a href="#cb102-1254" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-chap01-grass-bar-chart-solution}</span>
<span id="cb102-1255"><a href="#cb102-1255" aria-hidden="true" tabindex="-1"></a>: Percentage of NHANES participants answering yes and no to marijuana use</span>
<span id="cb102-1256"><a href="#cb102-1256" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb102-1257"><a href="#cb102-1257" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1258"><a href="#cb102-1258" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb102-1259"><a href="#cb102-1259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1260"><a href="#cb102-1260" aria-hidden="true" tabindex="-1"></a>::: {#lst-fig-chap01-grass-bar-chart-solution}</span>
<span id="cb102-1261"><a href="#cb102-1261" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-1262"><a href="#cb102-1262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1263"><a href="#cb102-1263" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-1264"><a href="#cb102-1264" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-grass-bar-chart-solution</span></span>
<span id="cb102-1265"><a href="#cb102-1265" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;Proportion of marijuana use of the participant in the NHANES 2013 survey&quot;</span></span>
<span id="cb102-1266"><a href="#cb102-1266" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 4</span></span>
<span id="cb102-1267"><a href="#cb102-1267" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb102-1268"><a href="#cb102-1268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1269"><a href="#cb102-1269" aria-hidden="true" tabindex="-1"></a>chap01_nhanes_2013_clean <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;data-clean/chap01_nhanes_2013_clean.rds&quot;</span>)</span>
<span id="cb102-1270"><a href="#cb102-1270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1271"><a href="#cb102-1271" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(chap01_nhanes_2013_clean,</span>
<span id="cb102-1272"><a href="#cb102-1272" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">aes</span>(grass, </span>
<span id="cb102-1273"><a href="#cb102-1273" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="dv">100</span> <span class="sc">*</span> ggplot2<span class="sc">::</span><span class="fu">after_stat</span>(count) <span class="sc">/</span></span>
<span id="cb102-1274"><a href="#cb102-1274" aria-hidden="true" tabindex="-1"></a>             base<span class="sc">::</span><span class="fu">sum</span>(ggplot2<span class="sc">::</span><span class="fu">after_stat</span>(count)),</span>
<span id="cb102-1275"><a href="#cb102-1275" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> grass</span>
<span id="cb102-1276"><a href="#cb102-1276" aria-hidden="true" tabindex="-1"></a>        )) <span class="sc">+</span></span>
<span id="cb102-1277"><a href="#cb102-1277" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_bar</span>() <span class="sc">+</span> </span>
<span id="cb102-1278"><a href="#cb102-1278" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb102-1279"><a href="#cb102-1279" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>, <span class="st">&#39;darkred&#39;</span>),</span>
<span id="cb102-1280"><a href="#cb102-1280" aria-hidden="true" tabindex="-1"></a>                    <span class="at">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb102-1281"><a href="#cb102-1281" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">scale_y_continuous</span>(</span>
<span id="cb102-1282"><a href="#cb102-1282" aria-hidden="true" tabindex="-1"></a>        <span class="co"># n.breaks = 10, </span></span>
<span id="cb102-1283"><a href="#cb102-1283" aria-hidden="true" tabindex="-1"></a>        <span class="at">breaks =</span> base<span class="sc">::</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">50</span>, <span class="at">by =</span> <span class="dv">5</span>),</span>
<span id="cb102-1284"><a href="#cb102-1284" aria-hidden="true" tabindex="-1"></a>        <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_percent</span>(<span class="at">scale =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb102-1285"><a href="#cb102-1285" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Did you ever use marijuana or hashish?&quot;</span>,</span>
<span id="cb102-1286"><a href="#cb102-1286" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Percent of responses&quot;</span>) <span class="sc">+</span></span>
<span id="cb102-1287"><a href="#cb102-1287" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">1</span>)</span>
<span id="cb102-1288"><a href="#cb102-1288" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb102-1289"><a href="#cb102-1289" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-1290"><a href="#cb102-1290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1291"><a href="#cb102-1291" aria-hidden="true" tabindex="-1"></a>My solution for creating a bar chart showing the percentage of NHANES participants answering yes and no to marijuana use</span>
<span id="cb102-1292"><a href="#cb102-1292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1293"><a href="#cb102-1293" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1294"><a href="#cb102-1294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1295"><a href="#cb102-1295" aria-hidden="true" tabindex="-1"></a>:::::{.my-note}</span>
<span id="cb102-1296"><a href="#cb102-1296" aria-hidden="true" tabindex="-1"></a>:::{.my-note-header}</span>
<span id="cb102-1297"><a href="#cb102-1297" aria-hidden="true" tabindex="-1"></a>What I learned from creating the bar chart</span>
<span id="cb102-1298"><a href="#cb102-1298" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1299"><a href="#cb102-1299" aria-hidden="true" tabindex="-1"></a>::::{.my-note-container}</span>
<span id="cb102-1300"><a href="#cb102-1300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1301"><a href="#cb102-1301" aria-hidden="true" tabindex="-1"></a>Even with this simple example of a bar chart I learned some new options:</span>
<span id="cb102-1302"><a href="#cb102-1302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1303"><a href="#cb102-1303" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Use <span class="in">`ggplot2::after_stat()`</span> inside the aesthetics of the first layer to convert frequencies to percentages.</span>
<span id="cb102-1304"><a href="#cb102-1304" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Adding breaks with <span class="in">`n.breaks = &lt;number&gt;`</span> or <span class="in">`breaks = base::seq(from, to, by = &lt;number&gt;)`</span> inside the appropriate scale.</span>
<span id="cb102-1305"><a href="#cb102-1305" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Use the {**scales**} package to add the <span class="in">`%`</span>-sign after the values. As I have already calculated the percentages I need to reduce the default value of <span class="in">`scale = 100`</span> to <span class="in">`scale = 1`</span>.</span>
<span id="cb102-1306"><a href="#cb102-1306" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Use <span class="in">`ggplot2::theme(aspect.ratio = &lt;number&gt;/1)`</span> creating thinner bars *and* reducing the spacing between the bars accordingly. In my case I changed the aspect ratio to <span class="in">`3/1`</span>. A bigger front number compresses the graph, a smaller front number extends it. Aspect ratio of <span class="in">`1/1`</span> is the standard (= no change).</span>
<span id="cb102-1307"><a href="#cb102-1307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1308"><a href="#cb102-1308" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-1309"><a href="#cb102-1309" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-1310"><a href="#cb102-1310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1311"><a href="#cb102-1311" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-1312"><a href="#cb102-1312" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-1313"><a href="#cb102-1313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1314"><a href="#cb102-1314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1315"><a href="#cb102-1315" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1316"><a href="#cb102-1316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1317"><a href="#cb102-1317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1318"><a href="#cb102-1318" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-1319"><a href="#cb102-1319" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-1320"><a href="#cb102-1320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1321"><a href="#cb102-1321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1322"><a href="#cb102-1322" aria-hidden="true" tabindex="-1"></a><span class="fu">### Marijuana use per age and sex {#sec-chap01-grass-age-sex}</span></span>
<span id="cb102-1323"><a href="#cb102-1323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1324"><a href="#cb102-1324" aria-hidden="true" tabindex="-1"></a>:::::{.my-exercise}</span>
<span id="cb102-1325"><a href="#cb102-1325" aria-hidden="true" tabindex="-1"></a>:::{.my-exercise-header}</span>
<span id="cb102-1326"><a href="#cb102-1326" aria-hidden="true" tabindex="-1"></a>:::::: {#exr-chap01-bar-chart-grass-age-group}</span>
<span id="cb102-1327"><a href="#cb102-1327" aria-hidden="true" tabindex="-1"></a>: Exploring the percentage of NHANES participants answering yes or no to marijuana use by age category and sex</span>
<span id="cb102-1328"><a href="#cb102-1328" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb102-1329"><a href="#cb102-1329" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1330"><a href="#cb102-1330" aria-hidden="true" tabindex="-1"></a>::::{.my-exercise-container}</span>
<span id="cb102-1331"><a href="#cb102-1331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1332"><a href="#cb102-1332" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb102-1333"><a href="#cb102-1333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1334"><a href="#cb102-1334" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Summary Table</span></span>
<span id="cb102-1335"><a href="#cb102-1335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1336"><a href="#cb102-1336" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb102-1337"><a href="#cb102-1337" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb102-1338"><a href="#cb102-1338" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-chap01-compute-grass-age-group-percentage}</span>
<span id="cb102-1339"><a href="#cb102-1339" aria-hidden="true" tabindex="-1"></a>: Show frequencies and percentages of NHANES participants answering yes and no to &quot;Ever used marijuana or hashish&quot;</span>
<span id="cb102-1340"><a href="#cb102-1340" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb102-1341"><a href="#cb102-1341" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1342"><a href="#cb102-1342" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb102-1343"><a href="#cb102-1343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1344"><a href="#cb102-1344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1345"><a href="#cb102-1345" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-1346"><a href="#cb102-1346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1347"><a href="#cb102-1347" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-1348"><a href="#cb102-1348" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: compute-grass-age-group-percentage</span></span>
<span id="cb102-1349"><a href="#cb102-1349" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb102-1350"><a href="#cb102-1350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1351"><a href="#cb102-1351" aria-hidden="true" tabindex="-1"></a>chap01_nhanes_2013_clean <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;data-clean/chap01_nhanes_2013_clean.rds&quot;</span>)</span>
<span id="cb102-1352"><a href="#cb102-1352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1353"><a href="#cb102-1353" aria-hidden="true" tabindex="-1"></a>chap01_nhanes_2013_grouped <span class="ot">&lt;-</span> chap01_nhanes_2013_clean <span class="sc">|&gt;</span> </span>
<span id="cb102-1354"><a href="#cb102-1354" aria-hidden="true" tabindex="-1"></a>    <span class="do">## cut age into several defined age groups</span></span>
<span id="cb102-1355"><a href="#cb102-1355" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">age_cat =</span> base<span class="sc">::</span><span class="fu">cut</span>(age,</span>
<span id="cb102-1356"><a href="#cb102-1356" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="dv">29</span>, <span class="dv">39</span>, <span class="dv">49</span>, <span class="dv">59</span>),</span>
<span id="cb102-1357"><a href="#cb102-1357" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;18 - 29&quot;</span>, <span class="st">&quot;30 - 39&quot;</span>, <span class="st">&quot;40 - 49&quot;</span>, <span class="st">&quot;50 - 59&quot;</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb102-1358"><a href="#cb102-1358" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(grass, sex, age_cat)</span>
<span id="cb102-1359"><a href="#cb102-1359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1360"><a href="#cb102-1360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1361"><a href="#cb102-1361" aria-hidden="true" tabindex="-1"></a><span class="do">## older trial, without the knowledge of {gtsummary}</span></span>
<span id="cb102-1362"><a href="#cb102-1362" aria-hidden="true" tabindex="-1"></a><span class="co"># tibble::enframe(table(chap01_nhanes_2013_grouped$age_cat)) |&gt;  </span></span>
<span id="cb102-1363"><a href="#cb102-1363" aria-hidden="true" tabindex="-1"></a><span class="co">#     dplyr::rename(`Ever used grass or hash` = 1, Freq = 2) |&gt; </span></span>
<span id="cb102-1364"><a href="#cb102-1364" aria-hidden="true" tabindex="-1"></a><span class="co">#     dplyr::mutate(Perc = round(100 * Freq / sum(Freq), 2))</span></span>
<span id="cb102-1365"><a href="#cb102-1365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1366"><a href="#cb102-1366" aria-hidden="true" tabindex="-1"></a>chap01_nhanes_2013_grouped <span class="sc">|&gt;</span> </span>
<span id="cb102-1367"><a href="#cb102-1367" aria-hidden="true" tabindex="-1"></a>    labelled<span class="sc">::</span><span class="fu">set_variable_labels</span>(</span>
<span id="cb102-1368"><a href="#cb102-1368" aria-hidden="true" tabindex="-1"></a>        <span class="at">grass =</span> <span class="st">&quot;Ever used grass or hash?&quot;</span></span>
<span id="cb102-1369"><a href="#cb102-1369" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb102-1370"><a href="#cb102-1370" aria-hidden="true" tabindex="-1"></a>    gtsummary<span class="sc">::</span><span class="fu">tbl_summary</span>(</span>
<span id="cb102-1371"><a href="#cb102-1371" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="fu">list</span>(</span>
<span id="cb102-1372"><a href="#cb102-1372" aria-hidden="true" tabindex="-1"></a>            <span class="at">age_cat =</span> <span class="st">&quot;Age Category&quot;</span>,</span>
<span id="cb102-1373"><a href="#cb102-1373" aria-hidden="true" tabindex="-1"></a>            <span class="at">sex =</span> <span class="st">&quot;Sex&quot;</span></span>
<span id="cb102-1374"><a href="#cb102-1374" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb102-1375"><a href="#cb102-1375" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> grass <span class="sc">~</span> <span class="st">&quot;categorical&quot;</span></span>
<span id="cb102-1376"><a href="#cb102-1376" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb102-1377"><a href="#cb102-1377" aria-hidden="true" tabindex="-1"></a>    gtsummary<span class="sc">::</span><span class="fu">bold_labels</span>()</span>
<span id="cb102-1378"><a href="#cb102-1378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1379"><a href="#cb102-1379" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(chap01_nhanes_2013_grouped, <span class="st">&quot;data-clean/chap01_nhanes_2013_grouped.rds&quot;</span>)</span>
<span id="cb102-1380"><a href="#cb102-1380" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-1381"><a href="#cb102-1381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1382"><a href="#cb102-1382" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-1383"><a href="#cb102-1383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1384"><a href="#cb102-1384" aria-hidden="true" tabindex="-1"></a>Instead of using <span class="in">`1`</span> and <span class="in">`2`</span> I could have used the position of the column numbers <span class="in">`name`</span> and <span class="in">`value`</span> (all names without the <span class="sc">\`</span>-sign.)</span>
<span id="cb102-1385"><a href="#cb102-1385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1386"><a href="#cb102-1386" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-1387"><a href="#cb102-1387" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-1388"><a href="#cb102-1388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1389"><a href="#cb102-1389" aria-hidden="true" tabindex="-1"></a>This is a manual calculation using the {**tidyverse**} approach: I am sure there are some packages that may facilitate this computation (e.g., {**Janitor**} or {**DescTools**}), but I had difficulties to apply the appropriate functions.</span>
<span id="cb102-1390"><a href="#cb102-1390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1391"><a href="#cb102-1391" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Age 1</span></span>
<span id="cb102-1392"><a href="#cb102-1392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1393"><a href="#cb102-1393" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb102-1394"><a href="#cb102-1394" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb102-1395"><a href="#cb102-1395" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-chap01-grass-age-group1}</span>
<span id="cb102-1396"><a href="#cb102-1396" aria-hidden="true" tabindex="-1"></a>: Table: Percentage of NHANES participants by age group answering yes and no to marijuana use in percent of total responses</span>
<span id="cb102-1397"><a href="#cb102-1397" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb102-1398"><a href="#cb102-1398" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1399"><a href="#cb102-1399" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb102-1400"><a href="#cb102-1400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1401"><a href="#cb102-1401" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-1402"><a href="#cb102-1402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1403"><a href="#cb102-1403" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-1404"><a href="#cb102-1404" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-grass-age-group1</span></span>
<span id="cb102-1405"><a href="#cb102-1405" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: &quot;Proportion of marijuana use of the participant by age group in percent of total responses in the NHANES 2013 survey&quot;</span></span>
<span id="cb102-1406"><a href="#cb102-1406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1407"><a href="#cb102-1407" aria-hidden="true" tabindex="-1"></a>chap01_nhanes_2013_grouped <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;data-clean/chap01_nhanes_2013_grouped.rds&quot;</span>)</span>
<span id="cb102-1408"><a href="#cb102-1408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1409"><a href="#cb102-1409" aria-hidden="true" tabindex="-1"></a>chap01_nhanes_2013_grouped <span class="sc">|&gt;</span> </span>
<span id="cb102-1410"><a href="#cb102-1410" aria-hidden="true" tabindex="-1"></a>    labelled<span class="sc">::</span><span class="fu">set_variable_labels</span>(</span>
<span id="cb102-1411"><a href="#cb102-1411" aria-hidden="true" tabindex="-1"></a>        <span class="at">grass =</span> <span class="st">&quot;**Ever used grass or hash?**&quot;</span></span>
<span id="cb102-1412"><a href="#cb102-1412" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb102-1413"><a href="#cb102-1413" aria-hidden="true" tabindex="-1"></a>    gtsummary<span class="sc">::</span><span class="fu">tbl_cross</span>(</span>
<span id="cb102-1414"><a href="#cb102-1414" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="fu">list</span>(</span>
<span id="cb102-1415"><a href="#cb102-1415" aria-hidden="true" tabindex="-1"></a>            <span class="at">age_cat =</span> <span class="st">&quot;Age Category&quot;</span>,</span>
<span id="cb102-1416"><a href="#cb102-1416" aria-hidden="true" tabindex="-1"></a>            <span class="at">sex =</span> <span class="st">&quot;Sex&quot;</span></span>
<span id="cb102-1417"><a href="#cb102-1417" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb102-1418"><a href="#cb102-1418" aria-hidden="true" tabindex="-1"></a>        <span class="at">row =</span> age_cat,</span>
<span id="cb102-1419"><a href="#cb102-1419" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> grass,</span>
<span id="cb102-1420"><a href="#cb102-1420" aria-hidden="true" tabindex="-1"></a>        <span class="at">percent =</span> <span class="st">&quot;cell&quot;</span></span>
<span id="cb102-1421"><a href="#cb102-1421" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb102-1422"><a href="#cb102-1422" aria-hidden="true" tabindex="-1"></a>    gtsummary<span class="sc">::</span><span class="fu">modify_header</span>(</span>
<span id="cb102-1423"><a href="#cb102-1423" aria-hidden="true" tabindex="-1"></a>      <span class="at">stat_1 =</span> <span class="st">&#39;**Yes**&#39;</span>,</span>
<span id="cb102-1424"><a href="#cb102-1424" aria-hidden="true" tabindex="-1"></a>      <span class="at">stat_2 =</span> <span class="st">&#39;**No**&#39;</span>,</span>
<span id="cb102-1425"><a href="#cb102-1425" aria-hidden="true" tabindex="-1"></a>      <span class="at">stat_0 =</span> <span class="st">&#39;**Total**&#39;</span></span>
<span id="cb102-1426"><a href="#cb102-1426" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb102-1427"><a href="#cb102-1427" aria-hidden="true" tabindex="-1"></a>    gtsummary<span class="sc">::</span><span class="fu">bold_labels</span>()</span>
<span id="cb102-1428"><a href="#cb102-1428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1429"><a href="#cb102-1429" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-1430"><a href="#cb102-1430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1431"><a href="#cb102-1431" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-1432"><a href="#cb102-1432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1433"><a href="#cb102-1433" aria-hidden="true" tabindex="-1"></a>I have required {**gtsummary**} to calculate the percentage with one decimal place. The reason was that the graphic did not match the table. For instance: Without decimal places the &quot;No&quot;-proportion of the age group 18-29 was with 13% equal to the &quot;Yes&quot;-proportion of the age group 30-39. But in the figure these two bars have a different height. The reason was a rounding error: Both values 13.3% and 12.6% were rounded to 13%. But in the figure one could see the difference of 0.7% in the length of the bars.</span>
<span id="cb102-1434"><a href="#cb102-1434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1435"><a href="#cb102-1435" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-1436"><a href="#cb102-1436" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-1437"><a href="#cb102-1437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1438"><a href="#cb102-1438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1439"><a href="#cb102-1439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1440"><a href="#cb102-1440" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb102-1441"><a href="#cb102-1441" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb102-1442"><a href="#cb102-1442" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-chap01-fig-grass-age-group1}</span>
<span id="cb102-1443"><a href="#cb102-1443" aria-hidden="true" tabindex="-1"></a>: Figure: Percentage of NHANES participants by age group answering yes and no to marijuana use in percent of total responses</span>
<span id="cb102-1444"><a href="#cb102-1444" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb102-1445"><a href="#cb102-1445" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1446"><a href="#cb102-1446" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb102-1447"><a href="#cb102-1447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1448"><a href="#cb102-1448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1449"><a href="#cb102-1449" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-1450"><a href="#cb102-1450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1451"><a href="#cb102-1451" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-1452"><a href="#cb102-1452" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-grass-age-group1</span></span>
<span id="cb102-1453"><a href="#cb102-1453" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;Percentage of NHANES participants by age group answering yes and no to marijuana use in percent of total responses&quot;</span></span>
<span id="cb102-1454"><a href="#cb102-1454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1455"><a href="#cb102-1455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1456"><a href="#cb102-1456" aria-hidden="true" tabindex="-1"></a><span class="do">## age groups bar chart 1 ########</span></span>
<span id="cb102-1457"><a href="#cb102-1457" aria-hidden="true" tabindex="-1"></a>chap01_nhanes_2013_grouped <span class="sc">|&gt;</span> </span>
<span id="cb102-1458"><a href="#cb102-1458" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(</span>
<span id="cb102-1459"><a href="#cb102-1459" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> age_cat, </span>
<span id="cb102-1460"><a href="#cb102-1460" aria-hidden="true" tabindex="-1"></a>        <span class="at">fill =</span> grass,</span>
<span id="cb102-1461"><a href="#cb102-1461" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="dv">100</span> <span class="sc">*</span> ggplot2<span class="sc">::</span><span class="fu">after_stat</span>(count) <span class="sc">/</span> </span>
<span id="cb102-1462"><a href="#cb102-1462" aria-hidden="true" tabindex="-1"></a>             base<span class="sc">::</span><span class="fu">sum</span>(ggplot2<span class="sc">::</span><span class="fu">after_stat</span>(count))</span>
<span id="cb102-1463"><a href="#cb102-1463" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb102-1464"><a href="#cb102-1464" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span> </span>
<span id="cb102-1465"><a href="#cb102-1465" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">&#39;dodge&#39;</span>) <span class="sc">+</span>    </span>
<span id="cb102-1466"><a href="#cb102-1466" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb102-1467"><a href="#cb102-1467" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;darkgreen&#39;</span>, <span class="st">&#39;darkred&#39;</span>),</span>
<span id="cb102-1468"><a href="#cb102-1468" aria-hidden="true" tabindex="-1"></a>                    <span class="at">name =</span> <span class="st">&quot;Ever used</span><span class="sc">\n</span><span class="st">grass or hash?&quot;</span>) <span class="sc">+</span></span>
<span id="cb102-1469"><a href="#cb102-1469" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Age group (in years)&quot;</span>,</span>
<span id="cb102-1470"><a href="#cb102-1470" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Percent of total responses&quot;</span>)</span>
<span id="cb102-1471"><a href="#cb102-1471" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-1472"><a href="#cb102-1472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1473"><a href="#cb102-1473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1474"><a href="#cb102-1474" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-1475"><a href="#cb102-1475" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-1476"><a href="#cb102-1476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1477"><a href="#cb102-1477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1478"><a href="#cb102-1478" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Age 2</span></span>
<span id="cb102-1479"><a href="#cb102-1479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1480"><a href="#cb102-1480" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb102-1481"><a href="#cb102-1481" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb102-1482"><a href="#cb102-1482" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-chap01-grass-age-group2}</span>
<span id="cb102-1483"><a href="#cb102-1483" aria-hidden="true" tabindex="-1"></a>: Table:: Percentage of NHANES 2013 survey participants by age group answering yes and no to marijuana use in percent of age group</span>
<span id="cb102-1484"><a href="#cb102-1484" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb102-1485"><a href="#cb102-1485" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1486"><a href="#cb102-1486" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb102-1487"><a href="#cb102-1487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1488"><a href="#cb102-1488" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-1489"><a href="#cb102-1489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1490"><a href="#cb102-1490" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-1491"><a href="#cb102-1491" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-grass-age-group2</span></span>
<span id="cb102-1492"><a href="#cb102-1492" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: &quot;Proportion of marijuana use of the participant by age group in the NHANES 2013 survey&quot;</span></span>
<span id="cb102-1493"><a href="#cb102-1493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1494"><a href="#cb102-1494" aria-hidden="true" tabindex="-1"></a>chap01_nhanes_2013_grouped <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;data-clean/chap01_nhanes_2013_grouped.rds&quot;</span>)</span>
<span id="cb102-1495"><a href="#cb102-1495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1496"><a href="#cb102-1496" aria-hidden="true" tabindex="-1"></a>chap01_nhanes_2013_grouped <span class="sc">|&gt;</span> </span>
<span id="cb102-1497"><a href="#cb102-1497" aria-hidden="true" tabindex="-1"></a>    labelled<span class="sc">::</span><span class="fu">set_variable_labels</span>(</span>
<span id="cb102-1498"><a href="#cb102-1498" aria-hidden="true" tabindex="-1"></a>            <span class="at">grass =</span> <span class="st">&quot;**Ever used grass or hash?**&quot;</span></span>
<span id="cb102-1499"><a href="#cb102-1499" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">|&gt;</span> </span>
<span id="cb102-1500"><a href="#cb102-1500" aria-hidden="true" tabindex="-1"></a>    gtsummary<span class="sc">::</span><span class="fu">tbl_cross</span>(</span>
<span id="cb102-1501"><a href="#cb102-1501" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="fu">list</span>(</span>
<span id="cb102-1502"><a href="#cb102-1502" aria-hidden="true" tabindex="-1"></a>            <span class="at">age_cat =</span> <span class="st">&quot;Age Category&quot;</span>,</span>
<span id="cb102-1503"><a href="#cb102-1503" aria-hidden="true" tabindex="-1"></a>            <span class="at">sex =</span> <span class="st">&quot;Sex&quot;</span></span>
<span id="cb102-1504"><a href="#cb102-1504" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb102-1505"><a href="#cb102-1505" aria-hidden="true" tabindex="-1"></a>        <span class="at">row =</span> age_cat,</span>
<span id="cb102-1506"><a href="#cb102-1506" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> grass,</span>
<span id="cb102-1507"><a href="#cb102-1507" aria-hidden="true" tabindex="-1"></a>        <span class="at">percent =</span> <span class="st">&quot;row&quot;</span>,</span>
<span id="cb102-1508"><a href="#cb102-1508" aria-hidden="true" tabindex="-1"></a>        <span class="at">margin =</span> <span class="st">&quot;column&quot;</span>,</span>
<span id="cb102-1509"><a href="#cb102-1509" aria-hidden="true" tabindex="-1"></a>        <span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb102-1510"><a href="#cb102-1510" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb102-1511"><a href="#cb102-1511" aria-hidden="true" tabindex="-1"></a>    gtsummary<span class="sc">::</span><span class="fu">modify_header</span>(</span>
<span id="cb102-1512"><a href="#cb102-1512" aria-hidden="true" tabindex="-1"></a>      <span class="at">stat_1 =</span> <span class="st">&#39;**Yes**&#39;</span>,</span>
<span id="cb102-1513"><a href="#cb102-1513" aria-hidden="true" tabindex="-1"></a>      <span class="at">stat_2 =</span> <span class="st">&#39;**No**&#39;</span>,</span>
<span id="cb102-1514"><a href="#cb102-1514" aria-hidden="true" tabindex="-1"></a>      <span class="at">stat_0 =</span> <span class="st">&#39;**Total**&#39;</span></span>
<span id="cb102-1515"><a href="#cb102-1515" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb102-1516"><a href="#cb102-1516" aria-hidden="true" tabindex="-1"></a>    gtsummary<span class="sc">::</span><span class="fu">bold_labels</span>()</span>
<span id="cb102-1517"><a href="#cb102-1517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1518"><a href="#cb102-1518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1519"><a href="#cb102-1519" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-1520"><a href="#cb102-1520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1521"><a href="#cb102-1521" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-1522"><a href="#cb102-1522" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-1523"><a href="#cb102-1523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1524"><a href="#cb102-1524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1525"><a href="#cb102-1525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1526"><a href="#cb102-1526" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb102-1527"><a href="#cb102-1527" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb102-1528"><a href="#cb102-1528" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-fig-grass-age-group2}</span>
<span id="cb102-1529"><a href="#cb102-1529" aria-hidden="true" tabindex="-1"></a>: Figure: Percentage of NHANES participants of the 2013 survey answering yes and no to marijuana use in percent of age group</span>
<span id="cb102-1530"><a href="#cb102-1530" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb102-1531"><a href="#cb102-1531" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1532"><a href="#cb102-1532" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb102-1533"><a href="#cb102-1533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1534"><a href="#cb102-1534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1535"><a href="#cb102-1535" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-1536"><a href="#cb102-1536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1537"><a href="#cb102-1537" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-1538"><a href="#cb102-1538" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-grass-age-group2</span></span>
<span id="cb102-1539"><a href="#cb102-1539" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;Percentage of NHANES participants of the 2013 survey answering yes and no to marijuana use in percent of age group&quot;</span></span>
<span id="cb102-1540"><a href="#cb102-1540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1541"><a href="#cb102-1541" aria-hidden="true" tabindex="-1"></a><span class="do">## age groups bar chart 2 ########</span></span>
<span id="cb102-1542"><a href="#cb102-1542" aria-hidden="true" tabindex="-1"></a>chap01_nhanes_2013_grouped <span class="sc">|&gt;</span> </span>
<span id="cb102-1543"><a href="#cb102-1543" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(grass, age_cat) <span class="sc">|&gt;</span></span>
<span id="cb102-1544"><a href="#cb102-1544" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">count</span>() <span class="sc">|&gt;</span> </span>
<span id="cb102-1545"><a href="#cb102-1545" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(age_cat) <span class="sc">|&gt;</span> </span>
<span id="cb102-1546"><a href="#cb102-1546" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">perc_grass =</span> <span class="dv">100</span> <span class="sc">*</span> n <span class="sc">/</span> base<span class="sc">::</span><span class="fu">sum</span>(n)) <span class="sc">|&gt;</span> </span>
<span id="cb102-1547"><a href="#cb102-1547" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> age_cat, <span class="at">fill =</span> grass,</span>
<span id="cb102-1548"><a href="#cb102-1548" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> perc_grass)) <span class="sc">+</span></span>
<span id="cb102-1549"><a href="#cb102-1549" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">&#39;dodge&#39;</span>) <span class="sc">+</span></span>
<span id="cb102-1550"><a href="#cb102-1550" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb102-1551"><a href="#cb102-1551" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;darkgreen&#39;</span>, <span class="st">&#39;darkred&#39;</span>),</span>
<span id="cb102-1552"><a href="#cb102-1552" aria-hidden="true" tabindex="-1"></a>                    <span class="at">name =</span> <span class="st">&quot;Ever used</span><span class="sc">\n</span><span class="st">grass or hash?&quot;</span>) <span class="sc">+</span></span>
<span id="cb102-1553"><a href="#cb102-1553" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Age group (in years)&quot;</span>,</span>
<span id="cb102-1554"><a href="#cb102-1554" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Percent of responses in age group&quot;</span>)</span>
<span id="cb102-1555"><a href="#cb102-1555" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-1556"><a href="#cb102-1556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1557"><a href="#cb102-1557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1558"><a href="#cb102-1558" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-1559"><a href="#cb102-1559" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-1560"><a href="#cb102-1560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1561"><a href="#cb102-1561" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Age &amp; Sex</span></span>
<span id="cb102-1562"><a href="#cb102-1562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1563"><a href="#cb102-1563" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb102-1564"><a href="#cb102-1564" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb102-1565"><a href="#cb102-1565" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-chap01-grass-age-sex}</span>
<span id="cb102-1566"><a href="#cb102-1566" aria-hidden="true" tabindex="-1"></a>: Percentage of NHANES participants 2013 survey by age group and sex answering yes and no to marijuana use</span>
<span id="cb102-1567"><a href="#cb102-1567" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb102-1568"><a href="#cb102-1568" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1569"><a href="#cb102-1569" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb102-1570"><a href="#cb102-1570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1571"><a href="#cb102-1571" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-1572"><a href="#cb102-1572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1573"><a href="#cb102-1573" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-1574"><a href="#cb102-1574" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-grass-age-sex</span></span>
<span id="cb102-1575"><a href="#cb102-1575" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;Proportion of marijuana use of the participant by age group and sex in the NHANES 2013 survey&quot;</span></span>
<span id="cb102-1576"><a href="#cb102-1576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1577"><a href="#cb102-1577" aria-hidden="true" tabindex="-1"></a>chap01_nhanes_2013_grouped <span class="ot">&lt;-</span> </span>
<span id="cb102-1578"><a href="#cb102-1578" aria-hidden="true" tabindex="-1"></a>    <span class="fu">readRDS</span>(<span class="st">&quot;data-clean/chap01_nhanes_2013_grouped.rds&quot;</span>)</span>
<span id="cb102-1579"><a href="#cb102-1579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1580"><a href="#cb102-1580" aria-hidden="true" tabindex="-1"></a><span class="do">## age and sex bar chart ########</span></span>
<span id="cb102-1581"><a href="#cb102-1581" aria-hidden="true" tabindex="-1"></a>chap01_nhanes_2013_grouped <span class="sc">|&gt;</span> </span>
<span id="cb102-1582"><a href="#cb102-1582" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(grass, age_cat, sex) <span class="sc">|&gt;</span> </span>
<span id="cb102-1583"><a href="#cb102-1583" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">count</span>() <span class="sc">|&gt;</span> </span>
<span id="cb102-1584"><a href="#cb102-1584" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(age_cat, sex) <span class="sc">|&gt;</span> </span>
<span id="cb102-1585"><a href="#cb102-1585" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">perc_grass_2 =</span> <span class="dv">100</span> <span class="sc">*</span> n <span class="sc">/</span> base<span class="sc">::</span><span class="fu">sum</span>(n)) <span class="sc">|&gt;</span> </span>
<span id="cb102-1586"><a href="#cb102-1586" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(</span>
<span id="cb102-1587"><a href="#cb102-1587" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> age_cat, </span>
<span id="cb102-1588"><a href="#cb102-1588" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> perc_grass_2,</span>
<span id="cb102-1589"><a href="#cb102-1589" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> sex)) <span class="sc">+</span></span>
<span id="cb102-1590"><a href="#cb102-1590" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">&#39;dodge&#39;</span>) <span class="sc">+</span></span>
<span id="cb102-1591"><a href="#cb102-1591" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb102-1592"><a href="#cb102-1592" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;#f98e31&#39;</span>, <span class="st">&#39;#730b6d&#39;</span>),</span>
<span id="cb102-1593"><a href="#cb102-1593" aria-hidden="true" tabindex="-1"></a>                             <span class="at">name =</span> <span class="st">&quot;sex&quot;</span>) <span class="sc">+</span></span>
<span id="cb102-1594"><a href="#cb102-1594" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb102-1595"><a href="#cb102-1595" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">&quot;Age group (in years)&quot;</span>,</span>
<span id="cb102-1596"><a href="#cb102-1596" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">&quot;Percent of males/females that used marijuana or hashish&quot;</span></span>
<span id="cb102-1597"><a href="#cb102-1597" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb102-1598"><a href="#cb102-1598" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-1599"><a href="#cb102-1599" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-1600"><a href="#cb102-1600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1601"><a href="#cb102-1601" aria-hidden="true" tabindex="-1"></a>With the exception of the oldest age group the graphic shows that the proportion of marijuana / hashish user increases with younger people. One possible explanation for the untypical high use in the oldest age group could be that people between 50-59 of the 2013 survey were born between 1954-1963 and were young adults during the time of the <span class="co">[</span><span class="ot">Flower Power</span><span class="co">](https://en.wikipedia.org/wiki/Flower_power)</span> generation part of the <span class="co">[</span><span class="ot">counterculture of the 1960s</span><span class="co">](Counterculture of the 1960s)</span>-1970s.</span>
<span id="cb102-1602"><a href="#cb102-1602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1603"><a href="#cb102-1603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1604"><a href="#cb102-1604" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-1605"><a href="#cb102-1605" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-1606"><a href="#cb102-1606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1607"><a href="#cb102-1607" aria-hidden="true" tabindex="-1"></a>@fig-grass-age-sex is a little difficult to interpret. Both bars colors shows the proportion of &quot;Yes&quot;-respondents in the appropriate age group. For instance: About 62% of males and about 51% of women of the age group 18-29 said &quot;Yes&quot;. </span>
<span id="cb102-1608"><a href="#cb102-1608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1609"><a href="#cb102-1609" aria-hidden="true" tabindex="-1"></a>Therefore the bars to not sum up to 100%. The figures shows only the &quot;Yes&quot; part of the dichotomous <span class="in">`grass`</span> variable for men and women in a certain age group. The other &quot;No&quot; part is missing.</span>
<span id="cb102-1610"><a href="#cb102-1610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1611"><a href="#cb102-1611" aria-hidden="true" tabindex="-1"></a>To distinguish the sex colors in @fig-grass-age-sex from the Yes/No colors in @fig-grass-age-group1 and @fig-grass-age-group2 I chose at first some kind of blue for men and red for females. But I learned from <span class="co">[</span><span class="ot">An alternative to pink &amp; blue: Colors for gender data</span><span class="co">](https://blog.datawrapper.de/gendercolor/)</span> that one should avoid this stereotypical colors. </span>
<span id="cb102-1612"><a href="#cb102-1612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1613"><a href="#cb102-1613" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; In our western culture, these colors come with the whole gender stereotype baggage. Pink means weak, shy girls who play with dolls and don’t deserve as much as boys. Blue stands for boys who need to be strong &amp; rough. **When we create a chart with pink &amp; blue, we endorse gender stereotypes**.</span></span>
<span id="cb102-1614"><a href="#cb102-1614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1615"><a href="#cb102-1615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1616"><a href="#cb102-1616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1617"><a href="#cb102-1617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1618"><a href="#cb102-1618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1619"><a href="#cb102-1619" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1620"><a href="#cb102-1620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1621"><a href="#cb102-1621" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-1622"><a href="#cb102-1622" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-1623"><a href="#cb102-1623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1624"><a href="#cb102-1624" aria-hidden="true" tabindex="-1"></a><span class="fu">### Data interpretation {#sec-chap01-data-interpretation}</span></span>
<span id="cb102-1625"><a href="#cb102-1625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1626"><a href="#cb102-1626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1627"><a href="#cb102-1627" aria-hidden="true" tabindex="-1"></a>::: {#rep-chap01-gss-nhanes .callout-tip}</span>
<span id="cb102-1628"><a href="#cb102-1628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1629"><a href="#cb102-1629" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Marijuana usage and opinions to legalize it (`r glossary(&quot;GSS&quot;)` and `r glossary(&quot;NHANES&quot;)` data)</span></span>
<span id="cb102-1630"><a href="#cb102-1630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1631"><a href="#cb102-1631" aria-hidden="true" tabindex="-1"></a>@fig-chap01-repr-fig-1-2 with <span class="in">`r glossary(&quot;GSS&quot;)`</span> data 2016 shows that younger people support the legalizing of marijuana. Therefore we can expect that in the future the proportion of people that approve legalizing will increase. With a small project on my own I have backed up this thesis. @fig-gss-grass-timeline demonstrates that the percentage of supporters has increased very strongly in the last years and has now hit the 70% mark. This trend is very clear even I have not distinguished in the longitudinal study between different age groups.</span>
<span id="cb102-1632"><a href="#cb102-1632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1633"><a href="#cb102-1633" aria-hidden="true" tabindex="-1"></a>The graphs of the <span class="in">`r glossary(&quot;NHANES&quot;)`</span> 2013 data in @fig-grass-age-group1 and fig-grass-age-group2 show that the highest proportion of people ever used marijuana or hashish lies in youngest age. The age trend is not very clear, because we have only figures for person equal or under 59 years. (Here would be necessary another small project with longitudinal analysis including newer data.)</span>
<span id="cb102-1634"><a href="#cb102-1634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1635"><a href="#cb102-1635" aria-hidden="true" tabindex="-1"></a>With the exception of the age group 40-49 the proportion of males ever used in their respective age group is higher than the percentage of women. (See @fig-grass-age-sex). But this is only a snapshot and difficult to interpret. Another possible thesis could be that there is a tiny upward trend from old top young in marijuana use. One possible explanation for the untypical higher use in the oldest age group could be that people between 50-59 of the 2013 survey were born between 1954-1963 and were young adults during the time of the <span class="co">[</span><span class="ot">Flower Power</span><span class="co">](https://en.wikipedia.org/wiki/Flower_power)</span> generation part of the <span class="co">[</span><span class="ot">counterculture of the 1960s</span><span class="co">](Counterculture of the 1960s)</span>-1970s.</span>
<span id="cb102-1636"><a href="#cb102-1636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1637"><a href="#cb102-1637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1638"><a href="#cb102-1638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1639"><a href="#cb102-1639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1640"><a href="#cb102-1640" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1641"><a href="#cb102-1641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1642"><a href="#cb102-1642" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-1643"><a href="#cb102-1643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1644"><a href="#cb102-1644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1645"><a href="#cb102-1645" aria-hidden="true" tabindex="-1"></a><span class="fu">## Get the GSS data {#sec-chap01-get-gss-data}</span></span>
<span id="cb102-1646"><a href="#cb102-1646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1647"><a href="#cb102-1647" aria-hidden="true" tabindex="-1"></a><span class="fu">### Working with the GSS</span></span>
<span id="cb102-1648"><a href="#cb102-1648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1649"><a href="#cb102-1649" aria-hidden="true" tabindex="-1"></a>I am very interested how to get <span class="in">`r glossary(&quot;GSS&quot;)`</span> data directly from</span>
<span id="cb102-1650"><a href="#cb102-1650" aria-hidden="true" tabindex="-1"></a>the GSS website, so that I could work on interesting research questions</span>
<span id="cb102-1651"><a href="#cb102-1651" aria-hidden="true" tabindex="-1"></a>myself.</span>
<span id="cb102-1652"><a href="#cb102-1652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1653"><a href="#cb102-1653" aria-hidden="true" tabindex="-1"></a>I have found several resources helping to work with the</span>
<span id="cb102-1654"><a href="#cb102-1654" aria-hidden="true" tabindex="-1"></a><span class="in">`r glossary(&quot;GSS&quot;)`</span>. The most important one is the {**gssr**} package (see: @pak-gssr)</span>
<span id="cb102-1655"><a href="#cb102-1655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1656"><a href="#cb102-1656" aria-hidden="true" tabindex="-1"></a>::: my-resource</span>
<span id="cb102-1657"><a href="#cb102-1657" aria-hidden="true" tabindex="-1"></a>::: my-resource-header</span>
<span id="cb102-1658"><a href="#cb102-1658" aria-hidden="true" tabindex="-1"></a>asdfree: Analyze Survey Data for Free</span>
<span id="cb102-1659"><a href="#cb102-1659" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1660"><a href="#cb102-1660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1661"><a href="#cb102-1661" aria-hidden="true" tabindex="-1"></a>::: my-resource-container</span>
<span id="cb102-1662"><a href="#cb102-1662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1663"><a href="#cb102-1663" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Analyze Survey Data for Free</span><span class="co">](http://asdfree.com/)</span> is a bookdown</span>
<span id="cb102-1664"><a href="#cb102-1664" aria-hidden="true" tabindex="-1"></a>website by [Anthony</span>
<span id="cb102-1665"><a href="#cb102-1665" aria-hidden="true" tabindex="-1"></a>Damico](https://www.youtube.com/@anthonyjosephdamico/playlists) with</span>
<span id="cb102-1666"><a href="#cb102-1666" aria-hidden="true" tabindex="-1"></a>currently 64 locations to grab free survey data. As expected it features</span>
<span id="cb102-1667"><a href="#cb102-1667" aria-hidden="true" tabindex="-1"></a>also a [description of the</span>
<span id="cb102-1668"><a href="#cb102-1668" aria-hidden="true" tabindex="-1"></a>GSS](http://asdfree.com/general-social-survey-gss.html) including</span>
<span id="cb102-1669"><a href="#cb102-1669" aria-hidden="true" tabindex="-1"></a>analysis examples with the {**survey**} package and --- especially</span>
<span id="cb102-1670"><a href="#cb102-1670" aria-hidden="true" tabindex="-1"></a>important for my purpose here --- {**lodown**}, a <span class="co">[</span><span class="ot">package on GitHub</span><span class="co">](https://github.com/ajdamico/lodown)</span> that is not maintained anymore.</span>
<span id="cb102-1671"><a href="#cb102-1671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1672"><a href="#cb102-1672" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1673"><a href="#cb102-1673" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1674"><a href="#cb102-1674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1675"><a href="#cb102-1675" aria-hidden="true" tabindex="-1"></a>@def-chap01-get-gss-data features five different strategies to download</span>
<span id="cb102-1676"><a href="#cb102-1676" aria-hidden="true" tabindex="-1"></a>GSS data:</span>
<span id="cb102-1677"><a href="#cb102-1677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1678"><a href="#cb102-1678" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Download extract by using the GSS Data Explorer --- Tab: &quot;Explorer&quot;</span>
<span id="cb102-1679"><a href="#cb102-1679" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Download files manually --- Tab: &quot;by hand&quot;</span>
<span id="cb102-1680"><a href="#cb102-1680" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Download files programmatically --- Tab: &quot;automated&quot;</span>
<span id="cb102-1681"><a href="#cb102-1681" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Download via the {**lodown**} package --- Tab: &quot;lodown&quot;</span>
<span id="cb102-1682"><a href="#cb102-1682" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>Download via the {**gssr**} package --- Tab: &quot;gssr&quot;</span>
<span id="cb102-1683"><a href="#cb102-1683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1684"><a href="#cb102-1684" aria-hidden="true" tabindex="-1"></a><span class="fu">### Five strategies to get GSS data</span></span>
<span id="cb102-1685"><a href="#cb102-1685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1686"><a href="#cb102-1686" aria-hidden="true" tabindex="-1"></a>::: my-experiment</span>
<span id="cb102-1687"><a href="#cb102-1687" aria-hidden="true" tabindex="-1"></a>::: my-experiment-header</span>
<span id="cb102-1688"><a href="#cb102-1688" aria-hidden="true" tabindex="-1"></a>::: {#def-chap01-get-gss-data}</span>
<span id="cb102-1689"><a href="#cb102-1689" aria-hidden="true" tabindex="-1"></a>: How to get the General Social Survey (GSS) data</span>
<span id="cb102-1690"><a href="#cb102-1690" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1691"><a href="#cb102-1691" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1692"><a href="#cb102-1692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1693"><a href="#cb102-1693" aria-hidden="true" tabindex="-1"></a>::: my-experiment-container</span>
<span id="cb102-1694"><a href="#cb102-1694" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb102-1695"><a href="#cb102-1695" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Explore</span></span>
<span id="cb102-1696"><a href="#cb102-1696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1697"><a href="#cb102-1697" aria-hidden="true" tabindex="-1"></a>To use all the facilities of the GSS Data Explorer (tagging, tabulating,</span>
<span id="cb102-1698"><a href="#cb102-1698" aria-hidden="true" tabindex="-1"></a>data extracting) you need to register for a free account. The good thing</span>
<span id="cb102-1699"><a href="#cb102-1699" aria-hidden="true" tabindex="-1"></a>is: This is a onetime procedure.</span>
<span id="cb102-1700"><a href="#cb102-1700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1701"><a href="#cb102-1701" aria-hidden="true" tabindex="-1"></a>::: my-procedure</span>
<span id="cb102-1702"><a href="#cb102-1702" aria-hidden="true" tabindex="-1"></a>::: my-procedure-header</span>
<span id="cb102-1703"><a href="#cb102-1703" aria-hidden="true" tabindex="-1"></a>::: {#prp-chap01-get-gss-data-explorer}</span>
<span id="cb102-1704"><a href="#cb102-1704" aria-hidden="true" tabindex="-1"></a>: Downloading data extracts with the GSS Data Explorer</span>
<span id="cb102-1705"><a href="#cb102-1705" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1706"><a href="#cb102-1706" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1707"><a href="#cb102-1707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1708"><a href="#cb102-1708" aria-hidden="true" tabindex="-1"></a>::: my-procedure-container</span>
<span id="cb102-1709"><a href="#cb102-1709" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Create a free account for the [GSS Data</span>
<span id="cb102-1710"><a href="#cb102-1710" aria-hidden="true" tabindex="-1"></a>    Explorer](https://gssdataexplorer.norc.org/), a tool that allows to</span>
<span id="cb102-1711"><a href="#cb102-1711" aria-hidden="true" tabindex="-1"></a>    browse the data that have been collected in the surveys.</span>
<span id="cb102-1712"><a href="#cb102-1712" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Fill out the form</span>
<span id="cb102-1713"><a href="#cb102-1713" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Wait for an email with the verification code</span>
<span id="cb102-1714"><a href="#cb102-1714" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Confirm the registration with the verification code</span>
<span id="cb102-1715"><a href="#cb102-1715" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Go for the tour to learn the interface (Link &quot;Tour Guide&quot;)</span>
<span id="cb102-1716"><a href="#cb102-1716" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Now you are ready to follow the advises in the slides. If you prefer</span>
<span id="cb102-1717"><a href="#cb102-1717" aria-hidden="true" tabindex="-1"></a>    you can view the slide show in a [standalone</span>
<span id="cb102-1718"><a href="#cb102-1718" aria-hidden="true" tabindex="-1"></a>    browser](https://petzi53.quarto.pub/gss-data-explorer/#/title-slide).</span>
<span id="cb102-1719"><a href="#cb102-1719" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1720"><a href="#cb102-1720" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1721"><a href="#cb102-1721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1722"><a href="#cb102-1722" aria-hidden="true" tabindex="-1"></a>&lt;iframe width=&quot;650&quot; height=&quot;400&quot; class=&quot;slide-deck&quot; src=&quot;https://petzi53.quarto.pub/gss-data-explorer/#/title-slide&quot;&gt;</span>
<span id="cb102-1723"><a href="#cb102-1723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1724"><a href="#cb102-1724" aria-hidden="true" tabindex="-1"></a>&lt;/iframe&gt;</span>
<span id="cb102-1725"><a href="#cb102-1725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1726"><a href="#cb102-1726" aria-hidden="true" tabindex="-1"></a>As one can see this is a somewhat cumbersome procedure to download the</span>
<span id="cb102-1727"><a href="#cb102-1727" aria-hidden="true" tabindex="-1"></a>desired data. Following the proposed strategies in the other tabs are</span>
<span id="cb102-1728"><a href="#cb102-1728" aria-hidden="true" tabindex="-1"></a>much easier for importing GSS data. But using the GSS Data Explorer is</span>
<span id="cb102-1729"><a href="#cb102-1729" aria-hidden="true" tabindex="-1"></a>very helpful to *explore* the dataset. Apply the first three steps of</span>
<span id="cb102-1730"><a href="#cb102-1730" aria-hidden="true" tabindex="-1"></a>the above list to find the correct variable names, to read the exact</span>
<span id="cb102-1731"><a href="#cb102-1731" aria-hidden="true" tabindex="-1"></a>wording of the question asked and to inspect the different codes that</span>
<span id="cb102-1732"><a href="#cb102-1732" aria-hidden="true" tabindex="-1"></a>are used for the variable. Otherwise you have to skim the more than 700</span>
<span id="cb102-1733"><a href="#cb102-1733" aria-hidden="true" tabindex="-1"></a>pages of the GSS codebook.😭</span>
<span id="cb102-1734"><a href="#cb102-1734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1735"><a href="#cb102-1735" aria-hidden="true" tabindex="-1"></a><span class="fu">###### by hand</span></span>
<span id="cb102-1736"><a href="#cb102-1736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1737"><a href="#cb102-1737" aria-hidden="true" tabindex="-1"></a>Another approach is to download the complete dataset (or all variables</span>
<span id="cb102-1738"><a href="#cb102-1738" aria-hidden="true" tabindex="-1"></a>of those years you are interested in) and manage the data in such a way</span>
<span id="cb102-1739"><a href="#cb102-1739" aria-hidden="true" tabindex="-1"></a>that it can be easily used for your research question. (See</span>
<span id="cb102-1740"><a href="#cb102-1740" aria-hidden="true" tabindex="-1"></a>@sec-chap01-data-wrangling)</span>
<span id="cb102-1741"><a href="#cb102-1741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1742"><a href="#cb102-1742" aria-hidden="true" tabindex="-1"></a>::: my-procedure</span>
<span id="cb102-1743"><a href="#cb102-1743" aria-hidden="true" tabindex="-1"></a>::: my-procedure-header</span>
<span id="cb102-1744"><a href="#cb102-1744" aria-hidden="true" tabindex="-1"></a>::: {#prp-chap01-get-gss-data-manually}</span>
<span id="cb102-1745"><a href="#cb102-1745" aria-hidden="true" tabindex="-1"></a>: Download GSS individual year data sets (cross-section only)</span>
<span id="cb102-1746"><a href="#cb102-1746" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1747"><a href="#cb102-1747" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1748"><a href="#cb102-1748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1749"><a href="#cb102-1749" aria-hidden="true" tabindex="-1"></a>::: my-procedure-container</span>
<span id="cb102-1750"><a href="#cb102-1750" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Visit <span class="ot">&lt;https://gss.norc.org/Get-The-Data&gt;</span> and choose under the</span>
<span id="cb102-1751"><a href="#cb102-1751" aria-hidden="true" tabindex="-1"></a>    section &quot;Download the Data&quot; the &quot;STATA&quot; format. I read elsewhere</span>
<span id="cb102-1752"><a href="#cb102-1752" aria-hidden="true" tabindex="-1"></a>    that this is the preferred format to convert the data into R with</span>
<span id="cb102-1753"><a href="#cb102-1753" aria-hidden="true" tabindex="-1"></a>    the {**haven**} package.</span>
<span id="cb102-1754"><a href="#cb102-1754" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>From the <span class="co">[</span><span class="ot">STATA-page</span><span class="co">](https://gss.norc.org/get-the-data/stata)</span></span>
<span id="cb102-1755"><a href="#cb102-1755" aria-hidden="true" tabindex="-1"></a>    choose the appropriate link (<span class="in">`2016`</span> in our case) under the section</span>
<span id="cb102-1756"><a href="#cb102-1756" aria-hidden="true" tabindex="-1"></a>    &quot;Individual Year Data Sets (cross-section only)&quot; and download the</span>
<span id="cb102-1757"><a href="#cb102-1757" aria-hidden="true" tabindex="-1"></a>    file <span class="in">`2016_stata.zip`</span> (994 MB) into your preferred folder on your</span>
<span id="cb102-1758"><a href="#cb102-1758" aria-hidden="true" tabindex="-1"></a>    hard disk. After you extract the .zip file you will get the STAT</span>
<span id="cb102-1759"><a href="#cb102-1759" aria-hidden="true" tabindex="-1"></a>    file <span class="in">`GSS2016.dta`</span> (4.4 MB).</span>
<span id="cb102-1760"><a href="#cb102-1760" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>You can now apply @cnj-chap01-import-stata-data.</span>
<span id="cb102-1761"><a href="#cb102-1761" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1762"><a href="#cb102-1762" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1763"><a href="#cb102-1763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1764"><a href="#cb102-1764" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb102-1765"><a href="#cb102-1765" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb102-1766"><a href="#cb102-1766" aria-hidden="true" tabindex="-1"></a>::: {#cnj-chap01-import-stata-data}</span>
<span id="cb102-1767"><a href="#cb102-1767" aria-hidden="true" tabindex="-1"></a>: Import STATA GSS 2016 file into R using (**haven**)</span>
<span id="cb102-1768"><a href="#cb102-1768" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1769"><a href="#cb102-1769" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1770"><a href="#cb102-1770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1771"><a href="#cb102-1771" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb102-1772"><a href="#cb102-1772" aria-hidden="true" tabindex="-1"></a>::: {#lst-chap01-import-stata-2016-file}</span>
<span id="cb102-1773"><a href="#cb102-1773" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-1774"><a href="#cb102-1774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1775"><a href="#cb102-1775" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-1776"><a href="#cb102-1776" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: import-stata-2016-file</span></span>
<span id="cb102-1777"><a href="#cb102-1777" aria-hidden="true" tabindex="-1"></a><span class="co">#| cache: true</span></span>
<span id="cb102-1778"><a href="#cb102-1778" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb102-1779"><a href="#cb102-1779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1780"><a href="#cb102-1780" aria-hidden="true" tabindex="-1"></a><span class="do">## run only once (manually) ###########</span></span>
<span id="cb102-1781"><a href="#cb102-1781" aria-hidden="true" tabindex="-1"></a>gss_2016_man <span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">read_dta</span>(<span class="st">&quot;data-raw/GSS2016.dta&quot;</span>)</span>
<span id="cb102-1782"><a href="#cb102-1782" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(gss_2016_man, <span class="at">file =</span> <span class="st">&quot;data-raw/gss_2016_man.rds&quot;</span> )</span>
<span id="cb102-1783"><a href="#cb102-1783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1784"><a href="#cb102-1784" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-1785"><a href="#cb102-1785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1786"><a href="#cb102-1786" aria-hidden="true" tabindex="-1"></a>(*This R code chunk has no visible output*)</span>
<span id="cb102-1787"><a href="#cb102-1787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1788"><a href="#cb102-1788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1789"><a href="#cb102-1789" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-1790"><a href="#cb102-1790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1791"><a href="#cb102-1791" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-1792"><a href="#cb102-1792" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: glance-data-stata-file</span></span>
<span id="cb102-1793"><a href="#cb102-1793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1794"><a href="#cb102-1794" aria-hidden="true" tabindex="-1"></a>gss_2016_man <span class="ot">&lt;-</span> </span>
<span id="cb102-1795"><a href="#cb102-1795" aria-hidden="true" tabindex="-1"></a>    <span class="fu">readRDS</span>(<span class="st">&quot;data-raw/gss_2016_man.rds&quot;</span>)</span>
<span id="cb102-1796"><a href="#cb102-1796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1797"><a href="#cb102-1797" aria-hidden="true" tabindex="-1"></a>gss_2016_man <span class="sc">|&gt;</span></span>
<span id="cb102-1798"><a href="#cb102-1798" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(age, grass)) <span class="sc">|&gt;</span> </span>
<span id="cb102-1799"><a href="#cb102-1799" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glance_data</span>(<span class="at">N =</span> <span class="dv">8</span>, <span class="at">seed =</span> <span class="dv">2016</span>)</span>
<span id="cb102-1800"><a href="#cb102-1800" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-1801"><a href="#cb102-1801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1802"><a href="#cb102-1802" aria-hidden="true" tabindex="-1"></a>Import STATA GSS 2016 file into R using (**haven**) and glance at the</span>
<span id="cb102-1803"><a href="#cb102-1803" aria-hidden="true" tabindex="-1"></a>data</span>
<span id="cb102-1804"><a href="#cb102-1804" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1805"><a href="#cb102-1805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1806"><a href="#cb102-1806" aria-hidden="true" tabindex="-1"></a>::: my-important</span>
<span id="cb102-1807"><a href="#cb102-1807" aria-hidden="true" tabindex="-1"></a>::: my-important-header</span>
<span id="cb102-1808"><a href="#cb102-1808" aria-hidden="true" tabindex="-1"></a>{**haven**} imports data as labelled vectors</span>
<span id="cb102-1809"><a href="#cb102-1809" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1810"><a href="#cb102-1810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1811"><a href="#cb102-1811" aria-hidden="true" tabindex="-1"></a>::: my-important-container</span>
<span id="cb102-1812"><a href="#cb102-1812" aria-hidden="true" tabindex="-1"></a>The data structure we have found here is very different from the Excel</span>
<span id="cb102-1813"><a href="#cb102-1813" aria-hidden="true" tabindex="-1"></a>data file provided with the book.</span>
<span id="cb102-1814"><a href="#cb102-1814" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1815"><a href="#cb102-1815" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1816"><a href="#cb102-1816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1817"><a href="#cb102-1817" aria-hidden="true" tabindex="-1"></a>Labelled vectors is a completely new feature for me. I learned that</span>
<span id="cb102-1818"><a href="#cb102-1818" aria-hidden="true" tabindex="-1"></a>value labels and other metadata tags that are commonly seen when working</span>
<span id="cb102-1819"><a href="#cb102-1819" aria-hidden="true" tabindex="-1"></a>with other statistical software like SAS, STATA or SPSS (cf. [Survey</span>
<span id="cb102-1820"><a href="#cb102-1820" aria-hidden="true" tabindex="-1"></a>Research and Datasets in</span>
<span id="cb102-1821"><a href="#cb102-1821" aria-hidden="true" tabindex="-1"></a>R](https://socialresearchcentre.github.io/r_survey_datasets/), here</span>
<span id="cb102-1822"><a href="#cb102-1822" aria-hidden="true" tabindex="-1"></a>section 3 [Labelled</span>
<span id="cb102-1823"><a href="#cb102-1823" aria-hidden="true" tabindex="-1"></a>Data](https://socialresearchcentre.github.io/r_survey_datasets/labelled-data.html))</span>
<span id="cb102-1824"><a href="#cb102-1824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1825"><a href="#cb102-1825" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; A labelled vector is a common data structure in other statistical</span></span>
<span id="cb102-1826"><a href="#cb102-1826" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; environments, allowing you to assign text labels to specific values.</span></span>
<span id="cb102-1827"><a href="#cb102-1827" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; This class makes it possible to import such labelled vectors in to R</span></span>
<span id="cb102-1828"><a href="#cb102-1828" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; without loss of fidelity. ([Create a labelled</span></span>
<span id="cb102-1829"><a href="#cb102-1829" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; vector](https://haven.tidyverse.org/reference/labelled.html))</span></span>
<span id="cb102-1830"><a href="#cb102-1830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1831"><a href="#cb102-1831" aria-hidden="true" tabindex="-1"></a>I will go into more details in @sec-chap01-labelled-data. The important</span>
<span id="cb102-1832"><a href="#cb102-1832" aria-hidden="true" tabindex="-1"></a>thing here is to notice that the variable <span class="in">`grass`</span> has labelled values</span>
<span id="cb102-1833"><a href="#cb102-1833" aria-hidden="true" tabindex="-1"></a>that explain the short code. Code <span class="in">`1`</span> represents the respondent option</span>
<span id="cb102-1834"><a href="#cb102-1834" aria-hidden="true" tabindex="-1"></a>that marijuana should be legalized and <span class="in">`2`</span> the opposite. We also learn</span>
<span id="cb102-1835"><a href="#cb102-1835" aria-hidden="true" tabindex="-1"></a>that there is with <span class="in">`NA i`</span> a special kind of <span class="in">`NA`</span> value:</span>
<span id="cb102-1836"><a href="#cb102-1836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1837"><a href="#cb102-1837" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; .i: Inapplicable (IAP). Respondents who are not asked to answer a</span></span>
<span id="cb102-1838"><a href="#cb102-1838" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; specific question are assigned to IAP. (See [Alert on the STATA</span></span>
<span id="cb102-1839"><a href="#cb102-1839" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; download page](https://gss.norc.org/get-the-data/stata))</span></span>
<span id="cb102-1840"><a href="#cb102-1840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1841"><a href="#cb102-1841" aria-hidden="true" tabindex="-1"></a>On the website we see under the &quot;Alert&quot; section that there other kind of</span>
<span id="cb102-1842"><a href="#cb102-1842" aria-hidden="true" tabindex="-1"></a>NA’s as well. And the 2022 GSS Codebook describes still other, less</span>
<span id="cb102-1843"><a href="#cb102-1843" aria-hidden="true" tabindex="-1"></a>common missing values.</span>
<span id="cb102-1844"><a href="#cb102-1844" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1845"><a href="#cb102-1845" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1846"><a href="#cb102-1846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1847"><a href="#cb102-1847" aria-hidden="true" tabindex="-1"></a>**Additional comments**</span>
<span id="cb102-1848"><a href="#cb102-1848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1849"><a href="#cb102-1849" aria-hidden="true" tabindex="-1"></a>I chose for file saving the <span class="in">`base::saveRDS()`</span> option (and not</span>
<span id="cb102-1850"><a href="#cb102-1850" aria-hidden="true" tabindex="-1"></a><span class="in">`base::save()`</span>) because when later reading into R again with</span>
<span id="cb102-1851"><a href="#cb102-1851" aria-hidden="true" tabindex="-1"></a><span class="in">`base::readRDS()`</span> it does not overwrite a variable with the same name</span>
<span id="cb102-1852"><a href="#cb102-1852" aria-hidden="true" tabindex="-1"></a>respectively I can assign the file to another variable name.</span>
<span id="cb102-1853"><a href="#cb102-1853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1854"><a href="#cb102-1854" aria-hidden="true" tabindex="-1"></a><span class="fu">###### automated</span></span>
<span id="cb102-1855"><a href="#cb102-1855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1856"><a href="#cb102-1856" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb102-1857"><a href="#cb102-1857" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb102-1858"><a href="#cb102-1858" aria-hidden="true" tabindex="-1"></a>::: {#cnj-chap01-get-gss2016-data}</span>
<span id="cb102-1859"><a href="#cb102-1859" aria-hidden="true" tabindex="-1"></a>: Get year 2016 of GSS data set with <span class="in">`base::download.file()`</span></span>
<span id="cb102-1860"><a href="#cb102-1860" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1861"><a href="#cb102-1861" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1862"><a href="#cb102-1862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1863"><a href="#cb102-1863" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb102-1864"><a href="#cb102-1864" aria-hidden="true" tabindex="-1"></a>::: {#lst-chap01-get-gss2016-automated}</span>
<span id="cb102-1865"><a href="#cb102-1865" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-1866"><a href="#cb102-1866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1867"><a href="#cb102-1867" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-1868"><a href="#cb102-1868" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: get-gss2016-automated</span></span>
<span id="cb102-1869"><a href="#cb102-1869" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: show</span></span>
<span id="cb102-1870"><a href="#cb102-1870" aria-hidden="true" tabindex="-1"></a><span class="co">#| cache: true</span></span>
<span id="cb102-1871"><a href="#cb102-1871" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb102-1872"><a href="#cb102-1872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1873"><a href="#cb102-1873" aria-hidden="true" tabindex="-1"></a><span class="do">## run only once (manually) ###########</span></span>
<span id="cb102-1874"><a href="#cb102-1874" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">tempfile</span>()</span>
<span id="cb102-1875"><a href="#cb102-1875" aria-hidden="true" tabindex="-1"></a>utils<span class="sc">::</span><span class="fu">download.file</span>(<span class="st">&quot;https://gss.norc.org/documents/stata/2016_stata.zip&quot;</span>,temp)</span>
<span id="cb102-1876"><a href="#cb102-1876" aria-hidden="true" tabindex="-1"></a>gss_2016_aut <span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">read_dta</span>(base<span class="sc">::</span><span class="fu">unz</span>(temp, <span class="st">&quot;GSS2016.dta&quot;</span>))</span>
<span id="cb102-1877"><a href="#cb102-1877" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">unlink</span>(temp)</span>
<span id="cb102-1878"><a href="#cb102-1878" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">saveRDS</span>(gss_2016_aut, <span class="at">file =</span> <span class="st">&quot;data-raw/gss_2016_aut.rds&quot;</span> )</span>
<span id="cb102-1879"><a href="#cb102-1879" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-1880"><a href="#cb102-1880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1881"><a href="#cb102-1881" aria-hidden="true" tabindex="-1"></a>Get year 2016 of GSS data set with <span class="in">`base::download.file()`</span></span>
<span id="cb102-1882"><a href="#cb102-1882" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1883"><a href="#cb102-1883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1884"><a href="#cb102-1884" aria-hidden="true" tabindex="-1"></a>(*This R code chunk has no visible output*)</span>
<span id="cb102-1885"><a href="#cb102-1885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1886"><a href="#cb102-1886" aria-hidden="true" tabindex="-1"></a>This time we have the file downloaded programmatically which is much</span>
<span id="cb102-1887"><a href="#cb102-1887" aria-hidden="true" tabindex="-1"></a>better in term of reproducibility. We don&#39;t need now to import the data</span>
<span id="cb102-1888"><a href="#cb102-1888" aria-hidden="true" tabindex="-1"></a>{**haven**} but can call base::readRDS().</span>
<span id="cb102-1889"><a href="#cb102-1889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1890"><a href="#cb102-1890" aria-hidden="true" tabindex="-1"></a>::: {#lst-chap01-read-rds-data}</span>
<span id="cb102-1891"><a href="#cb102-1891" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-1892"><a href="#cb102-1892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1893"><a href="#cb102-1893" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-1894"><a href="#cb102-1894" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: read-rds-data</span></span>
<span id="cb102-1895"><a href="#cb102-1895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1896"><a href="#cb102-1896" aria-hidden="true" tabindex="-1"></a>gss_2016_aut <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="st">&quot;data-raw/gss_2016_aut.rds&quot;</span>)</span>
<span id="cb102-1897"><a href="#cb102-1897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1898"><a href="#cb102-1898" aria-hidden="true" tabindex="-1"></a>gss_2016_aut <span class="sc">|&gt;</span> </span>
<span id="cb102-1899"><a href="#cb102-1899" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(age, grass)) <span class="sc">|&gt;</span> </span>
<span id="cb102-1900"><a href="#cb102-1900" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glance_data</span>(<span class="at">N =</span> <span class="dv">8</span>, <span class="at">seed =</span> <span class="dv">2016</span>)</span>
<span id="cb102-1901"><a href="#cb102-1901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1902"><a href="#cb102-1902" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-1903"><a href="#cb102-1903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1904"><a href="#cb102-1904" aria-hidden="true" tabindex="-1"></a>Read previously saved <span class="in">`.rds`</span> file into R and glance at the data</span>
<span id="cb102-1905"><a href="#cb102-1905" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1906"><a href="#cb102-1906" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1907"><a href="#cb102-1907" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1908"><a href="#cb102-1908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1909"><a href="#cb102-1909" aria-hidden="true" tabindex="-1"></a>Data now have a more R like appearance, even if the variable classes</span>
<span id="cb102-1910"><a href="#cb102-1910" aria-hidden="true" tabindex="-1"></a>with &lt;hvn_lbll&gt; &quot;*`r class(gss_2016_aut$age)`*&quot; are unfamiliar. But we</span>
<span id="cb102-1911"><a href="#cb102-1911" aria-hidden="true" tabindex="-1"></a>have now lost some information, especially we have to consult the</span>
<span id="cb102-1912"><a href="#cb102-1912" aria-hidden="true" tabindex="-1"></a>codebook to know what the codes <span class="in">`1`</span> and <span class="in">`2`</span> mean.</span>
<span id="cb102-1913"><a href="#cb102-1913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1914"><a href="#cb102-1914" aria-hidden="true" tabindex="-1"></a><span class="fu">###### lodown</span></span>
<span id="cb102-1915"><a href="#cb102-1915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1916"><a href="#cb102-1916" aria-hidden="true" tabindex="-1"></a>The following strategy I have taken from the bookdown book [Analyze</span>
<span id="cb102-1917"><a href="#cb102-1917" aria-hidden="true" tabindex="-1"></a>Survey Data for Free](http://asdfree.com/) (asdf.com) It gives step by</span>
<span id="cb102-1918"><a href="#cb102-1918" aria-hidden="true" tabindex="-1"></a>step instructions to explore public <span class="in">`r glossary(&quot;Microdata&quot;)`</span>. Here I</span>
<span id="cb102-1919"><a href="#cb102-1919" aria-hidden="true" tabindex="-1"></a>refer to the <span class="in">`r glossary(&quot;General Social Survey&quot;)`</span> (GSS) section of the</span>
<span id="cb102-1920"><a href="#cb102-1920" aria-hidden="true" tabindex="-1"></a>book.</span>
<span id="cb102-1921"><a href="#cb102-1921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1922"><a href="#cb102-1922" aria-hidden="true" tabindex="-1"></a>::: my-procedure</span>
<span id="cb102-1923"><a href="#cb102-1923" aria-hidden="true" tabindex="-1"></a>::: my-procedure-header</span>
<span id="cb102-1924"><a href="#cb102-1924" aria-hidden="true" tabindex="-1"></a>::: {#prp-chap01-get-gss2016-lodown}</span>
<span id="cb102-1925"><a href="#cb102-1925" aria-hidden="true" tabindex="-1"></a>: Get the GSS data with the {**lodown**} package and glance at the data</span>
<span id="cb102-1926"><a href="#cb102-1926" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1927"><a href="#cb102-1927" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1928"><a href="#cb102-1928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1929"><a href="#cb102-1929" aria-hidden="true" tabindex="-1"></a>::: my-procedure-container</span>
<span id="cb102-1930"><a href="#cb102-1930" aria-hidden="true" tabindex="-1"></a>Working with {**lodown**} is a three step procedure:</span>
<span id="cb102-1931"><a href="#cb102-1931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1932"><a href="#cb102-1932" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Retrieve a listing of all available extracts for the GSS data.</span>
<span id="cb102-1933"><a href="#cb102-1933" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Choose what files you want to download. In our case data for the</span>
<span id="cb102-1934"><a href="#cb102-1934" aria-hidden="true" tabindex="-1"></a>    year 2016.</span>
<span id="cb102-1935"><a href="#cb102-1935" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Download the specified dataset in the offered SPSS file format, but</span>
<span id="cb102-1936"><a href="#cb102-1936" aria-hidden="true" tabindex="-1"></a>    {**lodown**} produces with <span class="in">`.rds`</span> a native R file format with the</span>
<span id="cb102-1937"><a href="#cb102-1937" aria-hidden="true" tabindex="-1"></a>    name <span class="in">`2016.rds`</span>.</span>
<span id="cb102-1938"><a href="#cb102-1938" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1939"><a href="#cb102-1939" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1940"><a href="#cb102-1940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1941"><a href="#cb102-1941" aria-hidden="true" tabindex="-1"></a>The second step has to be done manually but I have the result of my</span>
<span id="cb102-1942"><a href="#cb102-1942" aria-hidden="true" tabindex="-1"></a>inspection already integrated in @lst-chap01-get-gss2016-lodown.</span>
<span id="cb102-1943"><a href="#cb102-1943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1944"><a href="#cb102-1944" aria-hidden="true" tabindex="-1"></a>As additional steps I renamed the downloaded file, so that I can</span>
<span id="cb102-1945"><a href="#cb102-1945" aria-hidden="true" tabindex="-1"></a>distinguish it from similar files of the other approaches. Finally I</span>
<span id="cb102-1946"><a href="#cb102-1946" aria-hidden="true" tabindex="-1"></a>glanced at the <span class="in">`grass`</span> and <span class="in">`age`</span> data.</span>
<span id="cb102-1947"><a href="#cb102-1947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1948"><a href="#cb102-1948" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb102-1949"><a href="#cb102-1949" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb102-1950"><a href="#cb102-1950" aria-hidden="true" tabindex="-1"></a>::: {#cnj-chap01-get-gss2016-lodown}</span>
<span id="cb102-1951"><a href="#cb102-1951" aria-hidden="true" tabindex="-1"></a>: Get GSS data via {**lodown**} package</span>
<span id="cb102-1952"><a href="#cb102-1952" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1953"><a href="#cb102-1953" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-1954"><a href="#cb102-1954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1955"><a href="#cb102-1955" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb102-1956"><a href="#cb102-1956" aria-hidden="true" tabindex="-1"></a>::: {#lst-chap01-get-gss2016-lodown}</span>
<span id="cb102-1957"><a href="#cb102-1957" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-1958"><a href="#cb102-1958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1959"><a href="#cb102-1959" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-1960"><a href="#cb102-1960" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: get-gss2016-lodown</span></span>
<span id="cb102-1961"><a href="#cb102-1961" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb102-1962"><a href="#cb102-1962" aria-hidden="true" tabindex="-1"></a><span class="co">#| cache: true</span></span>
<span id="cb102-1963"><a href="#cb102-1963" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb102-1964"><a href="#cb102-1964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1965"><a href="#cb102-1965" aria-hidden="true" tabindex="-1"></a><span class="do">## can&#39;t suppress messages, tried several options</span></span>
<span id="cb102-1966"><a href="#cb102-1966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1967"><a href="#cb102-1967" aria-hidden="true" tabindex="-1"></a><span class="do">## run only once (manually) ############</span></span>
<span id="cb102-1968"><a href="#cb102-1968" aria-hidden="true" tabindex="-1"></a>my_folder <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">paste0</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">&quot;/data-raw&quot;</span>)</span>
<span id="cb102-1969"><a href="#cb102-1969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1970"><a href="#cb102-1970" aria-hidden="true" tabindex="-1"></a><span class="co"># (1) retrieve a listing of all available extracts for the GSS data</span></span>
<span id="cb102-1971"><a href="#cb102-1971" aria-hidden="true" tabindex="-1"></a>gss_cat <span class="ot">&lt;-</span> lodown<span class="sc">::</span><span class="fu">get_catalog</span>(<span class="at">data_name =</span> <span class="st">&quot;gss&quot;</span>,</span>
<span id="cb102-1972"><a href="#cb102-1972" aria-hidden="true" tabindex="-1"></a>                               <span class="at">output_dir =</span> my_folder,</span>
<span id="cb102-1973"><a href="#cb102-1973" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;GSS&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb102-1974"><a href="#cb102-1974" aria-hidden="true" tabindex="-1"></a><span class="do">## (2) choose the catalog part to download</span></span>
<span id="cb102-1975"><a href="#cb102-1975" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(</span>
<span id="cb102-1976"><a href="#cb102-1976" aria-hidden="true" tabindex="-1"></a>        output_filename <span class="sc">==</span> base<span class="sc">::</span><span class="fu">paste0</span>(my_folder, <span class="st">&quot;/2016.rds&quot;</span>))</span>
<span id="cb102-1977"><a href="#cb102-1977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1978"><a href="#cb102-1978" aria-hidden="true" tabindex="-1"></a><span class="do">## (3) download the GSS microdata as 2016.rds</span></span>
<span id="cb102-1979"><a href="#cb102-1979" aria-hidden="true" tabindex="-1"></a>lodown<span class="sc">::</span><span class="fu">lodown</span>(<span class="st">&quot;gss&quot;</span> , gss_cat)</span>
<span id="cb102-1980"><a href="#cb102-1980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1981"><a href="#cb102-1981" aria-hidden="true" tabindex="-1"></a><span class="do">## rename dataset to distinguish from other download approaches</span></span>
<span id="cb102-1982"><a href="#cb102-1982" aria-hidden="true" tabindex="-1"></a>old_filename <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">paste0</span>(my_folder, <span class="st">&quot;/2016.rds&quot;</span>)</span>
<span id="cb102-1983"><a href="#cb102-1983" aria-hidden="true" tabindex="-1"></a>new_filename <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">paste0</span>(my_folder, <span class="st">&quot;/gss_2016_cat.rds&quot;</span>)</span>
<span id="cb102-1984"><a href="#cb102-1984" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">file.rename</span>(<span class="at">from =</span> old_filename, <span class="at">to =</span> new_filename)</span>
<span id="cb102-1985"><a href="#cb102-1985" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-1986"><a href="#cb102-1986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1987"><a href="#cb102-1987" aria-hidden="true" tabindex="-1"></a>(*This R code chunk has no visible output beside the warning message.*)</span>
<span id="cb102-1988"><a href="#cb102-1988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1989"><a href="#cb102-1989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1990"><a href="#cb102-1990" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-1991"><a href="#cb102-1991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1992"><a href="#cb102-1992" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-1993"><a href="#cb102-1993" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: glance-data-gss-cat</span></span>
<span id="cb102-1994"><a href="#cb102-1994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-1995"><a href="#cb102-1995" aria-hidden="true" tabindex="-1"></a><span class="do">## load and glance at data</span></span>
<span id="cb102-1996"><a href="#cb102-1996" aria-hidden="true" tabindex="-1"></a>gss_2016_cat <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="st">&quot;data-raw/gss_2016_cat.rds&quot;</span>)</span>
<span id="cb102-1997"><a href="#cb102-1997" aria-hidden="true" tabindex="-1"></a>gss_2016_cat <span class="sc">|&gt;</span> </span>
<span id="cb102-1998"><a href="#cb102-1998" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(age, grass)) <span class="sc">|&gt;</span> </span>
<span id="cb102-1999"><a href="#cb102-1999" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glance_data</span>(<span class="at">N =</span> <span class="dv">8</span>, <span class="at">seed =</span> <span class="dv">2016</span>)</span>
<span id="cb102-2000"><a href="#cb102-2000" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-2001"><a href="#cb102-2001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2002"><a href="#cb102-2002" aria-hidden="true" tabindex="-1"></a>Get GSS data for the year 2016 via the {**lodown**} package</span>
<span id="cb102-2003"><a href="#cb102-2003" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2004"><a href="#cb102-2004" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2005"><a href="#cb102-2005" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2006"><a href="#cb102-2006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2007"><a href="#cb102-2007" aria-hidden="true" tabindex="-1"></a>The result is a pure <span class="in">`.rds`</span> file where the columns are still of class</span>
<span id="cb102-2008"><a href="#cb102-2008" aria-hidden="true" tabindex="-1"></a>&quot;*`r class(gss_2016_cat$grass)`*&quot; as in @lst-chap01-read-rds-data.</span>
<span id="cb102-2009"><a href="#cb102-2009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2010"><a href="#cb102-2010" aria-hidden="true" tabindex="-1"></a><span class="fu">###### gssr</span></span>
<span id="cb102-2011"><a href="#cb102-2011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2012"><a href="#cb102-2012" aria-hidden="true" tabindex="-1"></a>Finally I will download the 2016 data with the help of the {**gssr**}</span>
<span id="cb102-2013"><a href="#cb102-2013" aria-hidden="true" tabindex="-1"></a>package (see @pak-gssr). This takes some minutes. At first I missed the vignette, so I</span>
<span id="cb102-2014"><a href="#cb102-2014" aria-hidden="true" tabindex="-1"></a>had to download the package again with the additional argument</span>
<span id="cb102-2015"><a href="#cb102-2015" aria-hidden="true" tabindex="-1"></a><span class="in">`build_vignettes = TRUE`</span>. Whereas the vignette explains how to analyse</span>
<span id="cb102-2016"><a href="#cb102-2016" aria-hidden="true" tabindex="-1"></a>data the GitHub is very helpful how to get the desired data.</span>
<span id="cb102-2017"><a href="#cb102-2017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2018"><a href="#cb102-2018" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; You can quickly get the data for any single GSS year by using</span></span>
<span id="cb102-2019"><a href="#cb102-2019" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; </span><span class="in">`gssr::gss_get_yr()`</span><span class="at"> to download the data file from NORC and put it</span></span>
<span id="cb102-2020"><a href="#cb102-2020" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; directly into a tibble.</span></span>
<span id="cb102-2021"><a href="#cb102-2021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2022"><a href="#cb102-2022" aria-hidden="true" tabindex="-1"></a>After downloaded the file we can --- as in the other tabs already done</span>
<span id="cb102-2023"><a href="#cb102-2023" aria-hidden="true" tabindex="-1"></a>--- load the file and glance at the grass/age data.</span>
<span id="cb102-2024"><a href="#cb102-2024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2025"><a href="#cb102-2025" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb102-2026"><a href="#cb102-2026" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb102-2027"><a href="#cb102-2027" aria-hidden="true" tabindex="-1"></a>::: {#cnj-chap01-get-gss2016-gssr}</span>
<span id="cb102-2028"><a href="#cb102-2028" aria-hidden="true" tabindex="-1"></a>: Get GSS 2016 Year Data Set (cross-section only) and glance at the data</span>
<span id="cb102-2029"><a href="#cb102-2029" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2030"><a href="#cb102-2030" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2031"><a href="#cb102-2031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2032"><a href="#cb102-2032" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb102-2033"><a href="#cb102-2033" aria-hidden="true" tabindex="-1"></a>::: {#lst-chap01-get-gss2016-gssr-and-glance-at-data}</span>
<span id="cb102-2034"><a href="#cb102-2034" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-2035"><a href="#cb102-2035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2036"><a href="#cb102-2036" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-2037"><a href="#cb102-2037" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: get-gss2016-gssr</span></span>
<span id="cb102-2038"><a href="#cb102-2038" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb102-2039"><a href="#cb102-2039" aria-hidden="true" tabindex="-1"></a><span class="co">#| cache: true</span></span>
<span id="cb102-2040"><a href="#cb102-2040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2041"><a href="#cb102-2041" aria-hidden="true" tabindex="-1"></a><span class="do">## run only once (manually) ####################</span></span>
<span id="cb102-2042"><a href="#cb102-2042" aria-hidden="true" tabindex="-1"></a>gss_2016_gssr <span class="ot">&lt;-</span> gssr<span class="sc">::</span><span class="fu">gss_get_yr</span>(<span class="at">year =</span> <span class="dv">2016</span>)</span>
<span id="cb102-2043"><a href="#cb102-2043" aria-hidden="true" tabindex="-1"></a>gss_2016_gssr <span class="ot">&lt;-</span> gss_2016_gssr <span class="sc">|&gt;</span></span>
<span id="cb102-2044"><a href="#cb102-2044" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(age, grass))</span>
<span id="cb102-2045"><a href="#cb102-2045" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">saveRDS</span>(gss_2016_gssr, <span class="at">file =</span> <span class="st">&quot;data-raw/gss_2016_gssr.rds&quot;</span> )</span>
<span id="cb102-2046"><a href="#cb102-2046" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-2047"><a href="#cb102-2047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2048"><a href="#cb102-2048" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-2049"><a href="#cb102-2049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2050"><a href="#cb102-2050" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-2051"><a href="#cb102-2051" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: glance-data-gss2016</span></span>
<span id="cb102-2052"><a href="#cb102-2052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2053"><a href="#cb102-2053" aria-hidden="true" tabindex="-1"></a><span class="do">## load data ####################</span></span>
<span id="cb102-2054"><a href="#cb102-2054" aria-hidden="true" tabindex="-1"></a>gss_2016_gssr <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="st">&quot;data-raw/gss_2016_gssr.rds&quot;</span>)</span>
<span id="cb102-2055"><a href="#cb102-2055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2056"><a href="#cb102-2056" aria-hidden="true" tabindex="-1"></a><span class="do">## glance at data</span></span>
<span id="cb102-2057"><a href="#cb102-2057" aria-hidden="true" tabindex="-1"></a>gss_2016_gssr <span class="sc">|&gt;</span> </span>
<span id="cb102-2058"><a href="#cb102-2058" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glance_data</span>(<span class="at">N =</span> <span class="dv">8</span>, <span class="at">seed =</span> <span class="dv">2016</span>)</span>
<span id="cb102-2059"><a href="#cb102-2059" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-2060"><a href="#cb102-2060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2061"><a href="#cb102-2061" aria-hidden="true" tabindex="-1"></a>Get GSS 2016 Year Data Set (cross-section only) and glance at the data</span>
<span id="cb102-2062"><a href="#cb102-2062" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2063"><a href="#cb102-2063" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2064"><a href="#cb102-2064" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2065"><a href="#cb102-2065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2066"><a href="#cb102-2066" aria-hidden="true" tabindex="-1"></a>Downloading data with {**gssr**} results in exactly the same format as</span>
<span id="cb102-2067"><a href="#cb102-2067" aria-hidden="true" tabindex="-1"></a>in listing @lst-chap01-import-stata-2016-file from the manual download.</span>
<span id="cb102-2068"><a href="#cb102-2068" aria-hidden="true" tabindex="-1"></a>But it has now the advantages from the {**gssr**} package. For instance</span>
<span id="cb102-2069"><a href="#cb102-2069" aria-hidden="true" tabindex="-1"></a>with the integrated help it is much easier to</span>
<span id="cb102-2070"><a href="#cb102-2070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2071"><a href="#cb102-2071" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>find the variables</span>
<span id="cb102-2072"><a href="#cb102-2072" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>to read the question text of the variable</span>
<span id="cb102-2073"><a href="#cb102-2073" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>to see in which year the questions was asked</span>
<span id="cb102-2074"><a href="#cb102-2074" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>what the code - including the different types of NA’s mean</span>
<span id="cb102-2075"><a href="#cb102-2075" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2076"><a href="#cb102-2076" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2077"><a href="#cb102-2077" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2078"><a href="#cb102-2078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2079"><a href="#cb102-2079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2080"><a href="#cb102-2080" aria-hidden="true" tabindex="-1"></a>::: my-important</span>
<span id="cb102-2081"><a href="#cb102-2081" aria-hidden="true" tabindex="-1"></a>::: my-important-header</span>
<span id="cb102-2082"><a href="#cb102-2082" aria-hidden="true" tabindex="-1"></a>Six different approaches to get the GSS data</span>
<span id="cb102-2083"><a href="#cb102-2083" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2084"><a href="#cb102-2084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2085"><a href="#cb102-2085" aria-hidden="true" tabindex="-1"></a>::: my-important-container</span>
<span id="cb102-2086"><a href="#cb102-2086" aria-hidden="true" tabindex="-1"></a>Using the {**gssr**} packages seems to me by far the best approach.</span>
<span id="cb102-2087"><a href="#cb102-2087" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2088"><a href="#cb102-2088" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2089"><a href="#cb102-2089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2090"><a href="#cb102-2090" aria-hidden="true" tabindex="-1"></a><span class="fu">## Working with Labelled Data {#sec-chap01-labelled-data}</span></span>
<span id="cb102-2091"><a href="#cb102-2091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2092"><a href="#cb102-2092" aria-hidden="true" tabindex="-1"></a><span class="fu">### How to work with labelled data? --- Resources</span></span>
<span id="cb102-2093"><a href="#cb102-2093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2094"><a href="#cb102-2094" aria-hidden="true" tabindex="-1"></a>During downloading GSS data I mentioned that {**haven**} imports data as</span>
<span id="cb102-2095"><a href="#cb102-2095" aria-hidden="true" tabindex="-1"></a>labelled vectors. As a completely new feature for me I looked at the</span>
<span id="cb102-2096"><a href="#cb102-2096" aria-hidden="true" tabindex="-1"></a>Internet for their advantages and how to work with them. I found four</span>
<span id="cb102-2097"><a href="#cb102-2097" aria-hidden="true" tabindex="-1"></a>important resources:</span>
<span id="cb102-2098"><a href="#cb102-2098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2099"><a href="#cb102-2099" aria-hidden="true" tabindex="-1"></a>::: my-resource</span>
<span id="cb102-2100"><a href="#cb102-2100" aria-hidden="true" tabindex="-1"></a>::: my-resource-header</span>
<span id="cb102-2101"><a href="#cb102-2101" aria-hidden="true" tabindex="-1"></a>How to work with labelled data?</span>
<span id="cb102-2102"><a href="#cb102-2102" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2103"><a href="#cb102-2103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2104"><a href="#cb102-2104" aria-hidden="true" tabindex="-1"></a>::: my-resource-container</span>
<span id="cb102-2105"><a href="#cb102-2105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2106"><a href="#cb102-2106" aria-hidden="true" tabindex="-1"></a>[Survey Research Datasets and</span>
<span id="cb102-2107"><a href="#cb102-2107" aria-hidden="true" tabindex="-1"></a>R](https://socialresearchcentre.github.io/r_survey_datasets/)</span>
<span id="cb102-2108"><a href="#cb102-2108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2109"><a href="#cb102-2109" aria-hidden="true" tabindex="-1"></a>A book accompanying a workshop delivered for the 7th Biennial</span>
<span id="cb102-2110"><a href="#cb102-2110" aria-hidden="true" tabindex="-1"></a><span class="in">`r glossary(&quot;ACSPRI&quot;)`</span> Social Science Methodology Conference. It</span>
<span id="cb102-2111"><a href="#cb102-2111" aria-hidden="true" tabindex="-1"></a>provides a practical demonstration of several packages for accessing and</span>
<span id="cb102-2112"><a href="#cb102-2112" aria-hidden="true" tabindex="-1"></a>working with survey data, associated metadata and official statistics in</span>
<span id="cb102-2113"><a href="#cb102-2113" aria-hidden="true" tabindex="-1"></a>R. The short book demonstrates</span>
<span id="cb102-2114"><a href="#cb102-2114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2115"><a href="#cb102-2115" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Working with external data sources from common statistical packages</span>
<span id="cb102-2116"><a href="#cb102-2116" aria-hidden="true" tabindex="-1"></a>    (SPSS, SAS, Stata, Excel) and their quirks</span>
<span id="cb102-2117"><a href="#cb102-2117" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Easily working with categorical data in R with the {**labelled**} R</span>
<span id="cb102-2118"><a href="#cb102-2118" aria-hidden="true" tabindex="-1"></a>    package</span>
<span id="cb102-2119"><a href="#cb102-2119" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Accessing external databases in an R native way using {**DBI**} and</span>
<span id="cb102-2120"><a href="#cb102-2120" aria-hidden="true" tabindex="-1"></a>    {**dbplyr**} (The <span class="co">[</span><span class="ot">DBI package</span><span class="co">](https://dbi.r-dbi.org/)</span> helps</span>
<span id="cb102-2121"><a href="#cb102-2121" aria-hidden="true" tabindex="-1"></a>    connecting R to database management systems (DBMS).</span>
<span id="cb102-2122"><a href="#cb102-2122" aria-hidden="true" tabindex="-1"></a>    <span class="co">[</span><span class="ot">dbplyr</span><span class="co">](https://dbplyr.tidyverse.org/)</span> is a {**dplyr**} backend for</span>
<span id="cb102-2123"><a href="#cb102-2123" aria-hidden="true" tabindex="-1"></a>    data bases)</span>
<span id="cb102-2124"><a href="#cb102-2124" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Accessing publicly available data in R scripts via the web</span>
<span id="cb102-2125"><a href="#cb102-2125" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Resources for accessing official statistics data in R</span>
<span id="cb102-2126"><a href="#cb102-2126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2127"><a href="#cb102-2127" aria-hidden="true" tabindex="-1"></a>Here I am interested only in the first two demonstration. I will refer</span>
<span id="cb102-2128"><a href="#cb102-2128" aria-hidden="true" tabindex="-1"></a>especially to the section on [Labelled</span>
<span id="cb102-2129"><a href="#cb102-2129" aria-hidden="true" tabindex="-1"></a>data](https://socialresearchcentre.github.io/r_survey_datasets/labelled-data.html).</span>
<span id="cb102-2130"><a href="#cb102-2130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2131"><a href="#cb102-2131" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb102-2132"><a href="#cb102-2132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2133"><a href="#cb102-2133" aria-hidden="true" tabindex="-1"></a>::: my-watch-out</span>
<span id="cb102-2134"><a href="#cb102-2134" aria-hidden="true" tabindex="-1"></a>::: my-watch-out-header</span>
<span id="cb102-2135"><a href="#cb102-2135" aria-hidden="true" tabindex="-1"></a>WATCH OUT! {**labelled**} and {**sjlabelled**} have similar purposes and</span>
<span id="cb102-2136"><a href="#cb102-2136" aria-hidden="true" tabindex="-1"></a>functions</span>
<span id="cb102-2137"><a href="#cb102-2137" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2138"><a href="#cb102-2138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2139"><a href="#cb102-2139" aria-hidden="true" tabindex="-1"></a>::: my-watch-out-container</span>
<span id="cb102-2140"><a href="#cb102-2140" aria-hidden="true" tabindex="-1"></a>{**labelled**} and {**sjlabelled**} are very similar. As far as I</span>
<span id="cb102-2141"><a href="#cb102-2141" aria-hidden="true" tabindex="-1"></a>understand is the main difference that {**sjlabelled**} supports not</span>
<span id="cb102-2142"><a href="#cb102-2142" aria-hidden="true" tabindex="-1"></a>only working with labelled data but also offers functions to benefit</span>
<span id="cb102-2143"><a href="#cb102-2143" aria-hidden="true" tabindex="-1"></a>from these features. {**labelled**} in contrast manipulates labelled</span>
<span id="cb102-2144"><a href="#cb102-2144" aria-hidden="true" tabindex="-1"></a>data only as an intermediate data structure that should be converted to</span>
<span id="cb102-2145"><a href="#cb102-2145" aria-hidden="true" tabindex="-1"></a>common R classes, loosing these kind of meta-data.</span>
<span id="cb102-2146"><a href="#cb102-2146" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2147"><a href="#cb102-2147" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2148"><a href="#cb102-2148" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2149"><a href="#cb102-2149" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2150"><a href="#cb102-2150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2151"><a href="#cb102-2151" aria-hidden="true" tabindex="-1"></a><span class="fu">### Displaying data including labelled vectors {#sec-chap01-labelled-data-2}</span></span>
<span id="cb102-2152"><a href="#cb102-2152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2153"><a href="#cb102-2153" aria-hidden="true" tabindex="-1"></a>To get comfortable with labelled data @def-chap01-show-labelled-data I</span>
<span id="cb102-2154"><a href="#cb102-2154" aria-hidden="true" tabindex="-1"></a>will show how labelled data appear in different viewing functions. To</span>
<span id="cb102-2155"><a href="#cb102-2155" aria-hidden="true" tabindex="-1"></a>inspect the possibilities of the {**labelled**} package see</span>
<span id="cb102-2156"><a href="#cb102-2156" aria-hidden="true" tabindex="-1"></a>@def-chap01-use-labelled-haven-package.</span>
<span id="cb102-2157"><a href="#cb102-2157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2158"><a href="#cb102-2158" aria-hidden="true" tabindex="-1"></a>::: my-experiment</span>
<span id="cb102-2159"><a href="#cb102-2159" aria-hidden="true" tabindex="-1"></a>::: my-experiment-header</span>
<span id="cb102-2160"><a href="#cb102-2160" aria-hidden="true" tabindex="-1"></a>::: {#def-chap01-show-labelled-data}</span>
<span id="cb102-2161"><a href="#cb102-2161" aria-hidden="true" tabindex="-1"></a>: Different types of data views with labelled data</span>
<span id="cb102-2162"><a href="#cb102-2162" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2163"><a href="#cb102-2163" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2164"><a href="#cb102-2164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2165"><a href="#cb102-2165" aria-hidden="true" tabindex="-1"></a>::: my-experiment-container</span>
<span id="cb102-2166"><a href="#cb102-2166" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb102-2167"><a href="#cb102-2167" aria-hidden="true" tabindex="-1"></a><span class="fu">###### str()</span></span>
<span id="cb102-2168"><a href="#cb102-2168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2169"><a href="#cb102-2169" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb102-2170"><a href="#cb102-2170" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb102-2171"><a href="#cb102-2171" aria-hidden="true" tabindex="-1"></a>::: {#cnj-chap01-str-labelled-data}</span>
<span id="cb102-2172"><a href="#cb102-2172" aria-hidden="true" tabindex="-1"></a>: Display the internal structure of labelled data</span>
<span id="cb102-2173"><a href="#cb102-2173" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2174"><a href="#cb102-2174" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2175"><a href="#cb102-2175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2176"><a href="#cb102-2176" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb102-2177"><a href="#cb102-2177" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-2178"><a href="#cb102-2178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2179"><a href="#cb102-2179" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-2180"><a href="#cb102-2180" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: str-labelled-data</span></span>
<span id="cb102-2181"><a href="#cb102-2181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2182"><a href="#cb102-2182" aria-hidden="true" tabindex="-1"></a>utils<span class="sc">::</span><span class="fu">str</span>(gss_2016_gssr)</span>
<span id="cb102-2183"><a href="#cb102-2183" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-2184"><a href="#cb102-2184" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2185"><a href="#cb102-2185" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2186"><a href="#cb102-2186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2187"><a href="#cb102-2187" aria-hidden="true" tabindex="-1"></a><span class="fu">###### attributes()</span></span>
<span id="cb102-2188"><a href="#cb102-2188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2189"><a href="#cb102-2189" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb102-2190"><a href="#cb102-2190" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb102-2191"><a href="#cb102-2191" aria-hidden="true" tabindex="-1"></a>::: {#cnj-chap01-attributes-labelled-data}</span>
<span id="cb102-2192"><a href="#cb102-2192" aria-hidden="true" tabindex="-1"></a>: Show attributes of labelled data</span>
<span id="cb102-2193"><a href="#cb102-2193" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2194"><a href="#cb102-2194" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2195"><a href="#cb102-2195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2196"><a href="#cb102-2196" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb102-2197"><a href="#cb102-2197" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-2198"><a href="#cb102-2198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2199"><a href="#cb102-2199" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-2200"><a href="#cb102-2200" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: attributes-labelled-data</span></span>
<span id="cb102-2201"><a href="#cb102-2201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2202"><a href="#cb102-2202" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">attributes</span>(gss_2016_gssr<span class="sc">$</span>grass)</span>
<span id="cb102-2203"><a href="#cb102-2203" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-2204"><a href="#cb102-2204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2205"><a href="#cb102-2205" aria-hidden="true" tabindex="-1"></a>This works only with vectors (variables), but not with data frames. You</span>
<span id="cb102-2206"><a href="#cb102-2206" aria-hidden="true" tabindex="-1"></a>can display specific list values with numbers (e.g.,</span>
<span id="cb102-2207"><a href="#cb102-2207" aria-hidden="true" tabindex="-1"></a><span class="in">`attributes(gss_2016_gssr$grass)[[4]]`</span>) or names (e.g.,</span>
<span id="cb102-2208"><a href="#cb102-2208" aria-hidden="true" tabindex="-1"></a><span class="in">`attributes(gss_2016_gssr$grass)[[&quot;labels&quot;]]`</span>).</span>
<span id="cb102-2209"><a href="#cb102-2209" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2210"><a href="#cb102-2210" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2211"><a href="#cb102-2211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2212"><a href="#cb102-2212" aria-hidden="true" tabindex="-1"></a><span class="fu">###### head()</span></span>
<span id="cb102-2213"><a href="#cb102-2213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2214"><a href="#cb102-2214" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb102-2215"><a href="#cb102-2215" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb102-2216"><a href="#cb102-2216" aria-hidden="true" tabindex="-1"></a>::: {#cnj-chap01-head-labelled-data}</span>
<span id="cb102-2217"><a href="#cb102-2217" aria-hidden="true" tabindex="-1"></a>: Show first six records of the labelled variable</span>
<span id="cb102-2218"><a href="#cb102-2218" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2219"><a href="#cb102-2219" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2220"><a href="#cb102-2220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2221"><a href="#cb102-2221" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb102-2222"><a href="#cb102-2222" aria-hidden="true" tabindex="-1"></a>::: {#lst-chap01-head-labelled-data}</span>
<span id="cb102-2223"><a href="#cb102-2223" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-2224"><a href="#cb102-2224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2225"><a href="#cb102-2225" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-2226"><a href="#cb102-2226" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: head-labelled-data</span></span>
<span id="cb102-2227"><a href="#cb102-2227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2228"><a href="#cb102-2228" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(gss_2016_gssr<span class="sc">$</span>grass)</span>
<span id="cb102-2229"><a href="#cb102-2229" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-2230"><a href="#cb102-2230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2231"><a href="#cb102-2231" aria-hidden="true" tabindex="-1"></a>Use <span class="in">`head()`</span> to show the first six records of the labelled variable.</span>
<span id="cb102-2232"><a href="#cb102-2232" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2233"><a href="#cb102-2233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2234"><a href="#cb102-2234" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb102-2235"><a href="#cb102-2235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2236"><a href="#cb102-2236" aria-hidden="true" tabindex="-1"></a>This works only with labelled vectors (variables), but not with data</span>
<span id="cb102-2237"><a href="#cb102-2237" aria-hidden="true" tabindex="-1"></a>frames.</span>
<span id="cb102-2238"><a href="#cb102-2238" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2239"><a href="#cb102-2239" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2240"><a href="#cb102-2240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2241"><a href="#cb102-2241" aria-hidden="true" tabindex="-1"></a><span class="fu">###### tibble()</span></span>
<span id="cb102-2242"><a href="#cb102-2242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2243"><a href="#cb102-2243" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; One immediate advantage of labelled vectors is that value labels are</span></span>
<span id="cb102-2244"><a href="#cb102-2244" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; used in data frame printing when using</span></span>
<span id="cb102-2245"><a href="#cb102-2245" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; </span><span class="co">[</span><span class="ot">tibble</span><span class="co">](https://tibble.tidyverse.org/)</span><span class="at"> (and by extension the wider</span></span>
<span id="cb102-2246"><a href="#cb102-2246" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; tidyverse) and other packages using the</span></span>
<span id="cb102-2247"><a href="#cb102-2247" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; </span><span class="co">[</span><span class="ot">pillar</span><span class="co">](https://cran.r-project.org/web/packages/pillar/index.html)</span></span>
<span id="cb102-2248"><a href="#cb102-2248" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; printing methods. ([Survey Research Datasets and</span></span>
<span id="cb102-2249"><a href="#cb102-2249" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; R](https://socialresearchcentre.github.io/r_survey_datasets/what-is-labelled-data.html))</span></span>
<span id="cb102-2250"><a href="#cb102-2250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2251"><a href="#cb102-2251" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb102-2252"><a href="#cb102-2252" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb102-2253"><a href="#cb102-2253" aria-hidden="true" tabindex="-1"></a>::: {#cnj-chap01-tibble-labelled-data}</span>
<span id="cb102-2254"><a href="#cb102-2254" aria-hidden="true" tabindex="-1"></a>: Using <span class="in">`tibble`</span> resp. <span class="in">`pillar`</span> printing methods</span>
<span id="cb102-2255"><a href="#cb102-2255" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2256"><a href="#cb102-2256" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2257"><a href="#cb102-2257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2258"><a href="#cb102-2258" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb102-2259"><a href="#cb102-2259" aria-hidden="true" tabindex="-1"></a>::: {#lst-chap01-tibble-labelled-data}</span>
<span id="cb102-2260"><a href="#cb102-2260" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-2261"><a href="#cb102-2261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2262"><a href="#cb102-2262" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-2263"><a href="#cb102-2263" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tibble-labelled-data</span></span>
<span id="cb102-2264"><a href="#cb102-2264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2265"><a href="#cb102-2265" aria-hidden="true" tabindex="-1"></a>gss_2016_gssr <span class="sc">|&gt;</span> </span>
<span id="cb102-2266"><a href="#cb102-2266" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">count</span>(grass)</span>
<span id="cb102-2267"><a href="#cb102-2267" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-2268"><a href="#cb102-2268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2269"><a href="#cb102-2269" aria-hidden="true" tabindex="-1"></a>Using <span class="in">`tibble`</span> resp. <span class="in">`pillar`</span> printing methods to display NA&#39;s</span>
<span id="cb102-2270"><a href="#cb102-2270" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2271"><a href="#cb102-2271" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2272"><a href="#cb102-2272" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2273"><a href="#cb102-2273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2274"><a href="#cb102-2274" aria-hidden="true" tabindex="-1"></a><span class="fu">###### glimpse()</span></span>
<span id="cb102-2275"><a href="#cb102-2275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2276"><a href="#cb102-2276" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb102-2277"><a href="#cb102-2277" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb102-2278"><a href="#cb102-2278" aria-hidden="true" tabindex="-1"></a>::: {#cnj-chap01-glimpse-labelled-data}</span>
<span id="cb102-2279"><a href="#cb102-2279" aria-hidden="true" tabindex="-1"></a>: Get a glimpse of labelled data</span>
<span id="cb102-2280"><a href="#cb102-2280" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2281"><a href="#cb102-2281" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2282"><a href="#cb102-2282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2283"><a href="#cb102-2283" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb102-2284"><a href="#cb102-2284" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-2285"><a href="#cb102-2285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2286"><a href="#cb102-2286" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-2287"><a href="#cb102-2287" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: glimpse-labelled-data</span></span>
<span id="cb102-2288"><a href="#cb102-2288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2289"><a href="#cb102-2289" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(gss_2016_gssr)</span>
<span id="cb102-2290"><a href="#cb102-2290" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-2291"><a href="#cb102-2291" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2292"><a href="#cb102-2292" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2293"><a href="#cb102-2293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2294"><a href="#cb102-2294" aria-hidden="true" tabindex="-1"></a><span class="fu">###### print()</span></span>
<span id="cb102-2295"><a href="#cb102-2295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2296"><a href="#cb102-2296" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb102-2297"><a href="#cb102-2297" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb102-2298"><a href="#cb102-2298" aria-hidden="true" tabindex="-1"></a>::: {#cnj-chap01-print-labelled-data}</span>
<span id="cb102-2299"><a href="#cb102-2299" aria-hidden="true" tabindex="-1"></a>: Print values as <span class="in">`tibble()`</span> with labelled data</span>
<span id="cb102-2300"><a href="#cb102-2300" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2301"><a href="#cb102-2301" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2302"><a href="#cb102-2302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2303"><a href="#cb102-2303" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb102-2304"><a href="#cb102-2304" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-2305"><a href="#cb102-2305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2306"><a href="#cb102-2306" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-2307"><a href="#cb102-2307" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: print-labelled-data</span></span>
<span id="cb102-2308"><a href="#cb102-2308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2309"><a href="#cb102-2309" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">print</span>(gss_2016_gssr)</span>
<span id="cb102-2310"><a href="#cb102-2310" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-2311"><a href="#cb102-2311" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2312"><a href="#cb102-2312" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2313"><a href="#cb102-2313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2314"><a href="#cb102-2314" aria-hidden="true" tabindex="-1"></a><span class="fu">###### glance_data()</span></span>
<span id="cb102-2315"><a href="#cb102-2315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2316"><a href="#cb102-2316" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb102-2317"><a href="#cb102-2317" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb102-2318"><a href="#cb102-2318" aria-hidden="true" tabindex="-1"></a>::: {#cnj-chap01-glance-labelled-data}</span>
<span id="cb102-2319"><a href="#cb102-2319" aria-hidden="true" tabindex="-1"></a>: Glance randomly at some records with labelled data</span>
<span id="cb102-2320"><a href="#cb102-2320" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2321"><a href="#cb102-2321" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2322"><a href="#cb102-2322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2323"><a href="#cb102-2323" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb102-2324"><a href="#cb102-2324" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-2325"><a href="#cb102-2325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2326"><a href="#cb102-2326" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-2327"><a href="#cb102-2327" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: glance-labelled-data</span></span>
<span id="cb102-2328"><a href="#cb102-2328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2329"><a href="#cb102-2329" aria-hidden="true" tabindex="-1"></a>gss_2016_gssr <span class="sc">|&gt;</span></span>
<span id="cb102-2330"><a href="#cb102-2330" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glance_data</span>(<span class="at">N =</span> <span class="dv">8</span>, <span class="at">seed =</span> <span class="dv">2016</span>)</span>
<span id="cb102-2331"><a href="#cb102-2331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2332"><a href="#cb102-2332" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-2333"><a href="#cb102-2333" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2334"><a href="#cb102-2334" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2335"><a href="#cb102-2335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2336"><a href="#cb102-2336" aria-hidden="true" tabindex="-1"></a><span class="fu">###### RStudio</span></span>
<span id="cb102-2337"><a href="#cb102-2337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2338"><a href="#cb102-2338" aria-hidden="true" tabindex="-1"></a>In RStudio you can see part of the labels by supplying additional</span>
<span id="cb102-2339"><a href="#cb102-2339" aria-hidden="true" tabindex="-1"></a>information about NAs in R code chunks and variable labels in the</span>
<span id="cb102-2340"><a href="#cb102-2340" aria-hidden="true" tabindex="-1"></a>RStudio viewer.</span>
<span id="cb102-2341"><a href="#cb102-2341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2342"><a href="#cb102-2342" aria-hidden="true" tabindex="-1"></a>::: {#fig-rstudio-labelled-data layout-ncol=&quot;2&quot;}</span>
<span id="cb102-2343"><a href="#cb102-2343" aria-hidden="true" tabindex="-1"></a>![Labelled data as a R code chunk result in</span>
<span id="cb102-2344"><a href="#cb102-2344" aria-hidden="true" tabindex="-1"></a>RStudio](img/chap01/rstudio-r-chunk-labelled-data-min.png){#fig-rstudio-chunk}</span>
<span id="cb102-2345"><a href="#cb102-2345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2346"><a href="#cb102-2346" aria-hidden="true" tabindex="-1"></a>![Labelled data in RStudio data</span>
<span id="cb102-2347"><a href="#cb102-2347" aria-hidden="true" tabindex="-1"></a>viewer](img/chap01/rstudio-viewer-labelled-data-min.png){#fig-rstudio-viewer}</span>
<span id="cb102-2348"><a href="#cb102-2348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2349"><a href="#cb102-2349" aria-hidden="true" tabindex="-1"></a>RStudio display of labelled data</span>
<span id="cb102-2350"><a href="#cb102-2350" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2351"><a href="#cb102-2351" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2352"><a href="#cb102-2352" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2353"><a href="#cb102-2353" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2354"><a href="#cb102-2354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2355"><a href="#cb102-2355" aria-hidden="true" tabindex="-1"></a><span class="in">`base::summary()`</span> with data frames that contain labelled data generates</span>
<span id="cb102-2356"><a href="#cb102-2356" aria-hidden="true" tabindex="-1"></a>an error when {**haven**} is not loaded:</span>
<span id="cb102-2357"><a href="#cb102-2357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2358"><a href="#cb102-2358" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; ! </span><span class="in">`summary.haven_labelled()`</span><span class="at"> not implemented.</span></span>
<span id="cb102-2359"><a href="#cb102-2359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2360"><a href="#cb102-2360" aria-hidden="true" tabindex="-1"></a>::: my-important</span>
<span id="cb102-2361"><a href="#cb102-2361" aria-hidden="true" tabindex="-1"></a>::: my-important-header</span>
<span id="cb102-2362"><a href="#cb102-2362" aria-hidden="true" tabindex="-1"></a>Labelled meta data not visible in most base R viewing functions</span>
<span id="cb102-2363"><a href="#cb102-2363" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2364"><a href="#cb102-2364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2365"><a href="#cb102-2365" aria-hidden="true" tabindex="-1"></a>::: my-important-container</span>
<span id="cb102-2366"><a href="#cb102-2366" aria-hidden="true" tabindex="-1"></a>With the exception of <span class="in">`base::str()`</span> labelled meta data are not visible</span>
<span id="cb102-2367"><a href="#cb102-2367" aria-hidden="true" tabindex="-1"></a>when viewing at the printed data.</span>
<span id="cb102-2368"><a href="#cb102-2368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2369"><a href="#cb102-2369" aria-hidden="true" tabindex="-1"></a>And even more important: You can&#39;t see the different types of NA&#39;s</span>
<span id="cb102-2370"><a href="#cb102-2370" aria-hidden="true" tabindex="-1"></a>without specialized functions. &quot;Tagged&quot; (labelled) missing values</span>
<span id="cb102-2371"><a href="#cb102-2371" aria-hidden="true" tabindex="-1"></a>behaves exactly like regular R missing values. For more information see</span>
<span id="cb102-2372"><a href="#cb102-2372" aria-hidden="true" tabindex="-1"></a>@def-chap01-use-labelled-haven-package.</span>
<span id="cb102-2373"><a href="#cb102-2373" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2374"><a href="#cb102-2374" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2375"><a href="#cb102-2375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2376"><a href="#cb102-2376" aria-hidden="true" tabindex="-1"></a><span class="fu">### Working with labelled data {#sec-chap01-labelled-data-3}</span></span>
<span id="cb102-2377"><a href="#cb102-2377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2378"><a href="#cb102-2378" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Two different approaches</span></span>
<span id="cb102-2379"><a href="#cb102-2379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2380"><a href="#cb102-2380" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; The purpose of the labelled package is to provide functions to</span></span>
<span id="cb102-2381"><a href="#cb102-2381" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; manipulate metadata as variable labels, value labels and defined</span></span>
<span id="cb102-2382"><a href="#cb102-2382" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; missing values using the </span><span class="in">`haven_labelled`</span><span class="at"> and </span><span class="in">`haven_labelled_spss`</span></span>
<span id="cb102-2383"><a href="#cb102-2383" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; classes introduced in haven package. ([Introduction to</span></span>
<span id="cb102-2384"><a href="#cb102-2384" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; labelled](https://cran.r-project.org/web/packages/labelled/vignettes/intro_labelled.html))</span></span>
<span id="cb102-2385"><a href="#cb102-2385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2386"><a href="#cb102-2386" aria-hidden="true" tabindex="-1"></a>Until now I have not worked in this book with <span class="in">`haven_labelled_spss`</span></span>
<span id="cb102-2387"><a href="#cb102-2387" aria-hidden="true" tabindex="-1"></a>classes. This class comes from imports of SPSS data files via the</span>
<span id="cb102-2388"><a href="#cb102-2388" aria-hidden="true" tabindex="-1"></a>{**haven**} package.</span>
<span id="cb102-2389"><a href="#cb102-2389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2390"><a href="#cb102-2390" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; This class is only used when </span><span class="in">`user_na = TRUE`</span><span class="at"> in </span><span class="in">`read_sav()`</span><span class="at">. It is</span></span>
<span id="cb102-2391"><a href="#cb102-2391" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; similar to the </span><span class="in">`labelled()`</span><span class="at"> class but it also models SPSS&#39;s</span></span>
<span id="cb102-2392"><a href="#cb102-2392" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; user-defined missings, which can be up to three distinct values, or</span></span>
<span id="cb102-2393"><a href="#cb102-2393" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; for numeric vectors a range. ([Labelled vector for</span></span>
<span id="cb102-2394"><a href="#cb102-2394" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; SPSS](https://haven.tidyverse.org/reference/labelled_spss.html))</span></span>
<span id="cb102-2395"><a href="#cb102-2395" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; </span><span class="ot">[^01-preparing-data-1]</span></span>
<span id="cb102-2396"><a href="#cb102-2396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2397"><a href="#cb102-2397" aria-hidden="true" tabindex="-1"></a><span class="ot">[^01-preparing-data-1]: </span>To prevent conflict with the labelled class from</span>
<span id="cb102-2398"><a href="#cb102-2398" aria-hidden="true" tabindex="-1"></a>    the {**Hmisc**} package {**haven**} has changed with version 2.0.0</span>
<span id="cb102-2399"><a href="#cb102-2399" aria-hidden="true" tabindex="-1"></a>    its label class names from <span class="in">`labelled`</span> and <span class="in">`labelled_spss`</span> to</span>
<span id="cb102-2400"><a href="#cb102-2400" aria-hidden="true" tabindex="-1"></a>    <span class="in">`haven_labelled`</span> and <span class="in">`haven_labelled_spss`</span>. (See [GitHub Issue</span>
<span id="cb102-2401"><a href="#cb102-2401" aria-hidden="true" tabindex="-1"></a>    #329](https://github.com/tidyverse/haven/issues/329).)</span>
<span id="cb102-2402"><a href="#cb102-2402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2403"><a href="#cb102-2403" aria-hidden="true" tabindex="-1"></a>As user-defined missing values are not important here I will stick with</span>
<span id="cb102-2404"><a href="#cb102-2404" aria-hidden="true" tabindex="-1"></a>STATA imports.</span>
<span id="cb102-2405"><a href="#cb102-2405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2406"><a href="#cb102-2406" aria-hidden="true" tabindex="-1"></a>My main interest with @def-chap01-use-labelled-haven-package is to</span>
<span id="cb102-2407"><a href="#cb102-2407" aria-hidden="true" tabindex="-1"></a>prepare and/or use the labelled data to work with R. There are principal</span>
<span id="cb102-2408"><a href="#cb102-2408" aria-hidden="true" tabindex="-1"></a>two approaches:</span>
<span id="cb102-2409"><a href="#cb102-2409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2410"><a href="#cb102-2410" aria-hidden="true" tabindex="-1"></a>::: my-procedure</span>
<span id="cb102-2411"><a href="#cb102-2411" aria-hidden="true" tabindex="-1"></a>::: my-procedure-header</span>
<span id="cb102-2412"><a href="#cb102-2412" aria-hidden="true" tabindex="-1"></a>::: {#prp-chap01-labelled-data-in-r}</span>
<span id="cb102-2413"><a href="#cb102-2413" aria-hidden="true" tabindex="-1"></a>: Two different procedures to work in R with labelled data</span>
<span id="cb102-2414"><a href="#cb102-2414" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2415"><a href="#cb102-2415" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2416"><a href="#cb102-2416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2417"><a href="#cb102-2417" aria-hidden="true" tabindex="-1"></a>::: my-procedure-container</span>
<span id="cb102-2418"><a href="#cb102-2418" aria-hidden="true" tabindex="-1"></a>**Approach A**</span>
<span id="cb102-2419"><a href="#cb102-2419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2420"><a href="#cb102-2420" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; In approach A, </span><span class="in">`haven_labelled`</span><span class="at"> vectors are converted into factors or</span></span>
<span id="cb102-2421"><a href="#cb102-2421" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; into numeric/character vectors just after data import, using</span></span>
<span id="cb102-2422"><a href="#cb102-2422" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; </span><span class="in">`unlabelled()`</span><span class="at">, </span><span class="in">`to_factor()`</span><span class="at"> or </span><span class="in">`unclass()`</span><span class="at">. Then, data cleaning,</span></span>
<span id="cb102-2423"><a href="#cb102-2423" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; recoding and analysis are performed using classic R vector types.</span></span>
<span id="cb102-2424"><a href="#cb102-2424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2425"><a href="#cb102-2425" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Data import</span>
<span id="cb102-2426"><a href="#cb102-2426" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>*Conversion to factor / numeric*</span>
<span id="cb102-2427"><a href="#cb102-2427" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Data cleaning / data recoding</span>
<span id="cb102-2428"><a href="#cb102-2428" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Data analysis</span>
<span id="cb102-2429"><a href="#cb102-2429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2430"><a href="#cb102-2430" aria-hidden="true" tabindex="-1"></a>**Approach B**</span>
<span id="cb102-2431"><a href="#cb102-2431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2432"><a href="#cb102-2432" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; In approach B, </span><span class="in">`haven_labelled`</span><span class="at"> vectors are kept for data cleaning and</span></span>
<span id="cb102-2433"><a href="#cb102-2433" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; coding, allowing to preserved original recoding, in particular if data</span></span>
<span id="cb102-2434"><a href="#cb102-2434" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; should be reexported after that step. Functions provided by labelled</span></span>
<span id="cb102-2435"><a href="#cb102-2435" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; will be useful for managing value labels. However, as in approach A,</span></span>
<span id="cb102-2436"><a href="#cb102-2436" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; </span><span class="in">`haven_labelled`</span><span class="at"> vectors will have to be converted into classic</span></span>
<span id="cb102-2437"><a href="#cb102-2437" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; factors or numeric vectors before data analysis (in particular</span></span>
<span id="cb102-2438"><a href="#cb102-2438" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; modeling) as this is the way categorical and continuous variables</span></span>
<span id="cb102-2439"><a href="#cb102-2439" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; should be coded for analysis functions. ([Introduction to</span></span>
<span id="cb102-2440"><a href="#cb102-2440" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; labelled](https://cran.r-project.org/web/packages/labelled/vignettes/intro_labelled.html))</span></span>
<span id="cb102-2441"><a href="#cb102-2441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2442"><a href="#cb102-2442" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Data import</span>
<span id="cb102-2443"><a href="#cb102-2443" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Data cleaning / data recoding (-<span class="sc">\&gt;</span> Data export to SPSS / SAS / STATA</span>
<span id="cb102-2444"><a href="#cb102-2444" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb102-2445"><a href="#cb102-2445" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>*Conversion to factor / numeric*</span>
<span id="cb102-2446"><a href="#cb102-2446" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Data analysis</span>
<span id="cb102-2447"><a href="#cb102-2447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2448"><a href="#cb102-2448" aria-hidden="true" tabindex="-1"></a>[![Two different approaches to work in R with labelled</span>
<span id="cb102-2449"><a href="#cb102-2449" aria-hidden="true" tabindex="-1"></a>data](img/chap01/labelled-approaches-min.png){#fig-chap01-two-approaches-with-labelled-data}](https://cran.r-project.org/web/packages/labelled/vignettes/intro_labelled.html)</span>
<span id="cb102-2450"><a href="#cb102-2450" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2451"><a href="#cb102-2451" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2452"><a href="#cb102-2452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2453"><a href="#cb102-2453" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Inspecting labelled data</span></span>
<span id="cb102-2454"><a href="#cb102-2454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2455"><a href="#cb102-2455" aria-hidden="true" tabindex="-1"></a>::: my-experiment</span>
<span id="cb102-2456"><a href="#cb102-2456" aria-hidden="true" tabindex="-1"></a>::: my-experiment-header</span>
<span id="cb102-2457"><a href="#cb102-2457" aria-hidden="true" tabindex="-1"></a>::: {#def-chap01-use-labelled-haven-package}</span>
<span id="cb102-2458"><a href="#cb102-2458" aria-hidden="true" tabindex="-1"></a>: Inspecting labelled data</span>
<span id="cb102-2459"><a href="#cb102-2459" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2460"><a href="#cb102-2460" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2461"><a href="#cb102-2461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2462"><a href="#cb102-2462" aria-hidden="true" tabindex="-1"></a>::: my-experiment-container</span>
<span id="cb102-2463"><a href="#cb102-2463" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb102-2464"><a href="#cb102-2464" aria-hidden="true" tabindex="-1"></a><span class="fu">###### var_label()</span></span>
<span id="cb102-2465"><a href="#cb102-2465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2466"><a href="#cb102-2466" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb102-2467"><a href="#cb102-2467" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb102-2468"><a href="#cb102-2468" aria-hidden="true" tabindex="-1"></a>::: {#cnj-chap01-labelled-var-label}</span>
<span id="cb102-2469"><a href="#cb102-2469" aria-hidden="true" tabindex="-1"></a>: Get variable labels of a labelled data frame</span>
<span id="cb102-2470"><a href="#cb102-2470" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2471"><a href="#cb102-2471" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2472"><a href="#cb102-2472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2473"><a href="#cb102-2473" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb102-2474"><a href="#cb102-2474" aria-hidden="true" tabindex="-1"></a>::: {#lst-chap01-labelled-var-label}</span>
<span id="cb102-2475"><a href="#cb102-2475" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-2476"><a href="#cb102-2476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2477"><a href="#cb102-2477" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-2478"><a href="#cb102-2478" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: labelled-var-label</span></span>
<span id="cb102-2479"><a href="#cb102-2479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2480"><a href="#cb102-2480" aria-hidden="true" tabindex="-1"></a>labelled<span class="sc">::</span><span class="fu">var_label</span>(gss_2016_gssr) </span>
<span id="cb102-2481"><a href="#cb102-2481" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-2482"><a href="#cb102-2482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2483"><a href="#cb102-2483" aria-hidden="true" tabindex="-1"></a>Use <span class="in">`labelled::var_label()`</span> to get variables labels of a data frame</span>
<span id="cb102-2484"><a href="#cb102-2484" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2485"><a href="#cb102-2485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2486"><a href="#cb102-2486" aria-hidden="true" tabindex="-1"></a>The labels of the two variable specifies in more detail their content.</span>
<span id="cb102-2487"><a href="#cb102-2487" aria-hidden="true" tabindex="-1"></a>For the <span class="in">`grass`</span> variable we get the question asked in the survey. This</span>
<span id="cb102-2488"><a href="#cb102-2488" aria-hidden="true" tabindex="-1"></a>is very helpful and saves consulting the codebook.</span>
<span id="cb102-2489"><a href="#cb102-2489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2490"><a href="#cb102-2490" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb102-2491"><a href="#cb102-2491" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2492"><a href="#cb102-2492" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2493"><a href="#cb102-2493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2494"><a href="#cb102-2494" aria-hidden="true" tabindex="-1"></a>I am using here the short form with <span class="in">`labelled::var_label()`</span> but there</span>
<span id="cb102-2495"><a href="#cb102-2495" aria-hidden="true" tabindex="-1"></a>exist also with <span class="in">`labelled::get_variable_labels()`</span> a long form which has</span>
<span id="cb102-2496"><a href="#cb102-2496" aria-hidden="true" tabindex="-1"></a>with it plural form a more consistent syntax.</span>
<span id="cb102-2497"><a href="#cb102-2497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2498"><a href="#cb102-2498" aria-hidden="true" tabindex="-1"></a><span class="fu">###### val_labels()</span></span>
<span id="cb102-2499"><a href="#cb102-2499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2500"><a href="#cb102-2500" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb102-2501"><a href="#cb102-2501" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb102-2502"><a href="#cb102-2502" aria-hidden="true" tabindex="-1"></a>::: {#cnj-chap01-labelled-val-labels}</span>
<span id="cb102-2503"><a href="#cb102-2503" aria-hidden="true" tabindex="-1"></a>: Get value labels of data frame variables</span>
<span id="cb102-2504"><a href="#cb102-2504" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2505"><a href="#cb102-2505" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2506"><a href="#cb102-2506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2507"><a href="#cb102-2507" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb102-2508"><a href="#cb102-2508" aria-hidden="true" tabindex="-1"></a>::: {#lst-chap01-labelled-val-labels}</span>
<span id="cb102-2509"><a href="#cb102-2509" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-2510"><a href="#cb102-2510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2511"><a href="#cb102-2511" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-2512"><a href="#cb102-2512" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: labelled-val-labels</span></span>
<span id="cb102-2513"><a href="#cb102-2513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2514"><a href="#cb102-2514" aria-hidden="true" tabindex="-1"></a>labelled<span class="sc">::</span><span class="fu">val_labels</span>(gss_2016_gssr)</span>
<span id="cb102-2515"><a href="#cb102-2515" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-2516"><a href="#cb102-2516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2517"><a href="#cb102-2517" aria-hidden="true" tabindex="-1"></a>Use <span class="in">`labelled::val_labels()`</span> to get value labels of data frame variables</span>
<span id="cb102-2518"><a href="#cb102-2518" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2519"><a href="#cb102-2519" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2520"><a href="#cb102-2520" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2521"><a href="#cb102-2521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2522"><a href="#cb102-2522" aria-hidden="true" tabindex="-1"></a>Important is the start of the list of value labels.</span>
<span id="cb102-2523"><a href="#cb102-2523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2524"><a href="#cb102-2524" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**age**: It shows that the value <span class="in">`89`</span> of variable <span class="in">`age`</span> includes</span>
<span id="cb102-2525"><a href="#cb102-2525" aria-hidden="true" tabindex="-1"></a>    values of <span class="in">`89 and older`</span>. This is important for the analysis and</span>
<span id="cb102-2526"><a href="#cb102-2526" aria-hidden="true" tabindex="-1"></a>    saves the work of recoding as done in</span>
<span id="cb102-2527"><a href="#cb102-2527" aria-hidden="true" tabindex="-1"></a>    @cnj-chap01-repl-data-fig-book.</span>
<span id="cb102-2528"><a href="#cb102-2528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2529"><a href="#cb102-2529" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**grass**: For the <span class="in">`grass`</span> variable we learn that <span class="in">`1`</span> stands for the</span>
<span id="cb102-2530"><a href="#cb102-2530" aria-hidden="true" tabindex="-1"></a>    opinion that Marijuana &quot;should be legal&quot; and two for the opposite.</span>
<span id="cb102-2531"><a href="#cb102-2531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2532"><a href="#cb102-2532" aria-hidden="true" tabindex="-1"></a>What follows is a comprehensive list of NA values used in the survey,</span>
<span id="cb102-2533"><a href="#cb102-2533" aria-hidden="true" tabindex="-1"></a>even if many of these values are not used for the two variables</span>
<span id="cb102-2534"><a href="#cb102-2534" aria-hidden="true" tabindex="-1"></a>considered here.</span>
<span id="cb102-2535"><a href="#cb102-2535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2536"><a href="#cb102-2536" aria-hidden="true" tabindex="-1"></a>We know from @cnj-chap01-tibble-labelled-data that the <span class="in">`grass`</span> variable</span>
<span id="cb102-2537"><a href="#cb102-2537" aria-hidden="true" tabindex="-1"></a>has 1024 NA&#39;s, but we do not know their composition of different NA</span>
<span id="cb102-2538"><a href="#cb102-2538" aria-hidden="true" tabindex="-1"></a>values. See @lst-chap01-haven-na-tag how to get this information.</span>
<span id="cb102-2539"><a href="#cb102-2539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2540"><a href="#cb102-2540" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb102-2541"><a href="#cb102-2541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2542"><a href="#cb102-2542" aria-hidden="true" tabindex="-1"></a>::: my-watch-out</span>
<span id="cb102-2543"><a href="#cb102-2543" aria-hidden="true" tabindex="-1"></a>::: my-watch-out-header</span>
<span id="cb102-2544"><a href="#cb102-2544" aria-hidden="true" tabindex="-1"></a>WATCH OUT! Inconsistency in the function names</span>
<span id="cb102-2545"><a href="#cb102-2545" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2546"><a href="#cb102-2546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2547"><a href="#cb102-2547" aria-hidden="true" tabindex="-1"></a>::: my-watch-out-container</span>
<span id="cb102-2548"><a href="#cb102-2548" aria-hidden="true" tabindex="-1"></a>There is an inconsistency in the singular vs. plural form between</span>
<span id="cb102-2549"><a href="#cb102-2549" aria-hidden="true" tabindex="-1"></a><span class="in">`labelled::var_label()`</span> and <span class="in">`labelled::val_labels()`</span>. Both functions</span>
<span id="cb102-2550"><a href="#cb102-2550" aria-hidden="true" tabindex="-1"></a>show a *list of values* (= plural) if there are more than one label</span>
<span id="cb102-2551"><a href="#cb102-2551" aria-hidden="true" tabindex="-1"></a>available.</span>
<span id="cb102-2552"><a href="#cb102-2552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2553"><a href="#cb102-2553" aria-hidden="true" tabindex="-1"></a>For value labels exist also a singular version with</span>
<span id="cb102-2554"><a href="#cb102-2554" aria-hidden="true" tabindex="-1"></a><span class="in">`labelled::val_label()`</span> to get a specific value label of a variable.</span>
<span id="cb102-2555"><a href="#cb102-2555" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2556"><a href="#cb102-2556" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2557"><a href="#cb102-2557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2558"><a href="#cb102-2558" aria-hidden="true" tabindex="-1"></a><span class="fu">###### head()</span></span>
<span id="cb102-2559"><a href="#cb102-2559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2560"><a href="#cb102-2560" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb102-2561"><a href="#cb102-2561" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb102-2562"><a href="#cb102-2562" aria-hidden="true" tabindex="-1"></a>::: {#cnj-chap01-labelled-head}</span>
<span id="cb102-2563"><a href="#cb102-2563" aria-hidden="true" tabindex="-1"></a>: Using <span class="in">`utils::head()`</span> on a labelled variable after {**labelled**} is</span>
<span id="cb102-2564"><a href="#cb102-2564" aria-hidden="true" tabindex="-1"></a>loaded</span>
<span id="cb102-2565"><a href="#cb102-2565" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2566"><a href="#cb102-2566" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2567"><a href="#cb102-2567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2568"><a href="#cb102-2568" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb102-2569"><a href="#cb102-2569" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-2570"><a href="#cb102-2570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2571"><a href="#cb102-2571" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-2572"><a href="#cb102-2572" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: labelled-head</span></span>
<span id="cb102-2573"><a href="#cb102-2573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2574"><a href="#cb102-2574" aria-hidden="true" tabindex="-1"></a><span class="do">## {**labelled**} is loaded through a call in the previous chunk</span></span>
<span id="cb102-2575"><a href="#cb102-2575" aria-hidden="true" tabindex="-1"></a>utils<span class="sc">::</span><span class="fu">head</span>(gss_2016_gssr<span class="sc">$</span>grass, <span class="dv">10</span>)</span>
<span id="cb102-2576"><a href="#cb102-2576" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-2577"><a href="#cb102-2577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2578"><a href="#cb102-2578" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb102-2579"><a href="#cb102-2579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2580"><a href="#cb102-2580" aria-hidden="true" tabindex="-1"></a>Using <span class="in">`utils::head()`</span> on a variable when {**labelled**} is loaded prints</span>
<span id="cb102-2581"><a href="#cb102-2581" aria-hidden="true" tabindex="-1"></a>a nicely formatted summary of the attached metadata, excluding formats.</span>
<span id="cb102-2582"><a href="#cb102-2582" aria-hidden="true" tabindex="-1"></a>It shows all NA value labels in the data frame used in the survey, even</span>
<span id="cb102-2583"><a href="#cb102-2583" aria-hidden="true" tabindex="-1"></a>only some of them is used here. (See @lst-chap01-haven-na-tag to get</span>
<span id="cb102-2584"><a href="#cb102-2584" aria-hidden="true" tabindex="-1"></a>type of NA&#39;s used for a variable.)</span>
<span id="cb102-2585"><a href="#cb102-2585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2586"><a href="#cb102-2586" aria-hidden="true" tabindex="-1"></a>We see in the first 10 records of the variable <span class="in">`grass`</span></span>
<span id="cb102-2587"><a href="#cb102-2587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2588"><a href="#cb102-2588" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>three <span class="in">`1`</span> (&quot;should be legal&quot;)</span>
<span id="cb102-2589"><a href="#cb102-2589" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>three <span class="in">`2`</span> (&quot;should not be legal&quot;) and</span>
<span id="cb102-2590"><a href="#cb102-2590" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>four <span class="in">`NA(i)`</span> (&quot;iap&quot;)</span>
<span id="cb102-2591"><a href="#cb102-2591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2592"><a href="#cb102-2592" aria-hidden="true" tabindex="-1"></a>Until now it is not clear what &quot;iap&quot; for the <span class="in">`NA(i)`</span> type means. If we</span>
<span id="cb102-2593"><a href="#cb102-2593" aria-hidden="true" tabindex="-1"></a>want [download (STATA) files directly from the GSS</span>
<span id="cb102-2594"><a href="#cb102-2594" aria-hidden="true" tabindex="-1"></a>website](https://gss.norc.org/get-the-data/stata) we see on the right</span>
<span id="cb102-2595"><a href="#cb102-2595" aria-hidden="true" tabindex="-1"></a>side a note about the most important <span class="in">`NA`</span> types. It explains the the</span>
<span id="cb102-2596"><a href="#cb102-2596" aria-hidden="true" tabindex="-1"></a>abbreviation &quot;iap&quot; stands for &quot;inapplicable&quot;.</span>
<span id="cb102-2597"><a href="#cb102-2597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2598"><a href="#cb102-2598" aria-hidden="true" tabindex="-1"></a>[![GSS Information about the most important NA</span>
<span id="cb102-2599"><a href="#cb102-2599" aria-hidden="true" tabindex="-1"></a>types](img/chap01/na-gss-website-note-min.png){#fig-chap01-gss-na-note</span>
<span id="cb102-2600"><a href="#cb102-2600" aria-hidden="true" tabindex="-1"></a>fig-alt=&quot;An \&quot;Alerts\&quot; explains that there are three main missing values in the data; \&quot;.i\&quot;: Inapplicable (IAP). Respondents whor are not asked to answer a specific question are assigned to IAP.\&quot;.d\&quot;: Don&#39;t know (DK). \&quot;.n\&quot;: No answer (NA).&quot;</span>
<span id="cb102-2601"><a href="#cb102-2601" aria-hidden="true" tabindex="-1"></a>fig-align=&quot;center&quot;}](https://gss.norc.org/get-the-data/stata)</span>
<span id="cb102-2602"><a href="#cb102-2602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2603"><a href="#cb102-2603" aria-hidden="true" tabindex="-1"></a>::: my-note</span>
<span id="cb102-2604"><a href="#cb102-2604" aria-hidden="true" tabindex="-1"></a>::: my-note-header</span>
<span id="cb102-2605"><a href="#cb102-2605" aria-hidden="true" tabindex="-1"></a>Two different meanings of &quot;NA&quot;</span>
<span id="cb102-2606"><a href="#cb102-2606" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2607"><a href="#cb102-2607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2608"><a href="#cb102-2608" aria-hidden="true" tabindex="-1"></a>::: my-note-container</span>
<span id="cb102-2609"><a href="#cb102-2609" aria-hidden="true" tabindex="-1"></a>With the <span class="in">`NA(n)`</span> type of missing value &quot;NA&quot; does not mean &quot;Not</span>
<span id="cb102-2610"><a href="#cb102-2610" aria-hidden="true" tabindex="-1"></a>Applicable&quot; but &quot;No answer&quot;.</span>
<span id="cb102-2611"><a href="#cb102-2611" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2612"><a href="#cb102-2612" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2613"><a href="#cb102-2613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2614"><a href="#cb102-2614" aria-hidden="true" tabindex="-1"></a>Returning only the <span class="in">`NA(i)`</span> type of a missing value does not mean that</span>
<span id="cb102-2615"><a href="#cb102-2615" aria-hidden="true" tabindex="-1"></a>there aren&#39;t any other NA types in the data. (See</span>
<span id="cb102-2616"><a href="#cb102-2616" aria-hidden="true" tabindex="-1"></a>@lst-chap01-labelled-print-unique-tagged to get the types of tagged NA&#39;s</span>
<span id="cb102-2617"><a href="#cb102-2617" aria-hidden="true" tabindex="-1"></a>of a variable.)</span>
<span id="cb102-2618"><a href="#cb102-2618" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2619"><a href="#cb102-2619" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2620"><a href="#cb102-2620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2621"><a href="#cb102-2621" aria-hidden="true" tabindex="-1"></a>This formatted result of labelled data is better readable as with</span>
<span id="cb102-2622"><a href="#cb102-2622" aria-hidden="true" tabindex="-1"></a>@lst-chap01-labelled-val-labels, because category and value are in the</span>
<span id="cb102-2623"><a href="#cb102-2623" aria-hidden="true" tabindex="-1"></a>same line. Compare the result of this code ({**labelled**} is loaded)</span>
<span id="cb102-2624"><a href="#cb102-2624" aria-hidden="true" tabindex="-1"></a>with @lst-chap01-head-labelled-data ({**labelled**} is not loaded).</span>
<span id="cb102-2625"><a href="#cb102-2625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2626"><a href="#cb102-2626" aria-hidden="true" tabindex="-1"></a>::: my-note</span>
<span id="cb102-2627"><a href="#cb102-2627" aria-hidden="true" tabindex="-1"></a>::: my-note-header</span>
<span id="cb102-2628"><a href="#cb102-2628" aria-hidden="true" tabindex="-1"></a>haven::print_labels() as equivalent of head() with {**labelled**} loaded</span>
<span id="cb102-2629"><a href="#cb102-2629" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2630"><a href="#cb102-2630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2631"><a href="#cb102-2631" aria-hidden="true" tabindex="-1"></a>::: my-note-container</span>
<span id="cb102-2632"><a href="#cb102-2632" aria-hidden="true" tabindex="-1"></a>With the exception of the specified rows in the <span class="in">`head()`</span> function, you</span>
<span id="cb102-2633"><a href="#cb102-2633" aria-hidden="true" tabindex="-1"></a>can get the same nicely formatted list of NA types with</span>
<span id="cb102-2634"><a href="#cb102-2634" aria-hidden="true" tabindex="-1"></a><span class="in">`haven::print_labels()`</span>. (See next tab &quot;Print labels&quot;.)</span>
<span id="cb102-2635"><a href="#cb102-2635" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2636"><a href="#cb102-2636" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2637"><a href="#cb102-2637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2638"><a href="#cb102-2638" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Print labels</span></span>
<span id="cb102-2639"><a href="#cb102-2639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2640"><a href="#cb102-2640" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb102-2641"><a href="#cb102-2641" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb102-2642"><a href="#cb102-2642" aria-hidden="true" tabindex="-1"></a>::: {#cnj-chap01-haven-print-labels}</span>
<span id="cb102-2643"><a href="#cb102-2643" aria-hidden="true" tabindex="-1"></a>: Print labels</span>
<span id="cb102-2644"><a href="#cb102-2644" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2645"><a href="#cb102-2645" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2646"><a href="#cb102-2646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2647"><a href="#cb102-2647" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb102-2648"><a href="#cb102-2648" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-2649"><a href="#cb102-2649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2650"><a href="#cb102-2650" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-2651"><a href="#cb102-2651" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: haven-print-labels</span></span>
<span id="cb102-2652"><a href="#cb102-2652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2653"><a href="#cb102-2653" aria-hidden="true" tabindex="-1"></a>haven<span class="sc">::</span><span class="fu">print_labels</span>(gss_2016_gssr<span class="sc">$</span>grass)</span>
<span id="cb102-2654"><a href="#cb102-2654" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-2655"><a href="#cb102-2655" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2656"><a href="#cb102-2656" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2657"><a href="#cb102-2657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2658"><a href="#cb102-2658" aria-hidden="true" tabindex="-1"></a>For a detailed explication see previous tab &quot;head()&quot;.</span>
<span id="cb102-2659"><a href="#cb102-2659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2660"><a href="#cb102-2660" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Unique NA&#39;s</span></span>
<span id="cb102-2661"><a href="#cb102-2661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2662"><a href="#cb102-2662" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb102-2663"><a href="#cb102-2663" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb102-2664"><a href="#cb102-2664" aria-hidden="true" tabindex="-1"></a>::: {#cnj-chap01-labelled-print-unique-tagged}</span>
<span id="cb102-2665"><a href="#cb102-2665" aria-hidden="true" tabindex="-1"></a>: Print unique tagged NA&#39;s</span>
<span id="cb102-2666"><a href="#cb102-2666" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2667"><a href="#cb102-2667" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2668"><a href="#cb102-2668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2669"><a href="#cb102-2669" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb102-2670"><a href="#cb102-2670" aria-hidden="true" tabindex="-1"></a>::: {#lst-chap01-labelled-print-unique-tagged}</span>
<span id="cb102-2671"><a href="#cb102-2671" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-2672"><a href="#cb102-2672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2673"><a href="#cb102-2673" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-2674"><a href="#cb102-2674" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: labelled-print-unique-tagged</span></span>
<span id="cb102-2675"><a href="#cb102-2675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2676"><a href="#cb102-2676" aria-hidden="true" tabindex="-1"></a>labelled<span class="sc">::</span><span class="fu">unique_tagged_na</span>(gss_2016_gssr<span class="sc">$</span>grass) <span class="sc">|&gt;</span> </span>
<span id="cb102-2677"><a href="#cb102-2677" aria-hidden="true" tabindex="-1"></a>    labelled<span class="sc">::</span><span class="fu">sort_tagged_na</span>() <span class="sc">|&gt;</span> </span>
<span id="cb102-2678"><a href="#cb102-2678" aria-hidden="true" tabindex="-1"></a>    haven<span class="sc">::</span><span class="fu">print_tagged_na</span>()</span>
<span id="cb102-2679"><a href="#cb102-2679" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-2680"><a href="#cb102-2680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2681"><a href="#cb102-2681" aria-hidden="true" tabindex="-1"></a>Show the unique types of NA&#39;s of a variable</span>
<span id="cb102-2682"><a href="#cb102-2682" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2683"><a href="#cb102-2683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2684"><a href="#cb102-2684" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb102-2685"><a href="#cb102-2685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2686"><a href="#cb102-2686" aria-hidden="true" tabindex="-1"></a>We see that variable <span class="in">`grass`</span> has three types of NA&#39;s:</span>
<span id="cb102-2687"><a href="#cb102-2687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2688"><a href="#cb102-2688" aria-hidden="true" tabindex="-1"></a><span class="in">`NA(d)`</span>: Don&#39;t know. <span class="in">`NA(i)`</span>: Inapplicable, e.g., these respondents were</span>
<span id="cb102-2689"><a href="#cb102-2689" aria-hidden="true" tabindex="-1"></a>not asked the marijuana question. <span class="in">`NA(n)`</span>: No answer</span>
<span id="cb102-2690"><a href="#cb102-2690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2691"><a href="#cb102-2691" aria-hidden="true" tabindex="-1"></a>Here I have used <span class="in">`haven::print_tagged_na()`</span> to format tagged NA&#39;s as</span>
<span id="cb102-2692"><a href="#cb102-2692" aria-hidden="true" tabindex="-1"></a><span class="in">`NA(a)`</span>, <span class="in">`NA(b)`</span>, etc. (See [&quot;Tagged&quot; missing</span>
<span id="cb102-2693"><a href="#cb102-2693" aria-hidden="true" tabindex="-1"></a>values](https://haven.tidyverse.org/reference/tagged_na.html))</span>
<span id="cb102-2694"><a href="#cb102-2694" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2695"><a href="#cb102-2695" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2696"><a href="#cb102-2696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2697"><a href="#cb102-2697" aria-hidden="true" tabindex="-1"></a>It would be interesting to know the composition of these different NA</span>
<span id="cb102-2698"><a href="#cb102-2698" aria-hidden="true" tabindex="-1"></a>types. One could reason that there is a big difference between &quot;question</span>
<span id="cb102-2699"><a href="#cb102-2699" aria-hidden="true" tabindex="-1"></a>not asked&quot; and &quot;no answer&quot;. (See @lst-chap01-haven-na-tag to get the</span>
<span id="cb102-2700"><a href="#cb102-2700" aria-hidden="true" tabindex="-1"></a>composition of the NA types.)</span>
<span id="cb102-2701"><a href="#cb102-2701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2702"><a href="#cb102-2702" aria-hidden="true" tabindex="-1"></a><span class="fu">###### NA composition</span></span>
<span id="cb102-2703"><a href="#cb102-2703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2704"><a href="#cb102-2704" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb102-2705"><a href="#cb102-2705" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb102-2706"><a href="#cb102-2706" aria-hidden="true" tabindex="-1"></a>::: {#cnj-chap01-haven-na-tag}</span>
<span id="cb102-2707"><a href="#cb102-2707" aria-hidden="true" tabindex="-1"></a>: Get the composition of the different types of tagged NA&#39;s</span>
<span id="cb102-2708"><a href="#cb102-2708" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2709"><a href="#cb102-2709" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2710"><a href="#cb102-2710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2711"><a href="#cb102-2711" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb102-2712"><a href="#cb102-2712" aria-hidden="true" tabindex="-1"></a>::: {#lst-chap01-haven-na-tag}</span>
<span id="cb102-2713"><a href="#cb102-2713" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-2714"><a href="#cb102-2714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2715"><a href="#cb102-2715" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-2716"><a href="#cb102-2716" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: haven-na-tagged</span></span>
<span id="cb102-2717"><a href="#cb102-2717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2718"><a href="#cb102-2718" aria-hidden="true" tabindex="-1"></a>gss_2016_gssr <span class="sc">|&gt;</span></span>
<span id="cb102-2719"><a href="#cb102-2719" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">count</span>(</span>
<span id="cb102-2720"><a href="#cb102-2720" aria-hidden="true" tabindex="-1"></a>    grass,</span>
<span id="cb102-2721"><a href="#cb102-2721" aria-hidden="true" tabindex="-1"></a>    haven<span class="sc">::</span><span class="fu">na_tag</span>(grass)</span>
<span id="cb102-2722"><a href="#cb102-2722" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb102-2723"><a href="#cb102-2723" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-2724"><a href="#cb102-2724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2725"><a href="#cb102-2725" aria-hidden="true" tabindex="-1"></a>Get the composition of the different types of tagged NA&#39;s</span>
<span id="cb102-2726"><a href="#cb102-2726" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2727"><a href="#cb102-2727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2728"><a href="#cb102-2728" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb102-2729"><a href="#cb102-2729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2730"><a href="#cb102-2730" aria-hidden="true" tabindex="-1"></a>We already know from @lst-chap01-tibble-labelled-data that the variable</span>
<span id="cb102-2731"><a href="#cb102-2731" aria-hidden="true" tabindex="-1"></a><span class="in">`grass`</span> has 1024 NA&#39;s. Now we know also the type composition of these</span>
<span id="cb102-2732"><a href="#cb102-2732" aria-hidden="true" tabindex="-1"></a>NA&#39;s.</span>
<span id="cb102-2733"><a href="#cb102-2733" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2734"><a href="#cb102-2734" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2735"><a href="#cb102-2735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2736"><a href="#cb102-2736" aria-hidden="true" tabindex="-1"></a>I could not find a similar function in {**labelled**}, so I have used</span>
<span id="cb102-2737"><a href="#cb102-2737" aria-hidden="true" tabindex="-1"></a>here <span class="in">`haven::na_tag()`</span>.</span>
<span id="cb102-2738"><a href="#cb102-2738" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2739"><a href="#cb102-2739" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2740"><a href="#cb102-2740" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2741"><a href="#cb102-2741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2742"><a href="#cb102-2742" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Working with labelled data</span></span>
<span id="cb102-2743"><a href="#cb102-2743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2744"><a href="#cb102-2744" aria-hidden="true" tabindex="-1"></a>There are two ways to work with labelled data in R:</span>
<span id="cb102-2745"><a href="#cb102-2745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2746"><a href="#cb102-2746" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; The goal of haven is not to provide a labelled vector that you can use</span></span>
<span id="cb102-2747"><a href="#cb102-2747" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; everywhere in your analysis. The goal is to provide an intermediate</span></span>
<span id="cb102-2748"><a href="#cb102-2748" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; datastructure that you can convert into a regular R data frame. You</span></span>
<span id="cb102-2749"><a href="#cb102-2749" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; can do this by either converting to a factor or stripping the labels</span></span>
<span id="cb102-2750"><a href="#cb102-2750" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; ({**Haven**} vignette [Conversion</span></span>
<span id="cb102-2751"><a href="#cb102-2751" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; semantics](https://haven.tidyverse.org/articles/semantics.html))</span></span>
<span id="cb102-2752"><a href="#cb102-2752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2753"><a href="#cb102-2753" aria-hidden="true" tabindex="-1"></a>::: my-experiment</span>
<span id="cb102-2754"><a href="#cb102-2754" aria-hidden="true" tabindex="-1"></a>::: my-experiment-header</span>
<span id="cb102-2755"><a href="#cb102-2755" aria-hidden="true" tabindex="-1"></a>::: {#def-conversion-labelled-data}</span>
<span id="cb102-2756"><a href="#cb102-2756" aria-hidden="true" tabindex="-1"></a>: How to convert labelled data for data analysis in R</span>
<span id="cb102-2757"><a href="#cb102-2757" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2758"><a href="#cb102-2758" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2759"><a href="#cb102-2759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2760"><a href="#cb102-2760" aria-hidden="true" tabindex="-1"></a>::: my-experiment-container</span>
<span id="cb102-2761"><a href="#cb102-2761" aria-hidden="true" tabindex="-1"></a>The second variable <span class="in">`grass`</span> is the labelled original variable. The third</span>
<span id="cb102-2762"><a href="#cb102-2762" aria-hidden="true" tabindex="-1"></a>variable (last column to the right) is the modified <span class="in">`grass`</span> variable.</span>
<span id="cb102-2763"><a href="#cb102-2763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2764"><a href="#cb102-2764" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb102-2765"><a href="#cb102-2765" aria-hidden="true" tabindex="-1"></a><span class="fu">###### as_factor()</span></span>
<span id="cb102-2766"><a href="#cb102-2766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2767"><a href="#cb102-2767" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb102-2768"><a href="#cb102-2768" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb102-2769"><a href="#cb102-2769" aria-hidden="true" tabindex="-1"></a>::: {#cnj-chap01-haven-as-factor}</span>
<span id="cb102-2770"><a href="#cb102-2770" aria-hidden="true" tabindex="-1"></a>: Convert labelled vectors to factors</span>
<span id="cb102-2771"><a href="#cb102-2771" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2772"><a href="#cb102-2772" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2773"><a href="#cb102-2773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2774"><a href="#cb102-2774" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb102-2775"><a href="#cb102-2775" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-2776"><a href="#cb102-2776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2777"><a href="#cb102-2777" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-2778"><a href="#cb102-2778" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: haven-as-factor</span></span>
<span id="cb102-2779"><a href="#cb102-2779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2780"><a href="#cb102-2780" aria-hidden="true" tabindex="-1"></a>gss_2016_grass <span class="ot">&lt;-</span> gss_2016_gssr <span class="sc">|&gt;</span> </span>
<span id="cb102-2781"><a href="#cb102-2781" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(grass)</span>
<span id="cb102-2782"><a href="#cb102-2782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2783"><a href="#cb102-2783" aria-hidden="true" tabindex="-1"></a>gss_2016_grass <span class="sc">|&gt;</span> </span>
<span id="cb102-2784"><a href="#cb102-2784" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">grass_factor =</span> haven<span class="sc">::</span><span class="fu">as_factor</span>(grass)) <span class="sc">|&gt;</span> </span>
<span id="cb102-2785"><a href="#cb102-2785" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glance_data</span>(<span class="at">N =</span> <span class="dv">8</span>, <span class="at">seed =</span> <span class="dv">42</span>)</span>
<span id="cb102-2786"><a href="#cb102-2786" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-2787"><a href="#cb102-2787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2788"><a href="#cb102-2788" aria-hidden="true" tabindex="-1"></a>Here I am using <span class="in">`haven::as_factor()`</span>. This function also knows how to</span>
<span id="cb102-2789"><a href="#cb102-2789" aria-hidden="true" tabindex="-1"></a>re-label missing values.</span>
<span id="cb102-2790"><a href="#cb102-2790" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2791"><a href="#cb102-2791" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2792"><a href="#cb102-2792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2793"><a href="#cb102-2793" aria-hidden="true" tabindex="-1"></a><span class="fu">###### zap_labels()</span></span>
<span id="cb102-2794"><a href="#cb102-2794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2795"><a href="#cb102-2795" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb102-2796"><a href="#cb102-2796" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb102-2797"><a href="#cb102-2797" aria-hidden="true" tabindex="-1"></a>::: {#cnj-chap01-haven-zap-labels}</span>
<span id="cb102-2798"><a href="#cb102-2798" aria-hidden="true" tabindex="-1"></a>: Remove labels</span>
<span id="cb102-2799"><a href="#cb102-2799" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2800"><a href="#cb102-2800" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2801"><a href="#cb102-2801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2802"><a href="#cb102-2802" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb102-2803"><a href="#cb102-2803" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-2804"><a href="#cb102-2804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2805"><a href="#cb102-2805" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-2806"><a href="#cb102-2806" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: haven-zap-labels</span></span>
<span id="cb102-2807"><a href="#cb102-2807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2808"><a href="#cb102-2808" aria-hidden="true" tabindex="-1"></a>gss_2016_grass <span class="sc">|&gt;</span> </span>
<span id="cb102-2809"><a href="#cb102-2809" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">grass_unlabelled =</span> haven<span class="sc">::</span><span class="fu">zap_labels</span>(grass)) <span class="sc">|&gt;</span> </span>
<span id="cb102-2810"><a href="#cb102-2810" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glance_data</span>(<span class="at">N =</span> <span class="dv">8</span>, <span class="at">seed =</span> <span class="dv">42</span>)</span>
<span id="cb102-2811"><a href="#cb102-2811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2812"><a href="#cb102-2812" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-2813"><a href="#cb102-2813" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2814"><a href="#cb102-2814" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2815"><a href="#cb102-2815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2816"><a href="#cb102-2816" aria-hidden="true" tabindex="-1"></a><span class="fu">###### zap_missing()</span></span>
<span id="cb102-2817"><a href="#cb102-2817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2818"><a href="#cb102-2818" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb102-2819"><a href="#cb102-2819" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb102-2820"><a href="#cb102-2820" aria-hidden="true" tabindex="-1"></a>::: {#cnj-chap01-haven-zap-missing}</span>
<span id="cb102-2821"><a href="#cb102-2821" aria-hidden="true" tabindex="-1"></a>: Convert special missings to regular R missings</span>
<span id="cb102-2822"><a href="#cb102-2822" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2823"><a href="#cb102-2823" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2824"><a href="#cb102-2824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2825"><a href="#cb102-2825" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb102-2826"><a href="#cb102-2826" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-2827"><a href="#cb102-2827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2828"><a href="#cb102-2828" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-2829"><a href="#cb102-2829" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: haven-zap-missing</span></span>
<span id="cb102-2830"><a href="#cb102-2830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2831"><a href="#cb102-2831" aria-hidden="true" tabindex="-1"></a>gss_2016_grass <span class="sc">|&gt;</span> </span>
<span id="cb102-2832"><a href="#cb102-2832" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">grass_rgular_na =</span> haven<span class="sc">::</span><span class="fu">zap_missing</span>(grass)) <span class="sc">|&gt;</span> </span>
<span id="cb102-2833"><a href="#cb102-2833" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glance_data</span>(<span class="at">N =</span> <span class="dv">8</span>, <span class="at">seed =</span> <span class="dv">42</span>)</span>
<span id="cb102-2834"><a href="#cb102-2834" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-2835"><a href="#cb102-2835" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2836"><a href="#cb102-2836" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2837"><a href="#cb102-2837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2838"><a href="#cb102-2838" aria-hidden="true" tabindex="-1"></a><span class="fu">###### zap_label()</span></span>
<span id="cb102-2839"><a href="#cb102-2839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2840"><a href="#cb102-2840" aria-hidden="true" tabindex="-1"></a>::: my-r-code</span>
<span id="cb102-2841"><a href="#cb102-2841" aria-hidden="true" tabindex="-1"></a>::: my-r-code-header</span>
<span id="cb102-2842"><a href="#cb102-2842" aria-hidden="true" tabindex="-1"></a>::: {#cnj-chap01-haven-zap-label}</span>
<span id="cb102-2843"><a href="#cb102-2843" aria-hidden="true" tabindex="-1"></a>: Remove variable labels from a data frame</span>
<span id="cb102-2844"><a href="#cb102-2844" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2845"><a href="#cb102-2845" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2846"><a href="#cb102-2846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2847"><a href="#cb102-2847" aria-hidden="true" tabindex="-1"></a>::: my-r-code-container</span>
<span id="cb102-2848"><a href="#cb102-2848" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-2849"><a href="#cb102-2849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2850"><a href="#cb102-2850" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-2851"><a href="#cb102-2851" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: haven-zap-label</span></span>
<span id="cb102-2852"><a href="#cb102-2852" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb102-2853"><a href="#cb102-2853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2854"><a href="#cb102-2854" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;*******   Original data frame   ********&quot;</span>)</span>
<span id="cb102-2855"><a href="#cb102-2855" aria-hidden="true" tabindex="-1"></a>labelled<span class="sc">::</span><span class="fu">var_label</span>(gss_2016_gssr)</span>
<span id="cb102-2856"><a href="#cb102-2856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2857"><a href="#cb102-2857" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;*******   Data frame after variable zapped   *******&quot;</span>)</span>
<span id="cb102-2858"><a href="#cb102-2858" aria-hidden="true" tabindex="-1"></a>gss_2016_gssr <span class="sc">|&gt;</span> </span>
<span id="cb102-2859"><a href="#cb102-2859" aria-hidden="true" tabindex="-1"></a>    haven<span class="sc">::</span><span class="fu">zap_label</span>() <span class="sc">|&gt;</span> </span>
<span id="cb102-2860"><a href="#cb102-2860" aria-hidden="true" tabindex="-1"></a>    labelled<span class="sc">::</span><span class="fu">var_label</span>()</span>
<span id="cb102-2861"><a href="#cb102-2861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2862"><a href="#cb102-2862" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-2863"><a href="#cb102-2863" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2864"><a href="#cb102-2864" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2865"><a href="#cb102-2865" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2866"><a href="#cb102-2866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2867"><a href="#cb102-2867" aria-hidden="true" tabindex="-1"></a>You can combine all three zap-commands.</span>
<span id="cb102-2868"><a href="#cb102-2868" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2869"><a href="#cb102-2869" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2870"><a href="#cb102-2870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2871"><a href="#cb102-2871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2872"><a href="#cb102-2872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2873"><a href="#cb102-2873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2874"><a href="#cb102-2874" aria-hidden="true" tabindex="-1"></a><span class="fu">## Table excursion</span></span>
<span id="cb102-2875"><a href="#cb102-2875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2876"><a href="#cb102-2876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2877"><a href="#cb102-2877" aria-hidden="true" tabindex="-1"></a><span class="fu">### Review several table packages {#sec-chap01-review-table-packages}</span></span>
<span id="cb102-2878"><a href="#cb102-2878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2879"><a href="#cb102-2879" aria-hidden="true" tabindex="-1"></a>Creating tables is an important result of preparing data --- the main subject of this section. In my research I came up with eight packages that seems to me the most important ones. What follows is a short introduction into these packages.</span>
<span id="cb102-2880"><a href="#cb102-2880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2881"><a href="#cb102-2881" aria-hidden="true" tabindex="-1"></a>:::::{.my-experiment}</span>
<span id="cb102-2882"><a href="#cb102-2882" aria-hidden="true" tabindex="-1"></a>:::{.my-experiment-header}</span>
<span id="cb102-2883"><a href="#cb102-2883" aria-hidden="true" tabindex="-1"></a>:::::: {#def-chap01-review-table-packages}</span>
<span id="cb102-2884"><a href="#cb102-2884" aria-hidden="true" tabindex="-1"></a>: Review table packages: {**DT**}, {**flextable**}, {**gt**}, {**gtsummary**}, {**htmlTable**}, {**kableExtra**}, {**tableone**}, {**xtable**}</span>
<span id="cb102-2885"><a href="#cb102-2885" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb102-2886"><a href="#cb102-2886" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2887"><a href="#cb102-2887" aria-hidden="true" tabindex="-1"></a>::::{.my-experiment-container}</span>
<span id="cb102-2888"><a href="#cb102-2888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2889"><a href="#cb102-2889" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb102-2890"><a href="#cb102-2890" aria-hidden="true" tabindex="-1"></a><span class="fu">###### DT</span></span>
<span id="cb102-2891"><a href="#cb102-2891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2892"><a href="#cb102-2892" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">{**DT**}</span><span class="co">](https://rstudio.github.io/DT/)</span></span>
<span id="cb102-2893"><a href="#cb102-2893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2894"><a href="#cb102-2894" aria-hidden="true" tabindex="-1"></a>DT is an abbreviation of &#39;DataTables.&#39; Data objects in R can be rendered as HTML tables using the JavaScript library &#39;DataTables&#39; (typically via R Markdown or Shiny). </span>
<span id="cb102-2895"><a href="#cb102-2895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2896"><a href="#cb102-2896" aria-hidden="true" tabindex="-1"></a>This R package provides an enhanced version of data.frames with more options for authors and users:</span>
<span id="cb102-2897"><a href="#cb102-2897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2898"><a href="#cb102-2898" aria-hidden="true" tabindex="-1"></a>**Authors**: DT supports data wrangling beside subsetting rows and selecting columns (e.g., computing on columns, sort, grouping). I am not sure if this is really an advantage because it requires the somewhat complex square brackets notation. Using {**dplyr**}  with other {**tidyverse**} packages seems --- for me at least --- easier to use.</span>
<span id="cb102-2899"><a href="#cb102-2899" aria-hidden="true" tabindex="-1"></a>**Users**: The really advantage of {**DT**} in my opinion is that the interface allows users to change values and display formats interactively. There are some option in the standard installations and much more with extensions.</span>
<span id="cb102-2900"><a href="#cb102-2900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2901"><a href="#cb102-2901" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Standard**: Out of the box {**DT**} allows user to </span>
<span id="cb102-2902"><a href="#cb102-2902" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>search, </span>
<span id="cb102-2903"><a href="#cb102-2903" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>sort, </span>
<span id="cb102-2904"><a href="#cb102-2904" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>choose the number of rows shown per page, </span>
<span id="cb102-2905"><a href="#cb102-2905" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>filter columns </span>
<span id="cb102-2906"><a href="#cb102-2906" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>add/remove row names and even </span>
<span id="cb102-2907"><a href="#cb102-2907" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>edit cells individually. </span>
<span id="cb102-2908"><a href="#cb102-2908" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Extensions**: There are also some extension to enhance the interactive options: Extensions allow users to </span>
<span id="cb102-2909"><a href="#cb102-2909" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>edit groups of cells, </span>
<span id="cb102-2910"><a href="#cb102-2910" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>provide buttons for copying or downloading the table in different formats, </span>
<span id="cb102-2911"><a href="#cb102-2911" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>to re-order and/or hide columns, </span>
<span id="cb102-2912"><a href="#cb102-2912" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>to fix columns and/or header if the table is too wide and/or to long and you have to scroll, </span>
<span id="cb102-2913"><a href="#cb102-2913" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>moving around with arrow keys like in Excel tables, </span>
<span id="cb102-2914"><a href="#cb102-2914" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>making the table responsive to smaller screens by collapsing columns, </span>
<span id="cb102-2915"><a href="#cb102-2915" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>grouping values by a column, </span>
<span id="cb102-2916"><a href="#cb102-2916" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>reordering rows, </span>
<span id="cb102-2917"><a href="#cb102-2917" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>scrolling through the rows and </span>
<span id="cb102-2918"><a href="#cb102-2918" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>selecting parts of variables interactively.</span>
<span id="cb102-2919"><a href="#cb102-2919" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb102-2920"><a href="#cb102-2920" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb102-2921"><a href="#cb102-2921" aria-hidden="true" tabindex="-1"></a>:::::{.my-note}</span>
<span id="cb102-2922"><a href="#cb102-2922" aria-hidden="true" tabindex="-1"></a>:::{.my-note-header}</span>
<span id="cb102-2923"><a href="#cb102-2923" aria-hidden="true" tabindex="-1"></a>My conclusion to {**DT**}</span>
<span id="cb102-2924"><a href="#cb102-2924" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2925"><a href="#cb102-2925" aria-hidden="true" tabindex="-1"></a>::::{.my-note-container}</span>
<span id="cb102-2926"><a href="#cb102-2926" aria-hidden="true" tabindex="-1"></a>{**DT**} is my first choice for interactive data exploring and very useful for Explorative Data Analysis (<span class="in">`r glossary(&quot;EDA&quot;)`</span>). I have already some experiences with this package but haven&#39;t use it lastly. </span>
<span id="cb102-2927"><a href="#cb102-2927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2928"><a href="#cb102-2928" aria-hidden="true" tabindex="-1"></a>Compared with the other table packages {**DT**} is not in the same category: The following packages are developed as `r glossary(&quot;Display Tables&quot;)` (in contrast to `r glossary(&quot;Data Tables&quot;)`. Beside of the interactive use {**DT**}s are Data Tables.</span>
<span id="cb102-2929"><a href="#cb102-2929" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-2930"><a href="#cb102-2930" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-2931"><a href="#cb102-2931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2932"><a href="#cb102-2932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2933"><a href="#cb102-2933" aria-hidden="true" tabindex="-1"></a><span class="fu">###### flextable</span></span>
<span id="cb102-2934"><a href="#cb102-2934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2935"><a href="#cb102-2935" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">{**flextable**}</span><span class="co">](https://davidgohel.github.io/flextable/)</span> </span>
<span id="cb102-2936"><a href="#cb102-2936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2937"><a href="#cb102-2937" aria-hidden="true" tabindex="-1"></a>This package helps you to create reporting table from a data frame easily. You can </span>
<span id="cb102-2938"><a href="#cb102-2938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2939"><a href="#cb102-2939" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>merge cells, </span>
<span id="cb102-2940"><a href="#cb102-2940" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>add headers, </span>
<span id="cb102-2941"><a href="#cb102-2941" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>add footers, </span>
<span id="cb102-2942"><a href="#cb102-2942" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>change formatting, </span>
<span id="cb102-2943"><a href="#cb102-2943" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>set how data in cells is displayed</span>
<span id="cb102-2944"><a href="#cb102-2944" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Table content can also contain mixed types of text and image content. </span>
<span id="cb102-2945"><a href="#cb102-2945" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Tables can be embedded from R Markdown documents into HTML, PDF, Word, and</span>
<span id="cb102-2946"><a href="#cb102-2946" aria-hidden="true" tabindex="-1"></a>    PowerPoint documents and can be embedded using Package Officer for</span>
<span id="cb102-2947"><a href="#cb102-2947" aria-hidden="true" tabindex="-1"></a>    Microsoft Word or PowerPoint documents. </span>
<span id="cb102-2948"><a href="#cb102-2948" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Tables can also be exported as R plots or graphic files, e.g., png, pdf, and jpeg.</span>
<span id="cb102-2949"><a href="#cb102-2949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2950"><a href="#cb102-2950" aria-hidden="true" tabindex="-1"></a>It is said that {**flextable**} --- together with the sparsely used [{**huxtable**}](https://hughjonesd.github.io/huxtable/) --- &quot;supports the widest range of output formats ... <span class="co">[</span><span class="ot">both</span><span class="co">]</span> support HTML, {{&lt; latex &gt;}}, and Office formats, and contain most common table features (e.g., conditional formatting).&quot; (Yihui: <span class="co">[</span><span class="ot">R Markdown Coobook</span><span class="co">](https://bookdown.org/yihui/rmarkdown-cookbook/table-other.html)</span>)</span>
<span id="cb102-2951"><a href="#cb102-2951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2952"><a href="#cb102-2952" aria-hidden="true" tabindex="-1"></a>:::::{.my-note}</span>
<span id="cb102-2953"><a href="#cb102-2953" aria-hidden="true" tabindex="-1"></a>:::{.my-note-header}</span>
<span id="cb102-2954"><a href="#cb102-2954" aria-hidden="true" tabindex="-1"></a>My conclusion to {**flextable**}</span>
<span id="cb102-2955"><a href="#cb102-2955" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2956"><a href="#cb102-2956" aria-hidden="true" tabindex="-1"></a>::::{.my-note-container}</span>
<span id="cb102-2957"><a href="#cb102-2957" aria-hidden="true" tabindex="-1"></a>{**flextable**} seems pretty well suited to create sophisticated tables for publications. It is often especially mentioned for exporting into Word files. Maybe I will look into this package in the near future, but currently my priority is {**gtsummary**}.</span>
<span id="cb102-2958"><a href="#cb102-2958" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-2959"><a href="#cb102-2959" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-2960"><a href="#cb102-2960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2961"><a href="#cb102-2961" aria-hidden="true" tabindex="-1"></a><span class="fu">###### gt</span></span>
<span id="cb102-2962"><a href="#cb102-2962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2963"><a href="#cb102-2963" aria-hidden="true" tabindex="-1"></a> <span class="co">[</span><span class="ot">{**gt**}</span><span class="co">](https://gt.rstudio.com/)</span></span>
<span id="cb102-2964"><a href="#cb102-2964" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb102-2965"><a href="#cb102-2965" aria-hidden="true" tabindex="-1"></a>{**gt**} stands for &quot;grammar of tables&quot;. It aims to do for tables what {**ggplot2**} did for graphics. (<span class="co">[</span><span class="ot">Hadley Wickham on X</span><span class="co">](https://twitter.com/hadleywickham/status/1247997744469295104?ref_src=twsrc%5Etfw%7Ctwcamp%5Etweetembed%7Ctwterm%5E1247997744469295104%7Ctwgr%5Edb446e88f95e2f0e4a5e791da84f82d626ceee1c%7Ctwcon%5Es1_&amp;ref_url=https%3A%2F%2Fcdn.embedly.com%2Fwidgets%2Fmedia.html%3Ftype%3Dtext2Fhtmlkey%3Da19fcc184b9711e1b4764040d3dc5c07schema%3Dtwitterurl%3Dhttps3A%2F%2Ftwitter.com%2Fhadleywickham%2Fstatus%2F1247997744469295104image%3D)</span>)</span>
<span id="cb102-2966"><a href="#cb102-2966" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb102-2967"><a href="#cb102-2967" aria-hidden="true" tabindex="-1"></a>{**gt**} offers a different and easy-to-use set of functions that helps to build display tables from tabular data. The {**gt**} philosophy states that a comprehensive collection of table parts can be used to create a broad range of functional tables. </span>
<span id="cb102-2968"><a href="#cb102-2968" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb102-2969"><a href="#cb102-2969" aria-hidden="true" tabindex="-1"></a>It allows you to compose a table by putting together different parts of the table, such as</span>
<span id="cb102-2970"><a href="#cb102-2970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2971"><a href="#cb102-2971" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>the table header (title and subtitle), </span>
<span id="cb102-2972"><a href="#cb102-2972" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>the column labels, </span>
<span id="cb102-2973"><a href="#cb102-2973" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>the table body, </span>
<span id="cb102-2974"><a href="#cb102-2974" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>row group labels, </span>
<span id="cb102-2975"><a href="#cb102-2975" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>and the table footer. </span>
<span id="cb102-2976"><a href="#cb102-2976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2977"><a href="#cb102-2977" aria-hidden="true" tabindex="-1"></a>Some parts are optional. You can also format numbers and add background shading to cells. </span>
<span id="cb102-2978"><a href="#cb102-2978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2979"><a href="#cb102-2979" aria-hidden="true" tabindex="-1"></a>[![Part of a {gt}</span>
<span id="cb102-2980"><a href="#cb102-2980" aria-hidden="true" tabindex="-1"></a>table](https://gt.rstudio.com/reference/figures/gt_parts_of_a_table.svg){#fig-gt-table-parts</span>
<span id="cb102-2981"><a href="#cb102-2981" aria-hidden="true" tabindex="-1"></a>fig-alt=&quot;The table shows all the different parts of a gt table: The TABLE HEADER consists of TITLE and SUBTITLE. The next part is called STUB HEAD and consists of STUBHEAD LABEL on the left, above the row names and SPANNER COLUMN LABEL with COLUMN LABELs below. The third part is called STUB and consists of ROW GROUP LABEL, ROW LABELs and SUMMARY LABEL on the left. On the right side are the values of the table in cells respectively summary cells. The last part is called TABLE FOOTER and consists of FOOTNOTES and SOURCE NOTES.&quot;}](https://gt.rstudio.com/index.html).</span>
<span id="cb102-2982"><a href="#cb102-2982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2983"><a href="#cb102-2983" aria-hidden="true" tabindex="-1"></a>At the beginning of the development process {**gt**} supported only HTML, but now you can also use it for LATEX and RTF outputs.</span>
<span id="cb102-2984"><a href="#cb102-2984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2985"><a href="#cb102-2985" aria-hidden="true" tabindex="-1"></a>{**gt**} is developed by the RStudio/Posit team, that stands not</span>
<span id="cb102-2986"><a href="#cb102-2986" aria-hidden="true" tabindex="-1"></a>    only for high quality but also for {**tidyverse**} compatibility. It was a little surprise for me that the download statistics does not reflect the normally very high figures of RStudio/Posit products. After trying to work with {**gt**} I believe I know the reasons:</span>
<span id="cb102-2987"><a href="#cb102-2987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-2988"><a href="#cb102-2988" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>With {**gt**} you have big flexibility but you have to provide all the details. This could be cumbersome, especially when other table packages are providing not only theses details but incorporate also many other features as calculations, tests etc. {**gt**} is therefore better used in combination with other packages like {**gtsummary**}.</span>
<span id="cb102-2989"><a href="#cb102-2989" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>{**gt**} is still very early in the development process. The issue tracker show this in the relation of open / closed issue: 272 open / 633 closed (2024-01-18).</span>
<span id="cb102-2990"><a href="#cb102-2990" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb102-2991"><a href="#cb102-2991" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb102-2992"><a href="#cb102-2992" aria-hidden="true" tabindex="-1"></a>:::::{.my-note}</span>
<span id="cb102-2993"><a href="#cb102-2993" aria-hidden="true" tabindex="-1"></a>:::{.my-note-header}</span>
<span id="cb102-2994"><a href="#cb102-2994" aria-hidden="true" tabindex="-1"></a>My conclusion to {**gt**}</span>
<span id="cb102-2995"><a href="#cb102-2995" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-2996"><a href="#cb102-2996" aria-hidden="true" tabindex="-1"></a>::::{.my-note-container}</span>
<span id="cb102-2997"><a href="#cb102-2997" aria-hidden="true" tabindex="-1"></a>I tried to work with {**gt**} but it is cumbersome. I noticed a <span class="co">[</span><span class="ot">bug even following the official online tutorial</span><span class="co">](https://github.com/rstudio/gt/issues/1535)</span>. Maybe</span>
<span id="cb102-2998"><a href="#cb102-2998" aria-hidden="true" tabindex="-1"></a>{**gt**} (together with {**gtsummary**} is better suited for creating easily complex tables in many formats.</span>
<span id="cb102-2999"><a href="#cb102-2999" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-3000"><a href="#cb102-3000" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-3001"><a href="#cb102-3001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3002"><a href="#cb102-3002" aria-hidden="true" tabindex="-1"></a><span class="fu">###### gtsummary</span></span>
<span id="cb102-3003"><a href="#cb102-3003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3004"><a href="#cb102-3004" aria-hidden="true" tabindex="-1"></a>The {**gtsummary**} package provides an efficient way to create publication-ready analytical and summary tables using the R programming language. {**gtsummary**} summarizes data sets, regression models, and more, using sensible defaults with highly customizable capabilities.</span>
<span id="cb102-3005"><a href="#cb102-3005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3006"><a href="#cb102-3006" aria-hidden="true" tabindex="-1"></a>{**gtsummary**} &quot;was written to be a companion to the {**gt**} package from RStudio. But not all output types are supported by the {**gt**} package. Therefore, [the developers] have made it possible to print {**gtsummary**} tables with various engines.&quot; (<span class="co">[</span><span class="ot">gtsummary + Quarto/R Markdown</span><span class="co">](https://www.danieldsjoberg.com/gtsummary/articles/rmarkdown.html)</span>)</span>
<span id="cb102-3007"><a href="#cb102-3007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3008"><a href="#cb102-3008" aria-hidden="true" tabindex="-1"></a>[![Summary of the various Quarto and R Markdown output types and the</span>
<span id="cb102-3009"><a href="#cb102-3009" aria-hidden="true" tabindex="-1"></a>print engines supporting</span>
<span id="cb102-3010"><a href="#cb102-3010" aria-hidden="true" tabindex="-1"></a>them](img/chap01/gtsummary-output-formats-min.png){#fig-chap01-gtsummary-outputs</span>
<span id="cb102-3011"><a href="#cb102-3011" aria-hidden="true" tabindex="-1"></a>fig-alt=&quot;Table of summaries for output formats: The table header reads from left to the right: Print Engine, Function, HTML, Word, PDF, RTF.  As print engines feature in this table: gt, flextable, huxtable, kableExtra, kable and tibble. All functions start with &#39;as_&#39; followed by the name of the package, e.g., as_gt(), as_flex_table(), as_kable_extra() etc. The table states that gt is still working on RTF output, flextable and kableExtra does not support RTF, kableExtra also has no output format for Word. Kable has all four options in a very reduced form (missing indentation, footnotes and spanning headers) and tibble fails on all four formats.&quot;</span>
<span id="cb102-3012"><a href="#cb102-3012" aria-hidden="true" tabindex="-1"></a>fig-align=&quot;center&quot;}](https://www.danieldsjoberg.com/gtsummary/articles/rmarkdown.html)</span>
<span id="cb102-3013"><a href="#cb102-3013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3014"><a href="#cb102-3014" aria-hidden="true" tabindex="-1"></a>:::::{.my-note}</span>
<span id="cb102-3015"><a href="#cb102-3015" aria-hidden="true" tabindex="-1"></a>:::{.my-note-header}</span>
<span id="cb102-3016"><a href="#cb102-3016" aria-hidden="true" tabindex="-1"></a>My conclusion to {**gtsummary**}</span>
<span id="cb102-3017"><a href="#cb102-3017" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-3018"><a href="#cb102-3018" aria-hidden="true" tabindex="-1"></a>::::{.my-note-container}</span>
<span id="cb102-3019"><a href="#cb102-3019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3020"><a href="#cb102-3020" aria-hidden="true" tabindex="-1"></a>I have tried out {**gtsummary**} and I am enthusiastic about it! I wrote an introduction with some examples (@sec-chap01-experiments-gtsummary) Now that I understand how it works I will definitely use it. (By the way: Besides the extensive documentation I found that the most effective introduction for me was watching the <span class="co">[</span><span class="ot">Youtube video presentation</span><span class="co">](https://www.youtube.com/watch?v=tANo9E1SYJE)</span> by the developer Daniel D. Sjoberg).</span>
<span id="cb102-3021"><a href="#cb102-3021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3022"><a href="#cb102-3022" aria-hidden="true" tabindex="-1"></a>{{&lt; video https://www.youtube.com/watch?v=tANo9E1SYJE &gt;}}</span>
<span id="cb102-3023"><a href="#cb102-3023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3024"><a href="#cb102-3024" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-3025"><a href="#cb102-3025" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-3026"><a href="#cb102-3026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3027"><a href="#cb102-3027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3028"><a href="#cb102-3028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3029"><a href="#cb102-3029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3030"><a href="#cb102-3030" aria-hidden="true" tabindex="-1"></a><span class="fu">###### htmlTable</span></span>
<span id="cb102-3031"><a href="#cb102-3031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3032"><a href="#cb102-3032" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">{**htmlTable**}</span><span class="co">](https://cran.r-project.org/web/packages/htmlTable/vignettes/complex_tables.html)</span></span>
<span id="cb102-3033"><a href="#cb102-3033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3034"><a href="#cb102-3034" aria-hidden="true" tabindex="-1"></a>I found {**htmlTable**} per accident searching the Internet with &quot;r creating complex table&quot;. This package is not mentioned in the literature I have read so far, but it seems not only able to produce complex tables but is also used quite often. Maybe it is the HTML limitation which reduces it application for Online journals because it requires a separate step to produce {{&lt; latex &gt;}} tables ready for printing.</span>
<span id="cb102-3035"><a href="#cb102-3035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3036"><a href="#cb102-3036" aria-hidden="true" tabindex="-1"></a>It is a pretty old package (version 1.0 appeared already in 2014) but still currently in active development. The <span class="co">[</span><span class="ot">last change</span><span class="co">](https://cran.r-project.org/web/packages/htmlTable/index.html)</span> today (2024-01-18) was version 2.4.2 from 2023-10-29.</span>
<span id="cb102-3037"><a href="#cb102-3037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3038"><a href="#cb102-3038" aria-hidden="true" tabindex="-1"></a>From the package documentation:</span>
<span id="cb102-3039"><a href="#cb102-3039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3040"><a href="#cb102-3040" aria-hidden="true" tabindex="-1"></a>**Advanced Tables for Markdown/HTML**</span>
<span id="cb102-3041"><a href="#cb102-3041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3042"><a href="#cb102-3042" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Tables with state-of-the-art layout elements such as row spanners,</span></span>
<span id="cb102-3043"><a href="#cb102-3043" aria-hidden="true" tabindex="-1"></a><span class="at">    column spanners, table spanners, zebra striping, and more. While allowing</span></span>
<span id="cb102-3044"><a href="#cb102-3044" aria-hidden="true" tabindex="-1"></a><span class="at">    advanced layout, the underlying css-structure is simple in order to maximize</span></span>
<span id="cb102-3045"><a href="#cb102-3045" aria-hidden="true" tabindex="-1"></a><span class="at">    compatibility with common word processors. The package also contains a few</span></span>
<span id="cb102-3046"><a href="#cb102-3046" aria-hidden="true" tabindex="-1"></a><span class="at">    text formatting functions that help outputting text compatible with HTML/LaTeX.</span></span>
<span id="cb102-3047"><a href="#cb102-3047" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb102-3048"><a href="#cb102-3048" aria-hidden="true" tabindex="-1"></a>Beside the extensive vignette documentation there are also some blog articles:</span>
<span id="cb102-3049"><a href="#cb102-3049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3050"><a href="#cb102-3050" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Introducing the htmlTable-package</span><span class="co">](https://gforge.se/2015/04/introducing-the-htmltable-package/)</span></span>
<span id="cb102-3051"><a href="#cb102-3051" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Tables form R into Word</span><span class="co">](https://gforge.se/2013/02/tables-from-r-into-word/)</span></span>
<span id="cb102-3052"><a href="#cb102-3052" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Fast-track publishing using knitr: table mania (part IV)</span><span class="co">](https://gforge.se/2014/01/fast-track-publishing-using-knitr-part-iv/)</span></span>
<span id="cb102-3053"><a href="#cb102-3053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3054"><a href="#cb102-3054" aria-hidden="true" tabindex="-1"></a>:::::{.my-note}</span>
<span id="cb102-3055"><a href="#cb102-3055" aria-hidden="true" tabindex="-1"></a>:::{.my-note-header}</span>
<span id="cb102-3056"><a href="#cb102-3056" aria-hidden="true" tabindex="-1"></a>My conclusion to {**htmlTable**}</span>
<span id="cb102-3057"><a href="#cb102-3057" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-3058"><a href="#cb102-3058" aria-hidden="true" tabindex="-1"></a>::::{.my-note-container}</span>
<span id="cb102-3059"><a href="#cb102-3059" aria-hidden="true" tabindex="-1"></a>{**htmlTable**} seems an interesting package not only for creating complex tables but also for exporting them into Word. But to learn this package is at the moment not on my task list.</span>
<span id="cb102-3060"><a href="#cb102-3060" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-3061"><a href="#cb102-3061" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-3062"><a href="#cb102-3062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3063"><a href="#cb102-3063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3064"><a href="#cb102-3064" aria-hidden="true" tabindex="-1"></a><span class="fu">###### kableExtra</span></span>
<span id="cb102-3065"><a href="#cb102-3065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3066"><a href="#cb102-3066" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">{**kableExtra**}</span><span class="co">](https://haozhu233.github.io/kableExtra/)</span></span>
<span id="cb102-3067"><a href="#cb102-3067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3068"><a href="#cb102-3068" aria-hidden="true" tabindex="-1"></a>{**kableExtra**} extends the basic functionality of <span class="in">`knitr::kable()`</span> tables. Although</span>
<span id="cb102-3069"><a href="#cb102-3069" aria-hidden="true" tabindex="-1"></a>    <span class="in">`knitr::kable()`</span> is simple by design, it has many features missing</span>
<span id="cb102-3070"><a href="#cb102-3070" aria-hidden="true" tabindex="-1"></a>    which are usually available in other packages. {**kableExtra**} has</span>
<span id="cb102-3071"><a href="#cb102-3071" aria-hidden="true" tabindex="-1"></a>    filled the gap nicely. One of the best thing about {**kableExtra**}</span>
<span id="cb102-3072"><a href="#cb102-3072" aria-hidden="true" tabindex="-1"></a>    is that most of its table capabilities work for both HTML and PDF</span>
<span id="cb102-3073"><a href="#cb102-3073" aria-hidden="true" tabindex="-1"></a>    formats.</span>
<span id="cb102-3074"><a href="#cb102-3074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3075"><a href="#cb102-3075" aria-hidden="true" tabindex="-1"></a>:::::{.my-note}</span>
<span id="cb102-3076"><a href="#cb102-3076" aria-hidden="true" tabindex="-1"></a>:::{.my-note-header}</span>
<span id="cb102-3077"><a href="#cb102-3077" aria-hidden="true" tabindex="-1"></a>My conclusion to {**kableExtra**}</span>
<span id="cb102-3078"><a href="#cb102-3078" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-3079"><a href="#cb102-3079" aria-hidden="true" tabindex="-1"></a>::::{.my-note-container}</span>
<span id="cb102-3080"><a href="#cb102-3080" aria-hidden="true" tabindex="-1"></a>I have already some experiences with {**kableExtra**}. I used it quasi as an add-on to `knitr::kable()` during personal HTML publications (Blog, bookdown, Quarto). I believe that other &quot;Table 1&quot; packages like {**gtsummary**} or maybe also {**tableOne**) are better suited for display and publication.</span>
<span id="cb102-3081"><a href="#cb102-3081" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-3082"><a href="#cb102-3082" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-3083"><a href="#cb102-3083" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3084"><a href="#cb102-3084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3085"><a href="#cb102-3085" aria-hidden="true" tabindex="-1"></a><span class="fu">###### tableone</span></span>
<span id="cb102-3086"><a href="#cb102-3086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3087"><a href="#cb102-3087" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">{**tableone**}</span><span class="co">](https://cran.r-project.org/web/packages/tableone/index.html)</span></span>
<span id="cb102-3088"><a href="#cb102-3088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3089"><a href="#cb102-3089" aria-hidden="true" tabindex="-1"></a>The first time I learned about the existence of {**tableone**} was in @sec-chap02 of Statistics with R. Consulting the online documentation it says:</span>
<span id="cb102-3090"><a href="#cb102-3090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3091"><a href="#cb102-3091" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Creates &quot;Table 1&quot;, i.e., description of baseline patient characteristics, which is essential in every medical research. Supports both continuous and categorical variables, as well as p-values and standardized mean differences. Weighted data are supported via the {**survey**} package. … Most important functions are </span><span class="in">`CreateTableOne()`</span><span class="at"> and </span><span class="in">`svyCreateTableOne()`</span><span class="at">.</span></span>
<span id="cb102-3092"><a href="#cb102-3092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3093"><a href="#cb102-3093" aria-hidden="true" tabindex="-1"></a>:::::{.my-note}</span>
<span id="cb102-3094"><a href="#cb102-3094" aria-hidden="true" tabindex="-1"></a>:::{.my-note-header}</span>
<span id="cb102-3095"><a href="#cb102-3095" aria-hidden="true" tabindex="-1"></a>My conclusion to {**tableone**}</span>
<span id="cb102-3096"><a href="#cb102-3096" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-3097"><a href="#cb102-3097" aria-hidden="true" tabindex="-1"></a>::::{.my-note-container}</span>
<span id="cb102-3098"><a href="#cb102-3098" aria-hidden="true" tabindex="-1"></a>The package is completely new for me. I have to check it out to see how and when to use. But my priority now is {**gtsummary**} because</span>
<span id="cb102-3099"><a href="#cb102-3099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3100"><a href="#cb102-3100" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>{**gtsummary**} is much more used than {**tableone**}: over 2000 versus under 500 downloads per day</span>
<span id="cb102-3101"><a href="#cb102-3101" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>last release of {**gtsummary**} was version 1.7.2 from July 15, 2023 versus release 26 from July 26, 2020.</span>
<span id="cb102-3102"><a href="#cb102-3102" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-3103"><a href="#cb102-3103" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-3104"><a href="#cb102-3104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3105"><a href="#cb102-3105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3106"><a href="#cb102-3106" aria-hidden="true" tabindex="-1"></a><span class="fu">###### xtable</span></span>
<span id="cb102-3107"><a href="#cb102-3107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3108"><a href="#cb102-3108" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">{**xtable**}</span><span class="co">](https://cran.r-project.org/web/packages/xtable/vignettes/xtableGallery.pdf)</span></span>
<span id="cb102-3109"><a href="#cb102-3109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3110"><a href="#cb102-3110" aria-hidden="true" tabindex="-1"></a>{**xtable**} is the oldest package and still the table package most used! From the documentation it is clear that it is very useful for the creation of publication ready tables. But I am little hesitant to learn it, because it is not mentioned in current literature and the last change was in April 2019.</span>
<span id="cb102-3111"><a href="#cb102-3111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3112"><a href="#cb102-3112" aria-hidden="true" tabindex="-1"></a>:::::{.my-note}</span>
<span id="cb102-3113"><a href="#cb102-3113" aria-hidden="true" tabindex="-1"></a>:::{.my-note-header}</span>
<span id="cb102-3114"><a href="#cb102-3114" aria-hidden="true" tabindex="-1"></a>My conclusion to {**xtable**}</span>
<span id="cb102-3115"><a href="#cb102-3115" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-3116"><a href="#cb102-3116" aria-hidden="true" tabindex="-1"></a>::::{.my-note-container}</span>
<span id="cb102-3117"><a href="#cb102-3117" aria-hidden="true" tabindex="-1"></a>Learning {**xtable**} is not on my agenda: It is not clear for me if {**xtable**} is still in developments and if it is supporting newer approaches. Learning other table packages, especially {**gtsummary**} probabily together with {**gt**} has priority for me.</span>
<span id="cb102-3118"><a href="#cb102-3118" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-3119"><a href="#cb102-3119" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-3120"><a href="#cb102-3120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3121"><a href="#cb102-3121" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-3122"><a href="#cb102-3122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3123"><a href="#cb102-3123" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-3124"><a href="#cb102-3124" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-3125"><a href="#cb102-3125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3126"><a href="#cb102-3126" aria-hidden="true" tabindex="-1"></a>There are other packages as well. But the above eight packages</span>
<span id="cb102-3127"><a href="#cb102-3127" aria-hidden="true" tabindex="-1"></a>are a first starting point for everybody to learn creating and displaying</span>
<span id="cb102-3128"><a href="#cb102-3128" aria-hidden="true" tabindex="-1"></a>sophisticated data tables in R. It is good to know about different packages but lastly one has to decide which one to learn and use in daily practice. At the moment my favorites is {**gtsummary**}.</span>
<span id="cb102-3129"><a href="#cb102-3129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3130"><a href="#cb102-3130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3131"><a href="#cb102-3131" aria-hidden="true" tabindex="-1"></a>:::::{.my-resource}</span>
<span id="cb102-3132"><a href="#cb102-3132" aria-hidden="true" tabindex="-1"></a>:::{.my-resource-header}</span>
<span id="cb102-3133"><a href="#cb102-3133" aria-hidden="true" tabindex="-1"></a>Other interesting table packages, but currently not considered for my personal purposes</span>
<span id="cb102-3134"><a href="#cb102-3134" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-3135"><a href="#cb102-3135" aria-hidden="true" tabindex="-1"></a>::::{.my-resource-container}</span>
<span id="cb102-3136"><a href="#cb102-3136" aria-hidden="true" tabindex="-1"></a>Just for a possible later reference I will add some other table packages I know of.</span>
<span id="cb102-3137"><a href="#cb102-3137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3138"><a href="#cb102-3138" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">{**reactable**}</span><span class="co">](https://glin.github.io/reactable/)</span>: <span class="in">`reactable()`</span></span>
<span id="cb102-3139"><a href="#cb102-3139" aria-hidden="true" tabindex="-1"></a>    creates a data table from tabular data with sorting and pagination</span>
<span id="cb102-3140"><a href="#cb102-3140" aria-hidden="true" tabindex="-1"></a>    by default. The data table is an HTML widget that can be used in R</span>
<span id="cb102-3141"><a href="#cb102-3141" aria-hidden="true" tabindex="-1"></a>    Markdown documents and Shiny applications or viewed from an R</span>
<span id="cb102-3142"><a href="#cb102-3142" aria-hidden="true" tabindex="-1"></a>    console. It is based on the React Table library and made with</span>
<span id="cb102-3143"><a href="#cb102-3143" aria-hidden="true" tabindex="-1"></a>    reactR. Features are:</span>
<span id="cb102-3144"><a href="#cb102-3144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3145"><a href="#cb102-3145" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>It creates a data table with sorting, filtering, and pagination</span>
<span id="cb102-3146"><a href="#cb102-3146" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>It has built-in column formatting</span>
<span id="cb102-3147"><a href="#cb102-3147" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>It supports custom rendering via R or JavaScript</span>
<span id="cb102-3148"><a href="#cb102-3148" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>It works seamlessly within R Markdown documents and the Shiny</span>
<span id="cb102-3149"><a href="#cb102-3149" aria-hidden="true" tabindex="-1"></a>        app</span>
<span id="cb102-3150"><a href="#cb102-3150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3151"><a href="#cb102-3151" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">{**ractablefmtr**}</span><span class="co">](https://kcuilla.github.io/reactablefmtr/index.html)</span>:</span>
<span id="cb102-3152"><a href="#cb102-3152" aria-hidden="true" tabindex="-1"></a>    The package improves the appearance and formatting of tables created</span>
<span id="cb102-3153"><a href="#cb102-3153" aria-hidden="true" tabindex="-1"></a>    using the reactable R library. It includes many conditional</span>
<span id="cb102-3154"><a href="#cb102-3154" aria-hidden="true" tabindex="-1"></a>    formatters that are highly customizable and easy to use.</span>
<span id="cb102-3155"><a href="#cb102-3155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3156"><a href="#cb102-3156" aria-hidden="true" tabindex="-1"></a>The authors of R Markdown Cookbook (Yihui Xie, Christophe Dervieux,</span>
<span id="cb102-3157"><a href="#cb102-3157" aria-hidden="true" tabindex="-1"></a>Emily Riederer) mention also several other table packages in the</span>
<span id="cb102-3158"><a href="#cb102-3158" aria-hidden="true" tabindex="-1"></a>section [Other packages for creating</span>
<span id="cb102-3159"><a href="#cb102-3159" aria-hidden="true" tabindex="-1"></a>tables](https://bookdown.org/yihui/rmarkdown-cookbook/table-other.html):</span>
<span id="cb102-3160"><a href="#cb102-3160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3161"><a href="#cb102-3161" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>{**rhandsontable**}: [Interface to the Handsontable.js Library.](https://jrowen.github.io/rhandsontable/)). Similar to {**DT**}, and has an Excel feel (e.g., you can edit data directly in the table). Visit <span class="ot">&lt;https://jrowen.github.io/rhandsontable/&gt;</span> to learn more about it.</span>
<span id="cb102-3162"><a href="#cb102-3162" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>{**pixiedust**}: [Tables so Beautifully Fine-Tuned You Will Believe It’s Magic](https://github.com/nutterb/pixiedust): Features creating tables for models (such as linear models) converted through the {**broom**} package (<span class="co">[</span><span class="ot">Broom: Convert Statistical Objects into Tidy Tibbles</span><span class="co">](https://broom.tidymodels.org/)</span>). It supports Markdown, HTML, and {{&lt; latex &gt;}} output formats.</span>
<span id="cb102-3163"><a href="#cb102-3163" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**stargazer**: (<span class="co">[</span><span class="ot">beautiful {{&lt; latex &gt;}}, HTML and ASCII tables from R statistical output</span><span class="co">](https://cran.r-project.org/web/packages/stargazer/vignettes/stargazer.pdf)</span>):</span>
<span id="cb102-3164"><a href="#cb102-3164" aria-hidden="true" tabindex="-1"></a>     Features formatting regression models and summary statistics</span>
<span id="cb102-3165"><a href="#cb102-3165" aria-hidden="true" tabindex="-1"></a>     tables. </span>
<span id="cb102-3166"><a href="#cb102-3166" aria-hidden="true" tabindex="-1"></a><span class="ss"> -   </span>**xtable** ([Dahl et al.</span>
<span id="cb102-3167"><a href="#cb102-3167" aria-hidden="true" tabindex="-1"></a>     2019](https://bookdown.org/yihui/rmarkdown-cookbook/table-other.html#ref-R-xtable)):</span>
<span id="cb102-3168"><a href="#cb102-3168" aria-hidden="true" tabindex="-1"></a>     Perhaps the oldest package for creating tables---the first release</span>
<span id="cb102-3169"><a href="#cb102-3169" aria-hidden="true" tabindex="-1"></a>     was made in 2000. It supports both {{&lt; latex &gt;}} and HTML formats.</span>
<span id="cb102-3170"><a href="#cb102-3170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3171"><a href="#cb102-3171" aria-hidden="true" tabindex="-1"></a>I&#39;m not going to introduce the rest of packages, but will just list</span>
<span id="cb102-3172"><a href="#cb102-3172" aria-hidden="true" tabindex="-1"></a>them here: </span>
<span id="cb102-3173"><a href="#cb102-3173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3174"><a href="#cb102-3174" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**tables**: <span class="co">[</span><span class="ot">Formula-Driven Table Generation</span><span class="co">](https://dmurdoch.github.io/tables/)</span>),</span>
<span id="cb102-3175"><a href="#cb102-3175" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**pander** ([Daróczi and Tsegelskyi</span>
<span id="cb102-3176"><a href="#cb102-3176" aria-hidden="true" tabindex="-1"></a>2022](https://bookdown.org/yihui/rmarkdown-cookbook/table-other.html#ref-R-pander)),</span>
<span id="cb102-3177"><a href="#cb102-3177" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**tangram** ([S. Garbett</span>
<span id="cb102-3178"><a href="#cb102-3178" aria-hidden="true" tabindex="-1"></a>2023](https://bookdown.org/yihui/rmarkdown-cookbook/table-other.html#ref-R-tangram)),</span>
<span id="cb102-3179"><a href="#cb102-3179" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**ztable** ([Moon</span>
<span id="cb102-3180"><a href="#cb102-3180" aria-hidden="true" tabindex="-1"></a>2021](https://bookdown.org/yihui/rmarkdown-cookbook/table-other.html#ref-R-ztable)),</span>
<span id="cb102-3181"><a href="#cb102-3181" aria-hidden="true" tabindex="-1"></a>and </span>
<span id="cb102-3182"><a href="#cb102-3182" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**condformat** (<span class="co">[</span><span class="ot">Introduction to condformat</span><span class="co">](https://zeehio.github.io/condformat/)</span>).</span>
<span id="cb102-3183"><a href="#cb102-3183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3184"><a href="#cb102-3184" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-3185"><a href="#cb102-3185" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-3186"><a href="#cb102-3186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3187"><a href="#cb102-3187" aria-hidden="true" tabindex="-1"></a>:::::{.my-important}</span>
<span id="cb102-3188"><a href="#cb102-3188" aria-hidden="true" tabindex="-1"></a>:::{.my-important-header}</span>
<span id="cb102-3189"><a href="#cb102-3189" aria-hidden="true" tabindex="-1"></a>Summary of my table packages review</span>
<span id="cb102-3190"><a href="#cb102-3190" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-3191"><a href="#cb102-3191" aria-hidden="true" tabindex="-1"></a>::::{.my-important-container}</span>
<span id="cb102-3192"><a href="#cb102-3192" aria-hidden="true" tabindex="-1"></a>It does not make sense to learn every package. SO I will concentrate on five packages with different usage:</span>
<span id="cb102-3193"><a href="#cb102-3193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3194"><a href="#cb102-3194" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>{**DT**}, see: @pak-DT: An important package for interactive HTML tables. It also manages quite good big datasets</span>
<span id="cb102-3195"><a href="#cb102-3195" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>{**gt**}, see @pak-gt: Although this package is still lacking many features in follows a systematic approach (&quot;Grammar of Tables&quot;) that allows to make fine grained changes. It is there somewhat cumbersome to apply it in everyday use. But it is especially valuable when you have another package for the standard features and you need some specialized change. I plan to use {**gt**} together with {**gtsummary**}. </span>
<span id="cb102-3196"><a href="#cb102-3196" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>{**gtsummary**}, see: @pak-gtsummary: I just learned this package and I am enthusiastic about it! I will use it as replacement for {**tableone**} that is used by Harris for the book to prepare publishing ready <span class="in">`r glossary(&quot;Table 1&quot;)`</span> tables.</span>
<span id="cb102-3197"><a href="#cb102-3197" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>{**kableExtra**}, see: @pak-kableExtra: It uses the `kable()` function from {**knitr**} (see: @pak-knitr), which is an essential part of the publishing infrastructure for `r glossary(&quot;literate programming&quot;)`. It is pretty flexible and could be used in tandem with {**gtsummary**}. </span>
<span id="cb102-3198"><a href="#cb102-3198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3199"><a href="#cb102-3199" aria-hidden="true" tabindex="-1"></a>For simple tables one can also use <span class="in">`knitr::kable()`</span> or just printing the tibble.</span>
<span id="cb102-3200"><a href="#cb102-3200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3201"><a href="#cb102-3201" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-3202"><a href="#cb102-3202" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-3203"><a href="#cb102-3203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3204"><a href="#cb102-3204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3205"><a href="#cb102-3205" aria-hidden="true" tabindex="-1"></a>As a consequence of my table packages review I experimented with the {**gtsummary**}. I wanted to create a table where I have information by the variables grass, age in four categories and sex with all their levels in absolute numbers and in percents.</span>
<span id="cb102-3206"><a href="#cb102-3206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3207"><a href="#cb102-3207" aria-hidden="true" tabindex="-1"></a><span class="fu">### Experiments with the gtsummary package {#sec-chap01-experiments-gtsummary}</span></span>
<span id="cb102-3208"><a href="#cb102-3208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3209"><a href="#cb102-3209" aria-hidden="true" tabindex="-1"></a>:::::{.my-experiment}</span>
<span id="cb102-3210"><a href="#cb102-3210" aria-hidden="true" tabindex="-1"></a>:::{.my-experiment-header}</span>
<span id="cb102-3211"><a href="#cb102-3211" aria-hidden="true" tabindex="-1"></a>:::::: {#def-chap01-gtsummary-intro}</span>
<span id="cb102-3212"><a href="#cb102-3212" aria-hidden="true" tabindex="-1"></a>: Experiments with {**gtsummary**}</span>
<span id="cb102-3213"><a href="#cb102-3213" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb102-3214"><a href="#cb102-3214" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-3215"><a href="#cb102-3215" aria-hidden="true" tabindex="-1"></a>::::{.my-experiment-container}</span>
<span id="cb102-3216"><a href="#cb102-3216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3217"><a href="#cb102-3217" aria-hidden="true" tabindex="-1"></a><span class="ss">0. </span>Display dataset used for the {**gtsummary**} introduction.</span>
<span id="cb102-3218"><a href="#cb102-3218" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>A very basic summary table without any adaptions or modifications.</span>
<span id="cb102-3219"><a href="#cb102-3219" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Changing dichotomous to a categorical variable.</span>
<span id="cb102-3220"><a href="#cb102-3220" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Ditto with a different method.</span>
<span id="cb102-3221"><a href="#cb102-3221" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Changing variable labels with two different methods.</span>
<span id="cb102-3222"><a href="#cb102-3222" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Output grouped by the <span class="in">`grass`</span> variable.</span>
<span id="cb102-3223"><a href="#cb102-3223" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>Header modified.</span>
<span id="cb102-3224"><a href="#cb102-3224" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>two cross tables of summary statistics stacked.</span>
<span id="cb102-3225"><a href="#cb102-3225" aria-hidden="true" tabindex="-1"></a><span class="ss">8. </span>Table stratified by the <span class="in">`grass`</span> variable.</span>
<span id="cb102-3226"><a href="#cb102-3226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3227"><a href="#cb102-3227" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb102-3228"><a href="#cb102-3228" aria-hidden="true" tabindex="-1"></a><span class="fu">###### 0</span></span>
<span id="cb102-3229"><a href="#cb102-3229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3230"><a href="#cb102-3230" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb102-3231"><a href="#cb102-3231" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb102-3232"><a href="#cb102-3232" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-chap01-gtsummary-data}</span>
<span id="cb102-3233"><a href="#cb102-3233" aria-hidden="true" tabindex="-1"></a>: Data used in this {**gtsummary**} introduction</span>
<span id="cb102-3234"><a href="#cb102-3234" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb102-3235"><a href="#cb102-3235" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-3236"><a href="#cb102-3236" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb102-3237"><a href="#cb102-3237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3238"><a href="#cb102-3238" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-3239"><a href="#cb102-3239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3240"><a href="#cb102-3240" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-3241"><a href="#cb102-3241" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: gtsummary-data</span></span>
<span id="cb102-3242"><a href="#cb102-3242" aria-hidden="true" tabindex="-1"></a><span class="co">#| cache: true</span></span>
<span id="cb102-3243"><a href="#cb102-3243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3244"><a href="#cb102-3244" aria-hidden="true" tabindex="-1"></a>chap01_nhanes_2013_clean <span class="ot">&lt;-</span> </span>
<span id="cb102-3245"><a href="#cb102-3245" aria-hidden="true" tabindex="-1"></a>    base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="st">&quot;data-clean/chap01_nhanes_2013_clean.rds&quot;</span>)</span>
<span id="cb102-3246"><a href="#cb102-3246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3247"><a href="#cb102-3247" aria-hidden="true" tabindex="-1"></a>chap01_gtsummary_basic <span class="ot">&lt;-</span> chap01_nhanes_2013_clean <span class="sc">|&gt;</span> </span>
<span id="cb102-3248"><a href="#cb102-3248" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb102-3249"><a href="#cb102-3249" aria-hidden="true" tabindex="-1"></a>    <span class="do">## cut age into several defined age groups</span></span>
<span id="cb102-3250"><a href="#cb102-3250" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">age_cat =</span> base<span class="sc">::</span><span class="fu">cut</span>(age,</span>
<span id="cb102-3251"><a href="#cb102-3251" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="dv">29</span>, <span class="dv">39</span>, <span class="dv">49</span>, <span class="dv">59</span>),</span>
<span id="cb102-3252"><a href="#cb102-3252" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;18 - 29&quot;</span>, <span class="st">&quot;30 - 39&quot;</span>, <span class="st">&quot;40 - 49&quot;</span>, <span class="st">&quot;50 - 59&quot;</span>))) <span class="sc">|&gt;</span></span>
<span id="cb102-3253"><a href="#cb102-3253" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(nr, age))</span>
<span id="cb102-3254"><a href="#cb102-3254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3255"><a href="#cb102-3255" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">saveRDS</span>(chap01_gtsummary_basic, <span class="st">&quot;data-clean/chap01_gtsummary_clean.rds&quot;</span>)</span>
<span id="cb102-3256"><a href="#cb102-3256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3257"><a href="#cb102-3257" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">summary</span>(chap01_gtsummary_basic)</span>
<span id="cb102-3258"><a href="#cb102-3258" aria-hidden="true" tabindex="-1"></a>chap01_gtsummary_basic</span>
<span id="cb102-3259"><a href="#cb102-3259" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-3260"><a href="#cb102-3260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3261"><a href="#cb102-3261" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-3262"><a href="#cb102-3262" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-3263"><a href="#cb102-3263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3264"><a href="#cb102-3264" aria-hidden="true" tabindex="-1"></a>I am going to use this dataset to experiment with  {**gtsummary**}.</span>
<span id="cb102-3265"><a href="#cb102-3265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3266"><a href="#cb102-3266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3267"><a href="#cb102-3267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3268"><a href="#cb102-3268" aria-hidden="true" tabindex="-1"></a><span class="fu">###### 1</span></span>
<span id="cb102-3269"><a href="#cb102-3269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3270"><a href="#cb102-3270" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb102-3271"><a href="#cb102-3271" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb102-3272"><a href="#cb102-3272" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-chap01-gtsummary-basic}</span>
<span id="cb102-3273"><a href="#cb102-3273" aria-hidden="true" tabindex="-1"></a>: A very basic summary without any adaptions or modifications</span>
<span id="cb102-3274"><a href="#cb102-3274" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb102-3275"><a href="#cb102-3275" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-3276"><a href="#cb102-3276" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb102-3277"><a href="#cb102-3277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3278"><a href="#cb102-3278" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-3279"><a href="#cb102-3279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3280"><a href="#cb102-3280" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-3281"><a href="#cb102-3281" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: gts-basic</span></span>
<span id="cb102-3282"><a href="#cb102-3282" aria-hidden="true" tabindex="-1"></a><span class="co">#| cache: true</span></span>
<span id="cb102-3283"><a href="#cb102-3283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3284"><a href="#cb102-3284" aria-hidden="true" tabindex="-1"></a>chap01_gtsummary_basic <span class="ot">&lt;-</span> </span>
<span id="cb102-3285"><a href="#cb102-3285" aria-hidden="true" tabindex="-1"></a>    base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="st">&quot;data-clean/chap01_gtsummary_clean.rds&quot;</span>)</span>
<span id="cb102-3286"><a href="#cb102-3286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3287"><a href="#cb102-3287" aria-hidden="true" tabindex="-1"></a>chap01_gtsummary_basic <span class="sc">|&gt;</span> </span>
<span id="cb102-3288"><a href="#cb102-3288" aria-hidden="true" tabindex="-1"></a>    gtsummary<span class="sc">::</span><span class="fu">tbl_summary</span>()</span>
<span id="cb102-3289"><a href="#cb102-3289" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-3290"><a href="#cb102-3290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3291"><a href="#cb102-3291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3292"><a href="#cb102-3292" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-3293"><a href="#cb102-3293" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-3294"><a href="#cb102-3294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3295"><a href="#cb102-3295" aria-hidden="true" tabindex="-1"></a>This is a very basic summary without any adaptions or modifications. It is strange, that there are for <span class="in">`grass`</span> not separated levels presented. From a <span class="co">[</span><span class="ot">video of an introduction to {**gtsummary**}</span><span class="co">](https://www.youtube.com/watch?v=tANo9E1SYJE)</span> by the package author Daniel D. Sjoberg I learned that a categorical variable with two levels is interpreted as dichotomous whenever the two levels are labelled <span class="in">`1`</span> and <span class="in">`0`</span>, <span class="in">`true`</span> and <span class="in">`false`</span> or <span class="in">`Yes`</span> and <span class="in">`No`</span>. And dichotomous variable are different as other categorical variables as they are reported by {**gtsummary**} only with one number (the <span class="in">`1`</span>, <span class="in">`true`</span> or <span class="in">`yes`</span> value).</span>
<span id="cb102-3296"><a href="#cb102-3296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3297"><a href="#cb102-3297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3298"><a href="#cb102-3298" aria-hidden="true" tabindex="-1"></a><span class="fu">###### 2</span></span>
<span id="cb102-3299"><a href="#cb102-3299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3300"><a href="#cb102-3300" aria-hidden="true" tabindex="-1"></a>Here I am going to change level names of the <span class="in">`grass`</span> variable to prevent that it is interpreted as a dichotomous variable.</span>
<span id="cb102-3301"><a href="#cb102-3301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3302"><a href="#cb102-3302" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb102-3303"><a href="#cb102-3303" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb102-3304"><a href="#cb102-3304" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-chap01-gtsummary-no-dichotomous1}</span>
<span id="cb102-3305"><a href="#cb102-3305" aria-hidden="true" tabindex="-1"></a>: Numbered R Code Title</span>
<span id="cb102-3306"><a href="#cb102-3306" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb102-3307"><a href="#cb102-3307" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-3308"><a href="#cb102-3308" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb102-3309"><a href="#cb102-3309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3310"><a href="#cb102-3310" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-3311"><a href="#cb102-3311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3312"><a href="#cb102-3312" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-3313"><a href="#cb102-3313" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: gts-not-dichotomous1</span></span>
<span id="cb102-3314"><a href="#cb102-3314" aria-hidden="true" tabindex="-1"></a><span class="co">#| cache: true</span></span>
<span id="cb102-3315"><a href="#cb102-3315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3316"><a href="#cb102-3316" aria-hidden="true" tabindex="-1"></a>chap01_gtsummary_basic2 <span class="ot">&lt;-</span> </span>
<span id="cb102-3317"><a href="#cb102-3317" aria-hidden="true" tabindex="-1"></a>    base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="st">&quot;data-clean/chap01_gtsummary_clean.rds&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb102-3318"><a href="#cb102-3318" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">grass =</span> </span>
<span id="cb102-3319"><a href="#cb102-3319" aria-hidden="true" tabindex="-1"></a>      forcats<span class="sc">::</span><span class="fu">fct_recode</span>(grass,</span>
<span id="cb102-3320"><a href="#cb102-3320" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;used&quot;</span> <span class="ot">=</span> <span class="st">&quot;Yes&quot;</span>, </span>
<span id="cb102-3321"><a href="#cb102-3321" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;not used&quot;</span> <span class="ot">=</span> <span class="st">&quot;No&quot;</span>)</span>
<span id="cb102-3322"><a href="#cb102-3322" aria-hidden="true" tabindex="-1"></a>            ) </span>
<span id="cb102-3323"><a href="#cb102-3323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3324"><a href="#cb102-3324" aria-hidden="true" tabindex="-1"></a>chap01_gtsummary_basic2 <span class="sc">|&gt;</span></span>
<span id="cb102-3325"><a href="#cb102-3325" aria-hidden="true" tabindex="-1"></a>    gtsummary<span class="sc">::</span><span class="fu">tbl_summary</span>()</span>
<span id="cb102-3326"><a href="#cb102-3326" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-3327"><a href="#cb102-3327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3328"><a href="#cb102-3328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3329"><a href="#cb102-3329" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-3330"><a href="#cb102-3330" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-3331"><a href="#cb102-3331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3332"><a href="#cb102-3332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3333"><a href="#cb102-3333" aria-hidden="true" tabindex="-1"></a>This time we can see both levels of <span class="in">`grass`</span>. But we loose the nice Yes/No answer of the survey.</span>
<span id="cb102-3334"><a href="#cb102-3334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3335"><a href="#cb102-3335" aria-hidden="true" tabindex="-1"></a><span class="fu">###### 3</span></span>
<span id="cb102-3336"><a href="#cb102-3336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3337"><a href="#cb102-3337" aria-hidden="true" tabindex="-1"></a>Another strategy to prevent a dichotomous interpretation is to tell {**gtsummary**} expressively with the <span class="in">`type =`</span> argument how a variable has to be interpreted.</span>
<span id="cb102-3338"><a href="#cb102-3338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3339"><a href="#cb102-3339" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb102-3340"><a href="#cb102-3340" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb102-3341"><a href="#cb102-3341" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-chap01-gtsummary-no-dichotomous2}</span>
<span id="cb102-3342"><a href="#cb102-3342" aria-hidden="true" tabindex="-1"></a>: Preventing a dichotomous interpretation</span>
<span id="cb102-3343"><a href="#cb102-3343" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb102-3344"><a href="#cb102-3344" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-3345"><a href="#cb102-3345" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb102-3346"><a href="#cb102-3346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3347"><a href="#cb102-3347" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-3348"><a href="#cb102-3348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3349"><a href="#cb102-3349" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-3350"><a href="#cb102-3350" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: gts-not-dichotomous2</span></span>
<span id="cb102-3351"><a href="#cb102-3351" aria-hidden="true" tabindex="-1"></a><span class="co">#| cache: true</span></span>
<span id="cb102-3352"><a href="#cb102-3352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3353"><a href="#cb102-3353" aria-hidden="true" tabindex="-1"></a>chap01_gtsummary_basic <span class="sc">|&gt;</span> </span>
<span id="cb102-3354"><a href="#cb102-3354" aria-hidden="true" tabindex="-1"></a>    gtsummary<span class="sc">::</span><span class="fu">tbl_summary</span>(</span>
<span id="cb102-3355"><a href="#cb102-3355" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> grass <span class="sc">~</span> <span class="st">&quot;categorical&quot;</span></span>
<span id="cb102-3356"><a href="#cb102-3356" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb102-3357"><a href="#cb102-3357" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-3358"><a href="#cb102-3358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3359"><a href="#cb102-3359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3360"><a href="#cb102-3360" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-3361"><a href="#cb102-3361" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-3362"><a href="#cb102-3362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3363"><a href="#cb102-3363" aria-hidden="true" tabindex="-1"></a>The same output as in the previous tab, but now with the desired Yes/No answer categories.</span>
<span id="cb102-3364"><a href="#cb102-3364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3365"><a href="#cb102-3365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3366"><a href="#cb102-3366" aria-hidden="true" tabindex="-1"></a><span class="fu">###### 4</span></span>
<span id="cb102-3367"><a href="#cb102-3367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3368"><a href="#cb102-3368" aria-hidden="true" tabindex="-1"></a>If there are labelled data {gtsummary} uses them as variable labels. This is a big advantages, especially if the data are already labelled and imported with {**haven**}. But you can use the {**labelled**} package to label the variables.</span>
<span id="cb102-3369"><a href="#cb102-3369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3370"><a href="#cb102-3370" aria-hidden="true" tabindex="-1"></a>If there are no labelled metadata then the variable name is taken, e.g., in most of the cases you have to provide a better name for the table display.</span>
<span id="cb102-3371"><a href="#cb102-3371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3372"><a href="#cb102-3372" aria-hidden="true" tabindex="-1"></a>I am using both methods in following code chunk: I provided labelled metadata for the <span class="in">`grass`</span> variable but used new variable names for <span class="in">`age_cat`</span> and <span class="in">`sex`</span>.</span>
<span id="cb102-3373"><a href="#cb102-3373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3374"><a href="#cb102-3374" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb102-3375"><a href="#cb102-3375" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb102-3376"><a href="#cb102-3376" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-chap01-gtsummary-label}</span>
<span id="cb102-3377"><a href="#cb102-3377" aria-hidden="true" tabindex="-1"></a>: Changing variable labels</span>
<span id="cb102-3378"><a href="#cb102-3378" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb102-3379"><a href="#cb102-3379" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-3380"><a href="#cb102-3380" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb102-3381"><a href="#cb102-3381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3382"><a href="#cb102-3382" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-3383"><a href="#cb102-3383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3384"><a href="#cb102-3384" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-3385"><a href="#cb102-3385" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: gts-label</span></span>
<span id="cb102-3386"><a href="#cb102-3386" aria-hidden="true" tabindex="-1"></a><span class="co">#| cache: true</span></span>
<span id="cb102-3387"><a href="#cb102-3387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3388"><a href="#cb102-3388" aria-hidden="true" tabindex="-1"></a><span class="do">## variant 1 to label variables</span></span>
<span id="cb102-3389"><a href="#cb102-3389" aria-hidden="true" tabindex="-1"></a><span class="co"># labelled::var_label(</span></span>
<span id="cb102-3390"><a href="#cb102-3390" aria-hidden="true" tabindex="-1"></a><span class="co">#     chap01_gtsummary_basic$grass) &lt;- &quot;Ever used grass or hash?&quot;</span></span>
<span id="cb102-3391"><a href="#cb102-3391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3392"><a href="#cb102-3392" aria-hidden="true" tabindex="-1"></a><span class="do">## variant 2 to label variables</span></span>
<span id="cb102-3393"><a href="#cb102-3393" aria-hidden="true" tabindex="-1"></a>chap01_gtsummary_basic <span class="sc">|&gt;</span> </span>
<span id="cb102-3394"><a href="#cb102-3394" aria-hidden="true" tabindex="-1"></a>    labelled<span class="sc">::</span><span class="fu">set_variable_labels</span>(</span>
<span id="cb102-3395"><a href="#cb102-3395" aria-hidden="true" tabindex="-1"></a>        <span class="at">grass =</span> <span class="st">&quot;Ever used grass or hash?&quot;</span></span>
<span id="cb102-3396"><a href="#cb102-3396" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb102-3397"><a href="#cb102-3397" aria-hidden="true" tabindex="-1"></a>    gtsummary<span class="sc">::</span><span class="fu">tbl_summary</span>(</span>
<span id="cb102-3398"><a href="#cb102-3398" aria-hidden="true" tabindex="-1"></a>        <span class="co"># by = grass,</span></span>
<span id="cb102-3399"><a href="#cb102-3399" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> grass <span class="sc">~</span> <span class="st">&quot;categorical&quot;</span>,</span>
<span id="cb102-3400"><a href="#cb102-3400" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="fu">list</span>(</span>
<span id="cb102-3401"><a href="#cb102-3401" aria-hidden="true" tabindex="-1"></a>            <span class="at">age_cat =</span> <span class="st">&quot;Age Category&quot;</span>,</span>
<span id="cb102-3402"><a href="#cb102-3402" aria-hidden="true" tabindex="-1"></a>            <span class="at">sex =</span> <span class="st">&quot;Sex&quot;</span></span>
<span id="cb102-3403"><a href="#cb102-3403" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb102-3404"><a href="#cb102-3404" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb102-3405"><a href="#cb102-3405" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-3406"><a href="#cb102-3406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3407"><a href="#cb102-3407" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-3408"><a href="#cb102-3408" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-3409"><a href="#cb102-3409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3410"><a href="#cb102-3410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3411"><a href="#cb102-3411" aria-hidden="true" tabindex="-1"></a><span class="fu">###### 5</span></span>
<span id="cb102-3412"><a href="#cb102-3412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3413"><a href="#cb102-3413" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb102-3414"><a href="#cb102-3414" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb102-3415"><a href="#cb102-3415" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-chap01-gtsummary-group}</span>
<span id="cb102-3416"><a href="#cb102-3416" aria-hidden="true" tabindex="-1"></a>: Summarize data by a grouped variable</span>
<span id="cb102-3417"><a href="#cb102-3417" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb102-3418"><a href="#cb102-3418" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-3419"><a href="#cb102-3419" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb102-3420"><a href="#cb102-3420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3421"><a href="#cb102-3421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3422"><a href="#cb102-3422" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-3423"><a href="#cb102-3423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3424"><a href="#cb102-3424" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-3425"><a href="#cb102-3425" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: gts-by-grass</span></span>
<span id="cb102-3426"><a href="#cb102-3426" aria-hidden="true" tabindex="-1"></a><span class="co">#| cache: true</span></span>
<span id="cb102-3427"><a href="#cb102-3427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3428"><a href="#cb102-3428" aria-hidden="true" tabindex="-1"></a>chap01_gtsummary_group <span class="ot">&lt;-</span>  chap01_gtsummary_basic <span class="sc">|&gt;</span> </span>
<span id="cb102-3429"><a href="#cb102-3429" aria-hidden="true" tabindex="-1"></a>    labelled<span class="sc">::</span><span class="fu">set_variable_labels</span>(</span>
<span id="cb102-3430"><a href="#cb102-3430" aria-hidden="true" tabindex="-1"></a>        <span class="at">grass =</span> <span class="st">&quot;Ever used grass or hash?&quot;</span></span>
<span id="cb102-3431"><a href="#cb102-3431" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb102-3432"><a href="#cb102-3432" aria-hidden="true" tabindex="-1"></a>    gtsummary<span class="sc">::</span><span class="fu">tbl_summary</span>(</span>
<span id="cb102-3433"><a href="#cb102-3433" aria-hidden="true" tabindex="-1"></a>        <span class="at">by =</span> grass,</span>
<span id="cb102-3434"><a href="#cb102-3434" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> grass <span class="sc">~</span> <span class="st">&quot;categorical&quot;</span>,</span>
<span id="cb102-3435"><a href="#cb102-3435" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="fu">list</span>(</span>
<span id="cb102-3436"><a href="#cb102-3436" aria-hidden="true" tabindex="-1"></a>            <span class="at">age_cat =</span> <span class="st">&quot;Age Category&quot;</span>,</span>
<span id="cb102-3437"><a href="#cb102-3437" aria-hidden="true" tabindex="-1"></a>            <span class="at">sex =</span> <span class="st">&quot;Sex&quot;</span></span>
<span id="cb102-3438"><a href="#cb102-3438" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb102-3439"><a href="#cb102-3439" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb102-3440"><a href="#cb102-3440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3441"><a href="#cb102-3441" aria-hidden="true" tabindex="-1"></a>chap01_gtsummary_group</span>
<span id="cb102-3442"><a href="#cb102-3442" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-3443"><a href="#cb102-3443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3444"><a href="#cb102-3444" aria-hidden="true" tabindex="-1"></a>The variable <span class="in">`grass`</span> is not grouped <span class="in">`dplyr::group_by()`</span> but inside <span class="in">`gtsummary::tbl_summary()`</span>.</span>
<span id="cb102-3445"><a href="#cb102-3445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3446"><a href="#cb102-3446" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-3447"><a href="#cb102-3447" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-3448"><a href="#cb102-3448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3449"><a href="#cb102-3449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3450"><a href="#cb102-3450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3451"><a href="#cb102-3451" aria-hidden="true" tabindex="-1"></a><span class="fu">###### 6</span></span>
<span id="cb102-3452"><a href="#cb102-3452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3453"><a href="#cb102-3453" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb102-3454"><a href="#cb102-3454" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb102-3455"><a href="#cb102-3455" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-chap01-gtsummary-header}</span>
<span id="cb102-3456"><a href="#cb102-3456" aria-hidden="true" tabindex="-1"></a>: Change table header</span>
<span id="cb102-3457"><a href="#cb102-3457" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb102-3458"><a href="#cb102-3458" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-3459"><a href="#cb102-3459" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb102-3460"><a href="#cb102-3460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3461"><a href="#cb102-3461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3462"><a href="#cb102-3462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3463"><a href="#cb102-3463" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-3464"><a href="#cb102-3464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3465"><a href="#cb102-3465" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-3466"><a href="#cb102-3466" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: gts-header</span></span>
<span id="cb102-3467"><a href="#cb102-3467" aria-hidden="true" tabindex="-1"></a><span class="co">#| cache: true</span></span>
<span id="cb102-3468"><a href="#cb102-3468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3469"><a href="#cb102-3469" aria-hidden="true" tabindex="-1"></a>chap01_gtsummary_group <span class="sc">|&gt;</span> </span>
<span id="cb102-3470"><a href="#cb102-3470" aria-hidden="true" tabindex="-1"></a>  gtsummary<span class="sc">::</span><span class="fu">modify_header</span>(label <span class="sc">~</span> <span class="st">&quot;**Variable**&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb102-3471"><a href="#cb102-3471" aria-hidden="true" tabindex="-1"></a>  gtsummary<span class="sc">::</span><span class="fu">modify_spanning_header</span>(</span>
<span id="cb102-3472"><a href="#cb102-3472" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="st">&quot;stat_1&quot;</span>, <span class="st">&quot;stat_2&quot;</span>) <span class="sc">~</span> <span class="st">&quot;**Ever used grass or hash?**&quot;</span>)</span>
<span id="cb102-3473"><a href="#cb102-3473" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-3474"><a href="#cb102-3474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3475"><a href="#cb102-3475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3476"><a href="#cb102-3476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3477"><a href="#cb102-3477" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-3478"><a href="#cb102-3478" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-3479"><a href="#cb102-3479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3480"><a href="#cb102-3480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3481"><a href="#cb102-3481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3482"><a href="#cb102-3482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3483"><a href="#cb102-3483" aria-hidden="true" tabindex="-1"></a><span class="fu">###### 7</span></span>
<span id="cb102-3484"><a href="#cb102-3484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3485"><a href="#cb102-3485" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb102-3486"><a href="#cb102-3486" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb102-3487"><a href="#cb102-3487" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-chap01-gtsummary-cross-table}</span>
<span id="cb102-3488"><a href="#cb102-3488" aria-hidden="true" tabindex="-1"></a>: Prepare cross tables and stack them </span>
<span id="cb102-3489"><a href="#cb102-3489" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb102-3490"><a href="#cb102-3490" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-3491"><a href="#cb102-3491" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb102-3492"><a href="#cb102-3492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3493"><a href="#cb102-3493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3494"><a href="#cb102-3494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3495"><a href="#cb102-3495" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-3496"><a href="#cb102-3496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3497"><a href="#cb102-3497" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-3498"><a href="#cb102-3498" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: gts-cross-table</span></span>
<span id="cb102-3499"><a href="#cb102-3499" aria-hidden="true" tabindex="-1"></a><span class="co">#| cache: true</span></span>
<span id="cb102-3500"><a href="#cb102-3500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3501"><a href="#cb102-3501" aria-hidden="true" tabindex="-1"></a>chap01_gtsummary_basic <span class="ot">&lt;-</span> </span>
<span id="cb102-3502"><a href="#cb102-3502" aria-hidden="true" tabindex="-1"></a>    <span class="fu">readRDS</span>(<span class="st">&quot;data-clean/chap01_gtsummary_clean.rds&quot;</span>)</span>
<span id="cb102-3503"><a href="#cb102-3503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3504"><a href="#cb102-3504" aria-hidden="true" tabindex="-1"></a>chap01_gtsummary_cross1 <span class="ot">&lt;-</span> chap01_gtsummary_basic <span class="sc">|&gt;</span> </span>
<span id="cb102-3505"><a href="#cb102-3505" aria-hidden="true" tabindex="-1"></a>    labelled<span class="sc">::</span><span class="fu">set_variable_labels</span>(</span>
<span id="cb102-3506"><a href="#cb102-3506" aria-hidden="true" tabindex="-1"></a>            <span class="at">grass =</span> <span class="st">&quot;**Ever used grass or hash?**&quot;</span></span>
<span id="cb102-3507"><a href="#cb102-3507" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">|&gt;</span> </span>
<span id="cb102-3508"><a href="#cb102-3508" aria-hidden="true" tabindex="-1"></a>    gtsummary<span class="sc">::</span><span class="fu">tbl_cross</span>(</span>
<span id="cb102-3509"><a href="#cb102-3509" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="fu">list</span>(</span>
<span id="cb102-3510"><a href="#cb102-3510" aria-hidden="true" tabindex="-1"></a>            <span class="at">age_cat =</span> <span class="st">&quot;Age Category&quot;</span>,</span>
<span id="cb102-3511"><a href="#cb102-3511" aria-hidden="true" tabindex="-1"></a>            <span class="at">sex =</span> <span class="st">&quot;Sex&quot;</span></span>
<span id="cb102-3512"><a href="#cb102-3512" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb102-3513"><a href="#cb102-3513" aria-hidden="true" tabindex="-1"></a>        <span class="at">row =</span> age_cat,</span>
<span id="cb102-3514"><a href="#cb102-3514" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> grass,</span>
<span id="cb102-3515"><a href="#cb102-3515" aria-hidden="true" tabindex="-1"></a>        <span class="at">percent =</span> <span class="st">&quot;cell&quot;</span></span>
<span id="cb102-3516"><a href="#cb102-3516" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb102-3517"><a href="#cb102-3517" aria-hidden="true" tabindex="-1"></a>    gtsummary<span class="sc">::</span><span class="fu">modify_header</span>(</span>
<span id="cb102-3518"><a href="#cb102-3518" aria-hidden="true" tabindex="-1"></a>      <span class="at">stat_1 =</span> <span class="st">&#39;**Yes**&#39;</span>,</span>
<span id="cb102-3519"><a href="#cb102-3519" aria-hidden="true" tabindex="-1"></a>      <span class="at">stat_2 =</span> <span class="st">&#39;**No**&#39;</span>,</span>
<span id="cb102-3520"><a href="#cb102-3520" aria-hidden="true" tabindex="-1"></a>      <span class="at">stat_0 =</span> <span class="st">&#39;**Total**&#39;</span></span>
<span id="cb102-3521"><a href="#cb102-3521" aria-hidden="true" tabindex="-1"></a>    ) </span>
<span id="cb102-3522"><a href="#cb102-3522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3523"><a href="#cb102-3523" aria-hidden="true" tabindex="-1"></a>chap01_gtsummary_cross2 <span class="ot">&lt;-</span> chap01_gtsummary_basic <span class="sc">|&gt;</span> </span>
<span id="cb102-3524"><a href="#cb102-3524" aria-hidden="true" tabindex="-1"></a>    labelled<span class="sc">::</span><span class="fu">set_variable_labels</span>(</span>
<span id="cb102-3525"><a href="#cb102-3525" aria-hidden="true" tabindex="-1"></a>            <span class="at">grass =</span> <span class="st">&quot;**Ever used grass or hash?**&quot;</span></span>
<span id="cb102-3526"><a href="#cb102-3526" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">|&gt;</span> </span>
<span id="cb102-3527"><a href="#cb102-3527" aria-hidden="true" tabindex="-1"></a>    gtsummary<span class="sc">::</span><span class="fu">tbl_cross</span>(</span>
<span id="cb102-3528"><a href="#cb102-3528" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="fu">list</span>(</span>
<span id="cb102-3529"><a href="#cb102-3529" aria-hidden="true" tabindex="-1"></a>            <span class="at">age_cat =</span> <span class="st">&quot;Age Category&quot;</span>,</span>
<span id="cb102-3530"><a href="#cb102-3530" aria-hidden="true" tabindex="-1"></a>            <span class="at">sex =</span> <span class="st">&quot;Sex&quot;</span></span>
<span id="cb102-3531"><a href="#cb102-3531" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb102-3532"><a href="#cb102-3532" aria-hidden="true" tabindex="-1"></a>        <span class="at">row =</span> sex,</span>
<span id="cb102-3533"><a href="#cb102-3533" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> grass,</span>
<span id="cb102-3534"><a href="#cb102-3534" aria-hidden="true" tabindex="-1"></a>        <span class="at">percent =</span> <span class="st">&quot;cell&quot;</span></span>
<span id="cb102-3535"><a href="#cb102-3535" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb102-3536"><a href="#cb102-3536" aria-hidden="true" tabindex="-1"></a>    gtsummary<span class="sc">::</span><span class="fu">modify_header</span>(</span>
<span id="cb102-3537"><a href="#cb102-3537" aria-hidden="true" tabindex="-1"></a>      <span class="at">stat_1 =</span> <span class="st">&#39;**Yes**&#39;</span>,</span>
<span id="cb102-3538"><a href="#cb102-3538" aria-hidden="true" tabindex="-1"></a>      <span class="at">stat_2 =</span> <span class="st">&#39;**No**&#39;</span>,</span>
<span id="cb102-3539"><a href="#cb102-3539" aria-hidden="true" tabindex="-1"></a>      <span class="at">stat_0 =</span> <span class="st">&#39;**Total**&#39;</span></span>
<span id="cb102-3540"><a href="#cb102-3540" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb102-3541"><a href="#cb102-3541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3542"><a href="#cb102-3542" aria-hidden="true" tabindex="-1"></a>gtsummary<span class="sc">::</span><span class="fu">tbl_stack</span>(</span>
<span id="cb102-3543"><a href="#cb102-3543" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(chap01_gtsummary_cross1,</span>
<span id="cb102-3544"><a href="#cb102-3544" aria-hidden="true" tabindex="-1"></a>         chap01_gtsummary_cross2)</span>
<span id="cb102-3545"><a href="#cb102-3545" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb102-3546"><a href="#cb102-3546" aria-hidden="true" tabindex="-1"></a>    gtsummary<span class="sc">::</span><span class="fu">bold_labels</span>() </span>
<span id="cb102-3547"><a href="#cb102-3547" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-3548"><a href="#cb102-3548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3549"><a href="#cb102-3549" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-3550"><a href="#cb102-3550" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-3551"><a href="#cb102-3551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3552"><a href="#cb102-3552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3553"><a href="#cb102-3553" aria-hidden="true" tabindex="-1"></a><span class="fu">###### 8</span></span>
<span id="cb102-3554"><a href="#cb102-3554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3555"><a href="#cb102-3555" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb102-3556"><a href="#cb102-3556" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb102-3557"><a href="#cb102-3557" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-ID-chap01-gtsummary-stratify}</span>
<span id="cb102-3558"><a href="#cb102-3558" aria-hidden="true" tabindex="-1"></a>: Stratify tables</span>
<span id="cb102-3559"><a href="#cb102-3559" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb102-3560"><a href="#cb102-3560" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-3561"><a href="#cb102-3561" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb102-3562"><a href="#cb102-3562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3563"><a href="#cb102-3563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3564"><a href="#cb102-3564" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-3565"><a href="#cb102-3565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3566"><a href="#cb102-3566" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-3567"><a href="#cb102-3567" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-gts-stratify</span></span>
<span id="cb102-3568"><a href="#cb102-3568" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: &quot;Did you ever use marijuana or hashish?&quot;</span></span>
<span id="cb102-3569"><a href="#cb102-3569" aria-hidden="true" tabindex="-1"></a><span class="co">#| cache: true</span></span>
<span id="cb102-3570"><a href="#cb102-3570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3571"><a href="#cb102-3571" aria-hidden="true" tabindex="-1"></a>chap01_gtsummary_basic <span class="ot">&lt;-</span> </span>
<span id="cb102-3572"><a href="#cb102-3572" aria-hidden="true" tabindex="-1"></a>    <span class="fu">readRDS</span>(<span class="st">&quot;data-clean/chap01_gtsummary_clean.rds&quot;</span>)</span>
<span id="cb102-3573"><a href="#cb102-3573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3574"><a href="#cb102-3574" aria-hidden="true" tabindex="-1"></a>chap01_gtsummary_basic <span class="sc">|&gt;</span> </span>
<span id="cb102-3575"><a href="#cb102-3575" aria-hidden="true" tabindex="-1"></a>    gtsummary<span class="sc">::</span><span class="fu">tbl_strata</span>(</span>
<span id="cb102-3576"><a href="#cb102-3576" aria-hidden="true" tabindex="-1"></a>        <span class="at">strata =</span> grass,</span>
<span id="cb102-3577"><a href="#cb102-3577" aria-hidden="true" tabindex="-1"></a>        <span class="sc">~</span> .x <span class="sc">|&gt;</span> </span>
<span id="cb102-3578"><a href="#cb102-3578" aria-hidden="true" tabindex="-1"></a>    gtsummary<span class="sc">::</span><span class="fu">tbl_summary</span>(</span>
<span id="cb102-3579"><a href="#cb102-3579" aria-hidden="true" tabindex="-1"></a>        <span class="at">by =</span> sex,</span>
<span id="cb102-3580"><a href="#cb102-3580" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> age_cat <span class="sc">~</span> <span class="st">&quot;Age Category&quot;</span></span>
<span id="cb102-3581"><a href="#cb102-3581" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">|&gt;</span> </span>
<span id="cb102-3582"><a href="#cb102-3582" aria-hidden="true" tabindex="-1"></a>    gtsummary<span class="sc">::</span><span class="fu">add_overall</span>() <span class="sc">|&gt;</span> </span>
<span id="cb102-3583"><a href="#cb102-3583" aria-hidden="true" tabindex="-1"></a>    gtsummary<span class="sc">::</span><span class="fu">modify_header</span>(</span>
<span id="cb102-3584"><a href="#cb102-3584" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="st">&quot;**Variables**&quot;</span>,</span>
<span id="cb102-3585"><a href="#cb102-3585" aria-hidden="true" tabindex="-1"></a>        gtsummary<span class="sc">::</span><span class="fu">all_stat_cols</span>() <span class="sc">~</span> <span class="st">&quot;**{level}**&quot;</span></span>
<span id="cb102-3586"><a href="#cb102-3586" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb102-3587"><a href="#cb102-3587" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb102-3588"><a href="#cb102-3588" aria-hidden="true" tabindex="-1"></a>  gtsummary<span class="sc">::</span><span class="fu">bold_labels</span>() </span>
<span id="cb102-3589"><a href="#cb102-3589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3590"><a href="#cb102-3590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3591"><a href="#cb102-3591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3592"><a href="#cb102-3592" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-3593"><a href="#cb102-3593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3594"><a href="#cb102-3594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3595"><a href="#cb102-3595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3596"><a href="#cb102-3596" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-3597"><a href="#cb102-3597" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-3598"><a href="#cb102-3598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3599"><a href="#cb102-3599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3600"><a href="#cb102-3600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3601"><a href="#cb102-3601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3602"><a href="#cb102-3602" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-3603"><a href="#cb102-3603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3604"><a href="#cb102-3604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3605"><a href="#cb102-3605" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-3606"><a href="#cb102-3606" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-3607"><a href="#cb102-3607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3608"><a href="#cb102-3608" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-3609"><a href="#cb102-3609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3610"><a href="#cb102-3610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3611"><a href="#cb102-3611" aria-hidden="true" tabindex="-1"></a><span class="fu">## Opinions about legalizing marijuana (1973-2022) {#sec-chap01-grass-timeline}</span></span>
<span id="cb102-3612"><a href="#cb102-3612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3613"><a href="#cb102-3613" aria-hidden="true" tabindex="-1"></a>:::::{.my-experiment}</span>
<span id="cb102-3614"><a href="#cb102-3614" aria-hidden="true" tabindex="-1"></a>:::{.my-experiment-header}</span>
<span id="cb102-3615"><a href="#cb102-3615" aria-hidden="true" tabindex="-1"></a>:::::: {#def-chap01-timeline-grass}</span>
<span id="cb102-3616"><a href="#cb102-3616" aria-hidden="true" tabindex="-1"></a>: Developing a graph showing the timeline of respondents opinion about legalizing marijuana (1973-2022)</span>
<span id="cb102-3617"><a href="#cb102-3617" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb102-3618"><a href="#cb102-3618" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-3619"><a href="#cb102-3619" aria-hidden="true" tabindex="-1"></a>::::{.my-experiment-container}</span>
<span id="cb102-3620"><a href="#cb102-3620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3621"><a href="#cb102-3621" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb102-3622"><a href="#cb102-3622" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Load data</span></span>
<span id="cb102-3623"><a href="#cb102-3623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3624"><a href="#cb102-3624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3625"><a href="#cb102-3625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3626"><a href="#cb102-3626" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb102-3627"><a href="#cb102-3627" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb102-3628"><a href="#cb102-3628" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-chap01-load-gss-grass-legal}</span>
<span id="cb102-3629"><a href="#cb102-3629" aria-hidden="true" tabindex="-1"></a>: Load the GSS data from 1972-2022 and select appropriate variables</span>
<span id="cb102-3630"><a href="#cb102-3630" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb102-3631"><a href="#cb102-3631" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-3632"><a href="#cb102-3632" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb102-3633"><a href="#cb102-3633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3634"><a href="#cb102-3634" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-3635"><a href="#cb102-3635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3636"><a href="#cb102-3636" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-3637"><a href="#cb102-3637" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: load-gss-grass-legal</span></span>
<span id="cb102-3638"><a href="#cb102-3638" aria-hidden="true" tabindex="-1"></a><span class="co">#| cache: true</span></span>
<span id="cb102-3639"><a href="#cb102-3639" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb102-3640"><a href="#cb102-3640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3641"><a href="#cb102-3641" aria-hidden="true" tabindex="-1"></a><span class="do">## run only once (manually) #########</span></span>
<span id="cb102-3642"><a href="#cb102-3642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3643"><a href="#cb102-3643" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gssr)   <span class="do">## load package</span></span>
<span id="cb102-3644"><a href="#cb102-3644" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(gss_all)   <span class="do">## attach GSS data </span></span>
<span id="cb102-3645"><a href="#cb102-3645" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(gss_dict)  <span class="do">## attach codebook</span></span>
<span id="cb102-3646"><a href="#cb102-3646" aria-hidden="true" tabindex="-1"></a>chap01_gss_grass_legal <span class="ot">&lt;-</span> gss_all <span class="sc">|&gt;</span> </span>
<span id="cb102-3647"><a href="#cb102-3647" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(year, age, grass) </span>
<span id="cb102-3648"><a href="#cb102-3648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3649"><a href="#cb102-3649" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">saveRDS</span>(chap01_gss_grass_legal, <span class="st">&quot;data-raw/chap01_gss_grass_legal.rds&quot;</span>)</span>
<span id="cb102-3650"><a href="#cb102-3650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3651"><a href="#cb102-3651" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">unloadNamespace</span>(<span class="st">&quot;gssr&quot;</span>)</span>
<span id="cb102-3652"><a href="#cb102-3652" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-3653"><a href="#cb102-3653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3654"><a href="#cb102-3654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3655"><a href="#cb102-3655" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-3656"><a href="#cb102-3656" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-3657"><a href="#cb102-3657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3658"><a href="#cb102-3658" aria-hidden="true" tabindex="-1"></a>(*This R code chunk has no visible output*)</span>
<span id="cb102-3659"><a href="#cb102-3659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3660"><a href="#cb102-3660" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Clean data</span></span>
<span id="cb102-3661"><a href="#cb102-3661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3662"><a href="#cb102-3662" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb102-3663"><a href="#cb102-3663" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb102-3664"><a href="#cb102-3664" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-chap01-clean-gss-grass-legal}</span>
<span id="cb102-3665"><a href="#cb102-3665" aria-hidden="true" tabindex="-1"></a>: Clean <span class="in">`grass-legal`</span> dataset</span>
<span id="cb102-3666"><a href="#cb102-3666" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb102-3667"><a href="#cb102-3667" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-3668"><a href="#cb102-3668" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb102-3669"><a href="#cb102-3669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3670"><a href="#cb102-3670" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-3671"><a href="#cb102-3671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3672"><a href="#cb102-3672" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-3673"><a href="#cb102-3673" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: clean-gss-grass-legal</span></span>
<span id="cb102-3674"><a href="#cb102-3674" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hold</span></span>
<span id="cb102-3675"><a href="#cb102-3675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3676"><a href="#cb102-3676" aria-hidden="true" tabindex="-1"></a><span class="do">## run only once (manually) ##########</span></span>
<span id="cb102-3677"><a href="#cb102-3677" aria-hidden="true" tabindex="-1"></a>chap01_gss_grass_legal <span class="ot">&lt;-</span> </span>
<span id="cb102-3678"><a href="#cb102-3678" aria-hidden="true" tabindex="-1"></a>    base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="st">&quot;data-raw/chap01_gss_grass_legal.rds&quot;</span>)</span>
<span id="cb102-3679"><a href="#cb102-3679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3680"><a href="#cb102-3680" aria-hidden="true" tabindex="-1"></a>chap01_gss_grass_legal_clean <span class="ot">&lt;-</span> chap01_gss_grass_legal <span class="sc">|&gt;</span> </span>
<span id="cb102-3681"><a href="#cb102-3681" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">drop_na</span>() <span class="sc">|&gt;</span> </span>
<span id="cb102-3682"><a href="#cb102-3682" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb102-3683"><a href="#cb102-3683" aria-hidden="true" tabindex="-1"></a>        <span class="at">grass =</span> forcats<span class="sc">::</span><span class="fu">as_factor</span>(grass),</span>
<span id="cb102-3684"><a href="#cb102-3684" aria-hidden="true" tabindex="-1"></a>        <span class="at">grass =</span> forcats<span class="sc">::</span><span class="fu">fct_drop</span>(grass),</span>
<span id="cb102-3685"><a href="#cb102-3685" aria-hidden="true" tabindex="-1"></a>        <span class="at">year =</span> base<span class="sc">::</span><span class="fu">as.numeric</span>(year),</span>
<span id="cb102-3686"><a href="#cb102-3686" aria-hidden="true" tabindex="-1"></a>        <span class="at">age =</span> base<span class="sc">::</span><span class="fu">as.numeric</span>(age)</span>
<span id="cb102-3687"><a href="#cb102-3687" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb102-3688"><a href="#cb102-3688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3689"><a href="#cb102-3689" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">saveRDS</span>(chap01_gss_grass_legal_clean, <span class="at">file =</span> </span>
<span id="cb102-3690"><a href="#cb102-3690" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;data-clean/chap01_gss_grass_legal_clean.rds&quot;</span>)</span>
<span id="cb102-3691"><a href="#cb102-3691" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-3692"><a href="#cb102-3692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3693"><a href="#cb102-3693" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-3694"><a href="#cb102-3694" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-3695"><a href="#cb102-3695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3696"><a href="#cb102-3696" aria-hidden="true" tabindex="-1"></a>(*This R code chunk has no visible output*)</span>
<span id="cb102-3697"><a href="#cb102-3697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3698"><a href="#cb102-3698" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Show summary</span></span>
<span id="cb102-3699"><a href="#cb102-3699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3700"><a href="#cb102-3700" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb102-3701"><a href="#cb102-3701" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb102-3702"><a href="#cb102-3702" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-chap01-gss-grass-clean-data}</span>
<span id="cb102-3703"><a href="#cb102-3703" aria-hidden="true" tabindex="-1"></a>: Show summary of cleaned dataset</span>
<span id="cb102-3704"><a href="#cb102-3704" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb102-3705"><a href="#cb102-3705" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-3706"><a href="#cb102-3706" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb102-3707"><a href="#cb102-3707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3708"><a href="#cb102-3708" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-3709"><a href="#cb102-3709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3710"><a href="#cb102-3710" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-3711"><a href="#cb102-3711" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-gtsummary-gss-grass-legal</span></span>
<span id="cb102-3712"><a href="#cb102-3712" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: &quot;Summary of GSS surveys about opinion about legalizing marijuana between 1972-2022&quot; </span></span>
<span id="cb102-3713"><a href="#cb102-3713" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb102-3714"><a href="#cb102-3714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3715"><a href="#cb102-3715" aria-hidden="true" tabindex="-1"></a>grass_legal <span class="ot">&lt;-</span> </span>
<span id="cb102-3716"><a href="#cb102-3716" aria-hidden="true" tabindex="-1"></a>    base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="st">&quot;data-clean/chap01_gss_grass_legal_clean.rds&quot;</span>)</span>
<span id="cb102-3717"><a href="#cb102-3717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3718"><a href="#cb102-3718" aria-hidden="true" tabindex="-1"></a><span class="do">## remove comma from big numbers</span></span>
<span id="cb102-3719"><a href="#cb102-3719" aria-hidden="true" tabindex="-1"></a>gtsummary<span class="sc">::</span><span class="fu">theme_gtsummary_language</span>(<span class="st">&quot;en&quot;</span>, <span class="at">big.mark =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb102-3720"><a href="#cb102-3720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3721"><a href="#cb102-3721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3722"><a href="#cb102-3722" aria-hidden="true" tabindex="-1"></a>grass_legal <span class="sc">|&gt;</span> </span>
<span id="cb102-3723"><a href="#cb102-3723" aria-hidden="true" tabindex="-1"></a>  gtsummary<span class="sc">::</span><span class="fu">tbl_summary</span>(</span>
<span id="cb102-3724"><a href="#cb102-3724" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">list</span>(</span>
<span id="cb102-3725"><a href="#cb102-3725" aria-hidden="true" tabindex="-1"></a>        year <span class="sc">~</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb102-3726"><a href="#cb102-3726" aria-hidden="true" tabindex="-1"></a>        age <span class="sc">~</span> <span class="st">&quot;Age&quot;</span>,</span>
<span id="cb102-3727"><a href="#cb102-3727" aria-hidden="true" tabindex="-1"></a>        grass <span class="sc">~</span> <span class="st">&quot;Should marijuana be legal?&quot;</span></span>
<span id="cb102-3728"><a href="#cb102-3728" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb102-3729"><a href="#cb102-3729" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="fu">list</span>(age <span class="sc">~</span> <span class="st">&quot;continuous2&quot;</span>, year <span class="sc">~</span> <span class="st">&quot;continuous2&quot;</span>),</span>
<span id="cb102-3730"><a href="#cb102-3730" aria-hidden="true" tabindex="-1"></a>    <span class="at">statistic =</span> </span>
<span id="cb102-3731"><a href="#cb102-3731" aria-hidden="true" tabindex="-1"></a>         <span class="fu">list</span>(</span>
<span id="cb102-3732"><a href="#cb102-3732" aria-hidden="true" tabindex="-1"></a>            age <span class="sc">~</span> <span class="fu">c</span>(</span>
<span id="cb102-3733"><a href="#cb102-3733" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;{mean} ({sd})&quot;</span>,</span>
<span id="cb102-3734"><a href="#cb102-3734" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;{median} ({p25}, {p75})&quot;</span>,</span>
<span id="cb102-3735"><a href="#cb102-3735" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;{min}, {max}&quot;</span></span>
<span id="cb102-3736"><a href="#cb102-3736" aria-hidden="true" tabindex="-1"></a>         ), </span>
<span id="cb102-3737"><a href="#cb102-3737" aria-hidden="true" tabindex="-1"></a>            year <span class="sc">~</span> <span class="fu">c</span>(<span class="st">&quot;{min}, {max}&quot;</span>)</span>
<span id="cb102-3738"><a href="#cb102-3738" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb102-3739"><a href="#cb102-3739" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb102-3740"><a href="#cb102-3740" aria-hidden="true" tabindex="-1"></a>  gtsummary<span class="sc">::</span><span class="fu">italicize_levels</span>() <span class="sc">|&gt;</span> </span>
<span id="cb102-3741"><a href="#cb102-3741" aria-hidden="true" tabindex="-1"></a>  gtsummary<span class="sc">::</span><span class="fu">bold_labels</span>()</span>
<span id="cb102-3742"><a href="#cb102-3742" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb102-3743"><a href="#cb102-3743" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-3744"><a href="#cb102-3744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3745"><a href="#cb102-3745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3746"><a href="#cb102-3746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3747"><a href="#cb102-3747" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-3748"><a href="#cb102-3748" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-3749"><a href="#cb102-3749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3750"><a href="#cb102-3750" aria-hidden="true" tabindex="-1"></a>:::::{.my-watch-out}</span>
<span id="cb102-3751"><a href="#cb102-3751" aria-hidden="true" tabindex="-1"></a>:::{.my-watch-out-header}</span>
<span id="cb102-3752"><a href="#cb102-3752" aria-hidden="true" tabindex="-1"></a>WATCH OUT! Summary with labelled data</span>
<span id="cb102-3753"><a href="#cb102-3753" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-3754"><a href="#cb102-3754" aria-hidden="true" tabindex="-1"></a>::::{.my-watch-out-container}</span>
<span id="cb102-3755"><a href="#cb102-3755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3756"><a href="#cb102-3756" aria-hidden="true" tabindex="-1"></a>I used for the summary the labelled data from the {**gssr**} package. This has the big advantage that I didn&#39;t recode the variable names and could use the variable and value metadata!</span>
<span id="cb102-3757"><a href="#cb102-3757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3758"><a href="#cb102-3758" aria-hidden="true" tabindex="-1"></a>But {**gtsummary**} warned me to see that this is only &quot;an intermediate data structure not meant for analysis&quot;.  </span>
<span id="cb102-3759"><a href="#cb102-3759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3760"><a href="#cb102-3760" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Column(s) age are class &quot;haven_labelled&quot;. This is an intermediate datastructure not meant for analysis. Convert columns with </span><span class="in">`haven::as_factor()`</span><span class="at">, </span><span class="in">`labelled::to_factor()`</span><span class="at">, </span><span class="in">`labelled::unlabelled()`</span><span class="at">, and </span><span class="in">`unclass()`</span><span class="at">. &quot;haven_labelled&quot; value labels are ignored when columns are not converted. Failure to convert may have unintended consequences or result in error.</span></span>
<span id="cb102-3761"><a href="#cb102-3761" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb102-3762"><a href="#cb102-3762" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; - </span><span class="co">[</span><span class="ot">https://haven.tidyverse.org/articles/semantics.html</span><span class="co">](https://haven.tidyverse.org/articles/semantics.html)</span></span>
<span id="cb102-3763"><a href="#cb102-3763" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; - </span><span class="co">[</span><span class="ot">https://larmarange.github.io/labelled/articles/intro_labelled.html#unlabelled</span><span class="co">](https://haven.tidyverse.org/articles/semantics.html)</span></span>
<span id="cb102-3764"><a href="#cb102-3764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3765"><a href="#cb102-3765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3766"><a href="#cb102-3766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3767"><a href="#cb102-3767" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-3768"><a href="#cb102-3768" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-3769"><a href="#cb102-3769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3770"><a href="#cb102-3770" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Prepare data</span></span>
<span id="cb102-3771"><a href="#cb102-3771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3772"><a href="#cb102-3772" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb102-3773"><a href="#cb102-3773" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb102-3774"><a href="#cb102-3774" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-chap01-gss-grass-prepare-data}</span>
<span id="cb102-3775"><a href="#cb102-3775" aria-hidden="true" tabindex="-1"></a>: Prepare data for timeline graph</span>
<span id="cb102-3776"><a href="#cb102-3776" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb102-3777"><a href="#cb102-3777" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-3778"><a href="#cb102-3778" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb102-3779"><a href="#cb102-3779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3780"><a href="#cb102-3780" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-3781"><a href="#cb102-3781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3782"><a href="#cb102-3782" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-3783"><a href="#cb102-3783" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: gss-grass-prepare-data</span></span>
<span id="cb102-3784"><a href="#cb102-3784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3785"><a href="#cb102-3785" aria-hidden="true" tabindex="-1"></a>grass_legal <span class="ot">&lt;-</span> </span>
<span id="cb102-3786"><a href="#cb102-3786" aria-hidden="true" tabindex="-1"></a>    base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="st">&quot;data-clean/chap01_gss_grass_legal_clean.rds&quot;</span>)</span>
<span id="cb102-3787"><a href="#cb102-3787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3788"><a href="#cb102-3788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3789"><a href="#cb102-3789" aria-hidden="true" tabindex="-1"></a>grass_legal2 <span class="ot">&lt;-</span> grass_legal <span class="sc">|&gt;</span> </span>
<span id="cb102-3790"><a href="#cb102-3790" aria-hidden="true" tabindex="-1"></a>    <span class="co"># labelled::remove_labels() |&gt; </span></span>
<span id="cb102-3791"><a href="#cb102-3791" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(year) <span class="sc">|&gt;</span> </span>
<span id="cb102-3792"><a href="#cb102-3792" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">add_count</span>(<span class="at">name =</span> <span class="st">&quot;N&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb102-3793"><a href="#cb102-3793" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">add_count</span>(grass) <span class="sc">|&gt;</span> </span>
<span id="cb102-3794"><a href="#cb102-3794" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">perc =</span> n <span class="sc">/</span> N <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">|&gt;</span> </span>
<span id="cb102-3795"><a href="#cb102-3795" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">ungroup</span>()</span>
<span id="cb102-3796"><a href="#cb102-3796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3797"><a href="#cb102-3797" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-3798"><a href="#cb102-3798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3799"><a href="#cb102-3799" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-3800"><a href="#cb102-3800" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-3801"><a href="#cb102-3801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3802"><a href="#cb102-3802" aria-hidden="true" tabindex="-1"></a>(*This R code chunk has no visible output*)</span>
<span id="cb102-3803"><a href="#cb102-3803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3804"><a href="#cb102-3804" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Timeline</span></span>
<span id="cb102-3805"><a href="#cb102-3805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3806"><a href="#cb102-3806" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb102-3807"><a href="#cb102-3807" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb102-3808"><a href="#cb102-3808" aria-hidden="true" tabindex="-1"></a>:::::: {#cnj-chap01-gss-grass-timeline}</span>
<span id="cb102-3809"><a href="#cb102-3809" aria-hidden="true" tabindex="-1"></a>: Timeline of respondents opinion about legalizing marijuana (1973-2022)</span>
<span id="cb102-3810"><a href="#cb102-3810" aria-hidden="true" tabindex="-1"></a>::::::</span>
<span id="cb102-3811"><a href="#cb102-3811" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-3812"><a href="#cb102-3812" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb102-3813"><a href="#cb102-3813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3814"><a href="#cb102-3814" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-3815"><a href="#cb102-3815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3816"><a href="#cb102-3816" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-3817"><a href="#cb102-3817" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-gss-grass-timeline</span></span>
<span id="cb102-3818"><a href="#cb102-3818" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: &quot;Timeline of respondents opinion about legalizing marijuana between 1972-2022 of the GSS data&quot;</span></span>
<span id="cb102-3819"><a href="#cb102-3819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3820"><a href="#cb102-3820" aria-hidden="true" tabindex="-1"></a>grass_legal2 <span class="sc">|&gt;</span> </span>
<span id="cb102-3821"><a href="#cb102-3821" aria-hidden="true" tabindex="-1"></a>    <span class="co"># dplyr::group_by(year) |&gt; </span></span>
<span id="cb102-3822"><a href="#cb102-3822" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(</span>
<span id="cb102-3823"><a href="#cb102-3823" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> year, </span>
<span id="cb102-3824"><a href="#cb102-3824" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> perc,</span>
<span id="cb102-3825"><a href="#cb102-3825" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> grass)) <span class="sc">+</span></span>
<span id="cb102-3826"><a href="#cb102-3826" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb102-3827"><a href="#cb102-3827" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb102-3828"><a href="#cb102-3828" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">scale_color_manual</span>(</span>
<span id="cb102-3829"><a href="#cb102-3829" aria-hidden="true" tabindex="-1"></a>        <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#79a778&quot;</span>, <span class="st">&#39;#7662aa&#39;</span>)</span>
<span id="cb102-3830"><a href="#cb102-3830" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">+</span></span>
<span id="cb102-3831"><a href="#cb102-3831" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">scale_x_continuous</span>(</span>
<span id="cb102-3832"><a href="#cb102-3832" aria-hidden="true" tabindex="-1"></a>        <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1973</span>, <span class="fu">seq</span>(<span class="dv">1978</span>, <span class="dv">2022</span>, <span class="dv">4</span>), <span class="dv">2022</span>)</span>
<span id="cb102-3833"><a href="#cb102-3833" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">+</span></span>
<span id="cb102-3834"><a href="#cb102-3834" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">axis.text.x =</span></span>
<span id="cb102-3835"><a href="#cb102-3835" aria-hidden="true" tabindex="-1"></a>          ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb102-3836"><a href="#cb102-3836" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb102-3837"><a href="#cb102-3837" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">&quot;Should marijuana be legal?&quot;</span>,</span>
<span id="cb102-3838"><a href="#cb102-3838" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">&quot;Percent of responses&quot;</span>,</span>
<span id="cb102-3839"><a href="#cb102-3839" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">&quot;Marijuana&quot;</span>) <span class="sc">+</span></span>
<span id="cb102-3840"><a href="#cb102-3840" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">82</span>, .<span class="dv">85</span>))</span>
<span id="cb102-3841"><a href="#cb102-3841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3842"><a href="#cb102-3842" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-3843"><a href="#cb102-3843" aria-hidden="true" tabindex="-1"></a>@fig-gss-grass-timeline shows that the proportion of people that support legalizing marijuana is (with the exception of 1978-1990) continuously rising. Starting from 19% support in 1973 approval hits 70% in 2022, the last date where data are available. The turning point where the proportion of affirmation was the first time greater than the disapproval was in 2014 (55/45).</span>
<span id="cb102-3844"><a href="#cb102-3844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3845"><a href="#cb102-3845" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-3846"><a href="#cb102-3846" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-3847"><a href="#cb102-3847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3848"><a href="#cb102-3848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3849"><a href="#cb102-3849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3850"><a href="#cb102-3850" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-3851"><a href="#cb102-3851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3852"><a href="#cb102-3852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3853"><a href="#cb102-3853" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-3854"><a href="#cb102-3854" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-3855"><a href="#cb102-3855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3856"><a href="#cb102-3856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3857"><a href="#cb102-3857" aria-hidden="true" tabindex="-1"></a><span class="fu">## Packages introduced in this chapter</span></span>
<span id="cb102-3858"><a href="#cb102-3858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3859"><a href="#cb102-3859" aria-hidden="true" tabindex="-1"></a><span class="fu">### dplyr</span></span>
<span id="cb102-3860"><a href="#cb102-3860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3861"><a href="#cb102-3861" aria-hidden="true" tabindex="-1"></a>:::::{.my-resource}</span>
<span id="cb102-3862"><a href="#cb102-3862" aria-hidden="true" tabindex="-1"></a>:::{.my-resource-header}</span>
<span id="cb102-3863"><a href="#cb102-3863" aria-hidden="true" tabindex="-1"></a>dplyr:: A Grammar of Data Manipulation</span>
<span id="cb102-3864"><a href="#cb102-3864" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-3865"><a href="#cb102-3865" aria-hidden="true" tabindex="-1"></a>::::{.my-resource-container}</span>
<span id="cb102-3866"><a href="#cb102-3866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3867"><a href="#cb102-3867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3868"><a href="#cb102-3868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3869"><a href="#cb102-3869" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-3870"><a href="#cb102-3870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3871"><a href="#cb102-3871" aria-hidden="true" tabindex="-1"></a>::: {#pak-dplyr}</span>
<span id="cb102-3872"><a href="#cb102-3872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3873"><a href="#cb102-3873" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-3874"><a href="#cb102-3874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3875"><a href="#cb102-3875" aria-hidden="true" tabindex="-1"></a>{**package**}: <span class="co">[</span><span class="ot">A Grammar of Data Manipulation</span><span class="co">](https://dplyr.tidyverse.org/)</span></span>
<span id="cb102-3876"><a href="#cb102-3876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3877"><a href="#cb102-3877" aria-hidden="true" tabindex="-1"></a>::: {layout=&quot;<span class="co">[</span><span class="ot">10, 30</span><span class="co">]</span>&quot; layout-valign=&quot;center&quot;}</span>
<span id="cb102-3878"><a href="#cb102-3878" aria-hidden="true" tabindex="-1"></a><span class="al">![](img/chap01/logoi/logo-dplyr-min.png)</span>{width=&quot;176&quot;}</span>
<span id="cb102-3879"><a href="#cb102-3879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3880"><a href="#cb102-3880" aria-hidden="true" tabindex="-1"></a>{**dplyr**} is a grammar of data manipulation, providing a consistent set of verbs that help you solve the most common data manipulation challenges:</span>
<span id="cb102-3881"><a href="#cb102-3881" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>mutate() adds new variables that are functions of existing variables</span>
<span id="cb102-3882"><a href="#cb102-3882" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>select() picks variables based on their names.</span>
<span id="cb102-3883"><a href="#cb102-3883" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>filter() picks cases based on their values.</span>
<span id="cb102-3884"><a href="#cb102-3884" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>summarise() reduces multiple values down to a single summary.</span>
<span id="cb102-3885"><a href="#cb102-3885" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>arrange() changes the ordering of the rows. <span class="co">[</span><span class="ot">@dplyr</span><span class="co">]</span></span>
<span id="cb102-3886"><a href="#cb102-3886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3887"><a href="#cb102-3887" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-3888"><a href="#cb102-3888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3889"><a href="#cb102-3889" aria-hidden="true" tabindex="-1"></a>These all combine naturally with group_by() which allows you to perform any operation “by group”. You can learn more about them in <span class="co">[</span><span class="ot">vignette(&quot;dplyr&quot;)</span><span class="co">](https://dplyr.tidyverse.org/articles/dplyr.html)</span>. As well as these single-table verbs, dplyr also provides a variety of two-table verbs, which you can learn about in <span class="co">[</span><span class="ot">vignette(&quot;two-table&quot;)</span><span class="co">](https://dplyr.tidyverse.org/articles/two-table.html)</span>. <span class="co">[</span><span class="ot">@dplyr</span><span class="co">]</span></span>
<span id="cb102-3890"><a href="#cb102-3890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3891"><a href="#cb102-3891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3892"><a href="#cb102-3892" aria-hidden="true" tabindex="-1"></a>Package for Data Manipulation</span>
<span id="cb102-3893"><a href="#cb102-3893" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-3894"><a href="#cb102-3894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3895"><a href="#cb102-3895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3896"><a href="#cb102-3896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3897"><a href="#cb102-3897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3898"><a href="#cb102-3898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3899"><a href="#cb102-3899" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-3900"><a href="#cb102-3900" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-3901"><a href="#cb102-3901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3902"><a href="#cb102-3902" aria-hidden="true" tabindex="-1"></a><span class="fu">### DT</span></span>
<span id="cb102-3903"><a href="#cb102-3903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3904"><a href="#cb102-3904" aria-hidden="true" tabindex="-1"></a>:::::{.my-resource}</span>
<span id="cb102-3905"><a href="#cb102-3905" aria-hidden="true" tabindex="-1"></a>:::{.my-resource-header}</span>
<span id="cb102-3906"><a href="#cb102-3906" aria-hidden="true" tabindex="-1"></a>DT: A Wrapper of the JavaScript Library &#39;DataTables&#39;</span>
<span id="cb102-3907"><a href="#cb102-3907" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-3908"><a href="#cb102-3908" aria-hidden="true" tabindex="-1"></a>::::{.my-resource-container}</span>
<span id="cb102-3909"><a href="#cb102-3909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3910"><a href="#cb102-3910" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-3911"><a href="#cb102-3911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3912"><a href="#cb102-3912" aria-hidden="true" tabindex="-1"></a>::: {#pak-DT}</span>
<span id="cb102-3913"><a href="#cb102-3913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3914"><a href="#cb102-3914" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-3915"><a href="#cb102-3915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3916"><a href="#cb102-3916" aria-hidden="true" tabindex="-1"></a>{**DT**}: <span class="co">[</span><span class="ot">https://github.com/rstudio/DT</span><span class="co">](https://rstudio.github.io/DT/)</span></span>
<span id="cb102-3917"><a href="#cb102-3917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3918"><a href="#cb102-3918" aria-hidden="true" tabindex="-1"></a>(*There is no hexagon icon available for {**DT**}*)</span>
<span id="cb102-3919"><a href="#cb102-3919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3920"><a href="#cb102-3920" aria-hidden="true" tabindex="-1"></a>Data objects in R can be rendered as HTML tables using the JavaScript library <span class="co">[</span><span class="ot">DataTables</span><span class="co">](https://datatables.net/)</span> (typically via R Markdown or Shiny). The &#39;DataTables&#39; library has been included in this R package. The package name {**DT**} is an abbreviation of &#39;DataTables&#39;.</span>
<span id="cb102-3921"><a href="#cb102-3921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3922"><a href="#cb102-3922" aria-hidden="true" tabindex="-1"></a>{**DT**}: A Package as Wrapper of the JavaScript Library &#39;DataTables&#39;</span>
<span id="cb102-3923"><a href="#cb102-3923" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-3924"><a href="#cb102-3924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3925"><a href="#cb102-3925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3926"><a href="#cb102-3926" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-3927"><a href="#cb102-3927" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-3928"><a href="#cb102-3928" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-3929"><a href="#cb102-3929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3930"><a href="#cb102-3930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3931"><a href="#cb102-3931" aria-hidden="true" tabindex="-1"></a><span class="fu">### forcats</span></span>
<span id="cb102-3932"><a href="#cb102-3932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3933"><a href="#cb102-3933" aria-hidden="true" tabindex="-1"></a>:::::{.my-resource}</span>
<span id="cb102-3934"><a href="#cb102-3934" aria-hidden="true" tabindex="-1"></a>:::{.my-resource-header}</span>
<span id="cb102-3935"><a href="#cb102-3935" aria-hidden="true" tabindex="-1"></a>forcats: Tools for Working with Categorical Variables</span>
<span id="cb102-3936"><a href="#cb102-3936" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-3937"><a href="#cb102-3937" aria-hidden="true" tabindex="-1"></a>::::{.my-resource-container}</span>
<span id="cb102-3938"><a href="#cb102-3938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3939"><a href="#cb102-3939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3940"><a href="#cb102-3940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3941"><a href="#cb102-3941" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-3942"><a href="#cb102-3942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3943"><a href="#cb102-3943" aria-hidden="true" tabindex="-1"></a>::: {#pak-forcats}</span>
<span id="cb102-3944"><a href="#cb102-3944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3945"><a href="#cb102-3945" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-3946"><a href="#cb102-3946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3947"><a href="#cb102-3947" aria-hidden="true" tabindex="-1"></a>{**forcats**}: <span class="co">[</span><span class="ot">Tools for Working with Categorical Variables (Factors)</span><span class="co">](https://forcats.tidyverse.org/)</span></span>
<span id="cb102-3948"><a href="#cb102-3948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3949"><a href="#cb102-3949" aria-hidden="true" tabindex="-1"></a>{**forcats**} provide a suite of useful tools that solve common problems with factors.</span>
<span id="cb102-3950"><a href="#cb102-3950" aria-hidden="true" tabindex="-1"></a>&quot;Forcats&quot; is an anagram of &quot;factors&quot; and part of the {**tidyverse**} suite of packages.</span>
<span id="cb102-3951"><a href="#cb102-3951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3952"><a href="#cb102-3952" aria-hidden="true" tabindex="-1"></a>::: {layout=&quot;<span class="co">[</span><span class="ot">10, 30</span><span class="co">]</span>&quot; layout-valign=&quot;center&quot;}</span>
<span id="cb102-3953"><a href="#cb102-3953" aria-hidden="true" tabindex="-1"></a><span class="al">![](img/chap01/logoi/logo-forcats-min.png)</span>{width=&quot;176&quot;}</span>
<span id="cb102-3954"><a href="#cb102-3954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3955"><a href="#cb102-3955" aria-hidden="true" tabindex="-1"></a>(1) reordering factor levels</span>
<span id="cb102-3956"><a href="#cb102-3956" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>moving specified levels to front, </span>
<span id="cb102-3957"><a href="#cb102-3957" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>ordering by first appearance, </span>
<span id="cb102-3958"><a href="#cb102-3958" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>reversing, and </span>
<span id="cb102-3959"><a href="#cb102-3959" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>randomly shuffling</span>
<span id="cb102-3960"><a href="#cb102-3960" aria-hidden="true" tabindex="-1"></a>(2) tools for modifying factor levels</span>
<span id="cb102-3961"><a href="#cb102-3961" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>collapsing rare levels into other, </span>
<span id="cb102-3962"><a href="#cb102-3962" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>&#39;anonymizing&#39;, and</span>
<span id="cb102-3963"><a href="#cb102-3963" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>manually &#39;recoding&#39;</span>
<span id="cb102-3964"><a href="#cb102-3964" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-3965"><a href="#cb102-3965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3966"><a href="#cb102-3966" aria-hidden="true" tabindex="-1"></a>forcats: A Package with Tools for Working with Categorical Variables</span>
<span id="cb102-3967"><a href="#cb102-3967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3968"><a href="#cb102-3968" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-3969"><a href="#cb102-3969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3970"><a href="#cb102-3970" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-3971"><a href="#cb102-3971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3972"><a href="#cb102-3972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3973"><a href="#cb102-3973" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-3974"><a href="#cb102-3974" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-3975"><a href="#cb102-3975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3976"><a href="#cb102-3976" aria-hidden="true" tabindex="-1"></a><span class="fu">### ggplot2</span></span>
<span id="cb102-3977"><a href="#cb102-3977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3978"><a href="#cb102-3978" aria-hidden="true" tabindex="-1"></a>:::::{.my-resource}</span>
<span id="cb102-3979"><a href="#cb102-3979" aria-hidden="true" tabindex="-1"></a>:::{.my-resource-header}</span>
<span id="cb102-3980"><a href="#cb102-3980" aria-hidden="true" tabindex="-1"></a>ggplot2: Create Elegant Data Visualisations Using the Grammar of Graphics</span>
<span id="cb102-3981"><a href="#cb102-3981" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-3982"><a href="#cb102-3982" aria-hidden="true" tabindex="-1"></a>::::{.my-resource-container}</span>
<span id="cb102-3983"><a href="#cb102-3983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3984"><a href="#cb102-3984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3985"><a href="#cb102-3985" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-3986"><a href="#cb102-3986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3987"><a href="#cb102-3987" aria-hidden="true" tabindex="-1"></a>::: {#pak-ggplot2}</span>
<span id="cb102-3988"><a href="#cb102-3988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3989"><a href="#cb102-3989" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-3990"><a href="#cb102-3990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3991"><a href="#cb102-3991" aria-hidden="true" tabindex="-1"></a>{**ggplot2**}: <span class="co">[</span><span class="ot">Create Elegant Data Visualisations Using the Grammar of Graphics</span><span class="co">](https://ggplot2.tidyverse.org/)</span></span>
<span id="cb102-3992"><a href="#cb102-3992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3993"><a href="#cb102-3993" aria-hidden="true" tabindex="-1"></a>::: {layout=&quot;<span class="co">[</span><span class="ot">10, 30</span><span class="co">]</span>&quot; layout-valign=&quot;center&quot;}</span>
<span id="cb102-3994"><a href="#cb102-3994" aria-hidden="true" tabindex="-1"></a><span class="al">![](img/chap01/logoi/logo-ggplot2-min.png)</span>{width=&quot;176&quot;}</span>
<span id="cb102-3995"><a href="#cb102-3995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3996"><a href="#cb102-3996" aria-hidden="true" tabindex="-1"></a>{**ggplot2**} is a system for declaratively creating graphics, based on [The Grammar of Graphics](https://link.springer.com/book/10.1007/0-387-28695-0). You provide the data, tell {**ggplot2**} how to map variables to aesthetics, what graphical primitives to use, and it takes care of the details. <span class="co">[</span><span class="ot">@ggplot2</span><span class="co">]</span></span>
<span id="cb102-3997"><a href="#cb102-3997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3998"><a href="#cb102-3998" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-3999"><a href="#cb102-3999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4000"><a href="#cb102-4000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4001"><a href="#cb102-4001" aria-hidden="true" tabindex="-1"></a>Package for Creating Data Visualisations</span>
<span id="cb102-4002"><a href="#cb102-4002" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-4003"><a href="#cb102-4003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4004"><a href="#cb102-4004" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-4005"><a href="#cb102-4005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4006"><a href="#cb102-4006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4007"><a href="#cb102-4007" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-4008"><a href="#cb102-4008" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-4009"><a href="#cb102-4009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4010"><a href="#cb102-4010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4011"><a href="#cb102-4011" aria-hidden="true" tabindex="-1"></a><span class="fu">### gssr</span></span>
<span id="cb102-4012"><a href="#cb102-4012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4013"><a href="#cb102-4013" aria-hidden="true" tabindex="-1"></a>:::::{.my-resource}</span>
<span id="cb102-4014"><a href="#cb102-4014" aria-hidden="true" tabindex="-1"></a>:::{.my-resource-header}</span>
<span id="cb102-4015"><a href="#cb102-4015" aria-hidden="true" tabindex="-1"></a>gssr: US General Social Survey (GSS) Data for R</span>
<span id="cb102-4016"><a href="#cb102-4016" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-4017"><a href="#cb102-4017" aria-hidden="true" tabindex="-1"></a>::::{.my-resource-container}</span>
<span id="cb102-4018"><a href="#cb102-4018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4019"><a href="#cb102-4019" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-4020"><a href="#cb102-4020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4021"><a href="#cb102-4021" aria-hidden="true" tabindex="-1"></a>::: {#pak-gssr}</span>
<span id="cb102-4022"><a href="#cb102-4022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4023"><a href="#cb102-4023" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-4024"><a href="#cb102-4024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4025"><a href="#cb102-4025" aria-hidden="true" tabindex="-1"></a>{**gssr**}: <span class="co">[</span><span class="ot">US General Social Survey (GSS) Data for R</span><span class="co">](https://kjhealy.github.io/gssr/)</span></span>
<span id="cb102-4026"><a href="#cb102-4026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4027"><a href="#cb102-4027" aria-hidden="true" tabindex="-1"></a>::: {layout=&quot;<span class="co">[</span><span class="ot">10, 30</span><span class="co">]</span>&quot; layout-valign=&quot;center&quot;}</span>
<span id="cb102-4028"><a href="#cb102-4028" aria-hidden="true" tabindex="-1"></a><span class="al">![](img/chap01/logoi/logo-gssr-min.png)</span>{width=&quot;376&quot;}</span>
<span id="cb102-4029"><a href="#cb102-4029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4030"><a href="#cb102-4030" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">GSSR Package</span><span class="co">](https://kjhealy.github.io/gssr/)</span>: The General Social</span>
<span id="cb102-4031"><a href="#cb102-4031" aria-hidden="true" tabindex="-1"></a>Survey Cumulative Data (1972-2022) and Panel Data files packaged for</span>
<span id="cb102-4032"><a href="#cb102-4032" aria-hidden="true" tabindex="-1"></a>easy use in R. {**gssr**} is a data package, developed and maintained by</span>
<span id="cb102-4033"><a href="#cb102-4033" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Kieran Healy</span><span class="co">](https://kieranhealy.org/)</span>, the author of [Data</span>
<span id="cb102-4034"><a href="#cb102-4034" aria-hidden="true" tabindex="-1"></a>Visualization](https://kieranhealy.org/publications/dataviz/). The</span>
<span id="cb102-4035"><a href="#cb102-4035" aria-hidden="true" tabindex="-1"></a>package bundles several datasets into a convenient format. Because of</span>
<span id="cb102-4036"><a href="#cb102-4036" aria-hidden="true" tabindex="-1"></a>its large size {**gssr**} is not hosted on CRAN but as a [GitHub</span>
<span id="cb102-4037"><a href="#cb102-4037" aria-hidden="true" tabindex="-1"></a>repository](https://github.com/kjhealy/gssr/).</span>
<span id="cb102-4038"><a href="#cb102-4038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4039"><a href="#cb102-4039" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-4040"><a href="#cb102-4040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4041"><a href="#cb102-4041" aria-hidden="true" tabindex="-1"></a>Instead of browsing and examining the complex dataset with the [GSS Data</span>
<span id="cb102-4042"><a href="#cb102-4042" aria-hidden="true" tabindex="-1"></a>Explorer](https://gssdataexplorer.norc.org/) or [download datasets</span>
<span id="cb102-4043"><a href="#cb102-4043" aria-hidden="true" tabindex="-1"></a>directly](https://gss.norc.org/Get-The-Data) from the The National</span>
<span id="cb102-4044"><a href="#cb102-4044" aria-hidden="true" tabindex="-1"></a>Opinion Research Center (<span class="co">[</span><span class="ot">NORC</span><span class="co">](http://norc.org/)</span>) you can now just work</span>
<span id="cb102-4045"><a href="#cb102-4045" aria-hidden="true" tabindex="-1"></a>inside R. The current package 0.4 (see: [gssr</span>
<span id="cb102-4046"><a href="#cb102-4046" aria-hidden="true" tabindex="-1"></a>Update](https://kieranhealy.org/blog/archives/2023/12/02/gssr-update/))</span>
<span id="cb102-4047"><a href="#cb102-4047" aria-hidden="true" tabindex="-1"></a>provides the GSS Cumulative Data File (1972-2022), three GSS Three Wave</span>
<span id="cb102-4048"><a href="#cb102-4048" aria-hidden="true" tabindex="-1"></a>Panel Data Files (for panels beginning in 2006, 2008, and 2010,</span>
<span id="cb102-4049"><a href="#cb102-4049" aria-hidden="true" tabindex="-1"></a>respectively), and the 2020 panel file.</span>
<span id="cb102-4050"><a href="#cb102-4050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4051"><a href="#cb102-4051" aria-hidden="true" tabindex="-1"></a>Version 0.40 also integrates survey code book information about</span>
<span id="cb102-4052"><a href="#cb102-4052" aria-hidden="true" tabindex="-1"></a>variables directly into R’s help system, allowing them to be accessed</span>
<span id="cb102-4053"><a href="#cb102-4053" aria-hidden="true" tabindex="-1"></a>via the help browser or from the console with ?, as if they were</span>
<span id="cb102-4054"><a href="#cb102-4054" aria-hidden="true" tabindex="-1"></a>functions or other documented objects.</span>
<span id="cb102-4055"><a href="#cb102-4055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4056"><a href="#cb102-4056" aria-hidden="true" tabindex="-1"></a>Package for Getting the US General Social Survey (GSS) Data More Easily</span>
<span id="cb102-4057"><a href="#cb102-4057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4058"><a href="#cb102-4058" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-4059"><a href="#cb102-4059" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-4060"><a href="#cb102-4060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4061"><a href="#cb102-4061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4062"><a href="#cb102-4062" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-4063"><a href="#cb102-4063" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-4064"><a href="#cb102-4064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4065"><a href="#cb102-4065" aria-hidden="true" tabindex="-1"></a><span class="fu">### gt</span></span>
<span id="cb102-4066"><a href="#cb102-4066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4067"><a href="#cb102-4067" aria-hidden="true" tabindex="-1"></a>:::::{.my-resource}</span>
<span id="cb102-4068"><a href="#cb102-4068" aria-hidden="true" tabindex="-1"></a>:::{.my-resource-header}</span>
<span id="cb102-4069"><a href="#cb102-4069" aria-hidden="true" tabindex="-1"></a>gt: Easily Create Presentation-Ready Display Tables</span>
<span id="cb102-4070"><a href="#cb102-4070" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-4071"><a href="#cb102-4071" aria-hidden="true" tabindex="-1"></a>::::{.my-resource-container}</span>
<span id="cb102-4072"><a href="#cb102-4072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4073"><a href="#cb102-4073" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-4074"><a href="#cb102-4074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4075"><a href="#cb102-4075" aria-hidden="true" tabindex="-1"></a>::: {#pak-gt}</span>
<span id="cb102-4076"><a href="#cb102-4076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4077"><a href="#cb102-4077" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-4078"><a href="#cb102-4078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4079"><a href="#cb102-4079" aria-hidden="true" tabindex="-1"></a>{**gt**}: <span class="co">[</span><span class="ot">Easily Create Presentation-Ready Display Tables</span><span class="co">](https://gt.rstudio.com)</span></span>
<span id="cb102-4080"><a href="#cb102-4080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4081"><a href="#cb102-4081" aria-hidden="true" tabindex="-1"></a>::: {layout=&quot;<span class="co">[</span><span class="ot">10, 30</span><span class="co">]</span>&quot; layout-valign=&quot;center&quot;}</span>
<span id="cb102-4082"><a href="#cb102-4082" aria-hidden="true" tabindex="-1"></a><span class="al">![](img/chap02/logoi/logo-gt-min.png)</span>{width=&quot;176&quot;}</span>
<span id="cb102-4083"><a href="#cb102-4083" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4084"><a href="#cb102-4084" aria-hidden="true" tabindex="-1"></a>With the {**gt**} package, anyone can make wonderful-looking tables using the R programming language. The gt philosophy: we can construct a wide variety of useful tables with a cohesive set of table parts. These include the table header, the stub, the column labels and spanner column labels, the table body, and the table footer.</span>
<span id="cb102-4085"><a href="#cb102-4085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4086"><a href="#cb102-4086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4087"><a href="#cb102-4087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4088"><a href="#cb102-4088" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-4089"><a href="#cb102-4089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4090"><a href="#cb102-4090" aria-hidden="true" tabindex="-1"></a>{**gt**}: A Package for Presentation-Ready Display Tables</span>
<span id="cb102-4091"><a href="#cb102-4091" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-4092"><a href="#cb102-4092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4093"><a href="#cb102-4093" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-4094"><a href="#cb102-4094" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-4095"><a href="#cb102-4095" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-4096"><a href="#cb102-4096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4097"><a href="#cb102-4097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4098"><a href="#cb102-4098" aria-hidden="true" tabindex="-1"></a><span class="fu">### gtsummary</span></span>
<span id="cb102-4099"><a href="#cb102-4099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4100"><a href="#cb102-4100" aria-hidden="true" tabindex="-1"></a>:::::{.my-resource}</span>
<span id="cb102-4101"><a href="#cb102-4101" aria-hidden="true" tabindex="-1"></a>:::{.my-resource-header}</span>
<span id="cb102-4102"><a href="#cb102-4102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4103"><a href="#cb102-4103" aria-hidden="true" tabindex="-1"></a>gtsummary: Presentation-Ready Data Summary and Analytic Result Tables</span>
<span id="cb102-4104"><a href="#cb102-4104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4105"><a href="#cb102-4105" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-4106"><a href="#cb102-4106" aria-hidden="true" tabindex="-1"></a>::::{.my-resource-container}</span>
<span id="cb102-4107"><a href="#cb102-4107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4108"><a href="#cb102-4108" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-4109"><a href="#cb102-4109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4110"><a href="#cb102-4110" aria-hidden="true" tabindex="-1"></a>::: {#pak-gtsummary}</span>
<span id="cb102-4111"><a href="#cb102-4111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4112"><a href="#cb102-4112" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-4113"><a href="#cb102-4113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4114"><a href="#cb102-4114" aria-hidden="true" tabindex="-1"></a>{**gtsummary**}: <span class="co">[</span><span class="ot">Presentation-Ready Data Summary and Analytic Result Tables</span><span class="co">](https://www.danieldsjoberg.com/gtsummary/)</span></span>
<span id="cb102-4115"><a href="#cb102-4115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4116"><a href="#cb102-4116" aria-hidden="true" tabindex="-1"></a>::: {layout=&quot;<span class="co">[</span><span class="ot">10, 30</span><span class="co">]</span>&quot; layout-valign=&quot;center&quot;}</span>
<span id="cb102-4117"><a href="#cb102-4117" aria-hidden="true" tabindex="-1"></a><span class="al">![](img/chap01/logoi/logo-gtsummary-min.png)</span>{width=&quot;176&quot;}</span>
<span id="cb102-4118"><a href="#cb102-4118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4119"><a href="#cb102-4119" aria-hidden="true" tabindex="-1"></a>Creates presentation-ready tables summarizing data sets, regression models, and more. The code to create the tables is concise and highly customizable. Data frames can be summarized with any function, e.g. mean(), median(), even user-written functions. Regression models are summarized and include the reference rows for categorical variables. Common regression models, such as logistic regression and Cox proportional hazards regression, are automatically identified and the tables are pre-filled with appropriate column headers.</span>
<span id="cb102-4120"><a href="#cb102-4120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4121"><a href="#cb102-4121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4122"><a href="#cb102-4122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4123"><a href="#cb102-4123" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-4124"><a href="#cb102-4124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4125"><a href="#cb102-4125" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Summarize data frames or tibbles easily in R. Perfect for creating a <span class="in">`r glossary(&quot;Table 1&quot;)`</span>. </span>
<span id="cb102-4126"><a href="#cb102-4126" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Summarize regression models in R and include reference rows for categorical variables. </span>
<span id="cb102-4127"><a href="#cb102-4127" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Customize {**gtsummary**} tables using a growing list of formatting/styling functions. </span>
<span id="cb102-4128"><a href="#cb102-4128" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Report statistics inline from summary tables and regression summary tables in R markdown. Make your reports completely reproducible!</span>
<span id="cb102-4129"><a href="#cb102-4129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4130"><a href="#cb102-4130" aria-hidden="true" tabindex="-1"></a>By leveraging {**broom**}, {**gt**}, and {**labelled**} packages, {**gtsummary**} creates beautifully formatted, ready-to-share summary and result tables in a single line of R code!</span>
<span id="cb102-4131"><a href="#cb102-4131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4132"><a href="#cb102-4132" aria-hidden="true" tabindex="-1"></a>Package for Presentation-Ready Data Summary and Analytic Result Tables</span>
<span id="cb102-4133"><a href="#cb102-4133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4134"><a href="#cb102-4134" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-4135"><a href="#cb102-4135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4136"><a href="#cb102-4136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4137"><a href="#cb102-4137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4138"><a href="#cb102-4138" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-4139"><a href="#cb102-4139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4140"><a href="#cb102-4140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4141"><a href="#cb102-4141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4142"><a href="#cb102-4142" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-4143"><a href="#cb102-4143" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-4144"><a href="#cb102-4144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4145"><a href="#cb102-4145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4146"><a href="#cb102-4146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4147"><a href="#cb102-4147" aria-hidden="true" tabindex="-1"></a><span class="fu">### haven</span></span>
<span id="cb102-4148"><a href="#cb102-4148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4149"><a href="#cb102-4149" aria-hidden="true" tabindex="-1"></a>:::::{.my-resource}</span>
<span id="cb102-4150"><a href="#cb102-4150" aria-hidden="true" tabindex="-1"></a>:::{.my-resource-header}</span>
<span id="cb102-4151"><a href="#cb102-4151" aria-hidden="true" tabindex="-1"></a>haven: Import and Export &#39;SPSS&#39;, &#39;Stata&#39; and &#39;SAS&#39; Files</span>
<span id="cb102-4152"><a href="#cb102-4152" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-4153"><a href="#cb102-4153" aria-hidden="true" tabindex="-1"></a>::::{.my-resource-container}</span>
<span id="cb102-4154"><a href="#cb102-4154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4155"><a href="#cb102-4155" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-4156"><a href="#cb102-4156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4157"><a href="#cb102-4157" aria-hidden="true" tabindex="-1"></a>::: {#pak-haven}</span>
<span id="cb102-4158"><a href="#cb102-4158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4159"><a href="#cb102-4159" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-4160"><a href="#cb102-4160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4161"><a href="#cb102-4161" aria-hidden="true" tabindex="-1"></a>{**haven**}: [Import and Export &#39;SPSS&#39;, &#39;Stata&#39; and &#39;SAS&#39;</span>
<span id="cb102-4162"><a href="#cb102-4162" aria-hidden="true" tabindex="-1"></a>Files](https://haven.tidyverse.org/index.html)</span>
<span id="cb102-4163"><a href="#cb102-4163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4164"><a href="#cb102-4164" aria-hidden="true" tabindex="-1"></a>{**haven**} enables R to read and write various data formats used by</span>
<span id="cb102-4165"><a href="#cb102-4165" aria-hidden="true" tabindex="-1"></a>other statistical packages. Currently it supports</span>
<span id="cb102-4166"><a href="#cb102-4166" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">SAS</span><span class="co">](https://www.sas.com/en_us/home.html)</span>,</span>
<span id="cb102-4167"><a href="#cb102-4167" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">SPSS</span><span class="co">](https://www.ibm.com/spss)</span> and <span class="co">[</span><span class="ot">STATA</span><span class="co">](https://www.stata.com/)</span>.</span>
<span id="cb102-4168"><a href="#cb102-4168" aria-hidden="true" tabindex="-1"></a>{**haven**} output object has four important features:</span>
<span id="cb102-4169"><a href="#cb102-4169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4170"><a href="#cb102-4170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4171"><a href="#cb102-4171" aria-hidden="true" tabindex="-1"></a>::: {layout=&quot;<span class="co">[</span><span class="ot">10, 30</span><span class="co">]</span>&quot; layout-valign=&quot;center&quot;}</span>
<span id="cb102-4172"><a href="#cb102-4172" aria-hidden="true" tabindex="-1"></a><span class="al">![](img/chap01/logoi/logo-haven-min.png)</span>{width=&quot;176&quot;}</span>
<span id="cb102-4173"><a href="#cb102-4173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4174"><a href="#cb102-4174" aria-hidden="true" tabindex="-1"></a>(1) It creates <span class="in">`tibbles::tibble()`</span> which a better print method for very</span>
<span id="cb102-4175"><a href="#cb102-4175" aria-hidden="true" tabindex="-1"></a>    long and very wide files.</span>
<span id="cb102-4176"><a href="#cb102-4176" aria-hidden="true" tabindex="-1"></a>(2) Dates and times are converted to R date/time classes.</span>
<span id="cb102-4177"><a href="#cb102-4177" aria-hidden="true" tabindex="-1"></a>(3) Character vectors are not converted to factors.</span>
<span id="cb102-4178"><a href="#cb102-4178" aria-hidden="true" tabindex="-1"></a>(4) Value labels are translated into a new <span class="in">`haven::labelled()`</span> class,</span>
<span id="cb102-4179"><a href="#cb102-4179" aria-hidden="true" tabindex="-1"></a>    which preserves the original semantics and can easily be coerced to</span>
<span id="cb102-4180"><a href="#cb102-4180" aria-hidden="true" tabindex="-1"></a>    factors with <span class="in">`haven::as_factor()`</span>. Special missing values are</span>
<span id="cb102-4181"><a href="#cb102-4181" aria-hidden="true" tabindex="-1"></a>    preserved. See details in the vignette [Conversion</span>
<span id="cb102-4182"><a href="#cb102-4182" aria-hidden="true" tabindex="-1"></a>    semantics](https://haven.tidyverse.org/articles/semantics.html).</span>
<span id="cb102-4183"><a href="#cb102-4183" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-4184"><a href="#cb102-4184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4185"><a href="#cb102-4185" aria-hidden="true" tabindex="-1"></a>haven: A Package for Import and Export of &#39;SPSS&#39;, &#39;Stata&#39; and &#39;SAS&#39;</span>
<span id="cb102-4186"><a href="#cb102-4186" aria-hidden="true" tabindex="-1"></a>Files</span>
<span id="cb102-4187"><a href="#cb102-4187" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-4188"><a href="#cb102-4188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4189"><a href="#cb102-4189" aria-hidden="true" tabindex="-1"></a>I am here interested especially in the fourth feature.</span>
<span id="cb102-4190"><a href="#cb102-4190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4191"><a href="#cb102-4191" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-4192"><a href="#cb102-4192" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-4193"><a href="#cb102-4193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4194"><a href="#cb102-4194" aria-hidden="true" tabindex="-1"></a><span class="fu">### kableExtra</span></span>
<span id="cb102-4195"><a href="#cb102-4195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4196"><a href="#cb102-4196" aria-hidden="true" tabindex="-1"></a>:::::{.my-resource}</span>
<span id="cb102-4197"><a href="#cb102-4197" aria-hidden="true" tabindex="-1"></a>:::{.my-resource-header}</span>
<span id="cb102-4198"><a href="#cb102-4198" aria-hidden="true" tabindex="-1"></a>kableExtra: Construct Complex Table with <span class="in">`knitr::kable()`</span> and Pipe Syntax</span>
<span id="cb102-4199"><a href="#cb102-4199" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-4200"><a href="#cb102-4200" aria-hidden="true" tabindex="-1"></a>::::{.my-resource-container}</span>
<span id="cb102-4201"><a href="#cb102-4201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4202"><a href="#cb102-4202" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-4203"><a href="#cb102-4203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4204"><a href="#cb102-4204" aria-hidden="true" tabindex="-1"></a>::: {#pak-kableExtra}</span>
<span id="cb102-4205"><a href="#cb102-4205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4206"><a href="#cb102-4206" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-4207"><a href="#cb102-4207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4208"><a href="#cb102-4208" aria-hidden="true" tabindex="-1"></a>{**kableExtra**}: <span class="co">[</span><span class="ot">Construct Complex Table with &#39;kable&#39; and Pipe Syntax</span><span class="co">](URL to package)</span></span>
<span id="cb102-4209"><a href="#cb102-4209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4210"><a href="#cb102-4210" aria-hidden="true" tabindex="-1"></a>::: {layout=&quot;<span class="co">[</span><span class="ot">10, 30</span><span class="co">]</span>&quot; layout-valign=&quot;center&quot;}</span>
<span id="cb102-4211"><a href="#cb102-4211" aria-hidden="true" tabindex="-1"></a><span class="al">![](img/chap02/logoi/logo-kableExtra-min.png)</span>{width=&quot;176&quot;}</span>
<span id="cb102-4212"><a href="#cb102-4212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4213"><a href="#cb102-4213" aria-hidden="true" tabindex="-1"></a>Build complex HTML or {{&lt; latex &gt;}} tables using <span class="in">`kable()`</span> from {**knitr**} and the piping syntax from {**magrittr**} Function `kable()` is a light weight table generator coming from {**knitr**}. This package simplifies the way to manipulate the HTML or {{&lt; latex &gt;}} codes generated by <span class="in">`kable()`</span> and allows users to construct complex tables and customize styles using a readable syntax. </span>
<span id="cb102-4214"><a href="#cb102-4214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4215"><a href="#cb102-4215" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-4216"><a href="#cb102-4216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4217"><a href="#cb102-4217" aria-hidden="true" tabindex="-1"></a>{**pkg-name**}: A Package to Construct Complex Table with &#39;kable&#39; and Pipe Syntax</span>
<span id="cb102-4218"><a href="#cb102-4218" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-4219"><a href="#cb102-4219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4220"><a href="#cb102-4220" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-4221"><a href="#cb102-4221" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-4222"><a href="#cb102-4222" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-4223"><a href="#cb102-4223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4224"><a href="#cb102-4224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4225"><a href="#cb102-4225" aria-hidden="true" tabindex="-1"></a><span class="fu">### knitr</span></span>
<span id="cb102-4226"><a href="#cb102-4226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4227"><a href="#cb102-4227" aria-hidden="true" tabindex="-1"></a>:::::{.my-resource}</span>
<span id="cb102-4228"><a href="#cb102-4228" aria-hidden="true" tabindex="-1"></a>:::{.my-resource-header}</span>
<span id="cb102-4229"><a href="#cb102-4229" aria-hidden="true" tabindex="-1"></a>knitr: A General-Purpose Package for Dynamic Report Generation in R</span>
<span id="cb102-4230"><a href="#cb102-4230" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-4231"><a href="#cb102-4231" aria-hidden="true" tabindex="-1"></a>::::{.my-resource-container}</span>
<span id="cb102-4232"><a href="#cb102-4232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4233"><a href="#cb102-4233" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-4234"><a href="#cb102-4234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4235"><a href="#cb102-4235" aria-hidden="true" tabindex="-1"></a>::: {#pak-knitr}</span>
<span id="cb102-4236"><a href="#cb102-4236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4237"><a href="#cb102-4237" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-4238"><a href="#cb102-4238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4239"><a href="#cb102-4239" aria-hidden="true" tabindex="-1"></a>{**knitr**}: <span class="co">[</span><span class="ot">A General-Purpose Package for Dynamic Report Generation in R</span><span class="co">](https://yihui.org/knitr/)</span></span>
<span id="cb102-4240"><a href="#cb102-4240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4241"><a href="#cb102-4241" aria-hidden="true" tabindex="-1"></a>(*There is no hexagon logo available*)</span>
<span id="cb102-4242"><a href="#cb102-4242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4243"><a href="#cb102-4243" aria-hidden="true" tabindex="-1"></a>Provides a general-purpose tool for dynamic report generation in R using Literate Programming techniques.</span>
<span id="cb102-4244"><a href="#cb102-4244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4245"><a href="#cb102-4245" aria-hidden="true" tabindex="-1"></a>{**knitr**}: A Package for Dynamic Report Generation in R</span>
<span id="cb102-4246"><a href="#cb102-4246" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-4247"><a href="#cb102-4247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4248"><a href="#cb102-4248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4249"><a href="#cb102-4249" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-4250"><a href="#cb102-4250" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-4251"><a href="#cb102-4251" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-4252"><a href="#cb102-4252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4253"><a href="#cb102-4253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4254"><a href="#cb102-4254" aria-hidden="true" tabindex="-1"></a><span class="fu">### labelled</span></span>
<span id="cb102-4255"><a href="#cb102-4255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4256"><a href="#cb102-4256" aria-hidden="true" tabindex="-1"></a>:::::{.my-resource}</span>
<span id="cb102-4257"><a href="#cb102-4257" aria-hidden="true" tabindex="-1"></a>:::{.my-resource-header}</span>
<span id="cb102-4258"><a href="#cb102-4258" aria-hidden="true" tabindex="-1"></a>labelled: Manipulating Labelled Data</span>
<span id="cb102-4259"><a href="#cb102-4259" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-4260"><a href="#cb102-4260" aria-hidden="true" tabindex="-1"></a>::::{.my-resource-container}</span>
<span id="cb102-4261"><a href="#cb102-4261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4262"><a href="#cb102-4262" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-4263"><a href="#cb102-4263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4264"><a href="#cb102-4264" aria-hidden="true" tabindex="-1"></a>::: {#pak-labelled}</span>
<span id="cb102-4265"><a href="#cb102-4265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4266"><a href="#cb102-4266" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-4267"><a href="#cb102-4267" aria-hidden="true" tabindex="-1"></a>{**labelled**}: [Manipulating Labelled</span>
<span id="cb102-4268"><a href="#cb102-4268" aria-hidden="true" tabindex="-1"></a>Data](https://larmarange.github.io/labelled/)</span>
<span id="cb102-4269"><a href="#cb102-4269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4270"><a href="#cb102-4270" aria-hidden="true" tabindex="-1"></a>::: {layout=&quot;<span class="co">[</span><span class="ot">10, 30</span><span class="co">]</span>&quot; layout-valign=&quot;center&quot;}</span>
<span id="cb102-4271"><a href="#cb102-4271" aria-hidden="true" tabindex="-1"></a><span class="al">![](img/chap01/logoi/logo-labelled-min.png)</span>{width=&quot;176&quot;}</span>
<span id="cb102-4272"><a href="#cb102-4272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4273"><a href="#cb102-4273" aria-hidden="true" tabindex="-1"></a>Work with labelled data imported from [IBM</span>
<span id="cb102-4274"><a href="#cb102-4274" aria-hidden="true" tabindex="-1"></a>SPSS](https://www.ibm.com/spss) or <span class="co">[</span><span class="ot">STATA</span><span class="co">](https://www.stata.com/)</span> with</span>
<span id="cb102-4275"><a href="#cb102-4275" aria-hidden="true" tabindex="-1"></a>{**haven**} or {**foreign**}. This package provides useful functions to</span>
<span id="cb102-4276"><a href="#cb102-4276" aria-hidden="true" tabindex="-1"></a>deal with &quot;haven_labelled&quot; and &quot;haven_labelled_spss&quot; classes introduced</span>
<span id="cb102-4277"><a href="#cb102-4277" aria-hidden="true" tabindex="-1"></a>by {**haven**} package. (With the free [gnu</span>
<span id="cb102-4278"><a href="#cb102-4278" aria-hidden="true" tabindex="-1"></a>PSPP](https://www.gnu.org/software/pspp/) exists also a SPSS like open</span>
<span id="cb102-4279"><a href="#cb102-4279" aria-hidden="true" tabindex="-1"></a>source version.) See details in the vignette [Introduction to</span>
<span id="cb102-4280"><a href="#cb102-4280" aria-hidden="true" tabindex="-1"></a>labelled](https://larmarange.github.io/labelled/articles/intro_labelled.html)</span>
<span id="cb102-4281"><a href="#cb102-4281" aria-hidden="true" tabindex="-1"></a>and the [GitHub website for</span>
<span id="cb102-4282"><a href="#cb102-4282" aria-hidden="true" tabindex="-1"></a>labelled](https://larmarange.github.io/labelled/). There are other</span>
<span id="cb102-4283"><a href="#cb102-4283" aria-hidden="true" tabindex="-1"></a>vignettes as well and a [cheat sheet as PDF for</span>
<span id="cb102-4284"><a href="#cb102-4284" aria-hidden="true" tabindex="-1"></a>download](https://github.com/larmarange/labelled/raw/main/cheatsheet/labelled_cheatsheet.pdf).</span>
<span id="cb102-4285"><a href="#cb102-4285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4286"><a href="#cb102-4286" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-4287"><a href="#cb102-4287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4288"><a href="#cb102-4288" aria-hidden="true" tabindex="-1"></a>labelled: A Package for Manipulating Labelled Data</span>
<span id="cb102-4289"><a href="#cb102-4289" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-4290"><a href="#cb102-4290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4291"><a href="#cb102-4291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4292"><a href="#cb102-4292" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-4293"><a href="#cb102-4293" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-4294"><a href="#cb102-4294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4295"><a href="#cb102-4295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4296"><a href="#cb102-4296" aria-hidden="true" tabindex="-1"></a><span class="fu">### sjlabelled</span></span>
<span id="cb102-4297"><a href="#cb102-4297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4298"><a href="#cb102-4298" aria-hidden="true" tabindex="-1"></a>:::::{.my-resource}</span>
<span id="cb102-4299"><a href="#cb102-4299" aria-hidden="true" tabindex="-1"></a>:::{.my-resource-header}</span>
<span id="cb102-4300"><a href="#cb102-4300" aria-hidden="true" tabindex="-1"></a>sjlabelled; </span>
<span id="cb102-4301"><a href="#cb102-4301" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-4302"><a href="#cb102-4302" aria-hidden="true" tabindex="-1"></a>::::{.my-resource-container}</span>
<span id="cb102-4303"><a href="#cb102-4303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4304"><a href="#cb102-4304" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-4305"><a href="#cb102-4305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4306"><a href="#cb102-4306" aria-hidden="true" tabindex="-1"></a>::: {#pak-sjlabelled}</span>
<span id="cb102-4307"><a href="#cb102-4307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4308"><a href="#cb102-4308" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-4309"><a href="#cb102-4309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4310"><a href="#cb102-4310" aria-hidden="true" tabindex="-1"></a>{**sjlabelled**}: [Labelled Data Utility</span>
<span id="cb102-4311"><a href="#cb102-4311" aria-hidden="true" tabindex="-1"></a>Functions](https://strengejacke.github.io/sjlabelled/)</span>
<span id="cb102-4312"><a href="#cb102-4312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4313"><a href="#cb102-4313" aria-hidden="true" tabindex="-1"></a>::: {layout=&quot;<span class="co">[</span><span class="ot">10, 30</span><span class="co">]</span>&quot; layout-valign=&quot;center&quot;}</span>
<span id="cb102-4314"><a href="#cb102-4314" aria-hidden="true" tabindex="-1"></a><span class="al">![](img/chap01/logoi/logo-sjlabelled-min.png)</span>{width=&quot;176&quot;}</span>
<span id="cb102-4315"><a href="#cb102-4315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4316"><a href="#cb102-4316" aria-hidden="true" tabindex="-1"></a>Basically, this package covers reading and writing data between other</span>
<span id="cb102-4317"><a href="#cb102-4317" aria-hidden="true" tabindex="-1"></a>statistical packages (like ‘SPSS’) and R, based on the haven and foreign</span>
<span id="cb102-4318"><a href="#cb102-4318" aria-hidden="true" tabindex="-1"></a>packages; hence, this package also includes functions to make working</span>
<span id="cb102-4319"><a href="#cb102-4319" aria-hidden="true" tabindex="-1"></a>with labelled data easier. This includes easy ways to get, set or change</span>
<span id="cb102-4320"><a href="#cb102-4320" aria-hidden="true" tabindex="-1"></a>value and variable label attributes, to convert labelled vectors into</span>
<span id="cb102-4321"><a href="#cb102-4321" aria-hidden="true" tabindex="-1"></a>factors or numeric (and vice versa), or to deal with multiple declared</span>
<span id="cb102-4322"><a href="#cb102-4322" aria-hidden="true" tabindex="-1"></a>missing values.</span>
<span id="cb102-4323"><a href="#cb102-4323" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-4324"><a href="#cb102-4324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4325"><a href="#cb102-4325" aria-hidden="true" tabindex="-1"></a>The prefix <span class="in">`sj`</span> in {**sjlabelled**} (= in German Strenge Jacke, &quot;strict</span>
<span id="cb102-4326"><a href="#cb102-4326" aria-hidden="true" tabindex="-1"></a>jacket&quot;) refers to other work of [Daniel</span>
<span id="cb102-4327"><a href="#cb102-4327" aria-hidden="true" tabindex="-1"></a>Lüdecke](https://www.uke.de/kliniken-institute/institute/medizinische-soziologie/team/profil_daniel_luedecke_ims.html),</span>
<span id="cb102-4328"><a href="#cb102-4328" aria-hidden="true" tabindex="-1"></a>who has developed many R packages. All the <span class="in">`sj`</span>-packages support labelled data.</span>
<span id="cb102-4329"><a href="#cb102-4329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4330"><a href="#cb102-4330" aria-hidden="true" tabindex="-1"></a>sjlabelled: A Package for Labelled Data Utility Functions</span>
<span id="cb102-4331"><a href="#cb102-4331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4332"><a href="#cb102-4332" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-4333"><a href="#cb102-4333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4334"><a href="#cb102-4334" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-4335"><a href="#cb102-4335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4336"><a href="#cb102-4336" aria-hidden="true" tabindex="-1"></a>His packages are divided in two approaches:</span>
<span id="cb102-4337"><a href="#cb102-4337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4338"><a href="#cb102-4338" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Most packages are part pf the project</span>
<span id="cb102-4339"><a href="#cb102-4339" aria-hidden="true" tabindex="-1"></a>    <span class="co">[</span><span class="ot">EasyStats</span><span class="co">](https://easystats.github.io/easystats/)</span>, that provides</span>
<span id="cb102-4340"><a href="#cb102-4340" aria-hidden="true" tabindex="-1"></a>    with 11 packages &quot;An R Framework for Easy Statistical Modeling,</span>
<span id="cb102-4341"><a href="#cb102-4341" aria-hidden="true" tabindex="-1"></a>    Visualization, and Reporting&quot;, similar to the {**tidyverse**}</span>
<span id="cb102-4342"><a href="#cb102-4342" aria-hidden="true" tabindex="-1"></a>    collection. The {**easystats**} collection is orientated more to</span>
<span id="cb102-4343"><a href="#cb102-4343" aria-hidden="true" tabindex="-1"></a>    statistics, whereas {**tidyverse**} is more directed to data</span>
<span id="cb102-4344"><a href="#cb102-4344" aria-hidden="true" tabindex="-1"></a>    science.</span>
<span id="cb102-4345"><a href="#cb102-4345" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>The other line of package development supports labelled data in</span>
<span id="cb102-4346"><a href="#cb102-4346" aria-hidden="true" tabindex="-1"></a>    combination with different R task like</span>
<span id="cb102-4347"><a href="#cb102-4347" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>[Data and Variable Transformation</span>
<span id="cb102-4348"><a href="#cb102-4348" aria-hidden="true" tabindex="-1"></a>        Functions](https://cran.r-project.org/web/packages/sjmisc/index.html)</span>
<span id="cb102-4349"><a href="#cb102-4349" aria-hidden="true" tabindex="-1"></a>        {**sjmisc**},</span>
<span id="cb102-4350"><a href="#cb102-4350" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>[Data Visualization for Statistics in Social</span>
<span id="cb102-4351"><a href="#cb102-4351" aria-hidden="true" tabindex="-1"></a>        Science](https://cran.r-project.org/web/packages/sjPlot/index.html)</span>
<span id="cb102-4352"><a href="#cb102-4352" aria-hidden="true" tabindex="-1"></a>        {**sjPlot**} and a</span>
<span id="cb102-4353"><a href="#cb102-4353" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>[Collection of Convenient Functions for Common Statistical</span>
<span id="cb102-4354"><a href="#cb102-4354" aria-hidden="true" tabindex="-1"></a>        Computations](https://cran.r-project.org/web/packages/sjstats/index.html)</span>
<span id="cb102-4355"><a href="#cb102-4355" aria-hidden="true" tabindex="-1"></a>        {**sjStats**}. -Additionally there exists {**sjtable2df**} a</span>
<span id="cb102-4356"><a href="#cb102-4356" aria-hidden="true" tabindex="-1"></a>        package to [Convert &#39;sjPlot&#39; HTML-Tables to R</span>
<span id="cb102-4357"><a href="#cb102-4357" aria-hidden="true" tabindex="-1"></a>        &#39;data.frame&#39;](https://cran.r-project.org/web/packages/sjtable2df/index.html).</span>
<span id="cb102-4358"><a href="#cb102-4358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4359"><a href="#cb102-4359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4360"><a href="#cb102-4360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4361"><a href="#cb102-4361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4362"><a href="#cb102-4362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4363"><a href="#cb102-4363" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-4364"><a href="#cb102-4364" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-4365"><a href="#cb102-4365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4366"><a href="#cb102-4366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4367"><a href="#cb102-4367" aria-hidden="true" tabindex="-1"></a><span class="fu">### readr </span></span>
<span id="cb102-4368"><a href="#cb102-4368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4369"><a href="#cb102-4369" aria-hidden="true" tabindex="-1"></a>:::::{.my-resource}</span>
<span id="cb102-4370"><a href="#cb102-4370" aria-hidden="true" tabindex="-1"></a>:::{.my-resource-header}</span>
<span id="cb102-4371"><a href="#cb102-4371" aria-hidden="true" tabindex="-1"></a>readr: Read Rectangular Text Data</span>
<span id="cb102-4372"><a href="#cb102-4372" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-4373"><a href="#cb102-4373" aria-hidden="true" tabindex="-1"></a>::::{.my-resource-container}</span>
<span id="cb102-4374"><a href="#cb102-4374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4375"><a href="#cb102-4375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4376"><a href="#cb102-4376" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-4377"><a href="#cb102-4377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4378"><a href="#cb102-4378" aria-hidden="true" tabindex="-1"></a>::: {#pak-readr}</span>
<span id="cb102-4379"><a href="#cb102-4379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4380"><a href="#cb102-4380" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-4381"><a href="#cb102-4381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4382"><a href="#cb102-4382" aria-hidden="true" tabindex="-1"></a>{**readr**}: <span class="co">[</span><span class="ot">Read Rectangular Text Data</span><span class="co">](https://readr.tidyverse.org/)</span></span>
<span id="cb102-4383"><a href="#cb102-4383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4384"><a href="#cb102-4384" aria-hidden="true" tabindex="-1"></a>::: {layout=&quot;<span class="co">[</span><span class="ot">10, 30</span><span class="co">]</span>&quot; layout-valign=&quot;center&quot;}</span>
<span id="cb102-4385"><a href="#cb102-4385" aria-hidden="true" tabindex="-1"></a><span class="al">![](img/chap01/logoi/logo-readr-min.png)</span>{width=&quot;176&quot;}</span>
<span id="cb102-4386"><a href="#cb102-4386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4387"><a href="#cb102-4387" aria-hidden="true" tabindex="-1"></a>The goal of readr is to provide a fast and friendly way to read rectangular data from delimited files, such as comma-separated values (CSV) and tab-separated values (TSV). It is designed to parse many types of data found in the wild, while providing an informative problem report when parsing leads to unexpected results. <span class="co">[</span><span class="ot">@readr</span><span class="co">]</span> </span>
<span id="cb102-4388"><a href="#cb102-4388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4389"><a href="#cb102-4389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4390"><a href="#cb102-4390" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-4391"><a href="#cb102-4391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4392"><a href="#cb102-4392" aria-hidden="true" tabindex="-1"></a>{**readr**} supports the following formats:</span>
<span id="cb102-4393"><a href="#cb102-4393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4394"><a href="#cb102-4394" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>read_csv(): comma-separated values (CSV)</span>
<span id="cb102-4395"><a href="#cb102-4395" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>read_tsv(): tab-separated values (TSV)</span>
<span id="cb102-4396"><a href="#cb102-4396" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>read_csv2(): semicolon-separated values with , as the decimal mark</span>
<span id="cb102-4397"><a href="#cb102-4397" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>read_delim(): delimited files (CSV and TSV are important special cases)</span>
<span id="cb102-4398"><a href="#cb102-4398" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>read_fwf(): fixed-width files</span>
<span id="cb102-4399"><a href="#cb102-4399" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>read_table(): whitespace-separated files</span>
<span id="cb102-4400"><a href="#cb102-4400" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>read_log(): web log files</span>
<span id="cb102-4401"><a href="#cb102-4401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4402"><a href="#cb102-4402" aria-hidden="true" tabindex="-1"></a>Package for Reading Rectangular Data</span>
<span id="cb102-4403"><a href="#cb102-4403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4404"><a href="#cb102-4404" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-4405"><a href="#cb102-4405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4406"><a href="#cb102-4406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4407"><a href="#cb102-4407" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-4408"><a href="#cb102-4408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4409"><a href="#cb102-4409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4410"><a href="#cb102-4410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4411"><a href="#cb102-4411" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-4412"><a href="#cb102-4412" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-4413"><a href="#cb102-4413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4414"><a href="#cb102-4414" aria-hidden="true" tabindex="-1"></a><span class="fu">### skimr</span></span>
<span id="cb102-4415"><a href="#cb102-4415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4416"><a href="#cb102-4416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4417"><a href="#cb102-4417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4418"><a href="#cb102-4418" aria-hidden="true" tabindex="-1"></a>:::::{.my-resource}</span>
<span id="cb102-4419"><a href="#cb102-4419" aria-hidden="true" tabindex="-1"></a>:::{.my-resource-header}</span>
<span id="cb102-4420"><a href="#cb102-4420" aria-hidden="true" tabindex="-1"></a>skimr: Compact and Flexible Summaries of Data</span>
<span id="cb102-4421"><a href="#cb102-4421" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-4422"><a href="#cb102-4422" aria-hidden="true" tabindex="-1"></a>::::{.my-resource-container}</span>
<span id="cb102-4423"><a href="#cb102-4423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4424"><a href="#cb102-4424" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-4425"><a href="#cb102-4425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4426"><a href="#cb102-4426" aria-hidden="true" tabindex="-1"></a>::: {#pak-skimr}</span>
<span id="cb102-4427"><a href="#cb102-4427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4428"><a href="#cb102-4428" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-4429"><a href="#cb102-4429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4430"><a href="#cb102-4430" aria-hidden="true" tabindex="-1"></a>{**skimr**}: <span class="co">[</span><span class="ot">Compact and Flexible Summaries of Data</span><span class="co">](https://docs.ropensci.org/skimr/)</span></span>
<span id="cb102-4431"><a href="#cb102-4431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4432"><a href="#cb102-4432" aria-hidden="true" tabindex="-1"></a>::: {layout=&quot;<span class="co">[</span><span class="ot">10, 30</span><span class="co">]</span>&quot; layout-valign=&quot;center&quot;}</span>
<span id="cb102-4433"><a href="#cb102-4433" aria-hidden="true" tabindex="-1"></a><span class="al">![](img/chap01/logoi/logo-skimr-min.png)</span>{width=&quot;176&quot;}</span>
<span id="cb102-4434"><a href="#cb102-4434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4435"><a href="#cb102-4435" aria-hidden="true" tabindex="-1"></a>A simple to use summary function that can be used with pipes and displays nicely in the console. The default summary statistics may be modified by the user as can the default formatting.  Support for data frames and vectors is included, and users can implement their own skim methods for specific object types as described in a vignette. Default summaries include support for inline spark graphs. Instructions for managing these on specific operating systems are given in the <span class="co">[</span><span class="ot">Using skimr</span><span class="co">](https://docs.ropensci.org/skimr/articles/skimr.html)</span> vignette and the <span class="co">[</span><span class="ot">README</span><span class="co">](https://github.com/ropensci/skimr/#skimr-)</span>.</span>
<span id="cb102-4436"><a href="#cb102-4436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4437"><a href="#cb102-4437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4438"><a href="#cb102-4438" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-4439"><a href="#cb102-4439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4440"><a href="#cb102-4440" aria-hidden="true" tabindex="-1"></a>At the moment I am just using the <span class="in">`skimr::skim()`</span> function. I believe most of the many other functions for adaption are oriented to developers. But still: I need to have a closer look to this package.</span>
<span id="cb102-4441"><a href="#cb102-4441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4442"><a href="#cb102-4442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4443"><a href="#cb102-4443" aria-hidden="true" tabindex="-1"></a>A Package for Compact and Flexible Summaries of Data</span>
<span id="cb102-4444"><a href="#cb102-4444" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-4445"><a href="#cb102-4445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4446"><a href="#cb102-4446" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-4447"><a href="#cb102-4447" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-4448"><a href="#cb102-4448" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-4449"><a href="#cb102-4449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4450"><a href="#cb102-4450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4451"><a href="#cb102-4451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4452"><a href="#cb102-4452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4453"><a href="#cb102-4453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4454"><a href="#cb102-4454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4455"><a href="#cb102-4455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4456"><a href="#cb102-4456" aria-hidden="true" tabindex="-1"></a><span class="fu">### tibble </span></span>
<span id="cb102-4457"><a href="#cb102-4457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4458"><a href="#cb102-4458" aria-hidden="true" tabindex="-1"></a>:::::{.my-resource}</span>
<span id="cb102-4459"><a href="#cb102-4459" aria-hidden="true" tabindex="-1"></a>:::{.my-resource-header}</span>
<span id="cb102-4460"><a href="#cb102-4460" aria-hidden="true" tabindex="-1"></a>tibble: Simple Data Frames</span>
<span id="cb102-4461"><a href="#cb102-4461" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-4462"><a href="#cb102-4462" aria-hidden="true" tabindex="-1"></a>::::{.my-resource-container}</span>
<span id="cb102-4463"><a href="#cb102-4463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4464"><a href="#cb102-4464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4465"><a href="#cb102-4465" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-4466"><a href="#cb102-4466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4467"><a href="#cb102-4467" aria-hidden="true" tabindex="-1"></a>::: {#pak-tibble}</span>
<span id="cb102-4468"><a href="#cb102-4468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4469"><a href="#cb102-4469" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-4470"><a href="#cb102-4470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4471"><a href="#cb102-4471" aria-hidden="true" tabindex="-1"></a>{**tibble**}: <span class="co">[</span><span class="ot">Simple Data Frames</span><span class="co">](https://tibble.tidyverse.org/)</span></span>
<span id="cb102-4472"><a href="#cb102-4472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4473"><a href="#cb102-4473" aria-hidden="true" tabindex="-1"></a>::: {layout=&quot;<span class="co">[</span><span class="ot">10, 30</span><span class="co">]</span>&quot; layout-valign=&quot;center&quot;}</span>
<span id="cb102-4474"><a href="#cb102-4474" aria-hidden="true" tabindex="-1"></a><span class="al">![](img/chap01/logoi/logo-tibble-min.png)</span>{width=&quot;176&quot;}</span>
<span id="cb102-4475"><a href="#cb102-4475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4476"><a href="#cb102-4476" aria-hidden="true" tabindex="-1"></a>A tibble, or <span class="in">`tbl_df`</span>, is a modern reimagining of the data.frame, keeping what time has proven to be effective, and throwing out what is not. Tibbles are data.frames that are lazy and surly: they do less (i.e. they don’t change variable names or types, and don’t do partial matching) and complain more (e.g. when a variable does not exist). This forces you to confront problems earlier, typically leading to cleaner, more expressive code. Tibbles also have an enhanced <span class="in">`print()`</span> method which makes them easier to use with large datasets containing complex objects. <span class="co">[</span><span class="ot">@tibble</span><span class="co">]</span></span>
<span id="cb102-4477"><a href="#cb102-4477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4478"><a href="#cb102-4478" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-4479"><a href="#cb102-4479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4480"><a href="#cb102-4480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4481"><a href="#cb102-4481" aria-hidden="true" tabindex="-1"></a>Package for Creating Simple Data Frames</span>
<span id="cb102-4482"><a href="#cb102-4482" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-4483"><a href="#cb102-4483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4484"><a href="#cb102-4484" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-4485"><a href="#cb102-4485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4486"><a href="#cb102-4486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4487"><a href="#cb102-4487" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-4488"><a href="#cb102-4488" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-4489"><a href="#cb102-4489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4490"><a href="#cb102-4490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4491"><a href="#cb102-4491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4492"><a href="#cb102-4492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4493"><a href="#cb102-4493" aria-hidden="true" tabindex="-1"></a><span class="fu">### tidyr </span></span>
<span id="cb102-4494"><a href="#cb102-4494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4495"><a href="#cb102-4495" aria-hidden="true" tabindex="-1"></a>:::::{.my-resource}</span>
<span id="cb102-4496"><a href="#cb102-4496" aria-hidden="true" tabindex="-1"></a>:::{.my-resource-header}</span>
<span id="cb102-4497"><a href="#cb102-4497" aria-hidden="true" tabindex="-1"></a>tidyr: Tidy Messy Data</span>
<span id="cb102-4498"><a href="#cb102-4498" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-4499"><a href="#cb102-4499" aria-hidden="true" tabindex="-1"></a>::::{.my-resource-container}</span>
<span id="cb102-4500"><a href="#cb102-4500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4501"><a href="#cb102-4501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4502"><a href="#cb102-4502" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-4503"><a href="#cb102-4503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4504"><a href="#cb102-4504" aria-hidden="true" tabindex="-1"></a>::: {#pak-tidyr}</span>
<span id="cb102-4505"><a href="#cb102-4505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4506"><a href="#cb102-4506" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-4507"><a href="#cb102-4507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4508"><a href="#cb102-4508" aria-hidden="true" tabindex="-1"></a>{**tidyr**}: <span class="co">[</span><span class="ot">Tidy Messy Data</span><span class="co">](https://tidyr.tidyverse.org/)</span></span>
<span id="cb102-4509"><a href="#cb102-4509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4510"><a href="#cb102-4510" aria-hidden="true" tabindex="-1"></a>::: {layout=&quot;<span class="co">[</span><span class="ot">10, 30</span><span class="co">]</span>&quot; layout-valign=&quot;center&quot;}</span>
<span id="cb102-4511"><a href="#cb102-4511" aria-hidden="true" tabindex="-1"></a><span class="al">![](img/chap01/logoi/logo-tidyr-min.png)</span>{width=&quot;176&quot;}</span>
<span id="cb102-4512"><a href="#cb102-4512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4513"><a href="#cb102-4513" aria-hidden="true" tabindex="-1"></a>The goal of tidyr is to help you create tidy data. Tidy data describes a standard way of storing data that is used wherever possible throughout the tidyverse. If you ensure that your data is tidy, you’ll spend less time fighting with the tools and more time working on your analysis. <span class="co">[</span><span class="ot">@tidyr</span><span class="co">]</span> Tidy data is data where:</span>
<span id="cb102-4514"><a href="#cb102-4514" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Every column is a variable.</span>
<span id="cb102-4515"><a href="#cb102-4515" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Every row is an observation.</span>
<span id="cb102-4516"><a href="#cb102-4516" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Every cell is a single value.</span>
<span id="cb102-4517"><a href="#cb102-4517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4518"><a href="#cb102-4518" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-4519"><a href="#cb102-4519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4520"><a href="#cb102-4520" aria-hidden="true" tabindex="-1"></a>Packages for Tidying Messy Data</span>
<span id="cb102-4521"><a href="#cb102-4521" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-4522"><a href="#cb102-4522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4523"><a href="#cb102-4523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4524"><a href="#cb102-4524" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-4525"><a href="#cb102-4525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4526"><a href="#cb102-4526" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-4527"><a href="#cb102-4527" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-4528"><a href="#cb102-4528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4529"><a href="#cb102-4529" aria-hidden="true" tabindex="-1"></a><span class="fu">### tidyverse</span></span>
<span id="cb102-4530"><a href="#cb102-4530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4531"><a href="#cb102-4531" aria-hidden="true" tabindex="-1"></a>:::::{.my-resource}</span>
<span id="cb102-4532"><a href="#cb102-4532" aria-hidden="true" tabindex="-1"></a>:::{.my-resource-header}</span>
<span id="cb102-4533"><a href="#cb102-4533" aria-hidden="true" tabindex="-1"></a>tidyverse: Easily Install and Load the &#39;Tidyverse&#39;</span>
<span id="cb102-4534"><a href="#cb102-4534" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-4535"><a href="#cb102-4535" aria-hidden="true" tabindex="-1"></a>::::{.my-resource-container}</span>
<span id="cb102-4536"><a href="#cb102-4536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4537"><a href="#cb102-4537" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-4538"><a href="#cb102-4538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4539"><a href="#cb102-4539" aria-hidden="true" tabindex="-1"></a>::: {#pak-tidyverse}</span>
<span id="cb102-4540"><a href="#cb102-4540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4541"><a href="#cb102-4541" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-4542"><a href="#cb102-4542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4543"><a href="#cb102-4543" aria-hidden="true" tabindex="-1"></a>{**tidyverse**}: <span class="co">[</span><span class="ot">Easily Install and Load the &#39;Tidyverse&#39;</span><span class="co">](https://www.tidyverse.org/)</span></span>
<span id="cb102-4544"><a href="#cb102-4544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4545"><a href="#cb102-4545" aria-hidden="true" tabindex="-1"></a>::: {layout=&quot;<span class="co">[</span><span class="ot">10, 30</span><span class="co">]</span>&quot; layout-valign=&quot;center&quot;}</span>
<span id="cb102-4546"><a href="#cb102-4546" aria-hidden="true" tabindex="-1"></a><span class="al">![](img/chap01/logoi/logo-tidyverse-min.png)</span>{width=&quot;176&quot;}</span>
<span id="cb102-4547"><a href="#cb102-4547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4548"><a href="#cb102-4548" aria-hidden="true" tabindex="-1"></a>The {**tidyverse**} is an opinionated [collection of R packages](https://www.tidyverse.org/packages/) designed for data science. All packages share an underlying design philosophy, grammar, and data structures [@tidyverse]. Read more about the philosophy and purpose: [The tidy tools manifesto](https://tidyverse.tidyverse.org/articles/manifesto.html) and [Welcome to the {**tidyverse**}](https://tidyverse.tidyverse.org/articles/paper.html) </span>
<span id="cb102-4549"><a href="#cb102-4549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4550"><a href="#cb102-4550" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-4551"><a href="#cb102-4551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4552"><a href="#cb102-4552" aria-hidden="true" tabindex="-1"></a>In this book I am not going to load {**tidyverse**} with all its packages. Instead I am using the <span class="in">`&lt;package&gt;::&lt;function&gt;`</span> format to access the commands.</span>
<span id="cb102-4553"><a href="#cb102-4553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4554"><a href="#cb102-4554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4555"><a href="#cb102-4555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4556"><a href="#cb102-4556" aria-hidden="true" tabindex="-1"></a>Metapackage: Easily Install and Load the &#39;Tidyverse&#39;</span>
<span id="cb102-4557"><a href="#cb102-4557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4558"><a href="#cb102-4558" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb102-4559"><a href="#cb102-4559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4560"><a href="#cb102-4560" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-4561"><a href="#cb102-4561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4562"><a href="#cb102-4562" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-4563"><a href="#cb102-4563" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb102-4564"><a href="#cb102-4564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4565"><a href="#cb102-4565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4566"><a href="#cb102-4566" aria-hidden="true" tabindex="-1"></a><span class="fu">## Glossary {.unnumbered}</span></span>
<span id="cb102-4567"><a href="#cb102-4567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4568"><a href="#cb102-4568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4569"><a href="#cb102-4569" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-4570"><a href="#cb102-4570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4571"><a href="#cb102-4571" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-4572"><a href="#cb102-4572" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: glossary-table</span></span>
<span id="cb102-4573"><a href="#cb102-4573" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb102-4574"><a href="#cb102-4574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4575"><a href="#cb102-4575" aria-hidden="true" tabindex="-1"></a><span class="fu">glossary_table</span>()</span>
<span id="cb102-4576"><a href="#cb102-4576" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-4577"><a href="#cb102-4577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4578"><a href="#cb102-4578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4579"><a href="#cb102-4579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4580"><a href="#cb102-4580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4581"><a href="#cb102-4581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4582"><a href="#cb102-4582" aria-hidden="true" tabindex="-1"></a><span class="fu">## Session Info {.unnumbered}</span></span>
<span id="cb102-4583"><a href="#cb102-4583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4584"><a href="#cb102-4584" aria-hidden="true" tabindex="-1"></a>:::::{.my-r-code}</span>
<span id="cb102-4585"><a href="#cb102-4585" aria-hidden="true" tabindex="-1"></a>:::{.my-r-code-header}</span>
<span id="cb102-4586"><a href="#cb102-4586" aria-hidden="true" tabindex="-1"></a>Session Info</span>
<span id="cb102-4587"><a href="#cb102-4587" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb102-4588"><a href="#cb102-4588" aria-hidden="true" tabindex="-1"></a>::::{.my-r-code-container}</span>
<span id="cb102-4589"><a href="#cb102-4589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4590"><a href="#cb102-4590" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb102-4591"><a href="#cb102-4591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4592"><a href="#cb102-4592" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb102-4593"><a href="#cb102-4593" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: session-info</span></span>
<span id="cb102-4594"><a href="#cb102-4594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4595"><a href="#cb102-4595" aria-hidden="true" tabindex="-1"></a>sessioninfo<span class="sc">::</span><span class="fu">session_info</span>()</span>
<span id="cb102-4596"><a href="#cb102-4596" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb102-4597"><a href="#cb102-4597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4598"><a href="#cb102-4598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4599"><a href="#cb102-4599" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb102-4600"><a href="#cb102-4600" aria-hidden="true" tabindex="-1"></a>:::::</span></code></pre></div>
</div>
<div class="hidden" aria-hidden="true">
<span class="glightbox-desc lightbox-desc-1">Graph 1.1 (a): Support for marijuana legalization among participants in the 2016 General Social Survey (Figure 1.1)</span>
<span class="glightbox-desc lightbox-desc-2">Graph 1.1 (b): Support for marijuana legalization by age group among participants in the 2016 General Social Survey (Figure 1.2)</span>
<span class="glightbox-desc lightbox-desc-3">Graph 1.2: Support for marijuana legalization among participants in the 2016 General Social Survey (Figure 1.1)</span>
<span class="glightbox-desc lightbox-desc-4">Graph 1.3: Support for marijuana legalization by age group among participants in the 2016 General Social Survey (Figure 1.2)</span>
<span class="glightbox-desc lightbox-desc-8">Graph 1.4: Proportion of marijuana use of the participant in the NHANES 2013 survey</span>
<span class="glightbox-desc lightbox-desc-9">Listing 1.7 (a): Proportion of marijuana use of the participant in the NHANES 2013 survey</span>
<span class="glightbox-desc lightbox-desc-10">Listing 1.8 (a): Proportion of marijuana use of the participant in the NHANES 2013 survey</span>
<span class="glightbox-desc lightbox-desc-11">Graph 1.5: Percentage of NHANES participants by age group answering yes and no to marijuana use in percent of total responses</span>
<span class="glightbox-desc lightbox-desc-12">Graph 1.6: Percentage of NHANES participants of the 2013 survey answering yes and no to marijuana use in percent of age group</span>
<span class="glightbox-desc lightbox-desc-13">Graph 1.7: Proportion of marijuana use of the participant by age group and sex in the NHANES 2013 survey</span>
<span class="glightbox-desc lightbox-desc-14">Graph 1.8 (a): Labelled data as a R code chunk result in RStudio</span>
<span class="glightbox-desc lightbox-desc-15">Graph 1.8 (b): Labelled data in RStudio data viewer</span>
<span class="glightbox-desc lightbox-desc-16">Graph 1.9: Two different approaches to work in R with labelled data</span>
<span class="glightbox-desc lightbox-desc-17">Graph 1.10: GSS Information about the most important NA types</span>
<span class="glightbox-desc lightbox-desc-18">Graph 1.11: Summary of the various Quarto and R Markdown output types and the print engines supporting them</span>
<span class="glightbox-desc lightbox-desc-19">Graph 1.12: Timeline of respondents opinion about legalizing marijuana between 1972-2022 of the GSS data</span>
<span class="glightbox-desc lightbox-desc-20">Package Profile 1.1: Package for Data Manipulation</span>
<span class="glightbox-desc lightbox-desc-21">Package Profile 1.3: forcats: A Package with Tools for Working with Categorical Variables</span>
<span class="glightbox-desc lightbox-desc-22">Package Profile 1.4: Package for Creating Data Visualisations</span>
<span class="glightbox-desc lightbox-desc-23">Package Profile 1.5: Package for Getting the US General Social Survey (GSS) Data More Easily</span>
<span class="glightbox-desc lightbox-desc-24">Package Profile 1.6: {<strong>gt</strong>}: A Package for Presentation-Ready Display Tables</span>
<span class="glightbox-desc lightbox-desc-25">Package Profile 1.7: Package for Presentation-Ready Data Summary and Analytic Result Tables</span>
<span class="glightbox-desc lightbox-desc-26">Package Profile 1.8: haven: A Package for Import and Export of ‘SPSS’, ‘Stata’ and ‘SAS’ Files</span>
<span class="glightbox-desc lightbox-desc-27">Package Profile 1.9: {<strong>pkg-name</strong>}: A Package to Construct Complex Table with ‘kable’ and Pipe Syntax</span>
<span class="glightbox-desc lightbox-desc-28">Package Profile 1.11: labelled: A Package for Manipulating Labelled Data</span>
<span class="glightbox-desc lightbox-desc-29">Package Profile 1.12: sjlabelled: A Package for Labelled Data Utility Functions</span>
<span class="glightbox-desc lightbox-desc-30">Package Profile 1.13: Package for Reading Rectangular Data</span>
<span class="glightbox-desc lightbox-desc-31">Package Profile 1.14: A Package for Compact and Flexible Summaries of Data</span>
<span class="glightbox-desc lightbox-desc-32">Package Profile 1.15: Package for Creating Simple Data Frames</span>
<span class="glightbox-desc lightbox-desc-33">Package Profile 1.16: Packages for Tidying Messy Data</span>
<span class="glightbox-desc lightbox-desc-34">Package Profile 1.17: </span>
</div>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-tibble" class="csl-entry" role="listitem">
Müller, Kirill, and Hadley Wickham. 2023. <span>“Tibble: Simple Data Frames.”</span> <a href="https://CRAN.R-project.org/package=tibble">https://CRAN.R-project.org/package=tibble</a>.
</div>
<div id="ref-ggplot2" class="csl-entry" role="listitem">
Wickham, Hadley. 2016. <span>“Ggplot2: Elegant Graphics for Data Analysis.”</span> <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.
</div>
<div id="ref-tidyverse" class="csl-entry" role="listitem">
Wickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy D’Agostino McGowan, Romain François, Garrett Grolemund, et al. 2019. <span>“Welcome to the <span></span>Tidyverse<span></span>”</span> 4: 1686. <a href="https://doi.org/10.21105/joss.01686">https://doi.org/10.21105/joss.01686</a>.
</div>
<div id="ref-dplyr" class="csl-entry" role="listitem">
Wickham, Hadley, Romain François, Lionel Henry, Kirill Müller, and Davis Vaughan. 2023. <span>“Dplyr: A Grammar of Data Manipulation.”</span> <a href="https://CRAN.R-project.org/package=dplyr">https://CRAN.R-project.org/package=dplyr</a>.
</div>
<div id="ref-readr" class="csl-entry" role="listitem">
Wickham, Hadley, Jim Hester, and Jennifer Bryan. 2024. <span>“Readr: Read Rectangular Text Data.”</span> <a href="https://CRAN.R-project.org/package=readr">https://CRAN.R-project.org/package=readr</a>.
</div>
<div id="ref-tidyr" class="csl-entry" role="listitem">
Wickham, Hadley, Davis Vaughan, and Maximilian Girlich. 2023. <span>“Tidyr: Tidy Messy Data.”</span> <a href="https://CRAN.R-project.org/package=tidyr">https://CRAN.R-project.org/package=tidyr</a>.
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr />
<ol>
<li id="fn1"><p>To prevent conflict with the labelled class from the {<strong>Hmisc</strong>} package {<strong>haven</strong>} has changed with version 2.0.0 its label class names from <code>labelled</code> and <code>labelled_spss</code> to <code>haven_labelled</code> and <code>haven_labelled_spss</code>. (See <a href="https://github.com/tidyverse/haven/issues/329">GitHub Issue #329</a>.)<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id = "quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a  href="/index.html" class="pagination-link  aria-label="Preface">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Preface</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a  href="/02-descriptive-statistics.html" class="pagination-link" aria-label="&lt;span class=&#39;chapter-number&#39;&gt;2&lt;/span&gt;  &lt;span class=&#39;chapter-title&#39;&gt;Descriptive statistics&lt;/span&gt;">
        <span class="nav-page-text"><span class='chapter-number'>2</span>  <span class='chapter-title'>Descriptive statistics</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","loop":false,"descPosition":"bottom","selector":".lightbox","openEffect":"zoom"});
window.onload = () => {
  lightboxQuarto.on('slide_before_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    const href = trigger.getAttribute('href');
    if (href !== null) {
      const imgEl = window.document.querySelector(`a[href="${href}"] img`);
      if (imgEl !== null) {
        const srcAttr = imgEl.getAttribute("src");
        if (srcAttr && srcAttr.startsWith("data:")) {
          slideConfig.href = srcAttr;
        }
      }
    } 
  });

  lightboxQuarto.on('slide_after_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    if (window.Quarto?.typesetMath) {
      window.Quarto.typesetMath(slideNode);
    }
  });

};
          </script>

</body>

</html>
